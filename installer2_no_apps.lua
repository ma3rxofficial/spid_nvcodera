local pkg = {["SpeedAPI"]={["devices"]="function find(name,prior)!@#&  local sides = {!@#&  \"top\";!@#&  \"front\";!@#&  \"left\";!@#&  \"right\";!@#&  \"back\";!@#&  \"bottom\" }!@#&!@#&  if prior==nil then!@#&        p=1!@#&  else!@#&        p=prior!@#&  end!@#&!@#&  for n=1,6 do!@#&        if peripheral.getType(sides[n])==name then!@#&          if p==1 then!@#&                return sides[n]!@#&          else!@#&                p=p-1!@#&          end!@#&        end!@#&  end!@#&  return \"none\"!@#&end",["graph"]="local Graph = {!@#&	getColor = function(self, value, trace)!@#&		local colorIndex = math.ceil((value - self.min[trace]) / ((self.max[trace] - self.min[trace]) / #self.gradient[trace]))!@#&		if colorIndex == 0 then colorIndex = 1 end!@#&		if self.target.isColor() then!@#&			return self.gradient[trace][colorIndex]!@#&		else!@#&			return colors.white!@#&		end!@#&	end,!@#&	draw = function(self)!@#&		--get the updates first.!@#&		for i=1, #self.update do!@#&			self.history[i][#self.history[i] + 1] = self.update[i]()!@#&		end!@#&		if self.target.setTextScale then self.target.setTextScale(0.5) end!@#&		self.target.setBackgroundColor(colors.black)!@#&		self.target.setTextColor(colors.white)!@#&		self.target.clear()!@#&		local newMax, newMin = self.max[1], self.min[1]!@#&		--draw traces!@#&		for trace=1,#self.update do!@#&			if self.history[trace][#self.history[trace]] > self.max[trace] then!@#&				if self.sharedBounds and self.history[trace][#self.history[trace]] > newMax then!@#&					newMax = self.history[trace][#self.history[trace]]!@#&				else!@#&					self.max[trace] = self.history[trace][#self.history[trace]]!@#&				end!@#&			elseif self.history[trace][#self.history[trace]] < self.min[trace] then!@#&				if self.sharedBounds and self.history[trace][#self.history[trace]] < newMin then!@#&					newMin = self.history[trace][#self.history[trace]]!@#&				else!@#&					self.min[trace] = self.history[trace][#self.history[trace]]!@#&				end!@#&			end!@#&			local xLim, yLim = self.target.getSize()!@#&			if #self.history[trace] > xLim then table.remove(self.history[trace], 1) end!@#&			--we set up our value string for numeric value readout here, but draw it later so it doesn't interfere with the full-screen trace.!@#&			for i=1, #self.history[trace] do!@#&				self.target.setCursorPos(i, yLim - math.ceil((yLim - 1) * (self.history[trace][i] - self.min[trace]) / (self.max[trace] - self.min[trace])))!@#&				self.target.setBackgroundColor(self:getColor(self.history[trace][i], trace))!@#&				self.target.write(\" \")!@#&				self.target.setBackgroundColor(colors.black)!@#&			end!@#&		end!@#&		--adjust min-max for next round.!@#&		if self.sharedBounds then!@#&			for i=1, #self.update do!@#&				self.max[i] = newMax!@#&				self.min[i] = newMin!@#&			end!@#&		end!@#&		--draw trace labels.!@#&		for trace = 1, #self.update do!@#&			local valueString, cStart, cEnd = \"\"!@#&			if self.valueText[trace] then!@#&				valueString = self.valueText[trace]..\": \"!@#&				cStart = #valueString + 1!@#&				valueString = valueString..tostring(self.history[trace][#self.history[trace]])!@#&				cEnd = #valueString!@#&				valueString = valueString..\" / \"..self.max[trace]!@#&			end!@#&			local xLim, yLim = self.target.getSize()!@#&			if trace + 1 <= yLim then!@#&				self.target.setCursorPos(2, trace + 1)!@#&				for i=1, #valueString do!@#&					if i >= cStart and i <= cEnd then!@#&						self.target.setTextColor(self:getColor(self.history[trace][#self.history[trace]], trace))!@#&					end!@#&					self.target.write(string.sub(valueString, i, i))!@#&					self.target.setTextColor(colors.white)!@#&				end!@#&			end!@#&		end!@#&	end,!@#&	tostring = function(self)!@#&		local valueString = \"\"!@#&		if self.valueText[1] then!@#&			valueString = self.valueText[1]..\": \"!@#&		end!@#&		valueString = valueString..tostring(self.history[1][#self.history[1]])..\" / \"..self.max[1]!@#&		return valueString!@#&	end,!@#&}!@#&!@#&local gmetatable = {!@#&	__index = Graph,!@#&	__tostring = function(g) return g:tostring() end,!@#&}!@#&!@#&function new(target, updateFunction, valueText, gradientTable, min, max, sharedBounds)!@#&	if not target then return nil, \"Must specify output target!\" end!@#&	if not updateFunction then return nil, \"Must specify update function!\" end!@#&	local g = {!@#&		min = type(min) == \"table\" and min or {},!@#&		max = type(max) == \"table\" and max or {},!@#&		target = target,!@#&		update = type(updateFunction) == \"table\" and updateFunction or {updateFunction},!@#&		history = {},!@#&		gradient = {},!@#&		valueText = type(valueText) == \"table\" and valueText or {valueText},!@#&		sharedBounds = shareBounds or false!@#&	}!@#&	for i=1, #g.update do!@#&		g.history[i] = {}!@#&	end!@#&	if type(min) ~= \"table\" then!@#&		local setMin = min or 0!@#&		for i=1, #g.update do!@#&			g.min[i] = setMin!@#&		end!@#&	end!@#&	if type(max) ~= \"table\" then!@#&		local setMax = max or 1!@#&		for i=1, #g.update do!@#&			g.max[i] = setMax!@#&		end!@#&	end!@#&	if gradientTable and type(gradientTable) == \"table\" and type(gradientTable[1]) == \"table\" then!@#&		g.gradient = gradientTable!@#&	elseif gradientTable and type(gradientTable) == \"table\" then!@#&		for i=1, #g.update do!@#&			g.gradient[i] = gradientTable!@#&		end!@#&	else!@#&		for i=1, #g.update do!@#&			g.gradient[i] = {colors.red, colors.orange, colors.yellow, colors.lime, colors.green}!@#&		end!@#&	end!@#&	setmetatable(g, gmetatable)!@#&	return g!@#&end",["sensor"]="local function waitForResponse( _id )!@#&	while true do!@#&		local event = {os.pullEvent()}!@#&		if event[2] == _id then!@#&			if event[1] == \"ocs_success\" then!@#&				return event[3]!@#&			elseif event[1] == \"ocs_error\" then!@#&				return nil, event[3]!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&function wrap(side)!@#&	local wrappedTable = {}!@#&	if peripheral.getType(side) == \"sensor\" then!@#&		local periph = peripheral.wrap(side)!@#&		for k,v in pairs(periph) do!@#&			if type(k) == \"string\" and type(v) == \"function\" then!@#&				wrappedTable[k] = function(...)!@#&					local id = periph[k](...)!@#&					if id == -1 then!@#&						return false!@#&					end!@#&					return waitForResponse(id)!@#&				end!@#&			end!@#&		end!@#&		return wrappedTable!@#&	else!@#&		return nil, \"not a sensor\"!@#&	end!@#&end!@#&!@#&function call(side, ...)!@#&	if peripheral.getType(side) == \"sensor\" then!@#&		local id = peripheral.call(side, ...)!@#&		if id == -1 then!@#&			return false!@#&		end!@#&		return waitForResponse(id)!@#&	else!@#&		return nil, \"not a sensor\"!@#&	end!@#&end",["bbpack"]="-- +---------------------+------------+---------------------+!@#&-- |                     |            |                     |!@#&-- |                     |   BBPack   |                     |!@#&-- |                     |            |                     |!@#&-- +---------------------+------------+---------------------+!@#&!@#&local version = \"Version 1.6.1\"!@#&!@#&-- Pastebin uploader/downloader for ComputerCraft, by Jeffrey Alexander (aka Bomb Bloke).!@#&-- Handles multiple files in a single paste, as well as non-ASCII symbols within files.!@#&-- Used to be called \"package\".!@#&-- http://www.computercraft.info/forums2/index.php?/topic/21801-!@#&-- pastebin get cUYTGbpb bbpack!@#&!@#&---------------------------------------------!@#&------------Variable Declarations------------!@#&---------------------------------------------!@#&!@#&local band, brshift, blshift = bit.band, bit.brshift, bit.blshift!@#&!@#&local b64 = {}!@#&for i = 1, 64 do!@#&	b64[i - 1] = (\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"):byte(i)!@#&	b64[(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"):sub(i, i)] = i - 1!@#&end!@#&!@#&---------------------------------------------!@#&------------Function Declarations------------!@#&---------------------------------------------!@#&!@#&local unpack = unpack or table.unpack!@#&!@#&local function snooze()!@#&	local myEvent = tostring({})!@#&	os.queueEvent(myEvent)!@#&	os.pullEvent(myEvent)!@#&end!@#&!@#&local function toBase64Internal(inputlist)!@#&	if type(inputlist) ~= \"table\" then error(\"bbpack.toBase64: Expected: table or file handle\", 2) end!@#&!@#&	if inputlist.read then!@#&		local templist, len = {}, 1!@#&!@#&		for byte in inputlist.read do!@#&			templist[len] = byte!@#&			len = len + 1!@#&		end!@#&!@#&		inputlist.close()!@#&		inputlist = templist!@#&	elseif inputlist.readLine then!@#&		inputlist.close()!@#&		error(\"bbpack.toBase64: Use a binary-mode file handle\", 2)!@#&	end!@#&!@#&	if #inputlist == 0 then return \"\" end!@#&!@#&	local curbit, curbyte, outputlist, len = 32, 0, {}, 1!@#&!@#&	for i = 1, #inputlist do!@#&		local inByte, mask = inputlist[i], 128!@#&!@#&		for j = 1, 8 do!@#&			if band(inByte, mask) == mask then curbyte = curbyte + curbit end!@#&			curbit, mask = curbit / 2, mask / 2!@#&!@#&			if curbit < 1 then!@#&				outputlist[len] = b64[curbyte]!@#&				curbit, curbyte, len = 32, 0, len + 1!@#&			end!@#&		end!@#&	end!@#&!@#&	if curbit > 1 then outputlist[len] = b64[curbyte] end!@#&!@#&	return string.char(unpack(outputlist))!@#&end!@#&!@#&local function fromBase64Internal(inData)!@#&	if type(inData) ~= \"string\" and type(inData) ~= \"table\" then error(\"bbpack.fromBase64: Expected: string or file handle\", 2) end!@#&!@#&	if type(inData) == \"table\" then!@#&		if inData.readLine then!@#&			local temp = inData.readAll()!@#&			inData.close()!@#&			inData = temp!@#&		else!@#&			if inData.close then inData.close() end!@#&			error(\"bbpack.fromBase64: Use text-mode file handles\", 2)!@#&		end!@#&	end!@#&!@#&	if #inData == 0 then return {} end!@#&!@#&	local curbyte, curbit, outputlist, len = 0, 128, {}, 1!@#&!@#&	for i = 1, #inData do!@#&		local mask, curchar = 32, b64[inData:sub(i, i)]!@#&!@#&		for j = 1, 6 do!@#&			if band(curchar, mask) == mask then curbyte = curbyte + curbit end!@#&			curbit, mask = curbit / 2, mask / 2!@#&!@#&			if curbit < 1 then!@#&				outputlist[len] = curbyte!@#&				curbit, curbyte, len = 128, 0, len + 1!@#&			end!@#&		end!@#&	end!@#&!@#&	if curbit > 1 and curbyte > 0 then outputlist[len] = curbyte end!@#&!@#&	return outputlist!@#&end!@#&!@#&local function compressIterator(ClearCode)!@#&	local startCodeSize = 1!@#&	while math.pow(2, startCodeSize) < ClearCode do startCodeSize = startCodeSize + 1 end!@#&!@#&	local EOI, ClearCode = math.pow(2, startCodeSize) + 1, math.pow(2, startCodeSize)!@#&	startCodeSize = startCodeSize + 1!@#&!@#&	local curstring, len, curbit, curbyte, outputlist, codes, CodeSize, MaxCode, nextcode, curcode = \"\", 2, 1, 0, {0}, {}, startCodeSize, math.pow(2, startCodeSize) - 1, EOI + 1!@#&!@#&	local function packByte(num)!@#&		local mask = 1!@#&!@#&		for i = 1, CodeSize do!@#&			if band(num, mask) == mask then curbyte = curbyte + curbit end!@#&			curbit, mask = curbit * 2, mask * 2!@#&!@#&			if curbit > 128 or (i == CodeSize and num == EOI) then!@#&				local counter = blshift(brshift(#outputlist - 1, 8), 8) + 1!@#&				outputlist[counter] = outputlist[counter] + 1!@#&!@#&				if outputlist[counter] > 255 then!@#&					outputlist[counter], outputlist[counter + 256], len = 255, 1, len + 1!@#&					snooze()!@#&				end!@#&!@#&				outputlist[len] = curbyte!@#&				curbit, curbyte, len = 1, 0, len + 1!@#&			end!@#&		end!@#&	end!@#&!@#&	packByte(ClearCode)!@#&!@#&	return function(incode)!@#&		if not incode then!@#&			if curcode then packByte(curcode) end!@#&			packByte(EOI)!@#&			outputlist[#outputlist + 1] = 0!@#&			return outputlist!@#&		end!@#&!@#&		if not curcode then!@#&			curcode = incode!@#&			return!@#&		end!@#&!@#&		curstring = curstring .. string.char(incode)!@#&		local thisCode = codes[curstring]!@#&!@#&		if thisCode then!@#&			curcode = thisCode!@#&		else!@#&			codes[curstring] = nextcode!@#&			nextcode = nextcode + 1!@#&!@#&			packByte(curcode)!@#&!@#&			if nextcode == MaxCode + 2 then!@#&				CodeSize = CodeSize + 1!@#&				MaxCode = math.pow(2, CodeSize) - 1!@#&			end!@#&!@#&			if nextcode == 4095 then!@#&				packByte(ClearCode)!@#&				CodeSize, MaxCode, nextcode, codes = startCodeSize, math.pow(2, startCodeSize) - 1, EOI + 1, {}!@#&			end!@#&!@#&			curcode, curstring = incode, string.char(incode)!@#&		end!@#&	end!@#&end!@#&!@#&local function compressInternal(inputlist, valRange)!@#&	if type(inputlist) ~= \"table\" and type(inputlist) ~= \"string\" then error(\"bbpack.compress: Expected: table, string or file handle\", 2) end!@#&!@#&	if not valRange then valRange = 256 end!@#&	if type(valRange) ~= \"number\" or valRange < 2 or valRange > 256 then error(\"bbpack.compress: Value range must be a number between 2 - 256.\", 2) end!@#&!@#&	if type(inputlist) == \"table\" and inputlist.close then!@#&		local templist!@#&		if inputlist.readAll then!@#&			templist = inputlist.readAll()!@#&		else!@#&			local len = 1!@#&			templist = {}!@#&			for thisByte in inputlist.read do!@#&				templist[len] = thisByte!@#&				len = len + 1!@#&			end!@#&		end!@#&		inputlist.close()!@#&		inputlist = templist!@#&	end!@#&!@#&	if type(inputlist) == \"string\" then inputlist = {inputlist:byte(1, #inputlist)} end!@#&!@#&	if #inputlist == 0 then return {} end!@#&!@#&	local compressIt = compressIterator(valRange)!@#&!@#&	local sleepCounter = 0!@#&	for i = 1, #inputlist do!@#&		compressIt(inputlist[i])!@#&!@#&		sleepCounter = sleepCounter + 1!@#&		if sleepCounter > 1023 then!@#&			sleepCounter = 0!@#&			snooze()!@#&		end!@#&	end!@#&!@#&	return compressIt(false)!@#&end!@#&!@#&local function decompressIterator(ClearCode, codelist)!@#&	local startCodeSize = 1!@#&	while math.pow(2, startCodeSize) < ClearCode do startCodeSize = startCodeSize + 1 end!@#&!@#&	local EOI, ClearCode = math.pow(2, startCodeSize) + 1, math.pow(2, startCodeSize)!@#&	startCodeSize = startCodeSize + 1!@#&!@#&	local lastcounter, curbyte, spot, CodeSize, MaxCode, maskbit, nextcode, codes, gotbytes = codelist[1], codelist[2], 3, startCodeSize, math.pow(2, startCodeSize) - 1, 1, EOI + 1, {}, 1!@#&	for i = 0, ClearCode - 1 do codes[i] = string.char(i) end!@#&!@#&	return function()!@#&		while true do!@#&			local curcode, curbit = 0, 1!@#&!@#&			for i = 1, CodeSize do!@#&				if band(curbyte, maskbit) == maskbit then curcode = curcode + curbit end!@#&				curbit, maskbit = curbit * 2, maskbit * 2!@#&!@#&				if maskbit > 128 and not (i == CodeSize and curcode == EOI) then!@#&					maskbit, curbyte, gotbytes = 1, codelist[spot], gotbytes + 1!@#&					spot = spot + 1!@#&!@#&					if gotbytes > lastcounter then!@#&						if curbyte == 0 then break end!@#&						lastcounter, gotbytes = curbyte, 1!@#&						curbyte = codelist[spot]!@#&						spot = spot + 1!@#&						snooze()!@#&					end!@#&				end!@#&			end!@#&!@#&			if curcode == ClearCode then!@#&				CodeSize, MaxCode, nextcode, codes = startCodeSize, math.pow(2, startCodeSize) - 1, EOI + 1, {}!@#&				for i = 0, ClearCode - 1 do codes[i] = string.char(i) end!@#&			elseif curcode ~= EOI then!@#&				if codes[nextcode - 1] then codes[nextcode - 1] = codes[nextcode - 1] .. codes[curcode]:sub(1, 1) else codes[nextcode - 1] = codes[curcode]:sub(1, 1) end!@#&!@#&				if nextcode < 4096 then!@#&					codes[nextcode] = codes[curcode]!@#&					nextcode = nextcode + 1!@#&				end!@#&!@#&				if nextcode - 2 == MaxCode then!@#&					CodeSize = CodeSize + 1!@#&					MaxCode = math.pow(2, CodeSize) - 1!@#&				end!@#&!@#&				return codes[curcode]!@#&			else return end!@#&		end!@#&	end!@#&end!@#&!@#&local function decompressInternal(codelist, outputText, valRange)!@#&	if type(codelist) ~= \"table\" then error(\"bbpack.decompress: Expected: table or file handle\", 2) end!@#&!@#&	if not valRange then valRange = 256 end!@#&	if type(valRange) ~= \"number\" or valRange < 2 or valRange > 256 then error(\"bbpack.decompress: Value range must be a number between 2 - 256.\", 2) end!@#&!@#&	if codelist.readLine then!@#&		codelist.close()!@#&		error(\"bbpack.decompress: Use binary-mode file handles\", 2)!@#&	elseif codelist.readAll then!@#&		codelist = codelist.readAll()!@#&		codelist = {codelist:byte(1, #codelist)}!@#&	elseif codelist.read then!@#&		local data, len = {}, 1!@#&		while true do!@#&			local amount = codelist.read()!@#&			data[len] = amount!@#&			len = len + 1!@#&!@#&			if amount == 0 then break end!@#&!@#&			for i = 1, amount do!@#&				data[len] = codelist.read()!@#&				len = len + 1!@#&			end!@#&!@#&			snooze()!@#&		end!@#&		codelist = data!@#&	elseif #codelist == 0 then return outputText and \"\" or {} end!@#&!@#&	local outputlist, decompressIt, len = {}, decompressIterator(valRange, codelist), 1!@#&!@#&	local sleepCounter = 0!@#&	while true do!@#&		local output = decompressIt()!@#&!@#&		if output then!@#&			outputlist[len] = output!@#&			len = len + 1!@#&		else break end!@#&	end!@#&!@#&	outputlist = table.concat(outputlist)!@#&!@#&	return outputText and outputlist or {outputlist:byte(1, #outputlist)}!@#&end!@#&!@#&local function uploadPasteInternal(name, content)!@#&	if type(name) ~= \"string\" or (type(content) ~= \"string\" and type(content) ~= \"table\") then error(\"bbpack.uploadPaste: Expected: (string) paste name, (string or file handle) paste content\", 2) end!@#&!@#&	if type(content) == \"table\" then!@#&		if content.readLine then!@#&			local temp = content.readAll()!@#&			content.close()!@#&			content = temp!@#&		else!@#&			if content.close then content.close() end!@#&			error(\"bbpack.uploadPaste: Use text-mode file handles\", 2)!@#&		end!@#&	end!@#&!@#&	local webHandle = http.post(!@#&		\"https://pastebin.com/api/api_post.php\", !@#&		\"api_option=paste&\" ..!@#&		\"api_dev_key=147764e5c6ac900a3015d77811334df1&\" ..!@#&		\"api_paste_format=lua&\" ..!@#&		\"api_paste_name=\" .. textutils.urlEncode(name) .. \"&\" ..!@#&		\"api_paste_code=\" .. textutils.urlEncode(content))!@#&!@#&	if webHandle then!@#&		local response = webHandle.readAll()!@#&		webHandle.close()!@#&		return string.match(response, \"[^/]+$\")!@#&	else error(\"Connection to pastebin failed. http API config in ComputerCraft.cfg is enabled, but may be set to block pastebin - or pastebin servers may be busy.\") end!@#&end!@#&!@#&local function downloadPasteInternal(pasteID)!@#&	if type(pasteID) ~= \"string\" then error(\"bbpack.downloadPaste: Expected: (string) paste ID\", 2) end!@#&!@#&	local webHandle = http.get(\"https://pastebin.com/raw/\" .. textutils.urlEncode(pasteID))!@#&!@#&	if webHandle then!@#&		local incoming = webHandle.readAll()!@#&		webHandle.close()!@#&		return incoming!@#&	else error(\"Connection to pastebin failed. http API config in ComputerCraft.cfg is enabled, but may be set to block pastebin - or pastebin servers may be busy.\") end!@#&end!@#&!@#&if shell then!@#&	---------------------------------------------!@#&	------------     Main Program    ------------!@#&	---------------------------------------------!@#&!@#&	if not bbpack then os.loadAPI(\"bbpack\") end!@#&!@#&	local args = {...}!@#&	if #args > 0 then args[1] = args[1]:lower() end!@#&!@#&	if #args < 1 or not (args[1] == \"put\" or args[1] == \"get\" or args[1] == \"fileput\" or args[1] == \"fileget\" or args[1] == \"mount\" or args[1] == \"compress\" or args[1] == \"decompress\" or args[1] == \"cluster\" or args[1] == \"update\") then!@#&		textutils.pagedPrint(\"Usage:\\n\")!@#&!@#&		textutils.pagedPrint(\"Uploads specified file or directory:\")!@#&		textutils.pagedPrint(\"bbpack put [file/directory name]\\n\")!@#&!@#&		textutils.pagedPrint(\"Dumps paste into specified file or directory:\")!@#&		textutils.pagedPrint(\"bbpack get <pasteID> [file/directory name]\\n\")!@#&!@#&		textutils.pagedPrint(\"Writes specified file or directory to archive file:\")!@#&		textutils.pagedPrint(\"bbpack fileput [file/directory name] <target file>\\n\")!@#&!@#&		textutils.pagedPrint(\"Unpacks archive file to specified file or directory:\")!@#&		textutils.pagedPrint(\"bbpack fileget <source file> [file/directory name]\\n\")!@#&!@#&		print(\"For the above options, if [file/directory name] is omitted the root of the drive will be used instead.\\n\")!@#&!@#&		textutils.pagedPrint(\"Enables automatic compression on hdd and compresses all existing files:\")!@#&		textutils.pagedPrint(\"bbpack compress\\n\")!@#&!@#&		textutils.pagedPrint(\"Disables automatic compression on hdd and decompresses all existing files:\")!@#&		textutils.pagedPrint(\"bbpack decompress\\n\")!@#&!@#&		textutils.pagedPrint(\"Mounts a given URL as the specified local file:\")!@#&		textutils.pagedPrint(\"bbpack mount <URL> <fileName>\\n\")!@#&!@#&		textutils.pagedPrint(\"Turns the system into a server for the specified cluster:\")!@#&		textutils.pagedPrint(\"bbpack cluster <clusterName>\\n\")!@#&!@#&		textutils.pagedPrint(\"Mounts the specified cluster as a drive:\")!@#&		textutils.pagedPrint(\"bbpack mount <clusterName>\\n\")!@#&!@#&		textutils.pagedPrint(\"Updates package, reboots, and instructs all mounted cluster servers to do the same:\")!@#&		textutils.pagedPrint(\"bbpack update\\n\")!@#&!@#&		return!@#&	end!@#&!@#&	if (args[1] == \"put\" or args[1] == \"get\") and not http then!@#&		print(\"BBPack's pastebin functionality requires that the http API be enabled.\")!@#&		print(\"Shut down MineCraft game/server, set http_enable to true in ComputerCraft.cfg, then restart.\")!@#&		error()!@#&	end!@#&!@#&	---------------------------------------------!@#&	------------      Uploading      ------------!@#&	---------------------------------------------!@#&!@#&	if args[1] == \"put\" or args[1] == \"fileput\" then!@#&		local toFile!@#&		if args[1] == \"fileput\" then toFile = table.remove(args, #args) end!@#&!@#&		local uploadName, parent!@#&!@#&		if not args[2] then!@#&			print(\"Full system upload - are you sure? (y/n)\")!@#&			if read():sub(1, 1):lower() ~= \"y\" then!@#&				print(\"Aborted.\")!@#&				error()!@#&			end!@#&!@#&			uploadName = os.getComputerLabel()!@#&			if not uploadName then!@#&				print(\"Enter paste title:\")!@#&				uploadName = read()!@#&			end!@#&!@#&			args[2] = \"\"!@#&		end!@#&!@#&		local target, output = shell.resolve(args[2]), {}!@#&		uploadName = uploadName or target!@#&!@#&		if not fs.exists(target) then!@#&			print(\"Invalid target.\")!@#&			error()!@#&		end!@#&!@#&		if fs.isDir(target) then!@#&			local fileList = fs.list(target)!@#&			parent = target!@#&			while #fileList > 0 do!@#&				if fs.isDir(shell.resolve(fs.combine(parent, fileList[#fileList]))) then!@#&					local thisDir = table.remove(fileList, #fileList)!@#&					local newList = fs.list(shell.resolve(fs.combine(parent, thisDir)))!@#&					for i = 1, #newList do fileList[#fileList + 1] = fs.combine(thisDir, newList[i]) end!@#&					if #newList == 0 then output[#output + 1] = thisDir end!@#&				else output[#output + 1] = table.remove(fileList, #fileList) end!@#&			end!@#&			target = output!@#&			output = {}!@#&		else parent, target = \"\", {target} end!@#&!@#&		snooze()!@#&!@#&		for i = #target, 1, -1 do!@#&			if fs.combine(parent, target[i]) ~= shell.getRunningProgram() and not (parent == \"\" and fs.getDrive(target[i]) ~= \"hdd\") then!@#&				if fs.isDir(fs.combine(parent, target[i])) then!@#&					print(target[i])!@#&					output[#output + 1] = {target[i], true}!@#&				else!@#&					print(target[i])!@#&					output[#output + 1] = {target[i], toBase64Internal(compressInternal(fs.open(fs.combine(parent, target[i]), \"rb\")))}!@#&					snooze()!@#&				end!@#&			end!@#&		end!@#&!@#&		if toFile then!@#&			output = textutils.serialize(output)!@#&			if fs.getFreeSpace(shell.dir()) < #output then error(\"Output \"..#output..\" bytes, disk space available \"..fs.getFreeSpace(shell.dir())..\" bytes: file not written.\") end!@#&!@#&			write(\"Writing to file \\\"\" .. toFile .. \"\\\"... \")!@#&!@#&			toFile = fs.open(shell.resolve(toFile), \"w\")!@#&			toFile.write(output)!@#&			toFile.close()!@#&			print(\"Success.\")!@#&		else!@#&			write(\"Connecting to pastebin.com... \")!@#&			local response = uploadPasteInternal(uploadName, textutils.serialize(output))!@#&			print(\"Success.\")!@#&!@#&			print(\"Uploaded to paste ID: \" .. response)!@#&			print(\"Run \\\"bbpack get \" .. response .. (parent == \"\" and \"\" or \" \" .. parent) .. \"\\\" to download.\")!@#&		end!@#&!@#&	---------------------------------------------!@#&	------------     Downloading     ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"get\" or args[1] == \"fileget\" then!@#&		local incoming!@#&		if args[1] == \"fileget\" then!@#&			write(\"Attempting to read from archive... \")!@#&			if not fs.exists(shell.resolve(args[2])) then error(\"Can't find \\\"\" .. shell.resolve(args[2]) .. \"\\\".\") end!@#&			local inFile = fs.open(shell.resolve(args[2]), \"r\")!@#&			incoming = textutils.unserialize(inFile.readAll())!@#&			inFile.close()!@#&			print(\"Success.\")!@#&		else!@#&			write(\"Connecting to pastebin.com... \")!@#&			incoming = textutils.unserialize(downloadPasteInternal(args[2]))!@#&			print(\"Downloaded.\")!@#&		end!@#&!@#&		local function getParent(path)!@#&			local pos = #path!@#&			if path:sub(pos,pos) == \"/\" then pos = pos - 1 end!@#&			while pos > 0 and path:sub(pos,pos) ~= \"/\" do pos = pos - 1 end!@#&			return pos > 0 and path:sub(1, pos - 1) or \"\"!@#&		end!@#&!@#&		local function writeFile(filePath, fileContent)!@#&			local path = fs.combine(shell.resolve(\".\"), filePath)!@#&			if not fs.exists(getParent(path)) then fs.makeDir(getParent(path)) end!@#&			if fs.getFreeSpace(shell.dir()) < #fileContent then error(path..\" \"..#fileContent..\" bytes, disk space available \"..fs.getFreeSpace(shell.dir())..\" bytes: file not written.\") end!@#&!@#&			snooze()!@#&!@#&			local myFile = fs.open(path, \"wb\")!@#&			for i = 1, #fileContent do myFile.write(fileContent[i]) end!@#&			myFile.close()!@#&!@#&			snooze()!@#&		end!@#&!@#&		args[3] = args[3] or \"\"!@#&		if args[3] ~= \"\" and #incoming == 1 then!@#&			print(incoming[1][1] .. \" => \"..args[3])!@#&			writeFile(args[3], decompressInternal(fromBase64Internal(incoming[1][2])))!@#&		else!@#&			for i = 1, #incoming do!@#&				print(incoming[i][1])!@#&				if type(incoming[i][2]) == \"string\" then!@#&					writeFile(fs.combine(args[3], incoming[i][1]), decompressInternal(fromBase64Internal(incoming[i][2])))!@#&				else fs.makeDir(fs.combine(shell.resolve(\".\"), fs.combine(args[3], incoming[i][1]))) end!@#&				incoming[i] = nil!@#&			end	!@#&		end!@#&!@#&	---------------------------------------------!@#&	------------     Compress FS     ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"compress\" then!@#&		bbpack.fileSys(true)!@#&		print(\"Filesystem compression enabled.\")!@#&!@#&	---------------------------------------------!@#&	------------    Decompress FS    ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"decompress\" then!@#&		print(bbpack.fileSys(false) and \"Filesystem compression disabled.\" or \"Filesystem compression disabled, but space is insufficient to decompress all files.\")!@#&!@#&	---------------------------------------------!@#&	------------        Mount        ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"mount\" then!@#&		bbpack.fileSys(args[2], args[3] and shell.resolve(args[3]))!@#&		print(\"Successfully mounted.\")!@#&!@#&	---------------------------------------------!@#&	------------       Cluster       ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"cluster\" then!@#&		local cluster, protocol = args[2], rednet.host and args[2]!@#&!@#&		rfs.makeDir(cluster)!@#&!@#&		for _, side in pairs(rs.getSides()) do if peripheral.getType(side) == \"modem\" then rednet.open(side) end end!@#&!@#&		print(\"Running as part of cluster \\\"\" .. cluster .. \"\\\"...\")!@#&!@#&		local function locFile(path)!@#&			local matches = rfs.find(path .. \"*\")!@#&!@#&			for i = 1, #matches do!@#&				local thisMatch = matches[i]!@#&				if #thisMatch == #path + 3 and thisMatch:sub(1, #path) == path then return thisMatch end!@#&			end!@#&!@#&			return nil!@#&		end!@#&		!@#&		return (function() while true do!@#&			local sender, msg = rednet.receive(protocol)!@#&!@#&			if type(msg) == \"table\" and msg.cluster == cluster then!@#&				local command, par1, par2 = unpack(msg)!@#&!@#&				if command == \"rollcall\" then!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, \"rollcallResponse\"}, protocol)!@#&				elseif command == \"isDir\" then!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, rfs.isDir(par1)}, protocol)!@#&				elseif command == \"makeDir\" then!@#&					rfs.makeDir(par1)!@#&				elseif command == \"exists\" then!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, type(locFile(par1)) == \"string\"}, protocol)!@#&				elseif command == \"getFreeSpace\" then!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, {rfs.getFreeSpace(\"\") - 10000, os.getComputerID()}}, protocol)!@#&				elseif command == \"getSize\" then!@#&					local path = locFile(par1)!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, path and rfs.getSize(path) or 0}, protocol)!@#&				elseif command == \"delete\" then!@#&					local path = locFile(par1)!@#&					if path then rfs.delete(path) end!@#&				elseif command == \"list\" then!@#&					local list = rfs.list(par1)!@#&!@#&					for i = 1, #list do!@#&						local entry = list[i]!@#&						if not fs.isDir(fs.combine(par1, entry)) then list[i] = entry:sub(1, -4) end!@#&					end!@#&!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, list}, protocol)!@#&				elseif command == \"get\" then!@#&					local path = locFile(par1)!@#&!@#&					if path then!@#&						local file, content = rfs.open(path, \"rb\")!@#&!@#&						if file.readAll then!@#&							content = file.readAll()!@#&						else!@#&							content = {}!@#&							local counter = 1!@#&							for byte in file.read do!@#&								content[counter] = byte!@#&								counter = counter + 1!@#&							end!@#&							content = string.char(unpack(content))!@#&						end!@#&!@#&						file.close()!@#&!@#&						rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, {tonumber(path:sub(-3)), content}}, protocol)!@#&					end!@#&					!@#&					rednet.send(sender, {[\"cluster\"] = cluster, [\"uuid\"] = msg.uuid, false}, protocol)!@#&				elseif command == \"put\" then!@#&					local file = rfs.open(par1, \"wb\")!@#&!@#&					if term.setPaletteColour then!@#&						file.write(par2)!@#&					else!@#&						par2 = {par2:byte(1, #par2)}!@#&						for i = 1, #par2 do file.write(par2[i]) end!@#&					end!@#&!@#&					file.close()!@#&				elseif command == \"update\" then!@#&					local file = rfs.open(\"bbpack\", \"w\")!@#&					file.write(downloadPasteInternal(\"cUYTGbpb\"))!@#&					file.close()!@#&!@#&					os.reboot()!@#&				end!@#&			end!@#&		end end)()!@#&!@#&	---------------------------------------------!@#&	------------        Update       ------------!@#&	---------------------------------------------!@#&!@#&	elseif args[1] == \"update\" then!@#&		bbpack.update()!@#&	end!@#&else!@#&	---------------------------------------------!@#&	------------     Load As API     ------------!@#&	---------------------------------------------!@#&!@#&	compress =      compressInternal!@#&	decompress =    decompressInternal!@#&!@#&	toBase64 =      toBase64Internal!@#&	fromBase64 =    fromBase64Internal!@#&!@#&	uploadPaste =   uploadPasteInternal!@#&	downloadPaste = downloadPasteInternal!@#&!@#&	function open(file, mode, valRange)!@#&		if (type(file) ~= \"table\" and type(file) ~= \"string\") or type(mode) ~= \"string\" then error(\"bbpack.open: Expected: file (string or handle), mode (string). Got: \" .. type(file) .. \", \" .. type(mode) .. \".\", 2) end!@#&!@#&		mode = mode:lower()!@#&		local binary, append, read, write, newhandle = mode:find(\"b\") ~= nil, mode:find(\"a\") ~= nil, mode:find(\"r\") ~= nil, mode:find(\"w\") ~= nil, {}!@#&!@#&		if not valRange then valRange = 256 end!@#&		if type(valRange) ~= \"number\" or valRange < 2 or valRange > 256 then error(\"bbpack.decompress: Value range must be a number between 2 - 256.\", 2) end!@#&!@#&		if not (append or write or read) then error(\"bbpack.open: Invalid file mode: \" .. mode, 2) end!@#&!@#&		if type(file) == \"string\" then!@#&			if append and rfs.exists(file) then!@#&				local oldfile = open(file, binary and \"rb\" or \"r\", valRange)!@#&				if not oldfile then return nil end!@#&				local olddata = oldfile.readAll()!@#&				oldfile.close()!@#&!@#&				newhandle = open(file, binary and \"wb\" or \"w\", valRange)!@#&				newhandle.write(olddata)!@#&				return newhandle!@#&			end!@#&!@#&			file = rfs.open(file, (read and \"r\" or \"w\") .. \"b\")!@#&			if not file then return nil end!@#&		else!@#&			if (write and (file.writeLine or not file.write)) or (read and not file.read) then error(\"bbpack.open: Handle / mode mismatch.\", 2) end!@#&!@#&			local tempfile, keys = {}, {}!@#&!@#&			for key, _ in pairs(file) do keys[#keys + 1] = key end!@#&			for i = 1, #keys do!@#&				tempfile[keys[i]] = file[keys[i]]!@#&				file[keys[i]] = nil!@#&			end!@#&!@#&			file = tempfile!@#&		end!@#&!@#&		if read then!@#&			local data = {}!@#&			if file.readAll then!@#&				local len = 1!@#&!@#&				while true do!@#&					local amount = file.read()!@#&					data[len] = string.char(amount)!@#&					len = len + 1!@#&!@#&					if amount == 0 then break end!@#&!@#&					data[len] = file.read(amount)!@#&					len = len + 1!@#&				end!@#&!@#&				data = table.concat(data)!@#&				data = {data:byte(1, #data)}!@#&			else!@#&				local len = 1!@#&!@#&				while true do!@#&					local amount = file.read()!@#&					data[len] = amount!@#&					len = len + 1!@#&!@#&					if amount == 0 then break end!@#&!@#&					for i = 1, amount do!@#&						data[len] = file.read()!@#&						len = len + 1!@#&					end!@#&!@#&					snooze()!@#&				end!@#&			end!@#&!@#&			local decompressIt, outputlist = decompressIterator(valRange, data), \"\"!@#&!@#&			if binary then!@#&				function newhandle.read(amount)!@#&					if not outputlist then return nil end!@#&!@#&					if type(amount) ~= \"number\" then!@#&						if #outputlist == 0 then!@#&							outputlist = decompressIt()!@#&							if not outputlist then return nil end!@#&						end!@#&!@#&						local result = outputlist:byte(1)!@#&						outputlist = outputlist:sub(2)!@#&						return result!@#&					else!@#&						while #outputlist < amount do!@#&							local new = decompressIt()!@#&!@#&							if not new then!@#&								new = outputlist!@#&								outputlist = nil!@#&								if #new > 0 then return new else return end!@#&							end!@#&!@#&							outputlist = outputlist .. new!@#&						end!@#&!@#&						local result = outputlist:sub(1, amount)!@#&						outputlist = outputlist:sub(amount + 1)!@#&						return result!@#&					end!@#&				end!@#&!@#&				function newhandle.readAll()!@#&					if not outputlist then return nil end!@#&!@#&					local result, len = {outputlist}, 2!@#&					for data in decompressIt do!@#&						result[len] = data!@#&						len = len + 1!@#&					end!@#&!@#&					outputlist = nil!@#&!@#&					return table.concat(result)!@#&				end!@#&			else!@#&				function newhandle.readLine()!@#&					if not outputlist then return nil end!@#&!@#&					while not outputlist:find(\"\\n\") do!@#&						local new = decompressIt()!@#&!@#&						if not new then!@#&							new = outputlist!@#&							outputlist = nil!@#&							if #new > 0 then return new else return end!@#&						end!@#&!@#&						outputlist = outputlist .. new!@#&					end!@#&!@#&					local result = outputlist:sub(1, outputlist:find(\"\\n\") - 1)!@#&					outputlist = outputlist:sub(outputlist:find(\"\\n\") + 1)!@#&!@#&					if outputlist:byte(1) == 13 then outputlist = outputlist:sub(2) end!@#&!@#&					return result!@#&				end!@#&!@#&				function newhandle.readAll()!@#&					if not outputlist then return nil end!@#&!@#&					local result, len = {outputlist}, 2!@#&					for data in decompressIt do!@#&						result[len] = data!@#&						len = len + 1!@#&					end!@#&!@#&					outputlist = nil!@#&!@#&					return table.concat(result)!@#&				end!@#&			end!@#&!@#&			function newhandle.extractHandle()!@#&				local keys = {}!@#&				for key, _ in pairs(newhandle) do keys[#keys + 1] = key end!@#&				for i = 1, #keys do newhandle[keys[i]] = nil end!@#&				return file!@#&			end!@#&		else!@#&			local compressIt = compressIterator(valRange)!@#&!@#&			if binary then!@#&				function newhandle.write(data)!@#&					if type(data) == \"number\" then!@#&						compressIt(data)!@#&					elseif type(data) == \"string\" then!@#&						data = {data:byte(1, #data)}!@#&						for i = 1, #data do compressIt(data[i]) end!@#&					else error(\"bbpackHandle.write: bad argument #1 (string or number expected, got \" .. type(data) .. \")\", 2) end!@#&				end!@#&			else!@#&				function newhandle.write(text)!@#&					text = tostring(text)!@#&					text = {text:byte(1, #text)}!@#&					for i = 1, #text do compressIt(text[i]) end!@#&				end!@#&!@#&				function newhandle.writeLine(text)!@#&					text = tostring(text)!@#&					text = {text:byte(1, #text)}!@#&					for i = 1, #text do compressIt(text[i]) end!@#&					compressIt(10)!@#&				end!@#&			end!@#&!@#&			newhandle.flush = file.flush!@#&!@#&			function newhandle.extractHandle()!@#&				local output, fWrite = compressIt(false), file.write!@#&				for j = 1, #output do fWrite(output[j]) end!@#&				local keys = {}!@#&				for key, _ in pairs(newhandle) do keys[#keys + 1] = key end!@#&				for i = 1, #keys do newhandle[keys[i]] = nil end!@#&				return file!@#&			end!@#&		end!@#&!@#&		function newhandle.close()!@#&			newhandle.extractHandle().close()!@#&		end!@#&!@#&		return newhandle!@#&	end!@#&!@#&	function lines(file)!@#&		if type(file) == \"string\" then!@#&			file = open(file, \"r\")!@#&		elseif type(file) ~= \"table\" or not file.readLine then!@#&			error(\"bbpack.lines: Expected: file (string or \\\"r\\\"-mode handle).\", 2)!@#&		end!@#&!@#&		return function()!@#&			if not file.readLine then return nil end!@#&!@#&			local line = file.readLine()!@#&			if line then!@#&				return line!@#&			else!@#&				file.close()!@#&				return nil!@#&			end!@#&		end!@#&	end!@#&	!@#&	local function dividePath(path)!@#&		local result = {}!@#&		for element in path:gmatch(\"[^/]+\") do result[#result + 1] = element end!@#&		return result!@#&	end!@#&	!@#&	local function getGithubRepo(repo)!@#&		local elements = dividePath(repo)!@#&		for i = 1, #elements do if table.remove(elements, 1) == \"github.com\" then break end end!@#&		if #elements < 2 or elements[3] == \"raw\" then return end!@#&		repo = elements[1] .. \"/\" .. elements[2]!@#&		local branch = (elements[3] == \"tree\") and elements[4] or \"master\"!@#&		!@#&		local webHandle = http.get(\"https://api.github.com/repos/\" .. repo .. \"/git/trees/\" .. branch .. \"?recursive=1\")!@#&		if not webHandle then return end!@#&		local json = textutils.unserialize(webHandle.readAll():gsub(\"\\10\", \"\"):gsub(\" \", \"\"):gsub(\"%[\", \"{\"):gsub(\"]\", \"}\"):gsub(\"{\\\"\", \"{[\\\"\"):gsub(\",\\\"\", \",[\\\"\"):gsub(\"\\\":\", \"\\\"]=\"))!@#&		webHandle.close()!@#&		if json.message == \"Not Found\" then return end!@#&		!@#&		local tree, results = json.tree, {}!@#&		!@#&		for i = 1, #tree do if tree[i].type == \"blob\" then!@#&			local path, cur = tree[i].path, results!@#&			local elements = dividePath(path)!@#&			!@#&			for i = 1, #elements - 1 do!@#&				local element = elements[i]!@#&				if not cur[element] then cur[element] = {} end!@#&				cur = cur[element]!@#&			end!@#&			!@#&			cur[elements[#elements]] = \"https://raw.githubusercontent.com/\" .. repo .. \"/\" .. branch .. \"/\" .. path!@#&		end end!@#&		!@#&		if #elements > 4 then for i = 5, #elements do results = results[elements[i]] end end!@#&		!@#&		return (type(results) == \"table\") and results!@#&	end!@#&	!@#&	local configTable = {[\"webMounts\"] = {}, [\"githubRepos\"] = {}, [\"clusters\"] = {}, [\"compressedFS\"] = false}!@#&!@#&	if fs.exists(\".bbpack.cfg\") then!@#&		local file = rfs and rfs.open(\".bbpack.cfg\", \"r\") or fs.open(\".bbpack.cfg\", \"r\")!@#&		local input = textutils.unserialize(file.readAll())!@#&		file.close()!@#&		!@#&		if type(input) == \"table\" then!@#&			if type(input.webMounts) == \"table\" then configTable.webMounts = input.webMounts end!@#&			if type(input.githubRepos) == \"table\" then configTable.githubRepos = input.githubRepos end!@#&			if type(input.clusters) == \"table\" then configTable.clusters = input.clusters end!@#&			if type(input.compressedFS) == \"boolean\" then configTable.compressedFS = input.compressedFS end!@#&		end!@#&	end!@#&	!@#&	local webMountList, clusterList, repoList = configTable.webMounts, configTable.clusters, {}!@#&	for path, url in pairs(configTable.githubRepos) do repoList[path] = getGithubRepo(url) end!@#&	if next(clusterList) then for _, side in pairs(rs.getSides()) do if peripheral.getType(side) == \"modem\" then rednet.open(side) end end end!@#&	local blacklist = {\"bbpack\", \"bbpack.lua\", \"startup\", \"startup.lua\", \".settings\", \".gif\", \".zip\", \".bbpack.cfg\"}!@#&!@#&	if not _G.rfs then!@#&		local rfs, ramdisk = {}, {}!@#&!@#&		for key, value in pairs(fs) do rfs[key] = value end!@#&		!@#&		local function clusterTalk(cluster, answer, ...)!@#&			local target, uuid, result, sender, msg = clusterList[cluster], math.random(1, 0x7FFFFFFF), {}!@#&!@#&			for i = 1, #target do rednet.send(target[i], {[\"cluster\"] = cluster, [\"uuid\"] = uuid, unpack(arg)}, rednet.host and cluster) end!@#&!@#&			if answer then!@#&				for i = 1, #target do!@#&					repeat sender, msg = rednet.receive(rednet.host and cluster) until type(msg) == \"table\" and msg.cluster == cluster and msg.uuid == uuid!@#&					result[i] = msg[1]!@#&				end!@#&!@#&				return result!@#&			end!@#&		end!@#&!@#&		_G.fs.list = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if not fs.isDir(path) then error(\"Not a directory\", 2) end!@#&!@#&			if fs.getDrive(path) == \"hdd\" then!@#&				local results = rfs.list(path)!@#&!@#&				for i = 1, #results do!@#&					local thisResult = results[i]!@#&					if thisResult:sub(-4) == \".bbp\" then results[i] = thisResult:sub(1, -5) end!@#&				end!@#&!@#&				for mount in pairs(webMountList) do!@#&					local mountElements = dividePath(mount)!@#&!@#&					if #elements == #mountElements - 1 then!@#&						local match = true!@#&!@#&						for i = 1, #elements do if elements[i] ~= mountElements[i] then!@#&							match = false!@#&							break!@#&						end end!@#&!@#&						if match then results[#results + 1] = mountElements[#mountElements] end!@#&					end!@#&				end!@#&!@#&				if path == \"\" then!@#&					results[#results + 1] = \"ram\"!@#&					for cluster in pairs(clusterList) do results[#results + 1] = cluster end!@#&					for repo in pairs(repoList) do results[#results + 1] = repo end!@#&				end!@#&!@#&				table.sort(results)!@#&!@#&				return results!@#&			elseif clusterList[elements[1]] then!@#&				local results = {}!@#&!@#&				local lists = clusterTalk(elements[1], true, \"list\", path)!@#&				for i = 1, #clusterList[elements[1]] do!@#&					local subList = lists[i]!@#&!@#&					for i = 1, #subList do!@#&						local found, thisSub = false, subList[i]!@#&!@#&						for j = 1, #results do if results[j] == thisSub then!@#&							found = true!@#&							break!@#&						end end!@#&!@#&						if not found then results[#results + 1] = thisSub end!@#&					end!@#&				end!@#&!@#&				table.sort(results)!@#&!@#&				return results!@#&			elseif elements[1] == \"ram\" or repoList[elements[1]] then!@#&				local cur, results = (elements[1] == \"ram\") and ramdisk or repoList[elements[1]], {}!@#&!@#&				for i = 2, #elements do cur = cur[elements[i]] end!@#&!@#&				for entry in pairs(cur) do results[#results + 1] = entry end!@#&!@#&				table.sort(results)!@#&!@#&				return results!@#&			else!@#&				return rfs.list(path)!@#&			end!@#&		end!@#&!@#&		_G.fs.exists = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if webMountList[path] then!@#&				return true!@#&			elseif clusterList[elements[1]] then!@#&				if #elements == 1 then return true end!@#&				local list = clusterTalk(elements[1], true, \"exists\", path)!@#&				for i = 1, #list do if list[i] then return true end end!@#&				return false!@#&			elseif elements[1] == \"ram\" or repoList[elements[1]] then!@#&				local cur = (elements[1] == \"ram\") and ramdisk or repoList[elements[1]]!@#&!@#&				for i = 2, #elements do!@#&					cur = cur[elements[i]]!@#&					if not cur then return false end!@#&				end!@#&!@#&				return true!@#&			else!@#&				return rfs.exists(path..\".bbp\") or rfs.exists(path)!@#&			end!@#&		end!@#&!@#&		_G.fs.isDir = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			if not fs.exists(path) then return false end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if clusterList[elements[1]] then!@#&				if #elements == 1 then return true end!@#&				local list = clusterTalk(elements[1], true, \"isDir\", path)!@#&				return list[1]!@#&			elseif elements[1] == \"ram\" or repoList[elements[1]] then!@#&				local cur = (elements[1] == \"ram\") and ramdisk or repoList[elements[1]]!@#&!@#&				for i = 2, #elements do!@#&					cur = cur[elements[i]]!@#&				end!@#&!@#&				return type(cur) == \"table\"!@#&			else!@#&				return rfs.isDir(path)!@#&			end!@#&		end!@#&!@#&		_G.fs.isReadOnly = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if webMountList[path] or repoList[elements[1]] then!@#&				return true!@#&			elseif clusterList[elements[1]] or elements[1] == \"ram\" then!@#&				return false!@#&			else!@#&				return rfs.isReadOnly(rfs.exists(path..\".bbp\") and (path..\".bbp\") or path)!@#&			end!@#&		end!@#&!@#&		_G.fs.getDrive = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if clusterList[elements[1]] or elements[1] == \"ram\" or repoList[elements[1]] then!@#&				return fs.exists(path) and elements[1]!@#&			else!@#&				return rfs.getDrive(rfs.exists(path..\".bbp\") and (path..\".bbp\") or path)!@#&			end!@#&		end!@#&!@#&		_G.fs.getSize = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if webMountList[path] or repoList[elements[1]] then!@#&				return 0!@#&			elseif clusterList[elements[1]] then!@#&				if #elements == 1 then return 0 end!@#&				if not fs.exists(path) then error(\"No such file\", 2) end!@#&!@#&				local size, list = 0, clusterTalk(elements[1], true, \"getSize\", path)!@#&				for i = 1, #clusterList[elements[1]] do size = size + list[i] end!@#&				return size!@#&			elseif elements[1] == \"ram\" then!@#&				local cur = ramdisk!@#&!@#&				for i = 2, #elements do!@#&					cur = cur[elements[i]]!@#&					if not cur then error(\"No such file\", 2) end!@#&				end!@#&!@#&				return type(cur) == \"string\" and #cur or 0!@#&			else!@#&				return rfs.getSize(rfs.exists(path..\".bbp\") and (path..\".bbp\") or path)!@#&			end!@#&		end!@#&!@#&		_G.fs.getFreeSpace = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if clusterList[elements[1]] then!@#&				local size, list = 0, clusterTalk(elements[1], true, \"getFreeSpace\")!@#&				for i = 1, #clusterList[elements[1]] do size = size + list[i][1] end!@#&				return size!@#&			elseif elements[1] == \"ram\" then!@#&				return math.huge!@#&			elseif repoList[elements[1]] then!@#&				return 0!@#&			else!@#&				return rfs.getFreeSpace(path)!@#&			end!@#&		end!@#&!@#&		_G.fs.makeDir = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if fs.exists(path) then!@#&				if fs.isDir(path) then!@#&					return!@#&				else!@#&					error(\"File exists\", 2)!@#&				end!@#&			end!@#&!@#&			if clusterList[elements[1]] then!@#&				clusterTalk(elements[1], false, \"makeDir\", path)!@#&			elseif elements[1] == \"ram\" then!@#&				local cur = ramdisk!@#&!@#&				for i = 2, #elements do!@#&					local next = cur[elements[i]]!@#&!@#&					if next then!@#&						cur = next!@#&					else!@#&						cur[elements[i]] = {}!@#&						cur = cur[elements[i]]!@#&					end!@#&				end!@#&			elseif repoList[elements[1]] then!@#&				error(\"Access denied\", 2)!@#&			else!@#&				return rfs.makeDir(path)!@#&			end!@#&		end!@#&!@#&		_G.fs.move = function(path1, path2)!@#&			if type(path1) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path1) .. \")\", 2 ) end!@#&			if type(path2) ~= \"string\" then error(\"bad argument #2 (expected string, got \" .. type(path2) .. \")\", 2 ) end!@#&			path1, path2 = fs.combine(path1, \"\"), fs.combine(path2, \"\")!@#&!@#&			if not fs.exists(path1) then error(\"No such file\", 2) end!@#&			if fs.exists(path2) then error(\"File exists\", 2) end!@#&			if fs.isReadOnly(path1) or fs.isReadOnly(path2) or (#dividePath(path1) == 1 and fs.getDrive(path1) ~= \"hdd\") then error(\"Access denied\", 2) end!@#&			if #dividePath(path1) < #dividePath(path2) and path2:sub(#path1) == path1 then error(\"Can't copy a directory inside itself\", 2) end!@#&			-- ... and if we run out of space we'll just let things fall over at the writing level.!@#&!@#&			if fs.isDir(path1) then!@#&				fs.makeDir(path2)!@#&				local list = fs.list(path1)!@#&				for i = 1, #list do fs.move(fs.combine(path1, list[i]), fs.combine(path2, list[i])) end!@#&			else!@#&				local input, output = fs.open(path1, \"rb\"), fs.open(path2, \"wb\")!@#&!@#&				if input.readAll then!@#&					output.write(input.readAll())!@#&				else!@#&					for byte in input.read do output.write(byte) end!@#&				end!@#&!@#&				input.close()!@#&				output.close()!@#&			end!@#&!@#&			fs.delete(path1)!@#&		end!@#&!@#&		_G.fs.copy = function(path1, path2)!@#&			if type(path1) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path1) .. \")\", 2 ) end!@#&			if type(path2) ~= \"string\" then error(\"bad argument #2 (expected string, got \" .. type(path2) .. \")\", 2 ) end!@#&			path1, path2 = fs.combine(path1, \"\"), fs.combine(path2, \"\")!@#&!@#&			if not fs.exists(path1) then error(\"No such file\", 2) end!@#&			if fs.exists(path2) then error(\"File exists\", 2) end!@#&			if fs.isReadOnly(path2) then error(\"Access denied\", 2) end!@#&			if #dividePath(path1) < #dividePath(path2) and path2:sub(#path1) == path1 then error(\"Can't copy a directory inside itself\", 2) end!@#&			-- ... and if we run out of space we'll just let things fall over at the writing level.!@#&!@#&			if fs.isDir(path1) then!@#&				fs.makeDir(path2)!@#&				local list = fs.list(path1)!@#&				for i = 1, #list do fs.copy(fs.combine(path1, list[i]), fs.combine(path2, list[i])) end!@#&			else!@#&				local input, output = fs.open(path1, \"rb\"), fs.open(path2, \"wb\")!@#&!@#&				if input.readAll then!@#&					output.write(input.readAll())!@#&				else!@#&					for byte in input.read do output.write(byte) end!@#&				end!@#&!@#&				input.close()!@#&				output.close()!@#&			end!@#&		end!@#&!@#&		_G.fs.delete = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			if not fs.exists(path) then return end!@#&!@#&			if webMountList[path] then!@#&				webMountList[path] = nil!@#&				local file = rfs.open(\".bbpack.cfg\", \"w\")!@#&				file.write(textutils.serialize(configTable))!@#&				file.close()!@#&			elseif clusterList[elements[1]] then!@#&				if #elements == 1 then!@#&					clusterList[elements[1]] = nil!@#&					local file = rfs.open(\".bbpack.cfg\", \"w\")!@#&					file.write(textutils.serialize(configTable))!@#&					file.close()!@#&				else!@#&					clusterTalk(elements[1], false, \"delete\", path)!@#&				end!@#&			elseif repoList[elements[1]] then!@#&				if #elements == 1 then!@#&					repoList[elements[1]], configTable.githubRepos[elements[1]] = nil, nil!@#&					local file = rfs.open(\".bbpack.cfg\", \"w\")!@#&					file.write(textutils.serialize(configTable))!@#&					file.close()!@#&				else!@#&					error(\"Access denied\", 2)!@#&				end!@#&			elseif elements[1] == \"ram\" then!@#&				if #elements == 1 then error(\"Access denied\", 2) end!@#&!@#&				local cur = ramdisk!@#&!@#&				for i = 2, #elements - 1 do!@#&					cur = cur[elements[i]]!@#&					if not cur then return end!@#&				end!@#&!@#&				cur[elements[#elements]] = nil!@#&			else!@#&				if fs.isDir(path) then!@#&					local list = fs.list(path)!@#&					!@#&					for i = 1, #list do!@#&						local ok, err = pcall(fs.delete, fs.combine(path, list[i]))!@#&						if not ok then error(err:gsub(\"pcall: \", \"\"), 2) end!@#&					end!@#&					!@#&					return rfs.delete(path)!@#&				else!@#&					return rfs.delete(rfs.exists(path..\".bbp\") and (path..\".bbp\") or path)!@#&				end!@#&			end!@#&		end!@#&!@#&		_G.fs.open = function(path, mode)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			if type(mode) ~= \"string\" then error(\"bad argument #2 (expected string, got \" .. type(mode) .. \")\", 2 ) end!@#&			path = fs.combine(path, \"\")!@#&			local elements = dividePath(path)!@#&!@#&			mode = mode:lower()!@#&			local binary, append, read, write = mode:find(\"b\") ~= nil, mode:find(\"a\") ~= nil, mode:find(\"r\") ~= nil, mode:find(\"w\") ~= nil!@#&!@#&			if webMountList[path] or clusterList[elements[1]] or elements[1] == \"ram\" or repoList[elements[1]] then!@#&				if not (append or write or read) then error(\"Invalid file mode: \" .. mode, 2) end!@#&!@#&				if read then!@#&					if not fs.exists(path) or fs.isDir(path) then return nil, \"No such file\" end!@#&!@#&					local data!@#&					local handle = {[\"close\"] = function() data = nil end}!@#&!@#&					if webMountList[path] then!@#&						local webHandle = http.get(webMountList[path], nil, term.setPaletteColour and true)!@#&						data = webHandle.readAll()!@#&						webHandle.close()!@#&					elseif clusterList[elements[1]] then!@#&						data = {}!@#&						local list = clusterTalk(elements[1], true, \"get\", path)!@#&						for i = 1, #clusterList[elements[1]] do if list[i] then data[list[i][1]] = list[i][2] end end!@#&						data = table.concat(data)!@#&						data = decompressInternal({data:byte(1, #data)}, true)!@#&					elseif repoList[elements[1]] then!@#&						data = repoList[elements[1]]!@#&						for i = 2, #elements do data = data[elements[i]] end!@#&						local webHandle = http.get(data, nil, term.setPaletteColour and true)!@#&						data = webHandle.readAll()!@#&						webHandle.close()!@#&					else!@#&						data = ramdisk!@#&						for i = 2, #elements do data = data[elements[i]] end!@#&					end!@#&!@#&					if #data == 0 then data = nil end!@#&!@#&					if binary then!@#&						handle.read = function(amount)!@#&							if not data then return nil end!@#&!@#&							local result!@#&							if type(amount) ~= \"number\" then!@#&								result = data:byte(1)!@#&								data = data:sub(2)!@#&							else!@#&								result = data:sub(1, amount)!@#&								data = data:sub(amount + 1)!@#&							end!@#&!@#&							if #data == 0 then data = nil end!@#&							return result!@#&						end!@#&!@#&						handle.readAll = function()!@#&							if not data then return nil end!@#&!@#&							local result = data!@#&							data = nil!@#&							return result!@#&						end!@#&					else!@#&						handle.readLine = function()!@#&							if not data then return nil end!@#&!@#&							if data:find(\"\\n\") then!@#&								local result = data:sub(1, data:find(\"\\n\") - 1)!@#&								data = data:sub(data:find(\"\\n\") + 1)!@#&								if data:byte(1) == 13 then data = data:sub(2) end!@#&								return result!@#&							else!@#&								local result = data!@#&								data = nil!@#&								return data!@#&							end!@#&						end!@#&!@#&						handle.readAll = function()!@#&							if not data then return nil end!@#&!@#&							local result = data!@#&							data = nil!@#&							return result!@#&						end!@#&					end!@#&!@#&					return handle!@#&				elseif write or append then!@#&					if webMountList[path] or repoList[elements[1]] then return nil, \"Access denied\" end!@#&					if fs.isDir(path) then return nil, \"Cannot write to directory\" end!@#&					fs.makeDir(fs.getDir(path))!@#&!@#&					local handle, output, counter = {}, {}, 1!@#&!@#&					if binary then!@#&						handle.write = function(data)!@#&							if type(data) ~= \"string\" and type(data) ~= \"number\" then error(\"bad argument #1 (string or number expected, got \" .. type(data) .. \")\", 2) end!@#&							output[counter] = type(data) == \"number\" and string.char(data) or data!@#&							counter = counter + 1!@#&						end!@#&					else!@#&						handle.write = function(data)!@#&							output[counter] = tostring(data)!@#&							counter = counter + 1!@#&						end!@#&!@#&						handle.writeLine = function(data)!@#&							output[counter] = tostring(data)!@#&							output[counter + 1] = \"\\n\"!@#&							counter = counter + 2!@#&						end!@#&					end!@#&!@#&					local ramLink, ramIndex!@#&					if clusterList[elements[1]] and append and fs.exists(path) then!@#&						local data, list = {}, clusterTalk(elements[1], true, \"get\", path)!@#&						for i = 1, #list do if list[i] then data[list[i][1]] = list[i][2] end end!@#&						data = table.concat(data)!@#&						output[1], counter = decompressInternal({data:byte(1, #data)}, true), 2!@#&					elseif elements[1] == \"ram\" then!@#&						ramLink = ramdisk!@#&						for i = 2, #elements - 1 do ramLink = ramLink[elements[i]] end!@#&						ramIndex = elements[#elements]!@#&						if (append and not ramLink[ramIndex]) or not append then ramLink[ramIndex] = \"\" end!@#&					end!@#&!@#&					handle.flush = function()!@#&						if clusterList[elements[1]] then!@#&							output, counter = {table.concat(output)}, 1!@#&							local data, segs, pos, totalSpace, thisCluster = string.char(unpack(compressInternal(output[1]))), 1, 1, fs.getFreeSpace(elements[1]), clusterList[elements[1]]!@#&							if fs.exists(path) then totalSpace = totalSpace + fs.getSize(path) end!@#&							if totalSpace < #data then error(\"Out of space\", 2) end!@#&!@#&							fs.delete(path)!@#&							!@#&							local spaceList = clusterTalk(elements[1], true, \"getFreeSpace\")!@#&							!@#&							for i = 1, #thisCluster do!@#&								local thisSpace = spaceList[i][1]!@#&								!@#&								if thisSpace > 0 then!@#&									local segString = tostring(segs)!@#&									rednet.send(spaceList[i][2], {[\"cluster\"] = elements[1], \"put\", path .. string.rep(\"0\", 3 - #segString) .. segString, data:sub(pos, pos + thisSpace - 1)}, rednet.host and elements[1])!@#&									pos, segs = pos + thisSpace, segs + 1!@#&								end!@#&!@#&								if pos > #data then break end!@#&							end!@#&						else!@#&							output = table.concat(output)!@#&							if append then output = ramLink[ramIndex] .. output end!@#&							ramLink[ramIndex] = output!@#&							output, counter, append = {}, 1, true!@#&						end!@#&					end!@#&!@#&					handle.close = function()!@#&						handle.flush()!@#&						for key in pairs(handle) do handle[key] = function() end end!@#&					end!@#&!@#&					return handle!@#&				end!@#&			else!@#&				if (write or append) and rfs.isReadOnly(path) then return nil, \"Access denied\" end!@#&!@#&				for i = 1, #blacklist do!@#&					local check = blacklist[i]!@#&					if path:sub(-#check):lower() == check then return rfs.open(path, mode) end!@#&				end!@#&!@#&				if read then!@#&					return rfs.exists(path .. \".bbp\") and open(path .. \".bbp\", mode) or rfs.open(path, mode)!@#&				elseif configTable.compressedFS then!@#&					if rfs.getDrive(elements[1]) and rfs.getDrive(elements[1]) ~= \"hdd\" then!@#&						return rfs.open(path, mode)!@#&					elseif append then!@#&						if rfs.exists(path) then!@#&							local file, content = rfs.open(path, binary and \"rb\" or \"r\")!@#&!@#&							if file.readAll then!@#&								content = file.readAll()!@#&							else!@#&								content = {}!@#&								for byte in file.read do content[#content + 1] = byte end!@#&								content = string.char(unpack(content))!@#&							end!@#&!@#&							file.close()!@#&!@#&							rfs.delete(path)!@#&!@#&							file = open(path .. \".bbp\", binary and \"wb\" or \"w\")!@#&							file.write(content)!@#&							return file!@#&						else return open(path .. \".bbp\", mode) end!@#&					elseif write then!@#&						if rfs.exists(path) then rfs.delete(path) end!@#&						return open(path .. \".bbp\", mode)!@#&					end!@#&				else!@#&					if append then!@#&						if rfs.exists(path .. \".bbp\") then!@#&							local file = open(path .. \".bbp\", binary and \"rb\" or \"r\")!@#&							local content = file.readAll()!@#&							file.close()!@#&!@#&							rfs.delete(path .. \".bbp\")!@#&!@#&							file = rfs.open(path, binary and \"wb\" or \"w\")!@#&!@#&							if file.writeLine or term.setPaletteColour then!@#&								file.write(content)!@#&							else!@#&								content = {string.byte(1, #content)}!@#&								for i = 1, #content do file.write(content[i]) end!@#&							end!@#&!@#&							return file!@#&						else return rfs.open(path, mode) end!@#&					elseif write then!@#&						if rfs.exists(path .. \".bbp\") then rfs.delete(path .. \".bbp\") end!@#&						return rfs.open(path, mode)!@#&					end!@#&				end!@#&!@#&				error(\"Unsupported mode\", 2)!@#&			end!@#&		end!@#&!@#&		_G.fs.find = function(path)!@#&			if type(path) ~= \"string\" then error(\"bad argument #1 (expected string, got \" .. type(path) .. \")\", 2 ) end!@#&			local pathParts, results, curfolder = {}, {}, \"/\"!@#&			for part in path:gmatch(\"[^/]+\") do pathParts[#pathParts + 1] = part:gsub(\"*\", \"[^/]*\") end!@#&			if #pathParts == 0 then return {} end!@#&!@#&			local prospects = fs.list(curfolder)!@#&			for i = 1, #prospects do prospects[i] = {[\"parent\"] = curfolder, [\"depth\"] = 1, [\"name\"] = prospects[i]} end!@#&!@#&			while #prospects > 0 do!@#&				local thisProspect = table.remove(prospects, 1)!@#&				local fullPath = fs.combine(thisProspect.parent, thisProspect.name)!@#&!@#&				if thisProspect.name == thisProspect.name:match(pathParts[thisProspect.depth]) then!@#&					if thisProspect.depth == #pathParts then!@#&						results[#results + 1] = fullPath!@#&					elseif fs.isDir(fullPath) and thisProspect.depth < #pathParts then!@#&						local newList = fs.list(fullPath)!@#&						for i = 1, #newList do prospects[#prospects + 1] = {[\"parent\"] = fullPath, [\"depth\"] = thisProspect.depth + 1, [\"name\"] = newList[i]} end!@#&					end!@#&				end!@#&			end!@#&!@#&			return results!@#&		end!@#&!@#&		_G.rfs = rfs!@#&	end!@#&!@#&	update = bbpack and bbpack.update or function()!@#&		for cluster, ids in pairs(clusterList) do for i = 1, #ids do!@#&			rednet.send(ids[i], {[\"cluster\"] = cluster, \"update\"}, rednet.host and cluster)!@#&		end end!@#&!@#&		local file = rfs.open(\"bbpack\", \"w\")!@#&		file.write(downloadPasteInternal(\"cUYTGbpb\"))!@#&		file.close()!@#&!@#&		os.reboot()!@#&	end!@#&!@#&	fileSys = bbpack and bbpack.fileSys or function(par1, par2)!@#&		if type(par1) == \"boolean\" or (type(par1) == \"string\" and type(par2) == \"boolean\") then!@#&			-- Compress / decompress hdd contents.!@#&			local list!@#&			if type(par1) == \"boolean\" then!@#&				list = rfs.list(\"\")!@#&				configTable.compressedFS = par1!@#&			else!@#&				list = {par1}!@#&				par1 = par2!@#&			end!@#&!@#&			while #list > 0 do!@#&				local entry = list[#list]!@#&				list[#list] = nil!@#&!@#&				if rfs.getDrive(entry) == \"hdd\" and not webMountList[entry] then!@#&					if rfs.isDir(entry) then!@#&						local newList, curLen = rfs.list(entry), #list!@#&						for i = 1, #newList do list[curLen + i] = fs.combine(entry, newList[i]) end!@#&					else!@#&						local blacklisted = false!@#&!@#&						for i = 1, #blacklist do!@#&							local check = blacklist[i]!@#&							if entry:sub(-#check):lower() == check then!@#&								blacklisted = true!@#&								break!@#&							end!@#&						end!@#&!@#&						if not blacklisted then!@#&							if par1 and entry:sub(-4) ~= \".bbp\" then!@#&								-- Compress this file.!@#&								local file, content = rfs.open(entry, \"rb\")!@#&								if file.readAll then!@#&									content = file.readAll()!@#&								else!@#&									content = {}!@#&									local counter = 1!@#&									for byte in file.read do!@#&										content[counter] = byte!@#&										counter = counter + 1!@#&									end!@#&									content = string.char(unpack(content))!@#&								end!@#&								file.close()!@#&								!@#&								content = compressInternal(content)!@#&								if rfs.getFreeSpace(entry) + rfs.getSize(entry) < #content then return false end!@#&								rfs.delete(entry)!@#&								snooze()!@#&!@#&								file = rfs.open(entry .. \".bbp\", \"wb\")!@#&!@#&								if term.setPaletteColor then!@#&									file.write(string.char(unpack(content)))!@#&								else!@#&									for i = 1, #content do file.write(content[i]) end!@#&								end!@#&!@#&								file.close()!@#&!@#&								snooze()!@#&							elseif not par1 and entry:sub(-4) == \".bbp\" then!@#&								-- Decompress this file.!@#&								local file = open(entry, \"rb\")!@#&								local content = file.readAll()!@#&								file.close()!@#&!@#&								if rfs.getFreeSpace(entry) + rfs.getSize(entry) < #content then return false end!@#&								rfs.delete(entry)!@#&								snooze()!@#&!@#&								file = rfs.open(entry:sub(1, -5), \"wb\")!@#&!@#&								if term.setPaletteColor then!@#&									file.write(content)!@#&								else!@#&									content = {content:byte(1, #content)}!@#&									for i = 1, #content do file.write(content[i]) end!@#&								end!@#&!@#&								file.close()!@#&!@#&								snooze()!@#&							end!@#&						end!@#&					end!@#&				end!@#&			end!@#&		elseif type(par1) == \"string\" and type(par2) == \"string\" then!@#&			-- New web mount.!@#&			local url, path = par1, fs.combine(par2, \"\")!@#&			local elements = dividePath(path)!@#&			!@#&			local repo = getGithubRepo(url)!@#&			if repo then!@#&				if #elements > 1 then error(\"bbpack.mount: Github repos must be mounted at the root of your file system\", 2) end!@#&				repoList[path] = repo!@#&				configTable.githubRepos[path] = url!@#&			else!@#&				if fs.getDrive(elements[1]) and fs.getDrive(elements[1]) ~= \"hdd\" then error(\"bbpack.mount: web mounts must be located on the main hdd\", 2) end!@#&!@#&				local get = http.get(url)!@#&				if not get then error(\"bbpack.mount: Can't connect to URL: \"..url, 2) end!@#&				get.close()!@#&!@#&				webMountList[path] = url!@#&			end!@#&		elseif type(par1) == \"string\" then!@#&			-- New cluster mount.!@#&			local cluster, uuid = par1, math.random(1, 0x7FFFFFFF)!@#&			for _, side in pairs(rs.getSides()) do if peripheral.getType(side) == \"modem\" then rednet.open(side) end end!@#&			rednet.broadcast({[\"cluster\"] = cluster, [\"uuid\"] = uuid, \"rollcall\"}, rednet.host and cluster)!@#&			clusterList[cluster] = nil!@#&			local myTimer, map = os.startTimer(5), {}!@#&!@#&			while true do!@#&				local event, par1, par2 = os.pullEvent()!@#&!@#&				if event == \"timer\" and par1 == myTimer then!@#&					break!@#&				elseif event == \"rednet_message\" and type(par2) == \"table\" and par2.cluster == cluster and par2.uuid == uuid and par2[1] == \"rollcallResponse\" then!@#&					map[#map + 1] = par1!@#&				end!@#&			end!@#&!@#&			if #map == 0 then error(\"bbpack.mount: Can't connect to cluster: \" .. cluster, 2) end!@#&			clusterList[cluster] = map!@#&		end!@#&!@#&		local file = rfs.open(\".bbpack.cfg\", \"w\")!@#&		file.write(textutils.serialize(configTable))!@#&		file.close()!@#&!@#&		return true!@#&	end!@#&end",["json"]="------------------------------------------------------------------ utils!@#&local controls = {[\"\\n\"]=\"\\\\n\", [\"\\r\"]=\"\\\\r\", [\"\\t\"]=\"\\\\t\", [\"\\b\"]=\"\\\\b\", [\"\\f\"]=\"\\\\f\", [\"\\\"\"]=\"\\\\\\\"\", [\"\\\\\"]=\"\\\\\\\\\"}!@#&!@#&local function isArray(t)!@#&	local max = 0!@#&	for k,v in pairs(t) do!@#&		if type(k) ~= \"number\" then!@#&			return false!@#&		elseif k > max then!@#&			max = k!@#&		end!@#&	end!@#&	return max == #t!@#&end!@#&!@#&local whites = {['\\n']=true; ['\\r']=true; ['\\t']=true; [' ']=true; [',']=true; [':']=true}!@#&function removeWhite(str)!@#&	while whites[str:sub(1, 1)] do!@#&		str = str:sub(2)!@#&	end!@#&	return str!@#&end!@#&!@#&------------------------------------------------------------------ encoding!@#&!@#&local function encodeCommon(val, pretty, tabLevel, tTracking)!@#&	local str = \"\"!@#&!@#&	-- Tabbing util!@#&	local function tab(s)!@#&		str = str .. (\"\\t\"):rep(tabLevel) .. s!@#&	end!@#&!@#&	local function arrEncoding(val, bracket, closeBracket, iterator, loopFunc)!@#&		str = str .. bracket!@#&		if pretty then!@#&			str = str .. \"\\n\"!@#&			tabLevel = tabLevel + 1!@#&		end!@#&		for k,v in iterator(val) do!@#&			tab(\"\")!@#&			loopFunc(k,v)!@#&			str = str .. \",\"!@#&			if pretty then str = str .. \"\\n\" end!@#&		end!@#&		if pretty then!@#&			tabLevel = tabLevel - 1!@#&		end!@#&		if str:sub(-2) == \",\\n\" then!@#&			str = str:sub(1, -3) .. \"\\n\"!@#&		elseif str:sub(-1) == \",\" then!@#&			str = str:sub(1, -2)!@#&		end!@#&		tab(closeBracket)!@#&	end!@#&!@#&	-- Table encoding!@#&	if type(val) == \"table\" then!@#&		assert(not tTracking[val], \"Cannot encode a table holding itself recursively\")!@#&		tTracking[val] = true!@#&		if isArray(val) then!@#&			arrEncoding(val, \"[\", \"]\", ipairs, function(k,v)!@#&				str = str .. encodeCommon(v, pretty, tabLevel, tTracking)!@#&			end)!@#&		else!@#&			arrEncoding(val, \"{\", \"}\", pairs, function(k,v)!@#&				assert(type(k) == \"string\", \"JSON object keys must be strings\", 2)!@#&				str = str .. encodeCommon(k, pretty, tabLevel, tTracking)!@#&				str = str .. (pretty and \": \" or \":\") .. encodeCommon(v, pretty, tabLevel, tTracking)!@#&			end)!@#&		end!@#&	-- String encoding!@#&	elseif type(val) == \"string\" then!@#&		str = '\"' .. val:gsub(\"[%c\\\"\\\\]\", controls) .. '\"'!@#&	-- Number encoding!@#&	elseif type(val) == \"number\" or type(val) == \"boolean\" then!@#&		str = tostring(val)!@#&	else!@#&		error(\"JSON only supports arrays, objects, numbers, booleans, and strings\", 2)!@#&	end!@#&	return str!@#&end!@#&!@#&function encode(val)!@#&	return encodeCommon(val, false, 0, {})!@#&end!@#&!@#&function encodePretty(val)!@#&	return encodeCommon(val, true, 0, {})!@#&end!@#&!@#&------------------------------------------------------------------ decoding!@#&!@#&local decodeControls = {}!@#&for k,v in pairs(controls) do!@#&	decodeControls[v] = k!@#&end!@#&!@#&function parseBoolean(str)!@#&	if str:sub(1, 4) == \"true\" then!@#&		return true, removeWhite(str:sub(5))!@#&	else!@#&		return false, removeWhite(str:sub(6))!@#&	end!@#&end!@#&!@#&function parseNull(str)!@#&	return nil, removeWhite(str:sub(5))!@#&end!@#&!@#&local numChars = {['e']=true; ['E']=true; ['+']=true; ['-']=true; ['.']=true}!@#&function parseNumber(str)!@#&	local i = 1!@#&	while numChars[str:sub(i, i)] or tonumber(str:sub(i, i)) do!@#&		i = i + 1!@#&	end!@#&	local val = tonumber(str:sub(1, i - 1))!@#&	str = removeWhite(str:sub(i))!@#&	return val, str!@#&end!@#&!@#&function parseString(str)!@#&	str = str:sub(2)!@#&	local s = \"\"!@#&	while str:sub(1,1) ~= \"\\\"\" do!@#&		local next = str:sub(1,1)!@#&		str = str:sub(2)!@#&		assert(next ~= \"\\n\", \"Unclosed string\")!@#&!@#&		if next == \"\\\\\" then!@#&			local escape = str:sub(1,1)!@#&			str = str:sub(2)!@#&!@#&			next = assert(decodeControls[next..escape], \"Invalid escape character\")!@#&		end!@#&!@#&		s = s .. next!@#&	end!@#&	return s, removeWhite(str:sub(2))!@#&end!@#&!@#&function parseArray(str)!@#&	str = removeWhite(str:sub(2))!@#&!@#&	local val = {}!@#&	local i = 1!@#&	while str:sub(1, 1) ~= \"]\" do!@#&		local v = nil!@#&		v, str = parseValue(str)!@#&		val[i] = v!@#&		i = i + 1!@#&		str = removeWhite(str)!@#&	end!@#&	str = removeWhite(str:sub(2))!@#&	return val, str!@#&end!@#&!@#&function parseObject(str)!@#&	str = removeWhite(str:sub(2))!@#&!@#&	local val = {}!@#&	while str:sub(1, 1) ~= \"}\" do!@#&		local k, v = nil, nil!@#&		k, v, str = parseMember(str)!@#&		val[k] = v!@#&		str = removeWhite(str)!@#&	end!@#&	str = removeWhite(str:sub(2))!@#&	return val, str!@#&end!@#&!@#&function parseMember(str)!@#&	local k = nil!@#&	k, str = parseValue(str)!@#&	local val = nil!@#&	val, str = parseValue(str)!@#&	return k, val, str!@#&end!@#&!@#&function parseValue(str)!@#&	local fchar = str:sub(1, 1)!@#&	if fchar == \"{\" then!@#&		return parseObject(str)!@#&	elseif fchar == \"[\" then!@#&		return parseArray(str)!@#&	elseif tonumber(fchar) ~= nil or numChars[fchar] then!@#&		return parseNumber(str)!@#&	elseif str:sub(1, 4) == \"true\" or str:sub(1, 5) == \"false\" then!@#&		return parseBoolean(str)!@#&	elseif fchar == \"\\\"\" then!@#&		return parseString(str)!@#&	elseif str:sub(1, 4) == \"null\" then!@#&		return parseNull(str)!@#&	end!@#&	return nil!@#&end!@#&!@#&function decode(str)!@#&	str = removeWhite(str)!@#&	t = parseValue(str)!@#&	return t!@#&end!@#&!@#&function decodeFromFile(path)!@#&	local file = assert(fs.open(path, \"r\"))!@#&	local decoded = decode(file.readAll())!@#&	file.close()!@#&	return decoded!@#&end",["xml"]="function parseargs(s)!@#&  local arg = {}!@#&  string.gsub(s, \"([%-%w]+)=([\\\"'])(.-)%2\", function (w, _, a)!@#&    arg[w] = a!@#&  end)!@#&  return arg!@#&end!@#&   !@#&function collect(s)!@#&  local stack = {}!@#&  local top = {}!@#&  table.insert(stack, top)!@#&  local ni,c,label,xarg, empty!@#&  local i, j = 1, 1!@#&  while true do!@#&    ni,j,c,label,xarg, empty = string.find(s, \"<(%/?)([%w:]+)(.-)(%/?)>\", i)!@#&    if not ni then break end!@#&    local text = string.sub(s, i, ni-1)!@#&    if not string.find(text, \"^%s*$\") then!@#&      table.insert(top, text)!@#&    end!@#&    if empty == \"/\" then  -- empty element tag!@#&      table.insert(top, {label=label, xarg=parseargs(xarg), empty=1})!@#&    elseif c == \"\" then   -- start tag!@#&      top = {label=label, xarg=parseargs(xarg)}!@#&      table.insert(stack, top)   -- new level!@#&    else  -- end tag!@#&      local toclose = table.remove(stack)  -- remove top!@#&      top = stack[#stack]!@#&      if #stack < 1 then!@#&        error(\"nothing to close with \"..label)!@#&      end!@#&      if toclose.label ~= label then!@#&        error(\"trying to close \"..toclose.label..\" with \"..label)!@#&      end!@#&      table.insert(top, toclose)!@#&    end!@#&    i = j+1!@#&  end!@#&  local text = string.sub(s, i)!@#&  if not string.find(text, \"^%s*$\") then!@#&    table.insert(stack[#stack], text)!@#&  end!@#&  if #stack > 1 then!@#&    error(\"unclosed \"..stack[#stack].label)!@#&  end!@#&  return stack[1]!@#&end",["config"]="function read(pathToConfig,whatToRead)!@#&        if not fs.exists(pathToConfig) then error(\"No such file\") end!@#&        local file = fs.open(pathToConfig,\"r\")!@#&        while true do!@#&                local line = file.readLine()!@#&                if line ~= nil then!@#&                        local key, value = string.match(line,\"(.*)=(.*)\")!@#&                        if value ~= nil and key == whatToRead then!@#&                                file.close()!@#&                                return value!@#&                        end!@#&                else!@#&                        file.close()!@#&                        break!@#&                end!@#&        end!@#&end!@#& !@#&function write(pathToConfig,key,value)!@#&        if not fs.exists(pathToConfig) then!@#&                local file = fs.open(pathToConfig,\"w\")!@#&                file.close()!@#&        end!@#& !@#&        local file = fs.open(pathToConfig,\"r\")!@#&        local Massiv = {}!@#&       !@#&        local lineCounter = 1!@#&        while true do!@#&                local line = file.readLine()!@#&                if line ~= nil then!@#&                        Massiv[lineCounter] = line!@#&                else!@#&                        file.close()!@#&                        break!@#&                end!@#&                lineCounter = lineCounter + 1!@#&        end!@#& !@#&        local success = false!@#&        for i=1,#Massiv do!@#&                local key1, value1 = string.match(Massiv[i],\"(.*)=(.*)\")!@#&                if value1 ~= nil and key1 == key then!@#&                        Massiv[i] = key..\"=\"..value!@#&                        success = true!@#&                end!@#&        end!@#& !@#&        if success == false then Massiv[#Massiv+1] = key..\"=\"..value end!@#& !@#&        local file = fs.open(pathToConfig,\"w\")!@#&        for i=1,#Massiv do!@#&                file.writeLine(Massiv[i])!@#&        end!@#&        file.close()!@#&end",["image"]="function draw(startX,startY,image)!@#&        local Colors = {!@#&                [\"0\"] = 1,!@#&                [\"1\"] = 2,!@#&                [\"2\"] = 4,!@#&                [\"3\"] = 8,!@#&                [\"4\"] = 16,!@#&                [\"5\"] = 32,!@#&                [\"6\"] = 64,!@#&                [\"7\"] = 128,!@#&                [\"8\"] = 256,!@#&                [\"9\"] = 512,!@#&                [\"a\"] = 1024,!@#&                [\"b\"] = 2048,!@#&                [\"c\"] = 4096,!@#&                [\"d\"] = 8192,!@#&                [\"e\"] = 16384,!@#&                [\"f\"] = 32768!@#&        }!@#&        local Pixels = {}!@#& !@#&        local function convert(mode,color)!@#&                if mode == \"from cc\" then!@#&                        for key,value in pairs(Colors) do!@#&                                if color == value then!@#&                                        return key!@#&                                end!@#&                        end!@#&                else!@#&                        if color == \"#\" then!@#&                                return \"0\"!@#&                        else!@#&                                return Colors[color]!@#&                        end!@#&                end!@#&        end!@#& !@#&        local function load(path)!@#&                local file = fs.open(path,\"r\")!@#&                local lineCounter = 1!@#&                while true do!@#&                        local line = file.readLine()!@#&                        Pixels[lineCounter]={}!@#&                        if line ~= nil then!@#&                                for i=1,#line,3 do!@#&                                        Pixels[lineCounter][(i+2)/3]={}!@#&                                        Pixels[lineCounter][(i+2)/3][\"symbol\"] = string.sub(line,i,i)!@#&                                        Pixels[lineCounter][(i+2)/3][\"textColor\"] = convert(\"to cc\",string.sub(line,i+1,i+1))!@#&                                        Pixels[lineCounter][(i+2)/3][\"backColor\"] = convert(\"to cc\",string.sub(line,i+2,i+2))!@#&                                end!@#&                                lineCounter = lineCounter + 1!@#&                        else!@#&                                break!@#&                        end!@#&                end!@#&                file.close()!@#&        end!@#& !@#&        load(image)!@#& !@#&        for y=1,#Pixels do!@#&                for x=1,#Pixels[y] do!@#&                        if Pixels[y][x][\"symbol\"] ~= \"#\" then!@#&                                term.setTextColor(Pixels[y][x][\"textColor\"])!@#&                                term.setBackgroundColor(Pixels[y][x][\"backColor\"])!@#&                                term.setCursorPos(startX+x-1,startY+y-1)!@#&                                term.write(Pixels[y][x][\"symbol\"])!@#&                        end!@#&                end!@#&        end!@#& !@#&end",["bsod"]="function bsod(error)!@#&  -- for the following 2 functions are from my Extended String Library...!@#&  local trim = function(str) return (str:gsub(\"^%s*(.-)%s*$\", \"%1\")) end!@#&!@#&  -- localize these as they are only used here!@#&  local setColors = function(bg, txt) if not (term.isColor and term.isColor()) then return false end if txt then term.setTextColor(txt) end if bg then term.setBackgroundColor(bg) end end!@#&  local clear = function(col) if col then term.setBackgroundColor(col) end term.clear() end!@#&  local cwrite = function(msg, y, offset) local sw,sh = term.getSize() term.setCursorPos(sw/2-#msg/2, (y or (sh/2)) + (offset or 0)) write(msg) end!@#&  local errHeader = function(text, y, centre) setColors(colors.white, colors.blue) if centre then cwrite(text, y) else term.setCursorPos(1,y) print(text) end setColors(colors.blue, colors.white) end!@#&  local printMsg = function(text, y) term.setCursorPos(1,y) print(text) end!@#&  local waitForKey = function() while true do local e,k=os.pullEventRaw(\"key\") if k == 28 or k == 156 then break end end end!@#&  local sw,sh = term.getSize()!@#&!@#&  clear(colors.blue)!@#&!@#&  -- the error headers!@#&  errHeader(\" ERROR :  SpeedOS(id: \"..os.getComputerID()..\")\", 2, true)!@#&  errHeader(\" Description:  \"..error, 7, false)!@#&  errHeader(\" Reporting the Issue \", sh-7, false)!@#&!@#&  -- BSOD content!@#&  printMsg(\"An error has occurred during runtime with and the program has ceased working.\", 4)!@#&  printMsg(\"If this problem persists please try reinstall SpeedOS and if the problem still persists report the issue to Ma3rX. Thanks!\",sh-5)!@#&!@#&  cwrite(\"Press enter to quit...\",sh-1)!@#&  waitForKey()!@#&!@#&  term.clear(colors.black)!@#&  term.setCursorPos(1,1)!@#&end",["speedtext"]="--Central Printing--!@#&function cPrint(string, y2)!@#&        local tX, tY = term.getSize()!@#&        local b = string.len(string) / 2!@#&        local x = (tX / 2) - b!@#&	local y = tY / 2!@#&	!@#&	if y2 then!@#&	  y = y2!@#&	end!@#&!@#&        term.setCursorPos(x, y)!@#&        write(string)!@#&end!@#&!@#&--Central Cursoring--!@#&function cCursor(string)!@#&        local tX, tY = term.getSize()!@#&        local b = string.len(string) / 2!@#&        local x = (tX / 2) - b!@#&	local y = tY / 2!@#&	!@#&	if y2 then!@#&	  y = y2!@#&	end!@#&!@#&        return {x, y}!@#&end!@#&!@#&--Line of \"-\" printing--!@#&function line()!@#&	print(\"---------------------------------------------------\")!@#&end!@#&!@#&--Extra exiting from program--!@#&function extraExit()!@#&	term.setBackgroundColor(colors.black)!@#&	term.setTextColor(colors.white)!@#&	term.setCursorPos(1, 1)!@#&	term.clear()!@#&	error()!@#&end",["zip"]="function archive(chto,vochto)!@#&        local Massiv2 = {}!@#&        local function FileList(path)!@#&                local Massiv = fs.list(path)!@#&                if #Massiv==0 then!@#&                        local Massiv2Id = #Massiv2 + 1!@#&                        Massiv2[Massiv2Id] = {}!@#&                        Massiv2[Massiv2Id][\"path\"] = path!@#&                        Massiv2[Massiv2Id][\"text\"] = \"@empty@empty\"!@#&                else!@#&                        for i=1,#Massiv do!@#&                                if fs.isDir(path..\"/\"..Massiv[i]) and Massiv[i] ~= \"/rom\" and Massiv[i] ~= \"rom\" then!@#&                                        FileList(path..\"/\"..Massiv[i])!@#&                                elseif not fs.isDir(path..\"/\"..Massiv[i]) and Massiv[i] ~= \"/rom\" and Massiv[i] ~= \"rom\" then!@#&                                        local Massiv2Id = #Massiv2 + 1!@#&                                        Massiv2[Massiv2Id] = {}!@#&                                        Massiv2[Massiv2Id][\"path\"] = path..\"/\"..Massiv[i]!@#&                                        local file = fs.open(path..\"/\"..Massiv[i],\"r\")!@#&                                        Massiv2[Massiv2Id][\"text\"] = file.readAll()!@#&                                        file.close()!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        FileList(chto)!@#&        file=fs.open(vochto..\".zip\",\"w\")!@#&        file.write(textutils.serialise(Massiv2))!@#&        file.close()!@#&        return Massiv2!@#&end!@#& !@#&function unarchive(chto,kuda)!@#&        --shell.run(\"cd \"..kuda)!@#&        shell.run(chto)!@#&        --local file = fs.open(chto,\"r\")!@#&        --Massiv = textutils.unserialise(file.readAll())!@#&        --file.close()!@#&        --for i=1,#Massiv do!@#&        --        if Massiv[i][\"text\"] == \"@empty@empty\" then!@#&        --                fs.makeDir(kuda..\"/\"..Massiv[i][\"path\"])!@#&        --        else!@#&        --                local file = fs.open(kuda..\"/\"..Massiv[i][\"path\"],\"w\")!@#&        --                file.write(Massiv[i][\"text\"])!@#&        --                file.close()!@#&       --         end!@#&       -- end!@#&end",["peripheral"]="-- v1.4.1!@#&native = peripheral.native or peripheral!@#&local native = native!@#&!@#&function getNames()!@#&	local tResults = {}!@#&	for n,sSide in ipairs( rs.getSides() ) do!@#&		if peripheral.isPresent( sSide ) then!@#&			table.insert( tResults, sSide )!@#&			local isWireless = false!@#&			--if pcall(function()isWireless = peripheral.call(sSide, 'isWireless') end) then!@#&			isWireless = true!@#&			--end     !@#&		end!@#&	end!@#&	return tResults!@#&end!@#&!@#&function find( sType, cable )!@#& _color = {\"white\",!@#&           \"orange\",!@#&           \"magenta\",!@#&           \"lightBlue\",!@#&           \"yellow\",!@#&           \"lime\",!@#&           \"pink\",!@#&           \"gray\",!@#& --          \"lightGray\",!@#&           \"cyan\",!@#&           \"purple\",!@#&           \"blue\",!@#&           \"brown\",!@#&           \"green\",!@#&           \"red\",!@#&           \"black\"} !@#& !@#& for _, value in pairs(rs.getSides()) do!@#&  	if peripheral.getType(value) == sType then!@#&    	  return value!@#&   end!@#&   !@#&   if cable then!@#&     for _, _value in pairs(_color) do!@#&       if peripheral.getType(value..\":\".._value) == sType then!@#&        return value..\":\".._value         !@#&       end!@#&     end!@#&   end!@#& end!@#&end!@#&!@#&local function decode(side)!@#&	local lside, color = side:match(\"(%w%w*):(%w%w*)\")!@#&	!@#&	if lside then!@#&		return lside, color!@#&	end!@#&	!@#&	return side!@#&end!@#&!@#&-- This can remain the same!@#&wrap = native.wrap!@#&!@#&function isPresent(side)!@#&	local color!@#&	side, color = decode(side)!@#&	!@#&	if not native.isPresent(side) then !@#&		return false!@#&	end!@#&	!@#&	if color then !@#&		if native.getType(side) ~= \"cable\" then!@#&			return false!@#&		end!@#&		return native.call(side, \"isPresent\", color)!@#&	end!@#&	!@#&	return true!@#&end!@#&!@#&function getType(side)!@#&	local color!@#&	side, color = decode(side)!@#&	!@#&	if color then !@#&		if native.getType(side) ~= \"cable\" then!@#&			return nil!@#&		end!@#&		return native.call(side, \"getType\", color)!@#&	end!@#&	!@#&	return native.getType(side)!@#&end!@#&!@#&function getMethods(side)!@#&	local color!@#&	side, color = decode(side)!@#&	!@#&	if color then !@#&		if native.getType(side) ~= \"cable\" then!@#&			return nil!@#&		end!@#&		return native.call(side, \"getMethods\", color)!@#&	end!@#&	!@#&	return native.getMethods(side)!@#&end!@#&!@#&function call(side, method, ...)!@#&	local color!@#&	side, color = decode(side)!@#&	!@#&	if color then !@#&		if native.getType(side) ~= \"cable\" then!@#&			error(\"No peripheral attached\")!@#&		end!@#&		return native.call(side, \"call\", color, method, ...)!@#&	end!@#&	!@#&	return native.call(side, method, ...)!@#&end!@#&!@#&function getSides()!@#&	local sides = rs.getSides()!@#&	!@#&	for i,side in ipairs(rs.getSides()) do!@#&		if native.getType(side) == \"cable\" then!@#&			local lsides = { native.call(side, \"list\") }!@#&			for _,ls in ipairs(lsides) do!@#&				table.insert(sides, i, ls)!@#&			end!@#&		end!@#&	end!@#&	!@#&	return sides!@#&end",["encryptor"]="os.loadAPI(\"/SpeedAPI/config\")!@#& !@#&local symbols = {!@#&        \"a\",!@#&        \"b\",!@#&        \"c\",!@#&        \"d\",!@#&        \"e\",!@#&        \"f\",!@#&        \"g\",!@#&        \"h\",!@#&        \"i\",!@#&        \"j\",!@#&        \"k\",!@#&        \"l\",!@#&        \"m\",!@#&        \"n\",!@#&        \"o\",!@#&        \"p\",!@#&        \"q\",!@#&        \"r\",!@#&        \"s\",!@#&        \"t\",!@#&        \"u\",!@#&        \"v\",!@#&        \"w\",!@#&        \"x\",!@#&        \"y\",!@#&        \"z\",!@#&        \"0\",!@#&        \"1\",!@#&        \"2\",!@#&        \"3\",!@#&        \"4\",!@#&        \"5\",!@#&        \"6\",!@#&        \"7\",!@#&        \"8\",!@#&        \"9\",!@#&}!@#& !@#&local symbolsFromConfig = {}!@#&for i=1,#symbols do!@#&        symbolsFromConfig[symbols[i]] = config.read(\"System/API/encryptor.cfg\",symbols[i])!@#&end!@#& !@#&local function stringReplace(stroka,chto,nachto)!@#&        while true do!@#&                local starting = 1!@#&                local starting,ending = string.find(stroka,chto,starting)!@#&                if ending ~= nil then!@#&                        stroka = string.sub(stroka,1,starting-1)..nachto..string.sub(stroka,ending+1,-1)!@#&                        starting = starting + #nachto!@#&                else!@#&                        break!@#&                end!@#&        end!@#&        return stroka!@#&end!@#& !@#&function code(stroka)!@#&        local array = {}!@#&        for i=1,#stroka do!@#&                array[i] = string.sub(stroka,i,i)!@#&                for key,val in pairs(symbolsFromConfig) do!@#&                        if array[i] == key then array[i] = val end!@#&                end!@#&        end!@#&        local text = \"\"!@#&        for i=1,#array do!@#&                text = text..array[i]!@#&        end!@#&        return text!@#&end!@#& !@#&function decode(stroka)!@#&        for key,val in pairs(symbolsFromConfig) do!@#&                stroka = stringReplace(stroka,val,key)!@#&        end!@#&        return stroka!@#&end!@#& !@#& !@#&--[[print(\" \")!@#&local cyka = \"hello world! heh kek lol \"!@#&print(\"Standart=\"..cyka)!@#&print(\" \")!@#&local codedcyka = code(cyka)!@#&print(\"Coded=\"..codedcyka)!@#&print(\" \")!@#&local decodedcyka = decode(codedcyka)!@#&print(\"Encoded=\"..decodedcyka)!@#&print(\" \")]]",["speedgui"]="dofunction = 1!@#&xmin = 2!@#&xmax = 4!@#&ymin = 3!@#&ymax = 5!@#&enable = 6!@#&textcolor = 8!@#&backcolor = 9!@#&text = 10!@#&width = 11!@#&btnindx = { }!@#&prgindx = { }!@#&gui =!@#&{!@#&    button =!@#&    {!@#&	    index = function (func,x1,y1,x2,y2,color,tcolor,bcolor,text,w)!@#&		  	if type(func) ~= \"function\" then error(\"Invalid argument 1 of gui.button.index, expected function, got \".. type(func) .. \", wanted function to run\",2) end!@#&		  	if type(x1) ~= \"number\" then error(\"Invalid argument 2 of gui.button.index, expected number, got \".. type(x1) .. \", wanted x1 value\",2) end!@#&		  	if type(y1) ~= \"number\" then error(\"Invalid argument 3 of gui.button.index, expected number, got \".. type(y2) .. \", wanted y1 value\",2) end!@#&		  	if type(x2) ~= \"number\" then error(\"Invalid argument 4 of gui.button.index, expected number, got \".. type(x2) .. \", wanted x2 value\",2) end!@#&		  	if type(y2) ~= \"number\" then error(\"Invalid argument 5 of gui.button.index, expected number, got \".. type(y2) .. \", wanted y2 value\",2) end!@#&		  	if type(color) ~= \"boolean\" then error(\"Invalid argument 6 of gui.button.index, expected number, got \".. type(color) .. \", wanted weather or not to draw button\",2) end!@#&		  	if type(tcolor) ~= \"number\" and type(tcolor) ~=  \"nil\" then error(\"Invalid argument 7 of gui.button.index, expected number, got \".. type(tcolor) .. \",wanted text color\",2) end!@#&		  	if type(bcolor) ~= \"number\" and type(bcolor) ~= \"nil\" then error(\"Invalid argument 8 of gui.button.index, expected number, got \".. type(bcolor) .. \",wanted background color\",2) end!@#&		  	if type(text) ~= \"string\" and type(text) ~= \"nil\" then error(\"Invalid argument 9 of gui.button.index, expected string, got \".. type(text) .. \", wanted button caption\",2) end!@#&		  	if type(w) ~= \"number\" and type(w) ~= \"nil\" then error(\"Invalid argument 10 of gui.button.index, expected number, got \".. type(w) .. \", wanted button width\",2) end!@#&		  	if tcolor == nil or bcolor == nil or text == nil then tcolor = \" \"; bcolor = \" \"; text = \" \" end!@#&		 	table.insert(btnindx,{func,x1,y1,x2,y2,true,color,tcolor,bcolor,text,w})!@#&		  	return #btnindx!@#&		end,!@#&	    draw = function (text, x,y,w,h, tcolor, bcolor)!@#&		    if type(text) ~= \"string\" then error(\"Invalid argument 1 of gui.button.draw, expected string, got \".. type(text) .. \", wanted button caption\",2) end!@#&		  	if type(x) ~= \"number\" then error(\"Invalid argument 2 of gui.button.draw, expected number, got \".. type(x) .. \", wanted x value\",2) end!@#&		  	if type(y) ~= \"number\" then error(\"Invalid argument 3 of gui.button.draw, expected number, got \".. type(y) .. \", wanted y value\",2) end!@#&		  	if type(w) ~= \"number\" then error(\"Invalid argument 4 of gui.button.draw, expected number, got \".. type(w) .. \", wanted button horizantal spacing\",2) end!@#&		  	if type(h) ~= \"number\" then error(\"Invalid argument 5 of gui.button.draw, expected number, got \".. type(h) .. \", wanted button height\",2) end!@#&		  	if type(tcolor) ~= \"number\" then error(\"Invalid argument 6 of gui.button.draw, expected number, got \".. type(y) .. \",wanted text color\",2) end!@#&		  	if type(bcolor) ~= \"number\" then error(\"Invalid argument 7 of gui.button.draw, expected number, got \".. type(y) .. \",wanted background color\",2) end!@#&		  	l = string.len(text)!@#&		  	gui.shape.rect(x,y,(w * 2) + l,h,bcolor)!@#&		  	term.setCursorPos(w+x,(h/2)+y)!@#&		  	term.setTextColor(tcolor)!@#&		  	term.write(text)!@#&		end,!@#&		add = function (text, func, x,y,w,h, tcolor, bcolor)!@#&		  	if type(text) ~= \"string\" then error(\"Invalid argument 1 of gui.button.add, expected string, got \".. type(text) .. \", wanted button caption\",2) end!@#&		  	if type(func) ~= \"function\" then error(\"Invalid argument 2 of gui.button.add, expected function, got \".. type(func) .. \", wanted function to run\",2) end!@#&		  	if type(x) ~= \"number\" then error(\"Invalid argument 3 of gui.button.add, expected number, got \".. type(x) .. \", wanted x value\",2) end!@#&		  	if type(y) ~= \"number\" then error(\"Invalid argument 4 of gui.button.add, expected number, got \".. type(y) .. \", wanted y value\",2) end!@#&		  	if type(w) ~= \"number\" then error(\"Invalid argument 5 of gui.button.add, expected number, got \".. type(w) .. \", wanted button horizantal spacing\",2) end!@#&		  	if type(h) ~= \"number\" then error(\"Invalid argument 6 of gui.button.add, expected number, got \".. type(h) .. \", wanted button height\",2) end!@#&		  	if type(tcolor) ~= \"number\" then error(\"Invalid argument 7 of gui.button.add, expected number, got \".. type(y) .. \",wanted text color\",2) end!@#&		  	if type(bcolor) ~= \"number\" then error(\"Invalid argument 8 of gui.button.add, expected number, got \".. type(y) .. \",wanted background color\",2) end!@#&		  	gui.button.draw(text,x,y,w,h,tcolor,bcolor)!@#&		  	return gui.button.index(func,x,y,x + string.len(text) + (w * 2) - 1,y + h - 1,true,tcolor,bcolor,text,w)!@#&		end,!@#&		gray = function (key)!@#&			if type(key) ~= \"number\" then error(\"Invalid argument of gui.button.gray, expected number, got \".. type(key) .. \", wanted button ID to gray\",2) end!@#&		  	if btnindx[key] == nil then error(\"Invalid argument of gui.button.gray, specified button ID does not exist\",2) end!@#&		  	if btnindx[key][6] == true then!@#&		  		btnindx[key][6] = false!@#&		  		if btnindx[key][7] == true then!@#&		  			gui.button.draw(btnindx[key][text], btnindx[key][xmin], btnindx[key][ymin], btnindx[key][width], (btnindx[key][ymax] - btnindx[key][ymin]) + 1, colors.white, colors.gray)!@#&		  		end!@#&!@#&		  	else!@#&		  		btnindx[key][6] = true!@#&		  		if btnindx[key][7] == true then!@#&		  			gui.button.draw(btnindx[key][text], btnindx[key][xmin], btnindx[key][ymin], btnindx[key][width], (btnindx[key][ymax] - btnindx[key][ymin]) + 1, btnindx[key][textcolor],btnindx[key][backcolor])!@#&		  			!@#&		  		end!@#&		  	end!@#&		end!@#&    },!@#&    shape =!@#&    {!@#&		 altrect = function (x1,y1,x2,y2,color)!@#&		  	if type(x1) ~= \"number\" then error(\"Invalid argument 1 of gui.shape.altrect, expected number, got \".. type(x1) .. \", wanted x1 value\",2) end!@#&		  	if type(y1) ~= \"number\" then error(\"Invalid argument 2 of gui.shape.altrect, expected number, got \".. type(y2) .. \", wanted y1 value\",2) end!@#&		  	if type(x2) ~= \"number\" then error(\"Invalid argument 3 of gui.shape.altrect, expected number, got \".. type(x2) .. \", wanted x2 value\",2) end!@#&		  	if type(y2) ~= \"number\" then error(\"Invalid argument 4 of gui.shape.altrect, expected number, got \".. type(y2) .. \", wanted y2 value\",2) end!@#&		  	if type(color) ~= \"number\" then error(\"Invalid argument 5 of gui.shape.altrect, expected number, got \".. type(color) .. \", wanted color\",2) end!@#&		  	for ydraw = y1,y2 - 1 do!@#&		  		for xdraw = x1,x2 - 1 do!@#&		  			gui.fill(xdraw,ydraw,color)!@#&		  		end!@#&		  	end!@#&		end,!@#&		rect = function (x,y,w,h,color)!@#&		  	if type(x) ~= \"number\" then error(\"Invalid argument 1 of gui.shape.rect, expected number, got \".. type(x) .. \", wanted x value\",2) end!@#&		  	if type(y) ~= \"number\" then error(\"Invalid argument 2 of gui.shape.rect, expected number, got \".. type(y2) .. \", wanted y value\",2) end!@#&		  	if type(w) ~= \"number\" then error(\"Invalid argument 3 of gui.shape.rect, expected number, got \".. type(x2) .. \", wanted width value\",2) end!@#&		  	if type(h) ~= \"number\" then error(\"Invalid argument 4 of gui.shape.rect, expected number, got \".. type(y2) .. \", wanted height value\",2) end!@#&		  	if type(color) ~= \"number\" then error(\"Invalid argument 5 of gui.shape.rect, expected number, got \".. type(color) .. \", wanted color\",2) end!@#&		  	gui.shape.altrect(x,y,x+w,y+h,color)!@#&		end,!@#&		line = function (x1,y1,x2,y2,color)!@#&		  	if type(x1) ~= \"number\" then error(\"Invalid argument 1 of gui.shape.line, expected number, got \".. type(x1) .. \", wanted x1 value\",2) end!@#&		  	if type(y1) ~= \"number\" then error(\"Invalid argument 2 of gui.shape.line, expected number, got \".. type(y1) .. \", wanted y1 value\",2) end!@#&		  	if type(x2) ~= \"number\" then error(\"Invalid argument 3 of gui.shape.line, expected number, got \".. type(x2) .. \", wanted x2 value\",2) end!@#&		  	if type(y2) ~= \"number\" then error(\"Invalid argument 3 of gui.shape.line, expected number, got \".. type(y2) .. \", wanted y2 value\",2) end!@#&		  	if type(color) ~= \"number\" then error(\"Invalid argument 4 of gui.shape.line, expected number, got \".. type(color) .. \", wanted color value\",2) end!@#&		  	--local m = (y2 - y1) / (x2 / x1)!@#&			--for lx = x1, x2 do!@#&	 		--	local ly = (m * lx) + y1!@#&	 		--	gui.fill(lx, ly, color)!@#&			--end!@#&			rise = y2 - y1!@#&			run = x2 - x1!@#&			m = rise / run!@#&			if x1 == x2 or y1 == y2 then!@#&				gui.shapes.altrect(x1, x2, y1, y2, color)!@#&			else!@#&				for i = x1, x2 do!@#&					y = (m * i) + y1!@#&					gui.fill(i, y, color)!@#&				end!@#&			end!@#&		end!@#&    },!@#&    progbar =!@#&    {!@#&	 	add = function (x, y, width, percent, forecolor, backcolor)!@#&	 		if type(x) ~= \"number\" then error(\"Invalid argument 1 of gui.progbar.add, expected number, got \".. type(x) .. \", wanted x value\",2) end!@#&	 		if type(y) ~= \"number\" then error(\"Invalid argument 2 of gui.progbar.add, expected number, got \".. type(y) .. \", wanted y value\",2) end!@#&	 		if type(width) ~= \"number\" then error(\"Invalid argument 3 of gui.progbar.add, expected number, got \".. type(width) .. \", wanted width value\",2) end!@#&	 		if type(percent) ~= \"number\" then error(\"Invalid argument 4 of gui.progbar.add, expected number, got \".. type(percent) .. \", wanted percent value\",2) end!@#&	 		if type(forecolor) ~= \"number\" then error(\"Invalid argument 5 of gui.progbar.add, expected number, got \".. type(forecolor) .. \", wanted forecolor value)\",2) end!@#&	 		if type(backcolor) ~= \"number\" then error(\"Invalid argument 6 of gui.progbar.add, expected number, got \".. type(backcolor) .. \", wanted x backcolor\",2) end!@#&	  		gui.shape.rect(x,y,width,1,backcolor)!@#&	 		if percent > 100 then percent = 100 end!@#&	 		gui.shape.rect(x,y,(percent / 100) * width,1,forecolor)!@#&	 		table.insert(prgindx,{x,y,width,percent,forecolor,backcolor})!@#&	 		return #prgindx!@#&	 	end,!@#&	 	increment = function (key, percent)!@#&	 		if type(key) ~= \"number\" then error(\"Invalid argument 1 of gui.progbar.increment, expected number, got \".. type(key) .. \", wanted progress bar ID value\",2) end!@#&	 		if type(percent) ~= \"number\" then error(\"Invalid argument 2 of gui.progbar.increment, expected number, got \".. type(percent) .. \", wanted percent incriment value\",2) end!@#&	  		prgindx[key][4] = prgindx[key][4] + percent!@#&	 		if prgindx[key][4] > 100 then prgindx[key][4] = 100 end!@#&	 		gui.shape.rect(prgindx[key][1],prgindx[key][2],prgindx[key][3],1,prgindx[key][6])!@#&	 		gui.shape.rect(prgindx[key][1],prgindx[key][2],(prgindx[key][4] / 100) * prgindx[key][3],1,prgindx[key][5])!@#&	 		return prgindx[key][4]!@#&	 	end,!@#&	 	set = function (key, percent)!@#&	 		if type(key) ~= \"number\" then error(\"Invalid argument 1 of gui.progbar.set, expected number, got \".. type(key) .. \", wanted progress bar ID value\",2) end!@#&	 		if type(percent) ~= \"number\" then error(\"Invalid argument 2 of gui.progbar.set, expected number, got \".. type(percent) .. \", wanted percent incriment value\",2) end!@#&	 		prgindx[key][4] = percent!@#&	 		if prgindx[key][4] > 100 then prgindx[key][4] = 100 end!@#&	 		gui.shape.rect(prgindx[key][1],prgindx[key][2],prgindx[key][3],1,prgindx[key][6])!@#&	 		gui.shape.rect(prgindx[key][1],prgindx[key][2],(prgindx[key][4] / 100) * prgindx[key][3],1,prgindx[key][5])!@#&	 	end!@#&	},!@#&	fill = function (x,y,color, char)!@#&		if type(x) ~= \"number\" then error(\"Invalid argument 1 of gui.fill, expected number, got \".. type(x) .. \", wanted x value\",2) end!@#&	 	if type(y) ~= \"number\" then error(\"Invalid argument 2 of gui.fill, expected number, got \".. type(y) .. \", wanted y value\",2) end!@#&	 	if type(color) ~= \"number\" then error(\"Invalid argument 3 of gui.fill, expected number, got \".. type(color) .. \", wanted color\",2) end!@#&	 	if type(char) ~= \"string\" and type(char) ~= \"nil\" then error(\"Invalid argument 4 of gui.fill, expected string, got \".. type(char) .. \", wanted single character (string)\",2) end!@#&	 	if type(char) ~= \"nil\" then if string.len(char) ~= 1 then error(\"Invalid argument 4 of gui.fill, expected 1 charecter, got\".. string.len(char) .. \" charectars, wanted charecter or nil\",2) end end!@#&		term.setCursorPos(x,y)!@#&		term.setBackgroundColor(color)!@#&		if type(char) == \"nil\" then term.write(\" \") else term.write(char) end!@#&	end!@#&}!@#&!@#&---------------------------------------------------!@#&--       ||                             ||       --!@#&--      _||_  Place your methods here  _||_      --!@#&--      \\  /                           \\  /      --  !@#&--       \\/                             \\/       --!@#&---------------------------------------------------!@#&!@#&!@#&!@#&---------------------------------------------------!@#&--       /\\                             /\\       --!@#&--      /  \\                           /  \\      --!@#&--      ~||~  Place your methods here  ~||~      --!@#&--       ||                             ||       --!@#&---------------------------------------------------!@#&!@#&thisway = function ()!@#&!@#&---------------------------------------------------!@#&--         ||                        ||          --!@#&--        _||_ Place your code here _||_         --!@#&--        \\  /                      \\  /         --!@#&--         \\/                        \\/          --!@#&---------------------------------------------------!@#&!@#&--HOLYSHITNOTHEREIMACOMMENT!!!!!!!!!!!!!!!!!!!!!!--!@#&!@#&---------------------------------------------------!@#&--         /\\                        /\\          --!@#&--        /  \\                      /  \\         --!@#&--        ~||~ Place your code here ~||~         --!@#&--         ||                        ||          --!@#&---------------------------------------------------!@#&!@#&end!@#&start = function ()!@#&	dof = true!@#&	while dof == true do!@#&		local event, button, xpos, ypos = os.pullEvent(\"mouse_click\")!@#&		for i = 1, #btnindx do!@#&			if xpos >= btnindx[i][2] and xpos <= btnindx[i][4] and ypos >= btnindx[i][3] and ypos <= btnindx[i][5] and btnindx[i][6] == true then!@#&				btnindx[i][1]()!@#&			end!@#&		end!@#&	end!@#&end!@#&stop = function ()!@#&	dof = false!@#&end!@#&!@#&if Is_running_in_portable_mode == true then parallel.waitForAll(thisway,start) end!@#&!@#&--Leonard Henry Phelan IV",["context"]="function menu(...)!@#&        --   < 3      TABLE,      API!@#&        if #arg < 3 or type(arg[3]) ~= \"table\" then error(\"Usage: menu(number x,number y,table Element1,table Element2, table Element3...) \\nReturns: string Action \\n<Element> structure: {string Name[, boolean isElementHidden][,number colorOfText]}\") end!@#&       !@#&        --  !@#&        local xSize, ySize = term.getSize()!@#& !@#&        --        !@#&        local function text(x,y,text1,color)!@#&                term.setTextColor(color)!@#&                term.setCursorPos(x,y)!@#&                term.write(text1)!@#&        end!@#& !@#&        --    (   ,     )!@#&        local Objects = {}!@#&        local function newObj(name,isHidden,xStart,xEnd,y)!@#&                Objects[name]={}!@#&                Objects[name][\"isHidden\"] = isHidden!@#&                Objects[name][\"xStart\"] = xStart!@#&                Objects[name][\"xEnd\"] = xEnd!@#&                Objects[name][\"y\"] = y!@#&        end!@#&       !@#&        --    -   !@#&        local theLongestElement = #arg[3][1]!@#&        for i=3,#arg do!@#&                if arg[i] ~= \"-\" and theLongestElement < #arg[i][1] then!@#&                        theLongestElement = #arg[i][1]!@#&                end!@#&        end!@#& !@#&        --  !@#&        local xSizeOfMenu = theLongestElement + 4!@#&        local ySizeOfMenu = #arg-2!@#& !@#&        local xStartToDisplay = nil!@#&        local yStartToDisplay = nil!@#& !@#&        --   !@#&        local function square(x1,y1,width,height,color)!@#&                local string = string.rep(\" \",width)!@#&                term.setBackgroundColor(color)!@#&                for y=y1,(y1+height-1) do!@#&                        term.setCursorPos(x1,y)!@#&                        term.write(string)!@#&                end!@#&        end!@#& !@#&        --   !@#&        local function drawSeparator(x,y,size)!@#&                term.setTextColor(colors.lightGray)!@#&                term.setCursorPos(x,y)!@#&                term.write(string.rep(\"-\",size))!@#&        end!@#&       !@#&        --   !@#&        local function drawMenu(xMenu,yMenu)!@#& !@#&                --  ,      !@#&                if yMenu+ySizeOfMenu - 1  >= ySize then yMenu = yMenu - (yMenu+ySizeOfMenu - 1 - ySize) - 1 end!@#&                if xMenu+xSizeOfMenu - 1  >= xSize then xMenu = xMenu - (xMenu+xSizeOfMenu - 1 - xSize) - 1 end!@#& !@#&                --      !@#&                xStartToDisplay = xMenu + 2!@#&                yStartToDisplay = yMenu!@#& !@#&                --  !@#&                square(xMenu+1,yMenu+1,xSizeOfMenu,ySizeOfMenu,colors.gray)!@#& !@#&                --   !@#&                square(xMenu,yMenu,xSizeOfMenu,ySizeOfMenu,colors.white)!@#& !@#&                --    ,    !@#&                for i=3,#arg do!@#&                        --     , !@#&                        if arg[i] ~= \"-\" then!@#&                                --      !@#&                                local contextColor = colors.black!@#&                                -- _2 (/ )  _3 (  )     , !@#&                                if arg[i][2] == nil and arg[i][3] == nil then!@#&                                        contextColor = colors.black!@#&                                --  2 = FALSE   3  , !@#&                                elseif arg[i][2] == false and arg[i][3] == nil then!@#&                                        contextColor = colors.black!@#&                                --  2 = FALSE   3 , !@#&                                elseif arg[i][2] == false and arg[i][3] ~= nil then!@#&                                        contextColor = arg[i][3]!@#&                                --  2 = TRUE,   !@#&                                elseif arg[i][2] == true then!@#&                                        contextColor = colors.lightGray!@#&                                end!@#& !@#&                                --     !@#&                                text(xStartToDisplay,yStartToDisplay+i-3,arg[i][1],contextColor)!@#&                                --    ,      !@#&                                newObj(arg[i][1],arg[i][2],xMenu,xMenu+xSizeOfMenu-1,yStartToDisplay+i-3)!@#& !@#&                        --  - , !@#&                        else!@#&                                drawSeparator(xMenu,yStartToDisplay+i-3,xSizeOfMenu)!@#&                        end!@#&                end!@#&        end!@#&       !@#&        -- ,  !@#&        drawMenu(arg[1],arg[2])!@#& !@#&        --  !@#&        local event,side,xClick,yClick = os.pullEvent()!@#&        if event == \"monitor_touch\" then side = 1 end!@#&        if event == \"mouse_click\" or event == \"monitor_touch\" then!@#&                --          ( = , KEY = VAL)!@#&                for key,val in pairs(Objects) do!@#&                        --    ,      , !@#&                        if xClick >= Objects[key][\"xStart\"] and xClick <= Objects[key][\"xEnd\"] and yClick == Objects[key][\"y\"] and Objects[key][\"isHidden\"] == false or xClick >= Objects[key][\"xStart\"] and xClick <= Objects[key][\"xEnd\"] and yClick == Objects[key][\"y\"] and Objects[key][\"isHidden\"] == nil then!@#&                                --    !@#&                                for i=Objects[key][\"xStart\"],Objects[key][\"xEnd\"] do!@#&                                        paintutils.drawPixel(i,Objects[key][\"y\"],colors.blue)!@#&                                end!@#&                                --   ,   !@#&                                text(xStartToDisplay,Objects[key][\"y\"],key,colors.white)!@#&                                --  !@#&                                sleep(0.3)!@#&                                --  KEY (     )    !@#&                                return key!@#&                        end!@#&                        --       ,    NIL!@#&                end!@#&        end!@#&end",["lddfm"]="--[[!@#&	LDDFM!@#&	 File Manager API!!@#&	Select files with ease!!@#&	!@#&	Just do something like!@#&	  local path = makeMenu()!@#&	and you're set!!@#&	!@#&	Get with:!@#&	  pastebin get wfdb986Z lddfm!@#&	  std ld lddfm lddfm!@#&	  std PB wfdb986Z lddfm!@#&--]]!@#&!@#&local lddfm = { --main API!@#&	scroll = 0,!@#&	ypaths = {},!@#&}!@#&!@#&lddfm.scr_x, lddfm.scr_y = term.getSize()!@#&!@#&lddfm.setPalate = function(_p)!@#&	if type(_p) ~= \"table\" then!@#&		_p = {}!@#&	end!@#&	lddfm.p = { --the DEFAULT color palate!@#&		bg =        _p.bg or colors.gray,			-- whole background color!@#&		d_txt =     _p.d_txt or colors.yellow,		-- directory text color!@#&		d_bg =      _p.d_bg or colors.gray,			-- directory bg color!@#&		f_txt =     _p.f_txt or colors.white,		-- file text color!@#&		f_bg =      _p.f_bg or colors.gray,			-- file bg color!@#&		p_txt =     _p.p_txt or colors.black,		-- path text color!@#&		p_bg =      _p.p_bg or colors.lightGray,	-- path bg color!@#&		close_txt = _p.close_txt or colors.gray,	-- close button text color!@#&		close_bg =  _p.close_bg or colors.lightGray,-- close button bg color!@#&		scr =       _p.scr or colors.lightGray,		-- scrollbar color!@#&		scrbar =    _p.scrbar or colors.gray,		-- scroll tab color!@#&	}!@#&end!@#&!@#&lddfm.setPalate()!@#&!@#&lddfm.foldersOnTop = function(floop,path)!@#&	local output = {}!@#&	for a = 1, #floop do!@#&		if fs.isDir(fs.combine(path,floop[a])) then!@#&			table.insert(output,1,floop[a])!@#&		else!@#&			table.insert(output,floop[a])!@#&		end!@#&	end!@#&	return output!@#&end!@#&!@#&lddfm.filterFileFolders = function(list,path,_noFiles,_noFolders,_noCD,_doHidden)!@#&	local output = {}!@#&	for a = 1, #list do!@#&		local entry = fs.combine(path,list[a])!@#&		if fs.isDir(entry) then!@#&			if entry == \"..\" then!@#&				if not (_noCD or _noFolders) then table.insert(output,list[a]) end!@#&			else!@#&				if not ((not _doHidden) and list[a]:sub(1,1) == \".\") then!@#&					if not _noFolders then table.insert(output,list[a]) end!@#&				end!@#&			end!@#&		else!@#&			if not ((not _doHidden) and list[a]:sub(1,1) == \".\") then!@#&				if not _noFiles then table.insert(output,list[a]) end!@#&			end!@#&		end!@#&	end!@#&	return output!@#&end!@#&!@#&lddfm.isColor = function(col)!@#&	for k,v in pairs(colors) do!@#&		if v == col then!@#&			return true, k!@#&		end!@#&	end!@#&	return false!@#&end!@#&!@#&lddfm.clearLine = function(x1,x2,_y,_bg,_char)!@#&	local cbg, bg = colors.black!@#&	local x,y = term.getCursorPos()!@#&	local sx,sy = term.getSize()!@#&	if type(_char) == \"string\" then char = _char else char = \" \" end!@#&	if type(_bg) == \"number\" then!@#&		if lddfm.isColor(_bg) then bg = _bg!@#&		else bg = cbg end!@#&	else bg = cbg end!@#&	term.setCursorPos(x1 or 1, _y or y)!@#&	term.setBackgroundColor(bg)!@#&	if x2 then --it pains me to add an if statement to something as simple as this!@#&		term.write((char or \" \"):rep(x2-x1))!@#&	else!@#&		term.write((char or \" \"):rep(sx-(x1 or 0)))!@#&	end!@#&	term.setBackgroundColor(cbg)!@#&	term.setCursorPos(x,y)!@#&end!@#&!@#&lddfm.render = function(_x1,_y1,_x2,_y2,_rlist,_path,_rscroll,_canClose,_scrbarY)!@#&	local tsv = term!@#&	local px,py = term.getCursorPos()!@#&	local x1, x2, y1, y2 = _x1 or 1, _x2 or lddfm.scr_x, _y1 or 1, _y2 or lddfm.scr_y!@#&	local rlist = _rlist or {\"Invalid directory.\"}!@#&	local path = _path or \"And that's terrible.\"!@#&	ypaths = {}!@#&	local rscroll = _rscroll or 0!@#&	for a = y1, y2 do!@#&		lddfm.clearLine(x1,x2,a,lddfm.p.bg)!@#&	end!@#&	term.setCursorPos(x1,y1)!@#&	term.setTextColor(lddfm.p.p_txt)!@#&	lddfm.clearLine(x1,x2+1,y1,lddfm.p.p_bg)!@#&	term.setBackgroundColor(lddfm.p.p_bg)!@#&	term.write((\"/\"..path):sub(1,x2-x1))!@#&	for a = 1,(y2-y1) do!@#&		if rlist[a+rscroll] then!@#&			term.setCursorPos(x1,a+(y1))!@#&			if fs.isDir(fs.combine(path,rlist[a+rscroll])) then!@#&				lddfm.clearLine(x1,x2,a+(y1),lddfm.p.d_bg)!@#&				term.setTextColor(lddfm.p.d_txt)!@#&				term.setBackgroundColor(lddfm.p.d_bg)!@#&			else!@#&				lddfm.clearLine(x1,x2,a+(y1),lddfm.p.f_bg)!@#&				term.setTextColor(lddfm.p.f_txt)!@#&				term.setBackgroundColor(lddfm.p.f_bg)!@#&			end!@#&			term.write(rlist[a+rscroll]:sub(1,x2-x1))!@#&			ypaths[a+(y1)] = rlist[a+rscroll]!@#&		else!@#&			lddfm.clearLine(x1,x2,a+(y1),lddfm.p.bg)!@#&		end!@#&	end!@#&	local scrbarY = _scrbarY or math.ceil( (y1+1)+( (_rscroll/(#_rlist-(y2-(y1+1))))*(y2-(y1+1)) ) )!@#&	for a = y1+1, y2 do!@#&		term.setCursorPos(x2,a)!@#&		if a == scrbarY then!@#&			term.setBackgroundColor(lddfm.p.scrbar)!@#&		else!@#&			term.setBackgroundColor(lddfm.p.scr)!@#&		end!@#&		term.write(\" \")!@#&	end!@#&	if _canClose then!@#&		term.setCursorPos(x2-4,y1)!@#&		term.setTextColor(lddfm.p.close_txt)!@#&		term.setBackgroundColor(lddfm.p.close_bg)!@#&		term.write(\"close\")!@#&	end!@#&	term.setCursorPos(px,py)!@#&	return scrbarY!@#&end!@#&!@#&lddfm.coolOutro = function(x1,y1,x2,y2,_bg,_txt,char)!@#&	local cx, cy = term.getCursorPos()!@#&	local bg, txt = term.getBackgroundColor(), term.getTextColor()!@#&	term.setTextColor(_txt or colors.white)!@#&	term.setBackgroundColor(_bg or colors.black)!@#&	local _uwah = 0!@#&	for y = y1, y2 do!@#&		for x = x1, x2 do!@#&			_uwah = _uwah + 1!@#&			term.setCursorPos(x,y)!@#&			term.write(char or \" \")!@#&			if _uwah >= math.ceil((x2-x1)*1.63) then sleep(0) _uwah = 0 end!@#&		end!@#&	end!@#&	term.setTextColor(txt)!@#&	term.setBackgroundColor(bg)!@#&	term.setCursorPos(cx,cy)!@#&end!@#&!@#&lddfm.scrollMenu = function(amount,list,y1,y2)!@#&	if #list >= y2-y1 then!@#&		lddfm.scroll = lddfm.scroll + amount!@#&		if lddfm.scroll < 0 then!@#&			lddfm.scroll = 0!@#&		end!@#&		if lddfm.scroll > #list-(y2-y1) then!@#&			lddfm.scroll = #list-(y2-y1)!@#&		end!@#&	end!@#&end!@#&!@#&--[[!@#& a quick explanation of the arguments:!@#&!@#&x1 and y1: top-left corner coordinates of menu window. defaults to the top-left corner of the screen!@#&x2 and y2: bottom-right corner coordinates of menu window. defaults to the bottom-right corner of the screen!@#&_path: path to start viewing. defaults to \"/\"!@#&_noFiles: whether or not to view files in the menu, mainly for picking a path for installing something. defaults to false!@#&_noFolders: whether or not to view folders in the menu, mainly for choosing a file to run or whatever. defaults to false!@#&_noCD: whether or not you can change the directory, mainly to limit choices to a single folder. defaults to false!@#&_noSelectFolders: whether or not you can select folders to return. defaults to false!@#&_doHidden: whether or not to hide hidden files (starts with \".\"). defaults to false!@#&_p: the palate. has: bg, d_txt, d_bg, f_txt, t_bg, p_txt, p_bg, scr, scrbar. 'd' is for directory, 'f' is for file, 'p' is for path bar.!@#&_canClose: whether or not you can click on the little top-right \"Cancel\" button.!@#&--]]!@#&!@#&makeMenu = function(_x1,_y1,_x2,_y2,_path,_noFiles,_noFolders,_noCD,_noSelectFolders,_doHidden,_p,_canClose)!@#&	if _noFiles and _noFolders then!@#&		return false, \"C'mon, man...\"!@#&	end!@#&	if _x1 == true then!@#&		return false, \"arguments: x1, y1, x2, y2, path, noFiles, noFolders, noCD, noSelectFolders, doHidden, palate, canClose\" -- a little help!@#&	end!@#&	lddfm.setPalate(_p)!@#&	local path, list = _path or \"\"!@#&	lddfm.scroll = 0!@#&	local _pbg, _ptxt = colors.black, colors.white!@#&	local x1, x2, y1, y2 = _x1 or 1, _x2 or lddfm.scr_x, _y1 or 1, _y2 or lddfm.scr_y!@#&	local keysDown = {}!@#&	local _barrY!@#&	while true do!@#&		list = lddfm.foldersOnTop(lddfm.filterFileFolders(fs.list(path),path,_noFiles,_noFolders,_noCD,_doHidden),path)!@#&		if (path ~= \"..\") and not (_noCD or _noFolders) then!@#&			table.insert(list,1,\"..\")!@#&		end!@#&		_res, _barrY = pcall( function() return lddfm.render(x1,y1,x2,y2,list,path,lddfm.scroll,_canClose) end)!@#&		if not _res then!@#&			error(_barrY)!@#&		end!@#&		local evt = {os.pullEvent()}!@#&		if evt[1] == \"mouse_scroll\" then!@#&			lddfm.scrollMenu(evt[2],list,y1,y2)!@#&		elseif evt[1] == \"mouse_click\" then!@#&			local butt,mx,my = evt[2],evt[3],evt[4]!@#&			if (butt == 1 and my == y1 and mx <= x2 and mx >= x2-4) and _canClose then!@#&				--lddfm.coolOutro(x1,y1,x2,y2)!@#&				term.setTextColor(_ptxt) term.setBackgroundColor(_pbg)!@#&				return false!@#&			elseif ypaths[my] and (mx >= x1 and mx < x2) then --x2 is reserved for the scrollbar, breh!@#&				if fs.isDir(fs.combine(path,ypaths[my])) then!@#&					if _noCD or butt == 3 then!@#&						if not _noSelectFolders or _noFolders then!@#&							--lddfm.coolOutro(x1,y1,x2,y2)!@#&							term.setTextColor(_ptxt) term.setBackgroundColor(_pbg)!@#&							return fs.combine(path,ypaths[my])!@#&						end!@#&					else!@#&						path = fs.combine(path,ypaths[my])!@#&						lddfm.scroll = 0!@#&					end!@#&				else!@#&					term.setTextColor(_ptxt) term.setBackgroundColor(_pbg)!@#&					return fs.combine(path,ypaths[my])!@#&				end!@#&			end!@#&		elseif evt[1] == \"key\" then!@#&			keysDown[evt[2]] = true!@#&			if evt[2] == keys.enter and not (_noFolders or _noCD or _noSelectFolders) then --the logic for _noCD being you'd normally need to go back a directory to select the current directory.!@#&				--lddfm.coolOutro(x1,y1,x2,y2)!@#&				term.setTextColor(_ptxt) term.setBackgroundColor(_pbg)!@#&				return path!@#&			end!@#&			if evt[2] == keys.up then!@#&				lddfm.scrollMenu(-1,list,y1,y2)!@#&			elseif evt[2] == keys.down then!@#&				lddfm.scrollMenu(1,list,y1,y2)!@#&			end!@#&			if evt[2] == keys.pageUp then!@#&				lddfm.scrollMenu(y1-y2,list,y1,y2)!@#&			elseif evt[2] == keys.pageDown then!@#&				lddfm.scrollMenu(y2-y1,list,y1,y2)!@#&			end!@#&			if evt[2] == keys.home then!@#&				lddfm.scroll = 0!@#&			elseif evt[2] == keys[\"end\"] then!@#&				if #list > (y2-y1) then!@#&					lddfm.scroll = #list-(y2-y1)!@#&				end!@#&			end!@#&			if evt[2] == keys.h then!@#&				if keysDown[keys.leftCtrl] or keysDown[keys.rightCtrl] then!@#&					_doHidden = not _doHidden!@#&				end!@#&			end!@#&		elseif evt[1] == \"key_up\" then!@#&			keysDown[evt[2]] = false!@#&		end!@#&	end!@#&end!@#&!@#&return makeMenu",["grid"]="!@#&-- ] Created by: Redxone(Lewisk3) [ -- !@#&-- ] 	(c)Lewisk3 Corpz 2016	  [ -- !@#&!@#&-- DOCUMENTATION (Sorta...) -- !@#&--] grid.create(width,height)!@#&--] grid:set(x,y,thing)!@#&--] grid:find(obj) - returns the found objects x and y location!@#&--] grid:findByAttrib(attrib,compare)!@#&--] grid:get(x,y) - returns the object in the x any y of the grid!@#&--] grid:getByAttrib(attrib,compare)!@#&--] grid:getWidth() - returns width of grid!@#&--] grid:getHeight() - returns grid height!@#&--] grid:unset(x,y) - set grid spot to {}!@#&--] grid:getRaw() - returns entire grid unserialized!@#&--] grid:getSerial() - returns entire grid serialized!@#&--] grid:replace(newgrid) - replaces grid with another grid!@#&--] grid:draw()!@#&--] grid:drawAttrib(attrib)!@#&--] grid:fill(with) - fills grid with something!@#&--] grid:setRegion(startx,starty,endx,endy,with) - fills grid from start x and start y to ends with something!@#&--] grid:drawRegion(startx,starty,endx,endy)!@#&!@#&function create(w, h)!@#&	local gridtable = {!@#&		maxw = w,!@#&		maxh = h,!@#&		grid = {},!@#&!@#&		set = function(self,x,y,obj)!@#&			if(x <= self.maxw and y <= self.maxh)then!@#&				self.grid[y][x] = obj!@#&			else!@#&				error(\"grid:set -> Invaild X and/or Y param(s).\")!@#&			end!@#&		end,!@#&!@#&		find = function(self,obj)!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		if(textutils.serialize(self.grid[y][x]) == textutils.serialize(obj))then!@#&			 			return x, y!@#&			 		end!@#&			 	end!@#&			 end!@#&		end,!@#&!@#&		get = function(self,x,y)!@#&			local tbl = {}!@#&			if(x <= self.maxw and y <= self.maxh )then!@#&				return self.grid[y][x]!@#&			else!@#&				return tbl!@#&			end!@#&		end,!@#&!@#&		getByAttribEqual = function(self,a,c)!@#&			local gx, gy = 0, 0!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		if(self.grid[y][x][a] == c)then!@#&			 			gx = x!@#&			 			gy = y!@#&			 		end!@#&			 	end!@#&			 end!@#&			return self:get(gx,gy)!@#&		end,!@#&!@#&		checkAttribEqual = function(self,x,y,a,e)!@#&			 if(self.grid[y][x][a] == c)then!@#&			 	return true!@#&			 else!@#&			 	return false!@#&			 end!@#&		end,!@#&!@#&		getByAttrib = function(self,a)!@#&			local xx, yy = 0, 0!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		if(self.grid[y][x][a] ~= nil)then!@#&			 			 xx = x!@#&			 			 yy = y!@#&			 		end!@#&			 	end!@#&			 end!@#&!@#&			 if(xx ~= 0 and yy ~= 0)then!@#&				return self:get(xx,yy)[a]!@#&			 else!@#&				return {}!@#&			 end!@#&		end,!@#&!@#&		setByAttrib = function(self,a,n)!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		if(self.grid[y][x][a] ~= nil)then!@#&			 			 local bset = self.grid[y][x]!@#&			 			 bset[a] = n!@#&			 			 self:set(x,y,bset)!@#&			 		end!@#&			 	end!@#&			 end!@#&		end,!@#&!@#&		getWidth = function(self)!@#&			return self.maxw!@#&		end,!@#&!@#&		getHeight = function(self)!@#&			return self.maxh!@#&		end,!@#&!@#&		unset = function(self,x,y)!@#&			if(x <= self.maxw and y <= self.maxh)then!@#&				self.grid[y][x] = {}!@#&			else!@#&				error(\"grid:unset -> Invaild X and/or Y param(s).\")!@#&			end!@#&		end,!@#&!@#&		getRaw = function(self)!@#&			return self.grid!@#&		end,!@#&!@#&		getSerial = function(self)!@#&			return textutils.serialize(self.grid):gsub(\"\\n%s*\",\"\")!@#&		end,!@#&!@#&		replace = function(self,grid)!@#&			if(type(grid) ~= \"table\")then error(\"grid:replace -> Invalid grid type. \") end!@#&			 -- calculating grid size... --!@#&			 self.maxh = 0!@#&			 self.maxw = 0!@#&!@#&			 for iy = 1, #grid do!@#&			 	self.maxh = self.maxh + 1!@#&			 end!@#&!@#&			 for ix = 1, #grid[0] do!@#&				self.maxw = self.maxw + 1!@#&		     end!@#&!@#&		     self.grid = grid!@#&!@#&			 if(self.maxh <= 0 or self.maxw <= 0)then error(\"grid:replace -> Grid is malformed.\") end!@#&!@#&		end,!@#&!@#&		draw = function(self)!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		term.setCursorPos(x,y)!@#&			 		if(self.grid[y][x] ~= {})then!@#&						term.write(self.grid[y][x])!@#&					end!@#&			 	end!@#&			 end!@#&		end,!@#&!@#&		swap = function(self,fromx,fromy,tox,toy)!@#&			local prevo = self.grid[fromy][fromx] !@#&			local too = self.grid[toy][tox]!@#&			self.grid[fromy][fromx] = too!@#&			self.grid[toy][tox] = prevo!@#&		end,!@#&!@#&		moveInto = function(self,obj,x,y,uap,flags)!@#&			local prloc = self:get(x,y)!@#&			local ox, oy = self:find(obj)!@#&			-- only take place if flags on other block are met --!@#&			if(type(flags) == \"table\")then!@#&				for k, v in pairs(flags) do!@#&					if(not self:checkAttribEqual(x,y,k,v))then!@#&						return false!@#&					end!@#&				end!@#&			end!@#&			-- if passes flags -- !@#&			if(type(uap) == \"table\")then!@#&				for k, v in pairs(uap) do!@#&					obj[k] = v!@#&				end				!@#&			end!@#&			self:set(ox,oy,prloc)!@#&			self:set(x,y,obj)!@#&		end,!@#&!@#&		renderSwap = function(self, charattrib, tcolattrib, bcolattrib, fromx,fromy,tox,toy)!@#&			self:swap(fromx,fromy,tox,toy)		!@#&			self:renderRegion(charattrib, tcolattrib, bcolattrib,tox,toy,tox,toy)!@#&			self:renderRegion(charattrib, tcolattrib, bcolattrib,fromx,fromy,fromx,fromy)!@#&		end,!@#&!@#&		render = function(self,charattrib,tcolattrib,bcolattrib)!@#&			local ta = colors.white!@#&			local ba = colors.black!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		term.setCursorPos(x,y)!@#&			 		term.setTextColor(self.grid[y][x][tcolattrib])!@#&			 		term.setBackgroundColor(self.grid[y][x][bcolattrib])!@#&					 	ta = colors.white!@#&					 	ba = colors.black!@#&					 	if(type(tcolattrib) == \"number\")then ta = tcolattrib end!@#&					 	if(type(bcolattrib) == \"number\")then ba = bcolattrib end!@#&					 	if(self.grid[y][x][charattrib] ~= nil)then!@#&					 		if(self.grid[y][x][tcolattrib] ~= nil)then!@#&					 			ta = self.grid[y][x][tcolattrib]!@#&					 		end!@#&					 		if(self.grid[y][x][bcolattrib] ~= nil)then!@#&					 			ba = self.grid[y][x][bcolattrib]!@#&					 		end!@#&						 	term.setTextColor(ta)!@#&				 			term.setBackgroundColor(ba)!@#&					 		term.write(self.grid[y][x][charattrib])!@#&					 	end!@#&				end!@#&			 end!@#&		end,!@#&!@#&		drawAttrib = function(self,a)!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		term.setCursorPos(x,y)!@#&			 		if(self.grid[y][x][a] ~= nil)then!@#&			 			term.write(self.grid[y][x][a])!@#&			 		end!@#&			 	end!@#&			 end!@#&		end,!@#&!@#&		fill = function(self,obj)!@#&			for y = 0, self.maxh do!@#&			 	for x = 0, self.maxw do!@#&			 		self.grid[y][x] = obj!@#&			 	end!@#&			 end!@#&		end,!@#&!@#&		setCursorPos = function(self,x,y)!@#&			term.setCursorPos(y,x)!@#&		end,!@#&!@#&		loop = function(self,f,startx,starty,endx,endy)!@#&			if(startx == nil)then startx = 0 end!@#&			if(starty == nil)then starty = 0 end!@#&			if(endx == nil and startx ~= nil)then endx = startx end!@#&			if(endy == nil and starty ~= nil)then endy = starty end!@#&			if(endx == nil)then endx = self.maxw end!@#&			if(endy == nil)then endy = self.maxh end!@#&			for y = tonumber(starty), tonumber(endy) do!@#&				for x = tonumber(startx), tonumber(endx) do!@#&					f(x,y)!@#&				end!@#&			end!@#&		end,!@#&!@#&		setRegion = function(self, sx, sy, ex, ey, obj)!@#&			if(sx <= self.maxw and sy <= self.maxh and ex <= self.maxw and ey <= self.maxh)then!@#&				for y = tonumber(sy), tonumber(ey) do!@#&				 	for x = tonumber(sx), tonumber(ex) do!@#&				 		self.grid[y][x] = obj!@#&				 	end!@#&				 end!@#&			else!@#&				error(\"grid:setRegion -> Invaild X and/or Y param(s).\")!@#&			end!@#&		end,!@#&!@#&		drawRegion = function(self, sx, sy, ex, ey)!@#&			if(sx <= self.maxw and sy <= self.maxh and ex <= self.maxw and ey <= self.maxh)then!@#&				for y = tonumber(sy), tonumber(ey) do!@#&				 	for x = tonumber(sx), tonumber(ex) do!@#&					 	term.setCursorPos(x,y)!@#&				 		if(self.grid[y][x] ~= {})then!@#&							term.write(self.grid[y][x])!@#&						end!@#&				 	end!@#&				 end!@#&			else!@#&				error(\"grid:drawRegion -> Invaild X and/or Y param(s).\")!@#&			end!@#&		end,!@#&!@#&		renderRegion = function(self, charattrib, tcolattrib, bcolattrib, sx, sy, ex, ey)!@#&			if(sx <= self.maxw and sy <= self.maxh and ex <= self.maxw and ey <= self.maxh)then!@#&				local ta = colors.white!@#&			 	local ba = colors.black!@#&				for y = tonumber(sy), tonumber(ey) do!@#&				 	for x = tonumber(sx), tonumber(ex) do!@#&					 	term.setCursorPos(x,y)!@#&					 	ta = colors.white!@#&					 	ba = colors.black!@#&					 	if(self.grid[y][x][charattrib] ~= nil)then!@#&					 		if(self.grid[y][x][tcolattrib] ~= nil)then!@#&					 			ta = self.grid[y][x][tcolattrib]!@#&					 		end!@#&					 		if(self.grid[y][x][bcolattrib] ~= nil)then!@#&					 			ba = self.grid[y][x][bcolattrib]!@#&					 		end!@#&						 	term.setTextColor(ta)!@#&				 			term.setBackgroundColor(ba)!@#&					 		term.write(self.grid[y][x][charattrib])!@#&					 	end!@#&				 	end!@#&				 end!@#&			else!@#&				error(\"grid:renderRegion -> Invaild X and/or Y param(s).\")!@#&			end!@#&		end,!@#&!@#&	}!@#&!@#&!@#&	-- generate grid locally --!@#&	for y = 0, h do!@#&		gridtable.grid[y] = {}!@#&		for x = 0, w do!@#&			gridtable.grid[y][x] = {}!@#&		end!@#&	end!@#&!@#&	-- return grid to user --!@#&	return gridtable!@#&end",["GIF"]="-- +---------------------+-----------+---------------------+!@#&-- |                     |           |                     |!@#&-- |                     |    GIF    |                     |!@#&-- |                     |           |                     |!@#&-- +---------------------+-----------+---------------------+!@#&!@#&local version = \"Version 1.3.0pr1\"!@#&!@#&-- Loads and renders GIF files in ComputerCraft.!@#&-- Capable of handling animations.!@#&-- http://www.computercraft.info/forums2/index.php?/topic/23056-gif-renderer!@#&!@#&---------------------------------------------!@#&------------Variable Declarations------------!@#&---------------------------------------------!@#&!@#&if not bbpack then os.loadAPI(\"/SpeedAPI/bbpack\") end!@#&!@#&local CCPal = io.lines and  -- CC 1.55 adds this function, and also changes the colours, so...!@#&		{[0] = {240,240,240},{242,178, 51},{229,127,216},{153,178,242},!@#&		{222,222,108},{127,204, 25},{242,178,204},{ 76, 76, 76},!@#&		{153,153,153},{ 76,153,178},{178,102,229},{ 51,102,204},!@#&		{127,102, 76},{ 87,166, 78},{204, 76, 76},{ 25, 25, 25}}!@#&	or!@#&		{[0] = {240,240,240},{235,136, 68},{195, 84,205},{102,137,211},!@#&		{222,222,108},{65,205, 52},{216,129,152},{ 67, 67, 67},!@#&		{153,153,153},{ 40,118,151},{123, 47,190},{ 37, 49,146},!@#&		{ 81, 48, 26},{ 59, 81, 26},{179, 49, 44},{  0,  0,  0}}!@#&!@#&local GIF87a, GIF89a, colourNum = {71,73,70,56,55,97}, {71,73,70,56,57,97}, {}!@#&!@#&do!@#&	local hex = \"0123456789abcdef\"!@#&	for i = 1, 16 do colourNum[i - 1] = hex:sub(i, i) end!@#&	for i = 1, 16 do colourNum[hex:sub(i, i)] = i - 1 end!@#&end!@#&!@#&---------------------------------------------!@#&------------Function Declarations------------!@#&---------------------------------------------!@#&!@#&local function snooze()!@#&	local myEvent = tostring({})!@#&	os.queueEvent(myEvent)!@#&	os.pullEvent(myEvent)!@#&end!@#&!@#&local function simpleWindow(terminal, xPos, yPos, width, height)!@#&	local results, curX, curY = {}, 1, 1!@#&	!@#&	results.clear = function(colour)!@#&		local text = string.rep(colour, width)!@#&		for y = 1, height do results[y] = text end!@#&	end!@#&	!@#&	results.draw = function(x1, y1, x2, y2)!@#&		if x1 then!@#&			local text = string.rep(\" \", x2 - x1 + 1)!@#&			for y = y1, y2 do!@#&				local snip = results[y]:sub(x1, x2)!@#&				terminal.setCursorPos(xPos + x1 - 1, yPos + y - 1)!@#&				terminal.blit(text, snip, snip)!@#&			end!@#&		else!@#&			local text = string.rep(\" \", width)!@#&			for y = 1, height do!@#&				terminal.setCursorPos(xPos, yPos + y - 1)!@#&				terminal.blit(text, results[y], results[y])!@#&			end!@#&		end!@#&	end!@#&	!@#&	results.setCursorPos = function(newX, newY)!@#&		curX, curY = newX, newY!@#&	end!@#&	!@#&	results.blit = function(_, _, colString)!@#&		if curY < 1 or curY > height or curX > width or curX + #colString < 2 then return end!@#&		!@#&		local ending = (curX + #colString - 1 > width) and (width - curX + 1) or #colString!@#&		if curX < 1 then!@#&			colString = colString:sub(2 - curX, ending)!@#&			curX = 1!@#&		elseif ending ~= #colString then colString = colString:sub(1, ending) end!@#&		!@#&		if curX > 1 then!@#&			if curX + #colString - 1 < width then!@#&				results[curY] = results[curY]:sub(1, curX - 1) .. colString .. results[curY]:sub(curX + #colString)!@#&			else!@#&				results[curY] = results[curY]:sub(1, curX - 1) .. colString!@#&			end!@#&		elseif #colString < width then!@#&			results[curY] = colString .. results[curY]:sub(curX + #colString)!@#&		else results[curY] = colString end!@#&	end!@#&	!@#&	return results!@#&end!@#&!@#&-- ComputerCraft builds prior to 1.74 lack term.blit(). This function implements a substitute:!@#&local function checkTerm(terminal)!@#&	if not terminal.blit then terminal.blit = function(_, _, backCol)!@#&		local counter, lastChar = 1, backCol:sub(1, 1)!@#&!@#&		for i = 2, #backCol do if backCol:sub(i, i) ~= lastChar then!@#&			terminal.setBackgroundColour(bit.blshift(1, colourNum[lastChar]))!@#&			terminal.write(string.rep(\" \", counter))!@#&			counter, lastChar = 1, backCol:sub(i, i)!@#&		else counter = counter + 1 end end!@#&!@#&		terminal.setBackgroundColour(bit.blshift(1, colourNum[lastChar]))!@#&		terminal.write(string.rep(\" \", counter))!@#&		!@#&		snooze()!@#&	end end!@#&end!@#&!@#&if term.setPaletteColour then!@#&	function applyPalette(image, terminal)!@#&		terminal = terminal or term!@#&!@#&		local col, pal = 1, image.pal!@#&!@#&		for i = 0, #pal do!@#&			local thisCol = pal[i]!@#&			terminal.setPaletteColour(col, thisCol[1] / 255, thisCol[2] / 255, thisCol[3] / 255)!@#&			col = col * 2!@#&		end!@#&	end!@#&end!@#&!@#&function drawGIF(image, xPos, yPos, terminal)!@#&	xPos, yPos, terminal = xPos or 1, yPos or 1, terminal or term!@#&	if type(image[1][1]) == \"table\" then image = image[1] end!@#&	checkTerm(terminal)!@#&	!@#&	for y = 1, image.yend do!@#&		local x, ystart, imageY = image.xstart + 1, image.ystart, image[y]!@#&		for i = 1, #imageY do!@#&			local imageYI = imageY[i]!@#&			if type(imageYI) == \"number\" then!@#&				x = x + imageYI!@#&			else!@#&				terminal.setCursorPos(x + xPos - 1, y + ystart + yPos - 1)!@#&				terminal.blit(string.rep(\" \", #imageYI), imageYI, imageYI)!@#&				x = x + #imageYI!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&function animateGIF(image, xPos, yPos, terminal)!@#&	if terminal == term or not terminal then terminal = term.current() end!@#&	checkTerm(terminal)!@#&	local buffer = simpleWindow(terminal, xPos, yPos, image.width, image.height)!@#&		!@#&	while true do for i = 1, #image do!@#&		local imageI, imageIneg1 = image[i], image[i - 1]!@#&		if i == 1 then buffer.clear(image.backgroundCol2) end!@#&		!@#&		drawGIF(imageI, 1, 1, buffer)!@#&		!@#&		if i == 1 then!@#&			buffer.draw()!@#&		elseif imageIneg1.disposal == 2 then!@#&			buffer.draw(math.min(imageIneg1.xstart, imageI.xstart) + 1, math.min(imageIneg1.ystart, imageI.ystart) + 1, math.max(imageIneg1.xstart + imageIneg1.xend, imageI.xstart + imageI.xend), math.max(imageIneg1.ystart + imageIneg1.yend, imageI.ystart + imageI.yend))!@#&		else!@#&			buffer.draw(imageI.xstart + 1, imageI.ystart + 1, imageI.xstart + imageI.xend, imageI.ystart + imageI.yend)!@#&		end!@#&		!@#&		sleep(imageI.delay)!@#&		!@#&		if imageI.disposal == 2 then!@#&			local blit = string.rep(image.backgroundCol2, imageI.xend)!@#&			for y = 1, imageI.yend do!@#&				buffer.setCursorPos(imageI.xstart + 1, y + imageI.ystart)!@#&				buffer.blit(nil, nil, blit)!@#&			end!@#&		end!@#&	end end!@#&end!@#&!@#&local function rasteriseGIF(image)!@#&	local results, buffer = {[\"width\"] = image.width, [\"height\"] = image.height, [\"backgroundCol\"] = image.backgroundCol, [\"backgroundCol2\"] = image.backgroundCol2, [\"pal\"] = image.pal}, {}!@#&	!@#&	for i = 1, image.height do!@#&		local temp = {}!@#&		for j = 1, image.width do temp[j] = \" \" end!@#&		buffer[i] = temp!@#&	end!@#&	!@#&	for i = 1, #image do!@#&		local thisImg = image[i]!@#&		local xStart, yStart = thisImg.xstart + 1, thisImg.ystart!@#&		!@#&		for y = 1, thisImg.yend do!@#&			local x, thisImgY, buffY = xStart, thisImg[y], buffer[y + yStart]!@#&			for i = 1, #thisImgY do!@#&				local thisImgYI = thisImgY[i]!@#&				if type(thisImgYI) == \"number\" then!@#&					x = x + thisImgYI!@#&				elseif type(thisImgYI) == \"string\" then!@#&					for j = 1, #thisImgYI do buffY[x + j - 1] = colourNum[thisImgYI:sub(j, j)] end!@#&					x = x + #thisImgYI!@#&				else!@#&					for j = 1, #thisImgYI do buffY[x + j - 1] = thisImgYI[j] end!@#&					x = x + #thisImgYI!@#&				end!@#&			end!@#&		end!@#&!@#&		local resultsI = {[\"delay\"] = thisImg.delay or 0.1}!@#&		for j = 1, #buffer do!@#&			local newRow, buffRow = {}, buffer[j]!@#&			for k = 1, #buffRow do newRow[k] = buffRow[k] end!@#&			resultsI[j] = newRow!@#&		end!@#&		results[i] = resultsI!@#&!@#&		if thisImg.disposal == 2 then!@#&			local xEnd = thisImg.xstart + thisImg.xend!@#&			for y = yStart + 1, yStart + thisImg.yend do!@#&				local bufferY = buffer[y]!@#&				for x = xStart, xEnd do bufferY[x] = \" \" end!@#&			end!@#&		end!@#&!@#&		snooze()!@#&	end!@#&!@#&	return results	!@#&end!@#&!@#&function flattenGIF(image, optimise, prerastered)!@#&	if not prerastered then image = rasteriseGIF(image) end!@#&	!@#&	local width, bump, cacheImg = image.width, 0!@#&	for i = 1, #image do!@#&		local prevImg, thisImg, nextImg, same = image[i - 1 - bump], image[i - bump], image[i + 1 - bump], true!@#&		if not thisImg then break end!@#&		local txStart, txEnd, tyStart, tyEnd, cxStart, cxEnd, cyStart, cyEnd = image.width, 1, image.height, 1!@#&		if cacheImg then cxStart, cxEnd, cyStart, cyEnd = cacheImg.xstart, cacheImg.xend, cacheImg.ystart, cacheImg.yend end!@#&		!@#&		if optimise and i > 1 then!@#&			local prevDisp = prevImg.disposal!@#&			for y = 1, #thisImg do!@#&				local thisImgY, cacheImgY = thisImg[y], cacheImg[y]!@#&				for x = 1, width do if thisImgY[x] ~= ((prevDisp == 2 and not (x < cxStart + 1 or y < cyStart + 1 or x > cxStart + cxEnd or y > cyStart + cyEnd)) and \" \" or cacheImgY[x]) then!@#&					same = false!@#&					if y < tyStart + 1 then tyStart = y - 1 end!@#&					if y > tyEnd then tyEnd = y end!@#&					if x < txStart + 1 then txStart = x - 1 end!@#&					if x > txEnd then txEnd = x end!@#&					snooze()!@#&				end end!@#&			end!@#&		elseif optimise == false then!@#&			same = false!@#&			for y = 1, #thisImg do!@#&				local thisImgY = thisImg[y]!@#&				for x = 1, width do if thisImgY[x] ~= \" \" then!@#&					if y < tyStart + 1 then tyStart = y - 1 end!@#&					if y > tyEnd then tyEnd = y end!@#&					if x < txStart + 1 then txStart = x - 1 end!@#&					if x > txEnd then txEnd = x end!@#&				end end!@#&				snooze()!@#&			end!@#&		else!@#&			same, txStart, txEnd, tyStart, tyEnd = false, 0, width, 0, #thisImg!@#&		end!@#&		!@#&		if same and i > 1 then!@#&			image[i - 1 - bump].delay = prevImg.delay + thisImg.delay!@#&			table.remove(image, i - bump)!@#&			bump = bump + 1!@#&			snooze()!@#&		else!@#&			if i - bump ~= #image and optimise ~= nil then!@#&				local obscured = true!@#&				for y = 1, #thisImg do!@#&					local thisImgY, nextImgY = thisImg[y], nextImg[y]!@#&					for x = 1, width do if thisImgY[x] ~= \" \" and nextImgY[x] == \" \" then!@#&						obscured = false!@#&						if y < tyStart + 1 then tyStart = y - 1 end!@#&						if y > tyEnd then tyEnd = y end!@#&						if x < txStart + 1 then txStart = x - 1 end!@#&						if x > txEnd then txEnd = x end!@#&					end end!@#&					snooze()!@#&				end!@#&				thisImg.disposal = obscured and 1 or 2!@#&			else thisImg.disposal = 1 end!@#&!@#&			if txStart > txEnd then txStart, txEnd, tyStart, tyEnd = 0, 1, 0, 1 end!@#&			!@#&			local nxStart, nxEnd, nyStart, nyEnd, cacheDisp = txStart, txEnd - txStart, tyStart, tyEnd - tyStart, cacheImg and cacheImg.disposal!@#&			newImg = {[\"delay\"] = thisImg.delay, [\"disposal\"] = thisImg.disposal, [\"xstart\"] = nxStart, [\"xend\"] = nxEnd, [\"ystart\"] = nyStart, [\"yend\"] = nyEnd}!@#&			!@#&			for y = 1, nyEnd do!@#&				local skip, chars, temp, thisImgY, cacheImgY = 0, {}, {}, thisImg[y + nyStart], cacheImg and cacheImg[y + nyStart]!@#&				for x = nxStart + 1, nxStart + nxEnd do!@#&					local thisVal = thisImgY[x]!@#&					if optimise ~= nil and cacheImg and thisVal == cacheImgY[x] and (cacheDisp == 1 or (cacheDisp == 2 and (x < cxStart + 1 or y + nyStart < cyStart + 1 or x > cxStart + cxEnd or y + nyStart > cyStart + cyEnd))) then thisVal = \" \" end!@#&					!@#&					if thisVal == \" \" then!@#&						skip = skip + 1!@#&						if #chars > 0 then!@#&							temp[#temp + 1] = (image.pal and image.pal[1][4]) and chars or table.concat(chars)!@#&							chars = {}!@#&						end!@#&					else!@#&						chars[#chars + 1] = (image.pal and image.pal[1][4]) and thisVal or colourNum[thisVal]!@#&						if skip > 0 then!@#&							temp[#temp + 1] = skip!@#&							skip = 0!@#&						end!@#&					end!@#&				end!@#&				if skip == 0 then temp[#temp + 1] = (image.pal and image.pal[1][4]) and chars or table.concat(chars) end!@#&				newImg[y] = temp!@#&				snooze()!@#&			end!@#&			thisImg.xstart, thisImg.xend, thisImg.ystart, thisImg.yend = txStart, txEnd, tyStart, tyEnd!@#&			cacheImg = thisImg!@#&			image[i - bump] = newImg!@#&		end!@#&	end!@#&	!@#&	return image!@#&end!@#&!@#&function resizeGIF(image, width, height)!@#&	if not width then width = math.floor(height / image.height * image.width) end!@#&	if not height then height = math.floor(width / image.width * image.height) end!@#&	local xInc, yInc, pal = image.width / width, image.height / height, image.pal or CCPal!@#&	image = rasteriseGIF(image)!@#&	!@#&	for i = 1, #image do!@#&		local oldFrame, yPos2 = image[i], 1!@#&		local newFrame = {[\"delay\"] = oldFrame.delay or 0.1}!@#&		for y = 1, height do!@#&			local thisLine, xPos2 = {}, 1!@#&			for x = 1, width do!@#&				local remY, R, G, B, totalWeight, yPos = yInc, 0, 0, 0, 0, yPos2!@#&				while remY > 0 do!@#&					local remX, maxInc, oldFrameY, xPos, yWeight = xInc, (math.floor(yPos) == yPos) and 1 or (math.ceil(yPos) - yPos), oldFrame[math.min(math.floor(yPos), image.height)], xPos2!@#&					if remY < maxInc then yWeight = remY remY = 0 else yWeight = maxInc remY = remY - maxInc end!@#&					while remX > 0 do!@#&						local maxInc, thisChar, xWeight = (math.floor(xPos) == xPos) and 1 or (math.ceil(xPos) - xPos), oldFrameY[math.min(math.floor(xPos), image.width)]!@#&						if remX < maxInc then xWeight = remX remX = 0 else xWeight = maxInc remX = remX - maxInc end!@#&!@#&						if thisChar ~= \" \" then!@#&							local thisWeight = xWeight * yWeight!@#&							totalWeight, thisChar = totalWeight + thisWeight, pal[thisChar]!@#&							R, G, B = R + thisChar[1] * thisWeight, G + thisChar[2] * thisWeight, B + thisChar[3] * thisWeight!@#&						end!@#&						!@#&						xPos = (maxInc < 1 and xWeight == maxInc) and math.ceil(xPos) or (xPos + xWeight)!@#&					end!@#&					yPos = (maxInc < 1 and yWeight == maxInc) and math.ceil(yPos) or (yPos + yWeight)!@#&				end!@#&				!@#&				if totalWeight > (xInc * yInc) / 2 then!@#&					local closest, difference = 0, 10000!@#&					R, G, B = R / totalWeight, G / totalWeight, B / totalWeight!@#&					for j = 0, #pal do!@#&						local thisDiff = math.abs(pal[j][1] - R) + math.abs(pal[j][2] - G) + math.abs(pal[j][3] - B)!@#&						if thisDiff < difference then!@#&							difference = thisDiff!@#&							closest = j!@#&							if difference == 0 then break end!@#&						end!@#&					end!@#&					thisLine[#thisLine + 1] = closest!@#&				else thisLine[#thisLine + 1] = \" \" end!@#&				xPos2 = xPos2 + xInc!@#&			end!@#&			yPos2 = yPos2 + yInc!@#&			newFrame[y] = thisLine!@#&			snooze()!@#&		end!@#&		image[i] = newFrame!@#&	end!@#&	!@#&	image.width, image.height = width, height!@#&	!@#&	return flattenGIF(image, false, true)!@#&end!@#&!@#&function loadGIF(targetfile, pal)!@#&	local results, fileread = {[\"backgroundCol\"] = 0}, fs.open(targetfile, \"rb\")!@#&	if not fileread then error(\"GIF.loadGIF(): Unable to open \" .. targetfile .. \" for input.\", 2) end!@#&	!@#&	if type(pal) == \"string\" then!@#&		local file = fs.open(pal, \"r\")!@#&		pal = textutils.unserialize(file.readAll())!@#&		file.close()!@#&		for i = 1, #pal do!@#&			local palI = pal[i]!@#&			if not palI[5] then palI[5] = 0 end!@#&		end!@#&		if not pal[0] then pal[0] = {1000, 1000, 1000, \"minecraft:air\", 0} end!@#&		results.pal = pal!@#&	elseif pal then!@#&		-- Construct a reduced palette from the GIF's own.!@#&		if not fileread.readAll then error(\"Installed version of CC does not support palette alterations.\") end!@#&!@#&		pal = {}!@#&		!@#&		fileread.read(10)!@#&		local temp, counter = fileread.read(), 0!@#&		fileread.read(2)!@#&!@#&		-- Read in global palette:!@#&		if bit.band(temp, 128) == 128 then for i = 1, 2 ^ (bit.band(temp, 7) + 1) do!@#&			local thisCol, found = fileread.read(3), false!@#&!@#&			for i = 1, counter do if pal[i] == thisCol then!@#&				found = true!@#&				break!@#&			end end!@#&!@#&			if not found then!@#&				counter = counter + 1!@#&				pal[counter] = thisCol!@#&			end!@#&		end end!@#&		!@#&		-- Read in any additional palettes:!@#&		while true do!@#&			local record = fileread.read()!@#&			!@#&			if record == 33 then!@#&				fileread.read()!@#&				!@#&				while true do!@#&					record = fileread.read()!@#&					if record == 0 then break end!@#&					fileread.read(record)!@#&					snooze()!@#&				end!@#&			elseif record == 44 then!@#&				fileread.read(8)!@#&				!@#&				record = fileread.read()!@#&!@#&				if bit.band(record, 128) == 128 then for i = 1, 2 ^ (bit.band(record, 7) + 1) do!@#&					local thisCol, found = fileread.read(3), false!@#&!@#&					for i = 1, counter do if pal[i] == thisCol then!@#&						found = true!@#&						break!@#&					end end!@#&!@#&					if not found then!@#&						counter = counter + 1!@#&						pal[counter] = thisCol!@#&					end!@#&				end end!@#&				!@#&				fileread.read()!@#&				!@#&				while true do!@#&					record = fileread.read()!@#&					if record == 0 then break end!@#&					fileread.read(record)!@#&					snooze()!@#&				end!@#&			elseif record == 59 then!@#&				fileread.close()!@#&				break!@#&			else!@#&				error(\"Malformed record\")!@#&			end!@#&		end!@#&!@#&		-- Condense palette:!@#&		for i = 1, counter do pal[i] = {pal[i]:byte(1, 3)} end!@#&		!@#&		while #pal > 16 do!@#&			local matches, tally, bestDiff, curLen = {}, tally, 1000, #pal!@#&			!@#&			for i = 1, curLen - 1 do!@#&				local palI, found = pal[i], false!@#&				!@#&				for j = i + 1, curLen do!@#&					local palJ = pal[j]!@#&					local thisDiff = math.abs(palJ[1] - palI[1]) + math.abs(palJ[2] - palI[2]) + math.abs(palJ[3] - palI[3])!@#&					!@#&					if thisDiff < bestDiff then!@#&						matches, tally, bestDiff, found = {[j] = i}, 1, thisDiff, true!@#&					elseif thisDiff == bestDiff and not matches[j] and not matches[i] and not found then!@#&						matches[j], tally, found = i, tally + 1, true!@#&					end!@#&				end!@#&			end!@#&			!@#&			local counter, max = 1, (curLen - tally > 15) and tally or (curLen - 16)!@#&			for i, j in pairs(matches) do!@#&				local palI, palJ = pal[i], pal[j]!@#&				--print(#pal,i,j,type(palI),type(palJ))!@#&				pal[i] = {math.floor((palI[1] + palJ[1]) / 2), math.floor((palI[2] + palJ[2]) / 2), math.floor((palI[3] + palJ[3]) / 2)}!@#&				pal[j], counter = \"remove\", counter + 1!@#&				if counter > max then break end!@#&			end!@#&			!@#&			for i = curLen, 1, -1 do if pal[i] == \"remove\" then table.remove(pal, i) end end!@#&		end!@#&		!@#&		pal[0] = pal[#pal]!@#&		pal[#pal] = nil!@#&		results.pal = pal!@#&		!@#&		fileread = fs.open(targetfile, \"rb\")!@#&	else pal = CCPal end!@#&	!@#&	local readByte = fileread.read!@#&	!@#&	local readBytes = fileread.readAll and!@#&		function(num)!@#&			local output = readByte(num)!@#&			return {output:byte(1, #output)}!@#&		end!@#&	or!@#&		function(num)!@#&			local output = {}!@#&			for i = 1, num do output[#output + 1] = readByte() end!@#&			return output!@#&		end!@#&	!@#&	local function readInt()!@#&		local results = readByte()!@#&		return results + readByte() * 256!@#&	end!@#&!@#&	-- GIF signature:!@#&	local temp = readBytes(6)!@#&	for i = 1, 6 do if temp[i] ~= GIF87a[i] and temp[i] ~= GIF89a[i] then!@#&		fileread.close()!@#&		error(\"GIF.loadGIF(): \" .. targetfile .. \" does not appear to be a GIF.\", 2)!@#&	end end!@#&!@#&	-- Screen discriptor:!@#&	local width = readInt()!@#&	local height = readInt()!@#&	results.width, results.height = width, height!@#&	!@#&	local cacheFrame, cacheBackup = {}!@#&	for y = 1, height do !@#&		local cacheFrameY = {}!@#&		for x = 1, width do cacheFrameY[x] = \" \" end!@#&		cacheFrame[y] = cacheFrameY!@#&	end!@#&		!@#&	temp = readByte()!@#&	local globalColourCount = 2 ^ (bit.band(temp, 7) + 1)!@#&	readInt()  -- This is the background colour, which we'll ignore, and instead pick something that contrasts the image later.!@#&	snooze()!@#&!@#&	-- Palette:!@#&	local globalPal = bit.band(temp, 128) == 128!@#&	if globalPal then!@#&		globalPal = {}!@#&		for i = 0, globalColourCount - 1 do globalPal[i] = readBytes(3) end!@#&	end!@#&	!@#&	-- Read image records:!@#&	while true do!@#&		local thisImg, interlace, thisPal, transparent = {}!@#&		!@#&		-- Read image headers:!@#&		while true do!@#&			snooze()!@#&			local record = readByte()!@#&!@#&			if record == 33 then!@#&				record = readByte()!@#&!@#&				-- Gif extensions:!@#&				if record == 249 then!@#&					-- Graphics control extension:!@#&					readByte()!@#&					local flags = readByte()!@#&					local isTransparent = bit.band(flags, 1) == 1!@#&					thisImg.inputExpected = bit.band(flags, 2) == 2!@#&					thisImg.disposal = bit.brshift(bit.band(flags, 28), 2)!@#&					thisImg.delay = readInt()!@#&					thisImg.delay = (thisImg.delay > 0) and (thisImg.delay / 100) or nil!@#&					transparent = readByte()!@#&					if not isTransparent then transparent = nil end!@#&					readByte()!@#&				elseif record == 254 then!@#&					-- File comment:!@#&					local fullComment = {}!@#&					!@#&					repeat!@#&						local length = readByte()!@#&						if length > 0 then fullComment[#fullComment + 1] = string.char(unpack(readBytes(length))) end!@#&					until length == 0!@#&							!@#&					results.comment = table.concat(fullComment)!@#&				elseif record == 1 then!@#&					-- Plain text extension:!@#&					readBytes(readByte())!@#&					!@#&					local fullText = {}!@#&					!@#&					repeat!@#&						local length = readByte()!@#&						if length > 0 then fullText[#fullText + 1] = string.char(unpack(readBytes(length))) end!@#&					until length == 0!@#&							!@#&					results.text = table.concat(fullText)!@#&				else!@#&					-- All other extensions we skip past:!@#&					repeat!@#&						local length = readByte()!@#&						if length > 0 then readBytes(length) end!@#&					until length == 0!@#&				end!@#&			elseif record == 44 then!@#&				-- Image descriptor:!@#&				thisImg.xstart = readInt()!@#&				thisImg.ystart = readInt()!@#&				thisImg.xend = readInt()!@#&				thisImg.yend = readInt()!@#&!@#&				record = readByte()!@#&				interlace = bit.band(record, 64) == 64!@#&!@#&				if bit.band(record, 128) == 128 then!@#&					-- Local colour map:!@#&					thisPal = {[0] = readBytes(3)}!@#&					for i = 2, 2 ^ (bit.band(record, 7) + 1) do thisPal[#thisPal + 1] = readBytes(3) end!@#&				else!@#&					-- Global colour map:!@#&					thisPal = textutils.unserialize(textutils.serialize(globalPal))!@#&				end!@#&				!@#&				local used = {}!@#&				for i = 0, #thisPal do!@#&					local closest, difference, thisPalI = 0, 10000, thisPal[i]!@#&!@#&					for j = 0, #pal do!@#&						local palJ = pal[j]!@#&						local thisDiff = math.abs(palJ[1] - thisPalI[1]) + math.abs(palJ[2] - thisPalI[2]) + math.abs(palJ[3] - thisPalI[3])!@#&!@#&						if thisDiff < difference then!@#&							difference = thisDiff!@#&							closest = j!@#&							if difference == 0 then break end!@#&						end!@#&					end!@#&!@#&					thisPal[i] = closest!@#&					if i ~= transparent then used[closest + 1] = true end!@#&				end!@#&				!@#&				local bgCol, bgCol2  = 2 ^ math.min(#used, 15), colourNum[math.min(#used, 15)]!@#&				if bgCol > results.backgroundCol then!@#&					results.backgroundCol = bgCol!@#&					results.backgroundCol2 = bgCol2!@#&				end!@#&				!@#&				-- Image data follows, go read it:!@#&				break!@#&			elseif record == 59 then!@#&				-- End of file.!@#&				fileread.close()!@#&				return flattenGIF(results, false, true)!@#&			end!@#&		end!@#&		!@#&		local xStart, yStart, xEnd, yEnd = thisImg.xstart, thisImg.ystart, thisImg.xend, thisImg.yend!@#&		!@#&		if thisImg.disposal == 3 then!@#&			cacheBackup = {}!@#&			for y = 1, math.min(height - yStart, yEnd) do!@#&				local cacheBackupY, cacheFrameY = {}, cacheFrame[y + yStart]!@#&				for x = 1, math.min(width - xStart, xEnd) do cacheBackupY[x]  = cacheFrameY[x + xStart] end!@#&				cacheBackup[y] = cacheBackupY!@#&			end!@#&		end!@#&		!@#&		-- Read image body:!@#&		!@#&		fileread = bbpack.open(fileread, \"rb\", 2 ^ fileread.read())!@#&		readByte = fileread.read!@#&!@#&		local y, passnum, stepsize = 1, 8, 8!@#&		while y < yEnd + 1 do!@#&			local cacheFrameY = cacheFrame[y + yStart]!@#&			if y <= height then!@#&				for x = 1, xEnd do!@#&					local thisVal = readByte()!@#&					if thisVal ~= transparent and x + xStart <= width then cacheFrameY[x + xStart] = thisPal[thisVal] end!@#&				end!@#&			else for x = 1, xEnd do readByte() end end!@#&			!@#&			if interlace then!@#&				y = y + stepsize!@#&!@#&				while y > yEnd and passnum > 1 do!@#&					stepsize = passnum!@#&					passnum = passnum / 2!@#&					y = passnum + 1!@#&				end!@#&			else y = y + 1 end!@#&			!@#&			snooze()!@#&		end!@#&		!@#&		for y = 1, height do!@#&			local thisImgY, cacheFrameY = {}, cacheFrame[y]!@#&			for x = 1, width do thisImgY[x] = cacheFrameY[x] end!@#&			thisImg[y] = thisImgY!@#&		end!@#&		if not thisImg.delay then thisImg.delay = 0.1 end!@#&		!@#&		if thisImg.disposal == 2 then!@#&			for y = 1, math.min(height - yStart, yEnd) do!@#&				local cacheFrameY = cacheFrame[y + yStart]!@#&				for x = 1, math.min(width - xStart, xEnd) do cacheFrameY[x + xStart] = \" \" end!@#&			end!@#&		elseif thisImg.disposal == 3 then!@#&			for y = 1, math.min(height - yStart, yEnd) do!@#&				local cacheFrameY, cacheBackupY = cacheFrame[y + yStart], cacheBackup[y]!@#&				for x = 1, math.min(width - xStart, xEnd) do cacheFrameY[x + xStart] = cacheBackupY[x] end!@#&			end!@#&			cacheBackup = nil!@#&		end!@#&		!@#&		fileread = fileread.extractHandle()!@#&		readByte = fileread.read!@#&		!@#&		results[#results + 1] = thisImg!@#&	end!@#&end!@#&!@#&function setBackgroundColour(image, colour)!@#&	if type(colour) ~= \"number\" and not colourNum[colour] then error(\"GIF.setBackgroundColour: Bad colour.\", 2) end!@#&	!@#&	if type(colour) == \"number\" then!@#&		local counter = 0!@#&		while colour > 1 do!@#&			colour = bit.brshift(colour, 1)!@#&			counter = counter + 1!@#&		end!@#&		image.backgroundCol = 2 ^ counter!@#&		image.backgroundCol2 = colourNum[counter]!@#&	else!@#&		image.backgroundCol = 2 ^ colourNum[colour]!@#&		image.backgroundCol2 = colour!@#&	end!@#&end!@#&setBackgroundColor = setBackgroundColour!@#&!@#&function toPaintutils(image)!@#&	if type(image[1][1]) == \"table\" then image = image[1] end!@#&	!@#&	local results = {}!@#&	!@#&	if not image.yend then error(\"wtf\",2) end!@#&	for y = 1, image.yend do!@#&		local resultsY, imageY = {}, image[y]!@#&		local x = image.xstart + 1!@#&		for i = 1, #imageY do!@#&			local imageYI = imageY[i]!@#&			if type(imageYI) == \"number\" then!@#&				for j = 1, imageYI do resultsY[#resultsY + 1] = 0 end!@#&			else!@#&				for j = 1, #imageYI do resultsY[#resultsY + 1] = 2 ^ colourNum[imageYI:sub(j, j)] end!@#&			end!@#&		end!@#&		results[y] = resultsY!@#&	end!@#&	!@#&	for i = #results[1] + 1, image.xstart + image.xend do results[1][i] = 0 end!@#&	!@#&	return results!@#&end!@#&!@#&function buildGIF(...)!@#&	local colourChar, hex, width, height, used = {[0] = \" \"}, \"0123456789abcdef\", 0, 0, 0!@#&	for i = 1, 16 do colourChar[2 ^ (i - 1)] = hex:sub(i, i) end!@#&	!@#&	for i = 1, #arg do!@#&		local argI = arg[i]!@#&		if #argI > height then height = #argI end!@#&		for y = 1, #argI do if #argI[y] > width then width = #argI[y] end end!@#&	end!@#&	!@#&	for i = 1, #arg do!@#&		local thisImage, argI = {[\"delay\"] = 0.1}, arg[i]!@#&		!@#&		for y = 1, #argI do!@#&			local thisLine, argIY = {}, argI[y]!@#&			!@#&			for x = 1, width do!@#&				local argIYX = argIY[x] or 0!@#&				if argIYX > used then used = argIYX end!@#&				thisLine[x] = colourNum[colourChar[argIYX]] or \" \"!@#&			end!@#&				!@#&			thisImage[y] = thisLine!@#&		end!@#&		!@#&		for y = #argI + 1, height do!@#&			local thisLine = {}!@#&			for x = 1, width do thisLine[x] = \" \" end!@#&			thisImage[y] = thisLine!@#&		end!@#&		!@#&		arg[i] = thisImage!@#&	end!@#&	!@#&	arg.width, arg.height, arg.backgroundCol, arg.backgroundCol2 = width, height, used, colourChar[used]!@#&	!@#&	return flattenGIF(arg, true, true)!@#&end!@#&!@#&function saveGIF(image, file)!@#&	if not (image.width or image.xstart) then!@#&		-- \"paintutils\" image.!@#&		image = buildGIF(image)!@#&	elseif not image.width then!@#&		-- Single frame of an image.!@#&		image = {width = image.xstart + image.xend, height = image.ystart + image.yend, image}!@#&	end!@#&	!@#&	local file, power, transCol = fs.open(file, \"wb\"), 5!@#&	if not file then error(\"Unable to open file for output.\", 2) end!@#&	local writeByte = file.write!@#&	!@#&	local function writeBytes(bytes)!@#&		for i = 1, #bytes do writeByte(bytes[i]) end!@#&	end!@#&	!@#&	local function writeInt(num)!@#&		writeByte(bit.band(num, 255))!@#&		writeByte(bit.brshift(num, 8))!@#&	end!@#&!@#&	-- GIF signature:!@#&	writeBytes(GIF89a)!@#&	!@#&	-- Screen discriptor:!@#&	writeInt(image.width)!@#&	writeInt(image.height)!@#&	!@#&	if image.pal then!@#&		local pal = image.pal!@#&		power = 1!@#&		while 2 ^ power < (#pal + 1) do power = power + 1 end!@#&		writeByte(127 + power)!@#&		transCol = 0!@#&		writeInt(transCol)!@#&!@#&		-- Palette:!@#&		for i = 0, #pal do!@#&			local palI = pal[i]!@#&			for j = 1, 3 do writeByte(palI[j]) end!@#&		end!@#&		for i = #pal + 2, 2 ^ power do writeBytes({127, 127, 127}) end!@#&	else!@#&		writeByte(132)!@#&		transCol = #CCPal + 1!@#&		writeInt(transCol)!@#&!@#&		-- Palette:!@#&		for i = 0, 15 do writeBytes(CCPal[i]) end!@#&		for i = 0, 15 do writeBytes({127, 127, 127}) end!@#&	end!@#&	!@#&	-- Loop extension:!@#&	if #image > 1 then!@#&		writeBytes({33, 255, 11})!@#&		for i = 1, 11 do writeByte(string.byte(\"NETSCAPE2.0\", i)) end!@#&		writeBytes({3, 1, 0, 0, 0})!@#&	end!@#&	!@#&	-- Write image records:!@#&	for i = 1, #image do!@#&		local image = image[i]!@#&		!@#&		writeBytes({33, 249, 4})!@#&		writeByte(image.disposal and (1 + bit.blshift(image.disposal, 2)) or 1)!@#&		writeInt((not image.delay) and 0 or math.floor(image.delay * 100))!@#&		writeInt(transCol)!@#&		!@#&		writeByte(44)!@#&		writeInt(image.xstart)!@#&		writeInt(image.ystart)!@#&		writeInt(image.xend)!@#&		writeInt(image.yend)!@#&		writeByte(0)!@#&		writeByte(power)!@#&!@#&		file = bbpack.open(file, \"wb\", 2 ^ power)!@#&		writeByte = file.write!@#&		!@#&		for y = 1, image.yend do!@#&			local rowLen, imageY = 0, image[y]!@#&			for i = 1, #imageY do!@#&				local imageYI = imageY[i]!@#&				if type(imageYI) == \"number\" then!@#&					for j = 1, imageYI do writeByte(transCol) end!@#&					rowLen = rowLen + imageYI!@#&				elseif type(imageYI) == \"string\" then!@#&					for j = 1, #imageYI do writeByte(colourNum[imageYI:sub(j, j)]) end!@#&					rowLen = rowLen + #imageYI!@#&				else!@#&					for j = 1, #imageYI do writeByte(imageYI[j]) end!@#&					rowLen = rowLen + #imageYI!@#&				end!@#&			end!@#&			for i = 1, image.xend - rowLen do writeByte(transCol) end!@#&			snooze()!@#&		end!@#&		!@#&		file = file.extractHandle()!@#&		writeByte = file.write!@#&	end!@#&	!@#&	writeByte(59)!@#&	file.close()!@#&end",["filemanager"]="os.loadAPI(\"SpeedAPI/windows\")!@#&os.loadAPI(\"SpeedAPI/image\")!@#&os.loadAPI(\"SpeedAPI/context\")!@#& !@#&local mode = \"open\"!@#&local workPath = \"\"!@#&local workPathHistory = {}!@#&local input = \"\"!@#& !@#&local xSize,ySize = term.getSize()!@#& !@#&local managerX = xSize-3!@#&local managerY = ySize-1!@#& !@#&local xStart = 2!@#&local yStart = 1!@#&local xEnd = xStart+managerX-1!@#&local yEnd = yStart+managerY-1!@#& !@#&local leftBarSize = 14!@#&local leftBarLimit = leftBarSize-3!@#& !@#&local sizeOfInputBar = 26!@#&local startOfInputBar = xStart+3!@#&local endOfInputBar = startOfInputBar+sizeOfInputBar-1!@#&local sizeOfSearchBar = managerX - sizeOfInputBar - 3 - 8 - 1!@#&local startOfSearchBar = xEnd-sizeOfSearchBar!@#& !@#&local xStartOfDrawingApps = xStart+leftBarSize+1!@#&local yStartOfDrawingApps = yStart+4!@#&local xSizeOfAppsArea = managerX-leftBarSize!@#&local ySizeOfAppsArea = managerY-3!@#&local xAppSize = 6!@#&local yAppSize = 6!@#&local xSpaceBetweenApps = 2!@#&local ySpaceBetweenApps = 1!@#&local countOfAppsByX = math.floor(xSizeOfAppsArea/(xAppSize+xSpaceBetweenApps))!@#&local countOfAppsByY = math.floor(ySizeOfAppsArea/(yAppSize+ySpaceBetweenApps))!@#&local countOfDesktops = 1!@#& !@#&local currentDesktop = 1!@#& !@#&local hideFileFormat = true!@#& !@#&--local main = window.create(term.native(),xStart,yStart,managerX+1,managerY+1)!@#& !@#&--------------------       --------------------!@#& !@#&local function clickedAtArea(x,y,sx,sy,ex,ey)!@#&    if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&    return false!@#&end!@#& !@#&local Favourites = {!@#&        [\"Root\"] = \"\",!@#&        [\"Applications\"] = \"/Applications\",!@#&        [\"Documents\"] = \"/Documents\",!@#&        [\"Images\"] = \"/Images\",!@#&        [\"rom\"] = \"/rom\",!@#&}!@#& !@#&local function saveConfig()!@#&        local path = \"System/Filemanager/Favourites.cfg\"!@#&        local f = fs.open(path,\"w\")!@#&        f.write(textutils.serialise(Favourites))!@#&        f.close()!@#&end!@#& !@#&local function loadConfig()!@#&        local path = \"System/Filemanager/Favourites.cfg\"!@#&        if fs.exists(path) then!@#&                local f = fs.open(path,\"r\")!@#&                local text = f.readAll()!@#&                Favourites = textutils.unserialise(text)!@#&                f.close()!@#&        end!@#&end!@#& !@#&local objects = {}!@#&local function newObj(class,name,key,value)!@#&        objects[class] = objects[class] or {}!@#&        objects[class][name] = objects[class][name] or {}!@#&        objects[class][name][key] = value!@#&end!@#& !@#&function drawSeparator(x1,y1,width,height,textColor,backColor,symbol)!@#&        local string = string.rep(symbol,width)!@#&        term.setBackgroundColor(backColor)!@#&        term.setTextColor(textColor)!@#&        for y=y1,(y1+height-1) do!@#&                windows.usualText(x1,y,string)!@#&        end!@#&end!@#& !@#&local function getFoldersList(workPath)!@#& !@#&end!@#& !@#&local function drawLeftBar()!@#&        objects[\"Favourites\"] = {}!@#& !@#&        windows.square(xStart,yStart+3,leftBarSize,yEnd-3,colors.white)!@#& !@#&        local y = yStart+4!@#&        local Peripherals = peripheral.getNames()!@#&        drawSeparator(xStart+leftBarSize-1,y-1,1,ySizeOfAppsArea,colors.lightGray,colors.white,\"|\")!@#& !@#&        local sFavourites = 0!@#&        for key,val in pairs(Favourites) do!@#&                sFavourites = sFavourites + 1!@#&        end!@#& !@#&        if sFavourites > 0 then!@#&                windows.colorText(xStart+1,y,\"Places\",colors.gray)!@#&                y = y + 1!@#& !@#&                for key,val in pairs(Favourites) do!@#&                        newObj(\"Favourites\",key,\"x1\",xStart)!@#&                        newObj(\"Favourites\",key,\"x2\",xStart+leftBarSize-1)!@#&                        newObj(\"Favourites\",key,\"y1\",y)!@#&                        newObj(\"Favourites\",key,\"path\",Favourites[key])!@#& !@#&                        if workPath == Favourites[key] then!@#&                                windows.square(xStart,y,leftBarSize-1,1,colors.blue)!@#&                                windows.colorText(xStart+2,y,windows.stringLimit(\"end\",key,leftBarLimit),colors.white)!@#&                        else!@#&                                windows.square(xStart,y,leftBarSize-1,1,colors.white)!@#&                                windows.colorText(xStart+2,y,windows.stringLimit(\"end\",key,leftBarLimit),colors.lightGray)!@#&                        end!@#& !@#&                        y = y + 1!@#&                end!@#& !@#&                y = y + 1!@#&        end!@#& !@#&        term.setBackgroundColor(colors.white)!@#&        if #Peripherals > 0 then!@#&                windows.colorText(xStart+1,y,\"Peripherals\",colors.gray)!@#&                y = y + 1!@#&                for i=1,#Peripherals do!@#&                        windows.colorText(xStart+2,y,windows.stringLimit(\"end\",Peripherals[i],leftBarLimit),colors.lightGray)!@#&                        y = y + 1!@#&                end!@#&        end!@#&end!@#& !@#&local function drawTopBar()!@#&        local posY = yStart + 1!@#&        windows.square(xStart,yStart,managerX,3,colors.lightGray)!@#&        windows.square(xStart+3,posY,sizeOfInputBar,1,colors.white)!@#&        windows.colorText(xStart+3,posY,windows.stringLimit(\"start\",input,sizeOfInputBar),colors.gray)!@#& !@#&        local text = mode!@#&        windows.colorTextWithBack(math.floor(xStart+managerX/2-#text/2-1),yStart,text,colors.white,colors.lightGray)!@#& !@#&        windows.square(startOfSearchBar,posY,sizeOfSearchBar,1,colors.white)!@#&        windows.colorText(startOfSearchBar,posY,\"Search\",colors.lightGray)!@#&        newObj(\"windowControls\",\"search\",\"x1\",startOfSearchBar);newObj(\"windowControls\",\"search\",\"x2\",startOfSearchBar+sizeOfSearchBar-1);newObj(\"windowControls\",\"search\",\"y\",posY)!@#&       !@#&        local colorCyka = nil!@#&        if #workPathHistory == 0 then colorCyka = colors.lightGray else colorCyka = colors.black end!@#&        windows.colorTextWithBack(xStart+1,posY,\"<\",colorCyka,colors.white)!@#& !@#&        local posX = startOfSearchBar - 7!@#&        windows.colorTextWithBack(posX,posY,\" \"..mode..\" \",colors.white,colors.lightBlue)!@#&        newObj(\"windowControls\",\"ok\",\"x1\",posX);newObj(\"windowControls\",\"ok\",\"x2\",posX+5);newObj(\"windowControls\",\"ok\",\"y\",posY)!@#&end!@#& !@#&local function drawWindow()!@#&        windows.square(xStart,yStart+3,managerX,ySizeOfAppsArea,colors.white)!@#&        drawTopBar()!@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+managerX) do!@#&                paintutils.drawPixel(x,yStart+managerY,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+managerY) do!@#&                paintutils.drawPixel(xStart+managerX,y,colors.gray)!@#&        end!@#&end!@#& !@#&------------------------------------------------------------------------------------------------------!@#& !@#&local function drawKonkretnoApp(x,y,name,backColor)!@#&        --                           !@#&        newObj(\"apps\",name,\"x1\",x)!@#&        newObj(\"apps\",name,\"x2\",x+xAppSize-1)!@#&        newObj(\"apps\",name,\"y1\",y)!@#&        newObj(\"apps\",name,\"y2\",y+yAppSize-1)!@#&        newObj(\"apps\",name,\"fileFormat\",windows.getFileFormat(name))!@#& !@#&        --                !@#&        windows.drawOSIcon(x,y,workPath,name,objects[\"apps\"][name][\"fileFormat\"])!@#& !@#&        --                          !@#&        term.setBackgroundColor(backColor)!@#&        if fs.isReadOnly(workPath..\"/\"..name) then!@#&                term.setTextColor(colors.red)!@#&        else!@#&                term.setTextColor(colors.black)!@#&        end!@#&        if windows.isFileHidden(name) then!@#&                term.setTextColor(colors.gray)!@#&        end!@#&        if hideFileFormat then!@#&                name = windows.hideFileFormat(name)!@#&        end!@#&        name = windows.stringLimit(\"end\",name,xAppSize,true)!@#&        windows.usualText(math.floor(x+xAppSize/2-#name/2),y+yAppSize-1,name)!@#&end!@#& !@#&local function drawApps(x,y,currentDesktop)!@#& !@#&        objects[\"apps\"] = {}!@#& !@#&        windows.square(x,y,xSizeOfAppsArea-2,ySizeOfAppsArea-2,colors.white)!@#& !@#&        local fileList = fs.list(workPath)!@#&        fileList = windows.reorganizeFilesAndFolders(workPath,fileList,true,true)!@#& !@#&        countOfDesktops = math.ceil(#fileList/(countOfAppsByY*countOfAppsByX))!@#&        local appCounter = 1 + currentDesktop * countOfAppsByY * countOfAppsByX - countOfAppsByY * countOfAppsByX!@#& !@#&        for j=1,countOfAppsByY do!@#&                for i=1,countOfAppsByX do!@#&                        if fileList[appCounter] then!@#&                                drawKonkretnoApp(x+i*(xAppSize+xSpaceBetweenApps)-(xAppSize+xSpaceBetweenApps),y+j*(yAppSize+ySpaceBetweenApps)-(yAppSize+ySpaceBetweenApps),fileList[appCounter],colors.white)!@#&                                appCounter = appCounter + 1!@#&                        else!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&------------------------------------------------------------------------------------------------------!@#& !@#&local function drawManager(x,y)!@#& !@#&        if x~=nil or y~=nil then!@#&                xStart = x!@#&                yStart = y!@#&                xStartOfDrawingApps = xStart+leftBarSize+1!@#&                yStartOfDrawingApps = yStart+4!@#&        end!@#& !@#&        currentDesktop = 1!@#&        --windows.emptyWindow(xStart,yStart,managerX,managerY,fs.getName(workPath))!@#&        drawWindow()!@#&        --windows.colorTextWithBack(xStart,yStart,\"x\",colors.black,colors.red);windows.colorTextWithBack(xStart+1,yStart,\"-\",colors.black,colors.orange);windows.colorTextWithBack(xStart+2,yStart,\"+\",colors.black,colors.lime)!@#&        drawLeftBar()!@#&        drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&        windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&end!@#& !@#&newObj(\"windowControls\",\"<\",\"x\",xStart+1);newObj(\"windowControls\",\"<\",\"y\",yStart+1)!@#& !@#&local function initializeProgram(mode1)!@#&        if mode1==\"open\" then mode = \"Open\" else mode = \"Save\" end!@#& !@#&        loadConfig()!@#&        saveConfig()!@#& !@#&        input = \"/\"..workPath!@#&        drawManager()!@#&       !@#&        local exit = false!@#&        while true do!@#& !@#&                local breakCycles = false!@#& !@#&                if exit then break end!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#& !@#&                        for key,val in pairs(objects[\"Favourites\"]) do!@#&                                if breakCycles then break end!@#& !@#&                                if clickedAtArea(x,y,objects[\"Favourites\"][key][\"x1\"],objects[\"Favourites\"][key][\"y1\"],objects[\"Favourites\"][key][\"x2\"],objects[\"Favourites\"][key][\"y1\"]) then!@#&                                       !@#&                                        if side == 1 then!@#&                                                if not fs.exists(objects[\"Favourites\"][key][\"path\"]) then fs.makeDir(key) end!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = objects[\"Favourites\"][key][\"path\"]!@#&                                                input = \"/\"..workPath!@#&                                                drawManager()!@#&                                        else!@#&                                                windows.square(xStart,objects[\"Favourites\"][key][\"y1\"],leftBarSize-1,1,colors.lightGray)!@#&                                                windows.colorText(xStart+2,objects[\"Favourites\"][key][\"y1\"],windows.stringLimit(\"end\",key,leftBarLimit),colors.white)!@#&                                                --sleep(0.2)!@#& !@#&                                                local action = context.menu(x,y,{\"Remove from sidebar\"})!@#&                                                if action == \"Remove from sidebar\" then!@#& !@#&                                                        Favourites[key] = nil!@#&                                                        saveConfig()!@#& !@#&                                                end!@#&                                                drawManager()!@#&                                        end!@#& !@#&                                        breakCycles = true!@#&                                        break!@#&                                end!@#&                        end!@#& !@#& !@#& !@#&                        for key,val in pairs(objects[\"apps\"]) do!@#&                                if breakCycles then break end!@#&                                if clickedAtArea(x,y,objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],objects[\"apps\"][key][\"x2\"],objects[\"apps\"][key][\"y2\"]) then!@#&                                       !@#&                                        if side == 1 then!@#&                                                if fs.isDir(workPath..\"/\"..key) and windows.getFileFormat(key) ~= \".app\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.blue)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.blue)!@#&                                                        sleep(0.2)!@#&                                                        workPathHistory[#workPathHistory+1] = workPath!@#&                                                        workPath = workPath..\"/\"..key!@#&                                                        input = \"/\"..workPath!@#&                                                        drawManager()!@#&                                                elseif not fs.isDir(workPath..\"/\"..key) and mode == \"Save\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.red)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.red)!@#&                                                        sleep(0.2)!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.white)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.white)!@#&                                                elseif not fs.isDir(workPath..\"/\"..key) and mode ~= \"Save\" or fs.isDir(workPath..\"/\"..key) and windows.getFileFormat(key) == \".app\" and mode ~= \"Save\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.blue)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.blue)!@#&                                                        sleep(0.2)!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.white)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.white)!@#&                                                        input = \"/\"..workPath..\"/\"..key!@#&                                                        drawTopBar()!@#&                                                end!@#&                                        else!@#&                                                if fs.isDir(workPath..\"/\"..key) then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.lightGray)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.lightGray)!@#&                                               !@#&                                                        local action = context.menu(x,y,{\"Add to sidebar\"})!@#&                                                        if action == \"Add to sidebar\" then!@#& !@#&                                                                Favourites[key] = workPath..\"/\"..key!@#&                                                                saveConfig()!@#& !@#&                                                        end!@#&                                                        drawManager()!@#&                                                end!@#&                                        end!@#& !@#&                                        breakCycles = true!@#&                                        break!@#&                                end    !@#&                        end!@#& !@#&                        if clickedAtArea(x,y,objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"],objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"]) then!@#&                                if #workPathHistory > 0 then!@#&                                        windows.colorTextWithBack(objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"],\"<\",colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        workPath = workPathHistory[#workPathHistory]!@#&                                        input = \"/\"..workPath!@#&                                        workPathHistory[#workPathHistory] = nil!@#&                                        drawManager()!@#&                                end!@#&                        elseif clickedAtArea(x,y,objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],objects[\"windowControls\"][\"ok\"][\"x2\"],objects[\"windowControls\"][\"ok\"][\"y\"]) then!@#&                                windows.colorTextWithBack(objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],\" \"..mode..\" \",colors.white,colors.blue)!@#&                                sleep(0.3)!@#&                                return string.sub(input,2,-1)!@#&                        elseif clickedAtArea(x,y,objects[\"windowControls\"][\"search\"][\"x1\"],objects[\"windowControls\"][\"search\"][\"y\"],objects[\"windowControls\"][\"search\"][\"x2\"],objects[\"windowControls\"][\"search\"][\"y\"]) then!@#&                                local searchResult = windows.search(xEnd-27,yStart,28,2,\"Search\")!@#&                                if searchResult ~= nil then!@#&                                        --windows.error(\"=\"..searchResult)!@#&                                        if fs.isDir(searchResult) then!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = searchResult!@#&                                                input = \"/\"..workPath!@#&                                        else!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = string.sub(searchResult,1,#searchResult-#fs.getName(searchResult)-1)!@#&                                                input = \"/\"..workPath..\"/\"..fs.getName(searchResult)!@#&                                        end!@#&                                end!@#&                                drawManager()!@#& !@#&                        elseif clickedAtArea(x,y,startOfInputBar,yStart+1,endOfInputBar,yStart+1) and mode ~= \"Open\" then!@#& !@#&                                local cursor = nil!@#& !@#&                                input = input..\"/\"!@#&                                drawTopBar()!@#& !@#&                                local accept = false!@#& !@#&                                while true do!@#& !@#&                                        cursor = startOfInputBar+#input!@#&                                        if cursor > startOfInputBar+sizeOfInputBar then cursor = startOfInputBar+sizeOfInputBar-1 end!@#&                                       !@#&                                        term.setCursorPos(cursor,yStart+1)!@#&                                        term.setTextColor(colors.black)!@#&                                        term.setCursorBlink(true)!@#& !@#&                                        local event1,side1,x1,y1 = os.pullEvent()!@#&                                        if event1 == \"char\" then!@#& !@#&                                                input = input..side1!@#&                                                drawTopBar()!@#&                                        elseif event1 == \"key\" then!@#&                                                if side1 == 28 then!@#&                                                        windows.colorTextWithBack(objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],\" \"..mode..\" \",colors.white,colors.blue)!@#&                                                        sleep(0.3)!@#&                                                        accept = true!@#&                                                        break!@#&                                                elseif side1 == 14 then!@#&                                                        if #input > 1 then!@#&                                                                input = string.sub(input,1,-2)!@#&                                                                drawTopBar()!@#&                                                        end!@#& !@#&                                                end!@#&                                        elseif event1 == \"mouse_click\" then!@#&                                                if clickedAtArea(x1,y1,objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],objects[\"windowControls\"][\"ok\"][\"x2\"],objects[\"windowControls\"][\"ok\"][\"y\"]) then!@#&                                                        accept = true!@#&                                                        drawTopBar()!@#&                                                else!@#&                                                        drawTopBar()!@#&                                                        break!@#&                                                end!@#&                                        end!@#& !@#&                                        term.setCursorBlink(false)!@#&                                end!@#& !@#&                                term.setCursorBlink(false)!@#& !@#&                                if accept then return string.sub(input,2,-1) end!@#& !@#&                        end!@#& !@#&                elseif event == \"mouse_scroll\" then!@#&                        if clickedAtArea(x,y,xStart+leftBarSize,yStart+1,xEnd-1,yEnd) then!@#&                                if side == 1 then!@#&                                        currentDesktop = currentDesktop + 1!@#&                                        if currentDesktop > countOfDesktops then!@#&                                                currentDesktop = countOfDesktops!@#&                                        else!@#&                                                drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&                                                windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&                                        end!@#&                                else!@#&                                        currentDesktop = currentDesktop - 1!@#&                                        if currentDesktop < 1 then!@#&                                                currentDesktop = 1!@#&                                        else!@#&                                                drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&                                                windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&                                        end!@#&                                end!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                return string.sub(input,2,-1)!@#&                        end!@#&                end!@#&        end!@#& !@#&end!@#& !@#&function open(cykaWorkPath)!@#&        if cykaWorkPath then workPath = cykaWorkPath end!@#& !@#&        for i=(1-managerY),1,2 do!@#&                drawManager(2,i)!@#&                sleep(0)!@#&        end!@#& !@#&        return initializeProgram(\"open\")!@#&end!@#& !@#&function save(cykaWorkPath)!@#&        if cykaWorkPath then workPath = cykaWorkPath end!@#& !@#&        for i=(1-managerY),1,2 do!@#&                drawManager(2,i)!@#&                sleep(0)!@#&        end!@#& !@#&        return initializeProgram(\"save\")!@#&end!@#& !@#&-------------------------------------!@#& !@#&--[[windows.clearScreen(colors.black)!@#& !@#&local path = open(\"\")!@#& !@#&term.setTextColor(colors.white)!@#&windows.clearScreen(colors.black)!@#&if path == \"\" then!@#&        windows.usualText(2,2,\"NIL!!\")!@#&else!@#&        windows.usualText(2,2,\"Path=\"..path)!@#&end]]",["alphanumeric"]="-- valid characters are:!@#&-- abcdefghijklmnopqrstuvwxyz1234567890!@#$%^&*()-=_+[]{};':\"\\|,./<>?`~!@#&function charToImg(char,c,x,y)!@#&  char = tostring(char)!@#&  local img = {}!@#&  if char == \"a\" or char == \"A\" then!@#&    img[1] = {0,c,c,c,0}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"b\" or char == \"B\" then!@#&    img[1] = {c,c,c,c,0}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,0}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,0}!@#&  elseif char == \"c\" or char == \"C\" then!@#&    img[1] = {0,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,0,0,0,0}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {0,c,c,c,c}!@#&  elseif char == \"d\" or char == \"D\" then!@#&    img[1] = {c,c,c,c,0}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,0}!@#&  elseif char == \"e\" or char == \"E\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,c,c,c,0}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"f\" or char == \"F\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,c,c,c,0}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \"g\" or char == \"G\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,0,0,c,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"h\" or char == \"H\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"i\" or char == \"I\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"j\" or char == \"J\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {c,0,c,0,0}!@#&    img[5] = {c,c,c,0,0}!@#&  elseif char == \"k\" or char == \"K\" then!@#&    img[1] = {c,0,0,c,0}!@#&    img[2] = {c,0,c,0,0}!@#&    img[3] = {c,c,c,0,0}!@#&    img[4] = {c,0,0,c,0}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"l\" or char == \"L\" then!@#&    img[1] = {c,0,0,0,0}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,0,0,0,0}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"m\" or char == \"M\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,c,0,c}!@#&    img[3] = {c,0,c,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"n\" or char == \"N\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"o\" or char == \"O\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"p\" or char == \"P\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \"q\" or char == \"Q\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,c,0,c}!@#&    img[4] = {c,0,0,c,0}!@#&    img[5] = {c,c,c,0,c}!@#&  elseif char == \"r\" or char == \"R\" then!@#&    img[1] = {c,c,c,c,0}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,0}!@#&    img[4] = {c,0,0,c,0}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"s\" or char == \"S\" then!@#&    img[1] = {0,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {0,c,c,c,0}!@#&    img[4] = {0,0,0,0,c}!@#&    img[5] = {c,c,c,c,0}!@#&  elseif char == \"t\" or char == \"T\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"u\" or char == \"U\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"v\" or char == \"V\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {0,c,0,c,0}!@#&    img[4] = {0,c,0,c,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"w\" or char == \"W\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,c,0,c}!@#&    img[4] = {c,0,c,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"x\" or char == \"X\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {0,c,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,c,0,c,0}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"y\" or char == \"Y\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {0,c,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"z\" or char == \"Z\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"1\" then!@#&    img[1] = {0,c,c,0,0}!@#&    img[2] = {c,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"2\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"3\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,0,0,c}!@#&    img[3] = {0,c,c,c,c}!@#&    img[4] = {0,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"4\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {0,0,0,0,c}!@#&    img[5] = {0,0,0,0,c}!@#&  elseif char == \"5\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {0,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"6\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,0}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"7\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \"8\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"9\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {0,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"0\" then!@#&    img[1] = {c,c,c,c,c}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {c,0,0,0,c}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"!\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"@\" then!@#&    img[1] = {c,c,c,c,0}!@#&    img[2] = {c,0,0,c,0}!@#&    img[3] = {c,0,c,c,0}!@#&    img[4] = {c,0,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"#\" then!@#&    img[1] = {0,c,0,c,0}!@#&    img[2] = {c,c,c,c,c}!@#&    img[3] = {0,c,0,c,0}!@#&    img[4] = {c,c,c,c,c}!@#&    img[5] = {0,c,0,c,0}!@#&  elseif char == \"$\" then!@#&    img[1] = {0,c,c,c,c}!@#&    img[2] = {c,0,c,0,0}!@#&    img[3] = {0,c,c,c,0}!@#&    img[4] = {0,0,c,0,c}!@#&    img[5] = {c,c,c,c,0}!@#&  elseif char == \"%\" then!@#&    img[1] = {c,0,0,0,c}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {c,0,0,0,c}!@#&  elseif char == \"^\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,c,0,c,0}!@#&    img[3] = {c,0,0,0,c}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"&\" then!@#&    img[1] = {0,c,0,0,0}!@#&    img[2] = {c,0,c,0,0}!@#&    img[3] = {0,c,c,0,c}!@#&    img[4] = {c,0,0,c,0}!@#&    img[5] = {0,c,c,0,c}!@#&  elseif char == \"*\" then!@#&    img[1] = {c,0,c,0,c}!@#&    img[2] = {0,c,c,c,0}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {0,c,c,c,0}!@#&    img[5] = {c,0,c,0,c}!@#&  elseif char == \"(\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {0,c,0,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \")\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,0,c,0}!@#&    img[4] = {0,0,0,c,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"-\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,0,0,0}!@#&    img[3] = {0,c,c,c,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"_\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,0,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {c,c,c,c,c}!@#&  elseif char == \"=\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {c,c,c,c,c}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {c,c,c,c,c}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"+\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {c,c,c,c,c}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"`\" then!@#&    img[1] = {c,0,0,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"~\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {c,0,c,0,c}!@#&    img[4] = {0,0,0,c,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"?\" then!@#&    img[1] = {0,c,c,c,0}!@#&    img[2] = {c,0,0,0,c}!@#&    img[3] = {0,0,c,c,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"/\" then!@#&    img[1] = {0,0,0,0,c}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \"<\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {c,0,0,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \">\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,0,0,c,0}!@#&    img[3] = {0,0,0,0,c}!@#&    img[4] = {0,0,0,c,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \",\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,0,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,c,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \".\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,0,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {c,0,0,0,0}!@#&  elseif char == \":\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \";\" then!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,c,0,0,0}!@#&  elseif char == \"'\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"\\\"\" then!@#&    img[1] = {0,0,c,0,c}!@#&    img[2] = {0,c,0,c,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  elseif char == \"{\" then!@#&    img[1] = {0,0,c,c,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,c,0,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,c,0}!@#&  elseif char == \"[\" then!@#&    img[1] = {0,0,c,c,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,c,0}!@#&  elseif char == \"}\" then!@#&    img[1] = {0,c,c,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,0,c,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,c,c,0,0}!@#&  elseif char == \"]\" then!@#&    img[1] = {0,c,c,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,c,c,0,0}!@#&  elseif char == \"|\" then!@#&    img[1] = {0,0,c,0,0}!@#&    img[2] = {0,0,c,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,c,0,0}!@#&    img[5] = {0,0,c,0,0}!@#&  elseif char == \"\\\\\" then!@#&    img[1] = {c,0,0,0,0}!@#&    img[2] = {0,c,0,0,0}!@#&    img[3] = {0,0,c,0,0}!@#&    img[4] = {0,0,0,c,0}!@#&    img[5] = {0,0,0,0,c}!@#&  else!@#&    img[1] = {0,0,0,0,0}!@#&    img[2] = {0,0,0,0,0}!@#&    img[3] = {0,0,0,0,0}!@#&    img[4] = {0,0,0,0,0}!@#&    img[5] = {0,0,0,0,0}!@#&  end!@#&  paintutils.drawImage(img,x,y)!@#&  term.setBackgroundColor(colors.black)!@#&end!@#&function stringToImg(_str,_color,_x,_y)!@#&  local maxX,maxY = term.getSize()!@#&  local iterator = 1!@#&  local _str = tostring(_str)!@#&  for i = 1, #_str do!@#&    local _char = _str:sub(i,i)!@#&    x = _x + ((iterator-1)*6)!@#&    if x+5 > maxX then!@#&      x = _x!@#&      _y = _y + 6!@#&      iterator = 1!@#&    end!@#&    charToImg(_char,_color,x,_y)!@#&    iterator = iterator + 1!@#&  end!@#&end!@#&!@#&local args={...}!@#&local command = args[1]!@#&if command==\"help\" then!@#&  term.clear()!@#&  term.setCursorPos(1,1)!@#&  print(\"This program is a simple api which allows programs to print large characters of text without having to resize the font size.\")!@#&  print(\"Functions:\\n  stringToImg(\\\"Text Here\\\",color,x,y)\\n  charToImg(\\\"c\\\",color,x,y)\")!@#&  print(\"Characters are 5x5. x and y point to the top left corner of where the characters should appear\")!@#&  print(\"Supported characters - a-z A-Z 0-9 !@#$%^&*()-=_+[]{};':\\\"\\\\|,./<>?~\")!@#&  print(\" \")!@#&  print(\"stringToImg(\\\"See It?\\\",colors.red,2,h-6) = \")!@#&  local w,h = term.getSize()!@#&  stringToImg(\"See It?\",colors.red,2,h-5)!@#&  print(\" \")!@#&end",["windows"]="---------------------------------------------------------------------------------------------------------------------------!@#& !@#&-- colorText(int _, int y_, string , int _)!@#&--      .     .!@#& !@#& !@#&-- usualText(int _, int y_, string )!@#&--      .!@#& !@#& !@#&-- square(int x_, int x_, int , int , int )!@#&--      (,   ).    .!@#& !@#& !@#&-- clearScreen(int )!@#&--     .!@#& !@#& !@#&-- fadeIn(int )!@#&-- fadeOut(int )!@#&--           .     0.!@#& !@#& !@#&-- tv(int )!@#&--      .     0.!@#& !@#& !@#&-- emptyWindow(int _, int y_, int , int , string )!@#&--        .!@#& !@#& !@#&-- sampleWindow(int _, int y_, int , int )!@#&--    ,   .!@#& !@#& !@#&-- drawProgressBar(int _, int y_, int , int , int __, int __, int __)!@#&--       .!@#& !@#& !@#&-- scrollBar(int _, int y_, int ___, int __, int _, int __, int __)!@#&--    .!@#&--    ,  ,    .!@#&--  ,       100,      50,!@#&--         .!@#& !@#&------------------------- -------------------------------------------------------------------------------------!@#& !@#&-- error(string _)!@#&--      .!@#& !@#& !@#&-- attention(table _, table _)!@#&--   \"!\"  - .!@#&--    -     ,     .!@#&--!@#&--  : attention({\"Hey!\",\"This is attention window!\"},{\"And this is information!\"})!@#& !@#& !@#&-- input(int x_, int y_, string _ , int _, table _1, table _2 ... table _N)!@#&--      .!@#&--   -    {string _, string ____}!@#&--      ,      .!@#&--!@#&--  x_  y_   \"auto\",   !@#&--            .!@#&--!@#&--  : myData = input(\"auto\",\"auto\",\"Login\",20,{\"Username\",\"\"},{\"Password\",\"\"})!@#&--      Username \"Igor\",    Password \"12345\",!@#&--      {\"Igor\",\"12345\"}!@#&--!@#&--  ,        ctrl+v!@#& !@#& !@#&-- select(table , table , table 1, table 2 ... table N)!@#&--        .!@#&--!@#&--     : {string 1, string 2 ... string N}!@#&--   : {string _, int _, int __}!@#&--!@#&--         .!@#&--!@#&--  : pressedButton = windows.select({\"Hello!\"},{\"Do you want to load OS\",\"when computer starts?\"},{\"No\",colors.lightGray,colors.black},{\"Yes\",colors.lightBlue,colors.black})!@#& !@#& !@#&-- aboutFile(int _, int y_, int _, string __)!@#&--        .!@#&--   .!@#& !@#& !@#&-- progressBar(int _, int y_, int _, string , string , int )!@#&--         ,   .!@#& !@#& !@#&-- search(int _, int y_, int _, int ___, string __)!@#&--        .!@#&--     .!@#&--          .!@#&--     .!@#&--        ,      .!@#& !@#&-------------------------  -------------------------------------------------------------------------------------!@#& !@#&-- getFileFormat(string __)!@#&--       .zip, .app  .   ,  nil.!@#& !@#&-- hideFileFormat(string __)!@#&--    ,        .   ,    .!@#& !@#&-- isFileHidden(string __)!@#&--        \".\",    true.  ,  false.!@#& !@#&-- getFileSize(string __)!@#&--         .        .!@#& !@#&-- getFileType(string __)!@#&--    . ,    .zip,    - Application.!@#& !@#&-- stringLimit(string , string , int _)!@#&--      .  :!@#&--!@#&-- local s = \"HelloWorldBitches!\"!@#&-- print(stringLimit(\"start\", s, 10))!@#&-- print(stringLimit(\"end\", s, 10))!@#&--!@#&--    :!@#&-- ...itches!!@#&-- HelloWo...!@#& !@#&-----------------------------------------------------------------------------------------------------------------------------------!@#& !@#& !@#&local xSize,ySize = term.getSize()!@#&local centerX,centerY = math.floor(xSize/2),math.floor(ySize/2)!@#& !@#&-- !@#&function findPeripheral(whatToFind)!@#&  local PeriList = rs.getSides()!@#&  for i=1,#PeriList do!@#&    if peripheral.getType(PeriList[i]) == whatToFind then!@#&      return PeriList[i]!@#&    end!@#&  end!@#&end!@#& !@#&--  !@#&function findWirelessModem()!@#&        local periList = rs.getSides() --peripheral.getNames()!@#&        for i=1,#periList do!@#&                if peripheral.getType(periList[i]) == \"modem\" then!@#&                        local govno = peripheral.wrap(periList[i])!@#&                        --if govno.isWireless() then!@#&                        return periList[i]!@#&                        --end!@#&                end!@#&        end!@#&end!@#& !@#&--   !@#&function clickedAtArea(x,y,sx,sy,ex,ey)!@#&    if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&    return false!@#&end!@#& !@#&-- ,  !@#&function toboolean(s)!@#&        if s == \"true\" then!@#&                return true!@#&        else!@#&                return false!@#&        end!@#&end!@#& !@#&-- !@#&function colorText(x,y,text,textColor)!@#&        term.setTextColor(textColor)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--   !@#&function colorTextWithBack(x,y,text,textColor,backColor)!@#&        term.setTextColor(textColor)!@#&        term.setBackgroundColor(backColor)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--    !@#&function usualText(x,y,text)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--       !@#&function centerText(how,coord,text,textColor,backColor)!@#&        term.setTextColor(textColor)!@#&        term.setBackgroundColor(backColor)!@#&        if how == \"xy\" then!@#&                term.setCursorPos(math.floor(xSize/2-#text/2),math.floor(ySize/2))!@#&        elseif how == \"x\" then!@#&                term.setCursorPos(math.floor(xSize/2-#text/2),coord)!@#&        elseif how == \"y\" then!@#&                term.setCursorPos(coord,math.floor(ySize/2))!@#&        end!@#&        term.write(text)!@#&end!@#& !@#&--   !@#&function square(x1,y1,width,height,color)!@#&        local string = string.rep(\" \",width)!@#&        term.setBackgroundColor(color)!@#&        for y=y1,(y1+height-1) do!@#&                usualText(x1,y,string)!@#&        end!@#&end!@#& !@#&-- !@#&function circle(cx, cy, radius, char, backColor, textColor)!@#&        local x = radius!@#&    local y = 0!@#&    local radiusError = 1 - x!@#&    term.setTextColor(textColor)!@#&    term.setBackgroundColor(backColor)!@#&    while (x >= y) do!@#&        usualText(x + cx, y + cy, char)!@#&        usualText(y + cx, x + cy, char)!@#&        usualText(-x + cx, y + cy, char)!@#&        usualText(-y + cx, x + cy, char)!@#&        usualText(-x + cx, -y + cy, char)!@#&        usualText(-y + cx, -x + cy, char)!@#&        usualText(x + cx, -y + cy, char)!@#&        usualText(y + cx, -x + cy, char)!@#&        y = y + 1!@#&        if (radiusError < 0) then!@#&            radiusError = radiusError + (2 * y + 1)!@#&        else!@#&            x = x - 1!@#&            radiusError = radiusError + (2 * (y - x + 1))!@#&        end!@#&    end!@#&end!@#& !@#&--  !@#&function clearScreen(color)!@#&        term.setBackgroundColor(color)!@#&        term.clear()!@#&end!@#& !@#&--  !@#&function fadeIn(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.white)!@#&        sleep(time)!@#&end!@#& !@#&--  !@#&function fadeOut(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.black)!@#&        sleep(time)!@#&        term.setCursorPos(1,1)!@#&        term.setTextColor(colors.white)!@#&end!@#& !@#&--    !@#&function emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#&        --DRAW WINDOW!@#&        square(xStart,yStart,xWindowSize,1,colors.lightGray)!@#&        colorText(math.floor(xStart+xWindowSize/2-#title/2),yStart,title,colors.white)!@#& !@#&        square(xStart,yStart+1,xWindowSize,yWindowSize-1,colors.white)!@#&       !@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+xWindowSize) do!@#&                paintutils.drawPixel(x,yStart+yWindowSize,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+yWindowSize) do!@#&                paintutils.drawPixel(xStart+xWindowSize,y,colors.gray)!@#&        end!@#&end!@#& !@#&--   !@#&function sampleWindow(xStart,yStart,xWindowSize,yWindowSize)!@#&        square(xStart,yStart,xWindowSize,yWindowSize,colors.white)!@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+xWindowSize) do!@#&                paintutils.drawPixel(x,yStart+yWindowSize,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+yWindowSize) do!@#&                paintutils.drawPixel(xStart+xWindowSize,y,colors.gray)!@#&        end!@#&end!@#& !@#&--  !@#&function stringLimit(mode,text,size,noDots)!@#&        if string.len(text)<=size then return text end!@#&        if mode == \"start\" then!@#&                if noDots then!@#&                        return string.sub(text,#text-size+1,-1)!@#&                else!@#&                        return \"...\"..string.sub(text,#text-size+4,-1)!@#&                end!@#&        else!@#&                if noDots then!@#&                        return string.sub(text,1,size)!@#&                else!@#&                        return string.sub(text,1,size-3)..\"...\"!@#&                end!@#&        end!@#&end!@#& !@#&--  !@#&function getFileFormat(path)!@#&        local name = fs.getName(path)!@#&        local starting,ending = string.find(name,\"(.)%.[%d%w]*$\")!@#&        if starting == nil then!@#&                return nil!@#&        else!@#&                return string.sub(name,starting+1,-1)!@#&        end!@#&end!@#& !@#&--,   !@#&function isFileHidden(path)!@#&        local name = fs.getName(path)!@#&        local starting,ending = string.find(name,\"^%.(.*)$\")!@#&        if starting == nil then!@#&                return false!@#&        else!@#&                return true!@#&        end!@#&end!@#& !@#&--  !@#&function hideFileFormat(path)!@#&        local name = fs.getName(path)!@#&        local fileFormat = getFileFormat(name)!@#&        if fileFormat == nil then!@#&                return name!@#&        else!@#&                return string.sub(name,1,#name-#fileFormat)!@#&        end!@#&end!@#& !@#&--    !@#&function getFileSize(path)!@#&        local allFilesSize = 0!@#&        if fs.isDir(path) then!@#&                local fileList = fs.list(path)!@#&                for i=1,#fileList do!@#&                        allFilesSize = allFilesSize + getFileSize(path..\"/\"..fileList[i])!@#&                end!@#&        else!@#&                allFilesSize = allFilesSize + fs.getSize(path)!@#&        end!@#&        return allFilesSize!@#&end!@#& !@#&--  !@#&function getFileType(path)!@#&        local fileTypes = {!@#&                [\".png\"] = \"Image\",!@#&                [\".cfg\"] = \"Config\",!@#&                [\".zip\"] = \"Archive\",!@#&                [\".app\"] = \"Application\",!@#&        }!@#& !@#&        local currentFileType = nil!@#& !@#&        local fileFormat = getFileFormat(path)!@#&        if fileFormat == nil then!@#&                if fs.isDir(path) then!@#&                        currentFileType = \"Folder\"!@#&                else!@#&                        currentFileType = \"Lua script\"!@#&                end!@#&        else!@#&                currentFileType = fileTypes[fileFormat] or fileFormat!@#&        end!@#&       !@#&        return currentFileType!@#&end!@#& !@#&--   -!@#&function reorganizeFilesAndFolders(workPath,massivSudaPihay,showHiddenFiles,showSystemFolders)!@#&        local reorganizedMassiv = {}!@#&        local function doGovno(i)!@#&                if showHiddenFiles then!@#&                        reorganizedMassiv[#reorganizedMassiv+1] = massivSudaPihay[i]!@#&                else!@#&                        if not windows.isFileHidden(workPath..\"/\"..massivSudaPihay[i]) then!@#&                                reorganizedMassiv[#reorganizedMassiv+1] = massivSudaPihay[i]!@#&                        end!@#&                end!@#&        end!@#&        local filePath = nil!@#&        for i=1,#massivSudaPihay do!@#&                filePath = workPath..\"/\"..massivSudaPihay[i]!@#&                if fs.isDir(filePath) and windows.getFileFormat(filePath) ~= \".app\" then!@#&                        if showSystemFolders then!@#&                                doGovno(i)!@#&                        else!@#&                                if massivSudaPihay[i] ~= \"rom\" and massivSudaPihay[i] ~= \"System\" then!@#&                                        --windows.attention({\"massiv[i] = \"..massivSudaPihay[i]},{\"heh\"})!@#&                                        doGovno(i)!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        for i=1,#massivSudaPihay do!@#&                filePath = workPath..\"/\"..massivSudaPihay[i]!@#&                if not fs.isDir(filePath) and massivSudaPihay[i] ~= \"OS\" or fs.isDir(filePath) and windows.getFileFormat(filePath) == \".app\" then!@#&                        doGovno(i)!@#&                end!@#&        end!@#&        return reorganizedMassiv!@#&end!@#& !@#&--   !@#&function drawOSIcon(xIconPos,yIconPos,workPath,name,fileFormat)!@#&        --   !@#&        if not fs.isDir(workPath..\"/\"..name) then!@#&                if fileFormat == \".png\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/image.png\")!@#&		elseif fileFormat == \".nfp\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/nfp.png\")!@#&		elseif fileFormat == \".skch\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/nfp.png\")!@#&		elseif fileFormat == \".gif\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/gif.png\")!@#&                elseif fileFormat == \".cfg\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/config.png\")!@#&                elseif fileFormat == \".zip\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/zip.png\")!@#&                else!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/default.png\")!@#&                end!@#&        --  !@#&        else!@#&                local iconPath = workPath..\"/\"..name..\"/Resources/icon.png\"!@#&                if fileFormat == \".app\" and fs.exists(iconPath) then!@#&                        image.draw(xIconPos,yIconPos,iconPath)!@#&                elseif string.sub(name,1,4)==\"disk\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/disk.png\")!@#&                else!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/folder.png\")!@#&                end!@#&        end!@#&end!@#& !@#&--  !@#&local function correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#&        if xStart == \"auto\" then!@#&                xStart = math.floor(xSize/2 - xWindowSize/2)!@#&        end!@#&        if yStart == \"auto\" then!@#&                yStart = math.floor(ySize/2 - yWindowSize/2)!@#&        end!@#&        return xStart,yStart!@#&end!@#& !@#&-- !@#&function button(x,y,xOffset,yOffset,text,textColor,backColor)!@#&        local width = xOffset*2+#text!@#&        local height = yOffset*2+1!@#&        x,y = correctStartCoords(x,y,width,height)!@#&        square(x,y,width,height,backColor)!@#&        colorText(x+xOffset,y+yOffset,text,textColor)!@#&        return x,y,x+width-1,y+height-1!@#&end!@#& !@#&--  !@#&local function drawProgressBar(xStart,yStart,width,height,frontColor,backColor,percent)!@#&        local doneSize = math.ceil(percent/100*width)!@#& !@#&        square(xStart,yStart,width,height,backColor)!@#&        square(xStart,yStart,doneSize,height,frontColor)!@#&end!@#& !@#&--  !@#&function scrollBar(xStart,yStart,height,countOfAllElements,currentElement,backColor,frontColor)!@#&        local percent = 1/countOfAllElements!@#&        local sizeOfScrollBar = math.ceil(percent * height)!@#&        local displayBarFrom = math.floor(yStart + height*((currentElement-1)/countOfAllElements))!@#& !@#&        for i=yStart,(yStart+height-1) do!@#&                paintutils.drawPixel(xStart,i,backColor)!@#&        end!@#& !@#&        for i=displayBarFrom,(displayBarFrom+sizeOfScrollBar-1) do!@#&                paintutils.drawPixel(xStart,i,frontColor)!@#&        end!@#&end!@#& !@#&-- -   !@#&local function searchInAllFiles(path,whatToFind)!@#& !@#&        local function poiskSovpadeniya(name)!@#&                local starting,ending = string.find(string.lower(name),string.lower(whatToFind))!@#&                if starting == nil then!@#&                        return false!@#&                else!@#&                        return true!@#&                end!@#&        end!@#& !@#&        local searchMassiv = {}!@#& !@#&        local function createFileMassiv(path,whatToFind)!@#&                local fileList = fs.list(path)!@#&                for i=1,#fileList do!@#&                        if fs.isDir(path..\"/\"..fileList[i]) then!@#&                                if poiskSovpadeniya(fileList[i]) then!@#&                                        searchMassiv[#searchMassiv+1] = {[\"path\"]=path,[\"name\"]=fileList[i],[\"isDir\"]=true,[\"fileSize\"]=getFileSize(path..\"/\"..fileList[i]),[\"fileType\"]=getFileType(path..\"/\"..fileList[i]),[\"fileFormat\"]=getFileFormat(path..\"/\"..fileList[i])}!@#&                                end!@#&                                createFileMassiv(path..\"/\"..fileList[i],whatToFind)!@#&                        else!@#&                                if poiskSovpadeniya(fileList[i]) then!@#&                                        searchMassiv[#searchMassiv+1] = {[\"path\"]=path,[\"name\"]=fileList[i],[\"isDir\"]=false,[\"fileSize\"]=getFileSize(path..\"/\"..fileList[i]),[\"fileType\"]=getFileType(path..\"/\"..fileList[i]),[\"fileFormat\"]=getFileFormat(path..\"/\"..fileList[i])}!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        createFileMassiv(path,whatToFind)!@#&        return searchMassiv!@#& !@#&end!@#& !@#&--       &6, &c, &a  ..!@#&local colorCodes = {!@#&        {[\"code\"] = \"&0\", [\"color\"] = 1},!@#&        {[\"code\"] = \"&1\", [\"color\"] = 2},!@#&        {[\"code\"] = \"&2\", [\"color\"] = 4},!@#&        {[\"code\"] = \"&3\", [\"color\"] = 8},!@#&        {[\"code\"] = \"&4\", [\"color\"] = 16},!@#&        {[\"code\"] = \"&5\", [\"color\"] = 32},!@#&        {[\"code\"] = \"&6\", [\"color\"] = 64},!@#&        {[\"code\"] = \"&7\", [\"color\"] = 128},!@#&        {[\"code\"] = \"&8\", [\"color\"] = 256},!@#&        {[\"code\"] = \"&9\", [\"color\"] = 512},!@#&        {[\"code\"] = \"&a\", [\"color\"] = 1024},!@#&        {[\"code\"] = \"&b\", [\"color\"] = 2048},!@#&        {[\"code\"] = \"&c\", [\"color\"] = 4096},!@#&        {[\"code\"] = \"&d\", [\"color\"] = 8192},!@#&        {[\"code\"] = \"&e\", [\"color\"] = 16384},!@#&        {[\"code\"] = \"&f\", [\"color\"] = 32768},!@#&}!@#& !@#&function foramattedText(text)!@#&        local color = colors.white!@#&        term.setTextColor(color)!@#&        local sText = #text!@#&        local searchFrom = 1!@#& !@#&        local exit = false!@#&        while true do!@#&                if exit then break end!@#&                local founded = false!@#&                local s,e = string.find(text,\"&\",searchFrom)!@#&                if s then!@#&                        local code = string.sub(text,s,s+1)!@#&                        for i=1,16 do!@#&                                if code == colorCodes[i][\"code\"] then!@#& !@#&                                        local cyka = string.sub(text,searchFrom,s-1)!@#&                                        term.write(cyka)!@#& !@#&                                        color = colorCodes[i][\"color\"]!@#&                                        term.setTextColor(color)!@#& !@#&                                        founded = true!@#&                                        searchFrom = searchFrom + #cyka + 2!@#&                                        break!@#&                                end!@#&                        end!@#&                end!@#&               !@#&                if not founded then!@#&                        term.write(string.sub(text,searchFrom,-1))!@#&                        exit = true!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function error(text1)!@#&       !@#&        local title = \"Error\"!@#&        local limit = xSize - 16 - 11!@#&        local sizeOfText1 = #text1!@#& !@#&        local parsedErr = {}!@#&        for i=1,(math.ceil(sizeOfText1/limit)) do!@#&                parsedErr[#parsedErr+1] = string.sub(text1,i*limit+1-limit,i*limit)!@#&        end!@#& !@#&        local theLongestElement = #title!@#&        for i=1,#parsedErr do!@#&                local size = #parsedErr[i]!@#&                if size > theLongestElement then theLongestElement = size end!@#&        end!@#&       !@#&        local xWindowSize = 9 + theLongestElement + 2!@#&        local yWindowSize = 2 + 1 + 1 + #parsedErr + 3!@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --DRAW ICON!@#&        paintutils.drawPixel(xStart+4,yStart+2,colors.red)!@#&        paintutils.drawPixel(xStart+3,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+4,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+5,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+2,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+3,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+4,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+5,yStart+4,colors.red)!@#&       !@#&        paintutils.drawPixel(xStart+6,yStart+4,colors.red)!@#&        colorText(xStart+4,yStart+3,\"!\",colors.white)!@#&       !@#&        --ERROR TEXT!@#&        term.setBackgroundColor(colors.white)!@#& !@#&        colorText(xStart+9,yStart+2,title,colors.gray)!@#& !@#&        for i=1,#parsedErr do!@#&                colorText(xStart+9,yStart+3+i,parsedErr[i],colors.lightGray)!@#&        end!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&        drawButton(colors.lightBlue,colors.black)!@#&       !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function attention(text1,text2)!@#& !@#&        local sizeOfText1 = #text1!@#&        local sizeOfText2 = #text2!@#& !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #text1[i] > theLongestElement then theLongestElement = #text1[i] end!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if #text2[i] > theLongestElement then theLongestElement = #text2[i] end!@#&        end!@#& !@#&        local xWindowSize = 9 + theLongestElement + 2!@#&        local yWindowSize = 2 + sizeOfText1 + 1 + sizeOfText2 + 3!@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --DRAW ICON!@#&        paintutils.drawPixel(xStart+4,yStart+2,colors.yellow)!@#&        paintutils.drawPixel(xStart+3,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+4,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+5,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+2,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+3,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+4,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+5,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+6,yStart+4,colors.yellow)!@#&        colorText(xStart+4,yStart+3,\"!\",colors.white)!@#&       !@#&        --ERROR TEXT!@#&        term.setBackgroundColor(colors.white)!@#&        for i=1,sizeOfText1 do!@#&                colorText(xStart+9,yStart+1+i,text1[i],colors.gray)!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                colorText(xStart+9,yStart+3+i,text2[i],colors.lightGray)!@#&        end!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&        drawButton(colors.lightBlue,colors.black)!@#&       !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function input(...)!@#&       !@#&        local xStart = arg[1]!@#&        local yStart = arg[2]!@#&        local title = arg[3]!@#&        local sizeOfInputRow = arg[4]!@#& !@#&        local sizeOfText1 = #arg-4!@#& !@#&        local Inputs = {}!@#& !@#&        local allowToPressOk = true!@#& !@#&        local inputCounter = 1!@#& !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #arg[i+4][1] > theLongestElement then theLongestElement = #arg[i+4][1] end!@#&        end!@#& !@#&        local xWindowSize = 2 + theLongestElement + 1 + sizeOfInputRow + 2!@#&        local yWindowSize = 2 + sizeOfText1 * 2 + 1 + 1!@#& !@#&        xStart, yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        --    , !@#&        for i=1,sizeOfText1 do!@#&                Inputs[i]=arg[i+4][2]!@#&        end!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&       !@#&        local function drawInputs()!@#&                for i=1,sizeOfText1 do!@#&                        local xPosOfInput = xStart+xWindowSize - 2 - sizeOfInputRow!@#&                        local yPosOfInput = yStart+i*2!@#& !@#&                        local inputArgument = arg[i+4]!@#& !@#&                        term.setBackgroundColor(colors.white)!@#&                        if inputCounter == i then!@#&                                colorText(xStart+2,yPosOfInput,inputArgument[1],colors.gray)!@#&                        else!@#&                                colorText(xStart+2,yPosOfInput,inputArgument[1],colors.lightGray)!@#&                        end!@#& !@#&                        square(xPosOfInput,yPosOfInput,sizeOfInputRow,1,colors.lightGray)!@#&                        newObj(\"inputs\",i,xPosOfInput,yPosOfInput,sizeOfInputRow,1)!@#& !@#&                        if Inputs[i] ~= nil then!@#&                                if inputArgument[3] == nil then!@#&                                        colorText(xPosOfInput,yPosOfInput,stringLimit(\"start\",Inputs[i],sizeOfInputRow),colors.black)!@#&                                else!@#&                                        colorText(xPosOfInput,yPosOfInput,stringLimit(\"start\",string.rep(\"*\",#Inputs[i]),sizeOfInputRow),colors.black)!@#&                                end!@#&                        end!@#&                       !@#&                        if inputCounter > sizeOfText1 then allowToPressOk = true end!@#&                end!@#& !@#&                if allowToPressOk then!@#&                        drawButton(colors.lightBlue,colors.black)!@#&                else!@#&                        drawButton(colors.lightGray,colors.black)!@#&                end!@#&        end!@#& !@#&        drawInputs()!@#&       !@#&        local currentInput = \"\"!@#& !@#&        while true do!@#&                if Inputs[inputCounter] ~= nil then currentInput = Inputs[inputCounter] end!@#& !@#&                term.setCursorBlink(false)!@#&                drawInputs(inputCounter)!@#&                term.setCursorBlink(true)!@#& !@#&                if #currentInput < sizeOfInputRow and inputCounter <= sizeOfText1 then!@#&                        term.setCursorPos(xStart+xWindowSize-2-sizeOfInputRow+#currentInput,yStart+inputCounter*2)!@#&                elseif #currentInput >= sizeOfInputRow and inputCounter <= sizeOfText1 then!@#&                        term.setCursorPos(xStart+xWindowSize-3,yStart+inputCounter*2)!@#&                else!@#&                        term.setCursorBlink(false)!@#&                end!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"key\" then!@#&                        --!@#&                        if side == 28 then!@#&                                if currentInput ~= \"\" then!@#&                                        currentInput = \"\"!@#&                                else!@#&                                        Inputs[inputCounter] = currentInput    !@#&                                end!@#& !@#&                                if inputCounter < sizeOfText1 then!@#&                                        inputCounter = inputCounter + 1!@#&                                else!@#&                                        term.setCursorBlink(false)!@#&                                        drawButton(colors.blue,colors.white)!@#&                                        sleep(0.2)!@#&                                        return Inputs!@#&                                end!@#&                        --!@#&                        elseif side == 14 then!@#&                                currentInput = string.sub(currentInput,1,-2)!@#&                                Inputs[inputCounter] = currentInput!@#&                        -- -!@#&                        elseif side == 200 then!@#&                                inputCounter = inputCounter - 1!@#&                                if inputCounter < 1 then inputCounter = 1 end!@#&                        elseif side == 208 then!@#&                                inputCounter = inputCounter + 1!@#&                                if inputCounter > #Inputs then inputCounter = #Inputs end!@#&                        end!@#&                elseif event == \"mouse_click\" then!@#&                        term.setCursorBlink(false)!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 and allowToPressOk == true then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                return Inputs!@#&                        end!@#&                        for key,val in pairs(Objects[\"inputs\"]) do!@#&                                if x>=Objects[\"inputs\"][key][\"x1\"] and x<=Objects[\"inputs\"][key][\"x2\"] and y==Objects[\"inputs\"][key][\"y1\"] then!@#&                                        inputCounter = key!@#&                                        break!@#&                                end!@#&                        end!@#&                elseif event == \"char\" then!@#&                        currentInput = currentInput..side!@#&                        Inputs[inputCounter] = currentInput!@#&                elseif event == \"paste\" then!@#&                        currentInput = currentInput..side!@#&                        Inputs[inputCounter] = currentInput!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function tv(speed)!@#&        term.setBackgroundColor(colors.black)!@#&        for i=1,centerY do!@#&                term.setCursorPos(1,i)!@#&                term.clearLine()!@#&                term.setCursorPos(1,ySize-i+1)!@#&                term.clearLine()!@#&                sleep(speed)!@#&        end!@#&        for i=1,centerX do!@#&                paintutils.drawPixel(i,centerY+1,colors.black)!@#&                paintutils.drawPixel(xSize-i+1,centerY+1,colors.black)!@#&                sleep(speed)!@#&        end!@#&        sleep(0.2)!@#&        clearScreen(colors.black)!@#&        term.setTextColor(colors.white)!@#&        term.setCursorPos(1,1)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function select(...)!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                --if not Objects[class] then Objects[class] = {} end!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        local function drawButton(x,y,name,textColor,backColor)!@#&                local sizeOfButton = 2+#name+2!@#&                square(x,y,sizeOfButton,1,backColor)!@#&                colorText(x+2,y,name,textColor)!@#&                newObj(\"buttons\",name,x,y,sizeOfButton,1)!@#&        end!@#& !@#&        local text1 = arg[1]!@#&        local text2 = arg[2]!@#& !@#&        local sizeOfText1 = #text1!@#&        local sizeOfText2 = #text2!@#&        local hereIsOnlyOneElement = false!@#&        if sizeOfText1 == 0 then hereIsOnlyOneElement = true end!@#& !@#&        --     !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #text1[i] > theLongestElement then theLongestElement = #text1[i] end!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if #text2[i] > theLongestElement then theLongestElement = #text2[i] end!@#&        end!@#& !@#&        --      !@#&        local countOfButtons = #arg-2!@#&        local sizeOfAllButtons = 0!@#&        for i=1,countOfButtons do!@#&                sizeOfAllButtons = sizeOfAllButtons + 2+#arg[2+i][1]+2 + 1!@#&        end!@#&        sizeOfAllButtons = sizeOfAllButtons - 1!@#&        if sizeOfAllButtons>theLongestElement then theLongestElement=sizeOfAllButtons end!@#& !@#&        --     !@#&        local xWindowSize = 2 + theLongestElement + 2!@#&        local yWindowSize = nil!@#&        if hereIsOnlyOneElement then!@#&                yWindowSize = 2 + sizeOfText2 + 3!@#&        else!@#&                yWindowSize = 2 + sizeOfText1 + 1 + sizeOfText2 + 3!@#&        end!@#& !@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --TEXTS!@#&        term.setBackgroundColor(colors.white)!@#&        for i=1,sizeOfText1 do!@#&                colorText(xStart+2,yStart+1+i,text1[i],colors.gray)!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if hereIsOnlyOneElement then!@#&                        colorText(xStart+2,yStart+1+sizeOfText1+i,text2[i],colors.lightGray)!@#&                else!@#&                        colorText(xStart+2,yStart+2+sizeOfText1+i,text2[i],colors.lightGray)!@#&                end!@#&        end!@#& !@#&        local xStartForButtons = xStart+xWindowSize-1 - sizeOfAllButtons - 1!@#&        local yStartForButtons = yStart+yWindowSize-2!@#&        for i=1,countOfButtons do!@#&                local text = arg[2+i][1]!@#&                local textColor = tonumber(arg[2+i][3])!@#&                local backColor = tonumber(arg[2+i][2])!@#& !@#&                drawButton(xStartForButtons,yStartForButtons,text,textColor,backColor)!@#&                xStartForButtons = xStartForButtons + 2+#arg[2+i][1]+2+1!@#&        end!@#& !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"buttons\"]) do!@#&                                if x>=Objects[\"buttons\"][key][\"x1\"] and x<=Objects[\"buttons\"][key][\"x2\"] and y==Objects[\"buttons\"][key][\"y1\"] then!@#&                                        drawButton(Objects[\"buttons\"][key][\"x1\"],Objects[\"buttons\"][key][\"y1\"],key,colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        return key!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function aboutFile(x,y,xWindowSize,path)!@#&        os.loadAPI(\"SpeedAPI/image\")!@#& !@#&        local name = fs.getName(path)!@#&        local limitOfText = xWindowSize - 2!@#&        local yWindowSize = 16!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        -- !@#&        local function drawButton(x,y,name,textColor,backColor)!@#&                local sizeOfButton = 2+#name+2!@#&                square(x,y,sizeOfButton,1,backColor)!@#&                colorText(x+2,y,name,textColor)!@#&                newObj(\"buttons\",name,x,y,sizeOfButton,1)!@#&        end!@#& !@#&        --------------- , !@#& !@#&        local info = {}!@#& !@#&        info[\"fileFormat\"] = getFileFormat(path)!@#& !@#&        info[\"fileType\"] = getFileType(path)!@#& !@#&        info[\"fileSize\"] = math.ceil(getFileSize(path)/1024)..\"KB\"!@#& !@#&        info[\"readOnly\"] = tostring(fs.isReadOnly(path))!@#&        --------------- !@#& !@#&        --  GOVNA,      !@#&        if y+yWindowSize - 1  >= ySize then y = y - (y+yWindowSize - 1 - ySize) - 1 end!@#&        if x+xWindowSize - 1  >= xSize then x = x - (x+xWindowSize - 1 - xSize) - 1 end!@#& !@#&        -- !@#&        emptyWindow(x,y,xWindowSize,yWindowSize,\"Properties\")!@#& !@#&        --, !@#&        drawOSIcon(x+1,y+2,path,name,info[\"fileFormat\"])!@#& !@#&        --  !@#&        square(x,y+7,xWindowSize,1,colors.lightGray)!@#&        colorText(x+1,y+7,\"Info\",colors.white)!@#& !@#&        --   !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(x+8,y+3,stringLimit(\"start\",name,xWindowSize-9),colors.gray)!@#&        colorText(x+8,y+4,info[\"fileSize\"],colors.lightGray)!@#& !@#&        --  !@#&        local textStart = y+9!@#&        colorText(x+1,textStart,\"Type:\",colors.gray)!@#&        usualText(x+1,textStart+1,\"Size:\",colors.gray)!@#&        usualText(x+1,textStart+2,\"Path:\",colors.gray)!@#&        usualText(x+1,textStart+3,\"Read only:\",colors.gray)!@#& !@#&        colorText(x+7,textStart,info[\"fileType\"],colors.lightGray)!@#&        usualText(x+7,textStart+1,info[\"fileSize\"])!@#&        usualText(x+7,textStart+2,stringLimit(\"start\",path,xWindowSize-8))!@#&        usualText(x+12,textStart+3,info[\"readOnly\"])!@#& !@#&        --!@#&        drawButton(x+xWindowSize-11,y+yWindowSize-2,\"Close\",colors.black,colors.lightBlue)!@#& !@#&        --   !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"buttons\"]) do!@#&                                if x>=Objects[\"buttons\"][key][\"x1\"] and x<=Objects[\"buttons\"][key][\"x2\"] and y==Objects[\"buttons\"][key][\"y1\"] then!@#&                                        drawButton(Objects[\"buttons\"][key][\"x1\"],Objects[\"buttons\"][key][\"y1\"],key,colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        return key!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function progressBar(xStart,yStart,xWindowSize,title,text,speed)!@#&        --  !@#&        if xWindowSize < 4+#text then!@#&                xWindowSize = 4+#text!@#&        end!@#& !@#&        local yWindowSize = 6!@#&        local sizeOfProgressBar = xWindowSize - 4!@#& !@#&        -- !@#&        xStart,yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        -- !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        -- !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(math.floor(xStart+(xWindowSize/2-#text/2)),yStart+2,text,colors.gray)!@#& !@#&        --  !@#&        local xProgressBarPos = xStart+2!@#&        local yProgressBarPos = yStart+4!@#&        drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,0)!@#&        sleep(0)!@#&        for i=1,100,speed do!@#&                drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,i)!@#&                sleep(0)!@#&        end!@#&        drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,100)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function search(xStart,yStart,xWindowSize,limitOfElements,searchText)!@#& !@#&        os.loadAPI(\"SpeedAPI/image\")!@#& !@#&        local searchList = {}!@#& !@#&        local sizeOfOneElement = 5!@#&        local yWindowSize = 4 + sizeOfOneElement*limitOfElements!@#&        local sizeOfSearchBar = xWindowSize - #searchText - 3!@#&        local xStartOfSearchBar = xStart + 2 + #searchText!@#&        local yStartOfSearchBar = yStart + 1!@#&        local limitOfAllText = xWindowSize - 10!@#&        local xWindowEnd = xStart + xWindowSize - 1!@#&        local yWindowEnd = yStart + yWindowSize - 1!@#& !@#&        local fromElement = 1!@#&        local searchInput = \"\"!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height,fileType,fileSize,path,fileName,fileFormat)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&                Objects[class][name][\"fileType\"]=fileType!@#&                Objects[class][name][\"fileSize\"]=fileSize!@#&                Objects[class][name][\"path\"]=path!@#&                Objects[class][name][\"fileName\"]=fileName!@#&                Objects[class][name][\"fileFormat\"]=fileFormat!@#&        end!@#& !@#&        local function drawConcretnoIcon(xStart,yStart,path,name,fileType,fileSize,backColor,fileFormat)!@#&                drawOSIcon(xStart,yStart,path,name,fileFormat)!@#&                term.setBackgroundColor(backColor)!@#&                colorText(xStart+8,yStart,stringLimit(\"end\",name,limitOfAllText),colors.gray)!@#&                colorText(xStart+8,yStart+1,stringLimit(\"start\",path,limitOfAllText),colors.lightGray)!@#&                colorText(xStart+8,yStart+2,stringLimit(\"start\",\"Type: \"..fileType,limitOfAllText),colors.lightGray)!@#&                colorText(xStart+8,yStart+3,stringLimit(\"start\",\"Size: \"..math.ceil(fileSize/1024)..\"KB\",limitOfAllText),colors.lightGray)!@#& !@#&                newObj(\"icon\",path..\"/\"..name,xStart,yStart,xWindowSize,4,fileType,fileSize,path,name,fileFormat)!@#&        end!@#& !@#&        local function drawSearches(fromElement)!@#&                -- !@#&                Objects = {}!@#&                newObj(\"icon\",\"cykaBlyad\",-5,-5,1,1,\"hehe\",5)          !@#& !@#&                --  !@#&                square(xStart,yStart+3,xWindowSize-1,yWindowSize-3,colors.white)!@#& !@#&                if #searchList == 0 then!@#&                        colorText(xStart+1,yStart+4,\"No mathes found.\",colors.lightGray)!@#&                else!@#&                        local iconCounter = 1!@#&                        for i=fromElement,#searchList do!@#&                                local yIconPos = yStart+4 + iconCounter*sizeOfOneElement - sizeOfOneElement!@#&                               !@#&                                drawConcretnoIcon(xStart+1,yIconPos,searchList[i][\"path\"],searchList[i][\"name\"],searchList[i][\"fileType\"],searchList[i][\"fileSize\"],colors.white,searchList[i][\"fileFormat\"])!@#& !@#&                                iconCounter = iconCounter + 1!@#&                                if iconCounter > limitOfElements then break end!@#&                        end!@#&                end!@#& !@#&                scrollBar(xWindowEnd,yStart+3,yWindowSize-3,#searchList,fromElement,colors.lightGray,colors.lightBlue)!@#&        end!@#& !@#&        local function textOnSearchBar()!@#&                term.setBackgroundColor(colors.white)!@#&                usualText(xStartOfSearchBar,yStartOfSearchBar,string.rep(\" \",sizeOfSearchBar))!@#&                colorText(xStartOfSearchBar,yStartOfSearchBar,stringLimit(\"start\",searchInput,sizeOfSearchBar),colors.black)!@#&        end!@#& !@#&        --!@#&        sampleWindow(xStart,yStart,xWindowSize,yWindowSize)!@#&        -- !@#&        square(xStart,yStart,xWindowSize,3,colors.blue)!@#&        colorText(xStart+1,yStart+1,searchText,colors.white)!@#&        square(xStartOfSearchBar,yStartOfSearchBar,sizeOfSearchBar,1,colors.white)!@#& !@#&        drawSearches(fromElement)!@#& !@#&        while true do!@#&                textOnSearchBar(searchInput)!@#&                if #searchInput > sizeOfSearchBar then!@#&                        term.setCursorPos(xStartOfSearchBar+sizeOfSearchBar-1,yStartOfSearchBar)!@#&                else!@#&                        term.setCursorPos(xStartOfSearchBar+#searchInput,yStartOfSearchBar)!@#&                end!@#& !@#&                term.setCursorBlink(true)!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_scroll\" then!@#&                        term.setCursorBlink(false)!@#&                        if side == 1 then!@#&                                fromElement = fromElement + 1!@#&                                if fromElement > #searchList then!@#&                                        fromElement = #searchList!@#&                                else!@#&                                        drawSearches(fromElement)!@#&                                end!@#&                        else!@#&                                fromElement = fromElement - 1!@#&                                if fromElement < 1 then!@#&                                        fromElement = 1!@#&                                else!@#&                                        drawSearches(fromElement)!@#&                                end!@#&                        end!@#&                elseif event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"icon\"]) do!@#&                                if x>=Objects[\"icon\"][key][\"x1\"] and x<=Objects[\"icon\"][key][\"x2\"] and y>=Objects[\"icon\"][key][\"y1\"] and y<=Objects[\"icon\"][key][\"y2\"] then!@#&                                        square(Objects[\"icon\"][key][\"x1\"]-1,Objects[\"icon\"][key][\"y1\"],xWindowSize-1,4,colors.blue)!@#&                                        drawConcretnoIcon(Objects[\"icon\"][key][\"x1\"],Objects[\"icon\"][key][\"y1\"],Objects[\"icon\"][key][\"path\"],Objects[\"icon\"][key][\"fileName\"],Objects[\"icon\"][key][\"fileType\"],Objects[\"icon\"][key][\"fileSize\"],colors.blue,Objects[\"icon\"][key][\"fileFormat\"])!@#&                                        sleep(0.3)!@#&                                        term.setCursorBlink(false)!@#&                                        return string.sub(key,2,-1)!@#&                                end!@#&                        end!@#&                        term.setCursorBlink(false)!@#&                        return nil!@#& !@#&                elseif event == \"char\" then!@#&                        fromElement = 1!@#&                        searchInput = searchInput..side!@#&                        searchList = searchInAllFiles(\"/\",searchInput)!@#&                        drawSearches(fromElement)!@#&                elseif event == \"key\" then!@#&                        if side == 14 then!@#&                                fromElement = 1!@#&                                searchInput = string.sub(searchInput,1,-2)!@#&                                searchList = searchInAllFiles(\"/\",searchInput)!@#&                                drawSearches(fromElement)!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--print(\"You selected: \"..search(2,2,28,2,\"Search\"))!@#& !@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function info(xStart,yStart,title,text)!@#&        local sizeOfText = #text!@#&        local xWindowSize = 4+sizeOfText!@#&        local yWindowSize = 4!@#&        local xStart,yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(xStart+2,yStart+2,text,colors.gray)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&--[[function fileManager(mode,workPath)!@#&        if workPath == nil then workPath = \"\" end!@#& !@#&        local xSize,ySize = term.getSize()!@#& !@#&        local managerX = xSize-3!@#&        local managerY = ySize-3!@#& !@#&        local xStart = 2!@#&        local yStart = 2!@#& !@#&        local main = window.create(term.native(),xStart,yStart,managerX+1,managerY+1)!@#&        term.redirect(main)!@#& !@#&        local function getFoldersList(workPath)!@#& !@#&        end!@#& !@#&        local function drawManager()!@#&                local currentPath = fs.getName(workPath)!@#&                emptyWindow(1,1,managerX,managerY,currentPath)!@#&                colorTextWithBack(1,1,\"x\",colors.black,colors.red);colorTextWithBack(2,1,\"-\",colors.black,colors.orange);colorTextWithBack(3,1,\"+\",colors.black,colors.lime)!@#&        end!@#& !@#&        local function clickedAtArea(x,y,sx,sy,ex,ey)!@#&        if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&        return false!@#&        end!@#& !@#&        drawManager()!@#& !@#&        term.redirect(term.native())!@#&end]]",},["encryptor.cfg"]="1=eafazf!@#&2=ezffqq!@#&3=ezfvfp!@#&4=eafooz!@#&5=eafaiz!@#&6=ezviio!@#&7=ezvzvi!@#&8=eqfooz!@#&9=eommqo!@#&0=ezivup!@#&a=ealajo!@#&b=eopxzj!@#&c=evmsyo!@#&d=ebiiql!@#&e=epovuz!@#&f=efivmt!@#&g=ezvito!@#&h=ezlfbh!@#&i=eaquat!@#&j=etirra!@#&k=emorta!@#&l=etampl!@#&m=enodus!@#&n=ezviri!@#&o=eponis!@#&p=enuihu!@#&q=exyupi!@#&r=ezdads!@#&s=eigurd!@#&t=eamati!@#&u=ebalro!@#&v=etshat!@#&w=ealsis!@#&x=ekizli!@#&y=eltrya!@#&z=espopu",["System"]={["OS"]={["monitor.cfg"]="false",["Icons"]={["zip.png"]=",70-70-70-70,70###!@#&|70 70 70 00|70###!@#&z07i07p07 70|70###!@#&|70_70_70_70|70###",["gif.png"]=" 30 3b 3b 3b 3b 30!@#& 30 0bP0bS0b 0b 30!@#& 30 fb fb fb fb 30!@#& 30.f0gf0if0ff0 30",["disk.png"]=" 07 07 07 07 07 07!@#& 07 5f 5f 5f 5f 07!@#& 08 f8 08 f8.e8.58!@#& 08d78i78s78k78 08",["nfp.png"]=" 30 3b 3b 3b 3b 30!@#& 30 0bP0bS0b 0b 30!@#& 30 fb fb fb fb 30!@#& 30.f0if0mf0gf0 30",["os.png"]=" 80 80 80 80 80 80!@#& 80 80O70S70 80 80!@#& 80 80 80 80 80 80!@#& 80v80380.80080 80",["default.png"]=" 0f 0f 0f 0f 0f 0f!@#& 0f>4f_0f 0f 0f 0f!@#& 0f 0f 0f 0f 0f 0f!@#& 0f 0f 0f 0f 0f 0f",["config.png"]="###-80-80-80-80###!@#&###-80-80-80-80###!@#&###-80-80-80-80###!@#&###.e0ce0fe0ge0###",["folder.png"]=" 04 04############!@#&-04-04-04-04-04-04!@#& 04 04 04 04 04 04!@#&ff4of4lf4df4ef4rf4",["image.png"]=" 30 3b 3b 3b 3b 30!@#& 30 0bP0bS0b 0b 30!@#& 30 fb fb fb fb 30!@#& 30.f0pf0nf0gf0 30",},["userdata.cfg"]="showSystemFolders=true!@#&showHiddenFiles=true!@#&hideFileFormat=true",},["Graph"]={["userdata.cfg"]="formula=x*math.sin(x)!@#&scale=2!@#&step=0.1",},["NewsTicker"]={["userdata.cfg"]="string=Suka!@#&scale=5!@#&delay=10!@#&speed=0.1",},["Photoshop"]={["pslogo.png"]="",},["MineCode"]={["logo.png"]="",["syntax_colors.cfg"]="",},["Clipboard.temp"]="{[1]={[\"Visible\"]=true,[\"Pixels\"]={[1]=\"4f               \",[2]=\"4f f             4 \",[3]=\"4f f 4> 0eblan4     4 \",[4]=\"4f f   4 f         4 \",[5]=\"4f f             4 \",[6]=\"4f f             4 \",[7]=\"4f f             4 \",[8]=\"4f f             4 \",[9]=\"4f f        5.e .f  4 \",[10]=\"4f               \",},[\"Index\"]=1,[\"Name\"]=\"Background\",[\"BackgroundColour\"]=-1,},}",["API"]={["zip"]="function archive(chto,vochto)!@#&        local Massiv2 = {}!@#&        local function FileList(path)!@#&                local Massiv = fs.list(path)!@#&                if #Massiv==0 then!@#&                        local Massiv2Id = #Massiv2 + 1!@#&                        Massiv2[Massiv2Id] = {}!@#&                        Massiv2[Massiv2Id][\"path\"] = path!@#&                        Massiv2[Massiv2Id][\"text\"] = \"@empty@empty\"!@#&                else!@#&                        for i=1,#Massiv do!@#&                                if fs.isDir(path..\"/\"..Massiv[i]) and Massiv[i] ~= \"/rom\" and Massiv[i] ~= \"rom\" then!@#&                                        FileList(path..\"/\"..Massiv[i])!@#&                                elseif not fs.isDir(path..\"/\"..Massiv[i]) and Massiv[i] ~= \"/rom\" and Massiv[i] ~= \"rom\" then!@#&                                        local Massiv2Id = #Massiv2 + 1!@#&                                        Massiv2[Massiv2Id] = {}!@#&                                        Massiv2[Massiv2Id][\"path\"] = path..\"/\"..Massiv[i]!@#&                                        local file = fs.open(path..\"/\"..Massiv[i],\"r\")!@#&                                        Massiv2[Massiv2Id][\"text\"] = file.readAll()!@#&                                        file.close()!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        FileList(chto)!@#&        file=fs.open(vochto..\".zip\",\"w\")!@#&        file.write(textutils.serialise(Massiv2))!@#&        file.close()!@#&        return Massiv2!@#&end!@#& !@#&function unarchive(chto,kuda)!@#&        local file = fs.open(chto,\"r\")!@#&        Massiv = textutils.unserialise(file.readAll())!@#&        file.close()!@#&        for i=1,#Massiv do!@#&                if Massiv[i][\"text\"] == \"@empty@empty\" then!@#&                        fs.makeDir(kuda..\"/\"..Massiv[i][\"path\"])!@#&                else!@#&                        local file = fs.open(kuda..\"/\"..Massiv[i][\"path\"],\"w\")!@#&                        file.write(Massiv[i][\"text\"])!@#&                        file.close()!@#&                end!@#&        end!@#&end",["cluster"]="--[[!@#&:!@#&        AC: x  y -  !@#&        RC: x  y -  !@#&]]--!@#&--monitors[j][i][id/xSize/ySize/xStart/xEnd/yStart/yEnd]!@#&----!@#&local CurrentMonitor = nil!@#&local Monitors       = nil!@#& !@#&local CursorPosX, CursorPosY = 1, 1!@#& !@#&local BGColor = colors.black!@#&local TextColor = colors.white!@#&local Scale = 1!@#& !@#&-- --!@#&function PointInRect(x, y, sx, sy, ex, ey)!@#&        if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end!@#&       !@#&        return false!@#&end!@#& !@#&----!@#& !@#&--      !@#&function GetRelativeCursorPos(ax, ay)!@#&        local MonitorID = nil!@#&        local PosX  = nil!@#&        local PosY  = nil!@#&       !@#&        for j = 1, Monitors[\"monitorsCountInHeight\"], 1 do!@#&                for i = 1, Monitors[\"monitorsCountInWidth\"], 1 do!@#&                       !@#&                        if PointInRect(ax, ay, Monitors[j][i][\"xStart\"], Monitors[j][i][\"yStart\"], Monitors[j][i][\"xEnd\"], Monitors[j][i][\"yEnd\"]) then!@#&                                PosX = ax - Monitors[j][i][\"xStart\"] + 1!@#&                                PosY = ay - Monitors[j][i][\"yStart\"] + 1!@#&                                MonitorID = Monitors[j][i][\"id\"]!@#&                                return MonitorID, PosX, PosY, i, j!@#&                        end!@#&                end!@#&        end!@#&       !@#&        return nil!@#&end!@#& !@#&--      !@#&function GetAbsoluteCursorPos(MonitorID, rx, ry)!@#&        local PosX = nil!@#&        local PosY = nil!@#& !@#&        for j = 1, Monitors[\"monitorsCountInHeight\"], 1 do!@#&                for i = 1, Monitors[\"monitorsCountInWidth\"], 1 do!@#&                        if Monitors[j][i][\"id\"] == MonitorID then!@#&                                PosX = Monitors[j][i][\"xStart\"] + rx - 1!@#&                                PosY = Monitors[j][i][\"yStart\"] + ry - 1!@#&                                return PosX, PosY, i, j!@#&                        end!@#&                end!@#&        end!@#&       !@#&        return nil!@#&end!@#& !@#&-- API!@#&function Init()!@#&        if not fs.exists(\"System/ClusterCalibration.cfg\") then error(\"Calibration config not found.\") end!@#&        file = fs.open(\"System/ClusterCalibration.cfg\", \"r\")!@#&        local _data = file.readAll(monitors)!@#&        file.close()!@#&       !@#&        Monitors = textutils.unserialise(_data)!@#&        SetMonitorParameters(nil, nil, Monitors[\"monitorsScale\"])!@#&        SetCursorPos(CursorPosX, CursorPosY)!@#&end!@#& !@#&--  !@#&function SetCursorPos(ax, ay)!@#&        CursorPosX, CursorPosY = ax, ay!@#&       !@#&        local _m, _rx, _ry = GetRelativeCursorPos(CursorPosX, CursorPosY)!@#&        CurrentMonitor = peripheral.wrap(_m)!@#&        CurrentMonitor.setCursorPos(_rx, _ry)!@#&end!@#& !@#&-- !@#&function WriteText(str)!@#&        for s in string.gmatch(str, \".\") do!@#&                if CursorPosY > Monitors[\"totalMonitorSizeY\"] then!@#&                        break!@#&                elseif s == '\\n' then!@#&                        CursorPosX = 0!@#&                        CursorPosY = CursorPosY + 1!@#&                elseif CursorPosX + 1 > Monitors[\"totalMonitorSizeX\"] then!@#&                        CurrentMonitor.write(s)!@#&                        CursorPosX = 1!@#&                        CursorPosY = CursorPosY + 1!@#&                        SetCursorPos(CursorPosX, CursorPosY)!@#&                else!@#&                        CurrentMonitor.write(s)!@#&                        CursorPosX = CursorPosX + 1!@#&                        SetCursorPos(CursorPosX, CursorPosY)!@#&                end!@#&        end!@#&end!@#& !@#&-- \\ !@#&function SetMonitorParameters(backgroundcolor, textcolor, scale)!@#&        BGColor = backgroundcolor or BGColor!@#&        TextColor = textcolor or TextColor!@#&        Scale = scale or Scale!@#&       !@#&        for j = 1, Monitors[\"monitorsCountInHeight\"], 1 do!@#&                for i = 1, Monitors[\"monitorsCountInWidth\"], 1 do!@#&                        local _m = peripheral.wrap(Monitors[j][i][\"id\"])!@#&                        _m.setBackgroundColor(BGColor)!@#&                        _m.setTextColor(TextColor)!@#&                        _m.setTextScale(Scale)!@#&                end!@#&        end!@#&end!@#& !@#&--!@#&function ClearAll()!@#&        for j = 1, Monitors[\"monitorsCountInHeight\"], 1 do!@#&                for i = 1, Monitors[\"monitorsCountInWidth\"], 1 do!@#&                        local _m = peripheral.wrap(Monitors[j][i][\"id\"])!@#&                        _m.setBackgroundColor(BGColor)!@#&                        _m.setTextColor(TextColor)!@#&                        _m.clear()!@#&                end!@#&        end!@#&end!@#& !@#&Init()",["syntax"]="os.loadAPI(\"System/API/config\")!@#& !@#&local Colors = {!@#&        [\"text\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"text\")),!@#&        [\"commands\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"commands\")),!@#&        [\"api\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"api\")),!@#&        [\"string\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"string\")),!@#&        [\"comments\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"comments\")),!@#&        [\"compares\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"compares\")),!@#&        [\"loops\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"basics\")),!@#&        [\"boolean\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"boolean\")),!@#&        [\"number\"] = tonumber(config.read(\"System/MineCode/syntax_colors.cfg\",\"number\")),!@#&}!@#& !@#&local KeyWords = {!@#&        {[\"pattern\"]=\"for\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"while\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"true\", [\"color\"]=Colors[\"boolean\"]},!@#&        {[\"pattern\"]=\"false\", [\"color\"]=Colors[\"boolean\"]},!@#&        {[\"pattern\"]=\"if\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"then\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"else\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"elseif\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"do\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"break\", [\"color\"]=colors.red},!@#&        {[\"pattern\"]=\"function\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"and\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"not\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"or\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"in\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"until\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"return\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"repeat\", [\"color\"]=Colors[\"loops\"]},!@#&        {[\"pattern\"]=\"nil\", [\"color\"]=Colors[\"boolean\"]},!@#&        {[\"pattern\"]=\"local\", [\"color\"]=Colors[\"loops\"]},!@#&}!@#&       !@#&local Compares = {!@#&        \"=\",!@#&        \"==\",!@#&        \"~=\",!@#&        \">\",!@#&        \"<\",!@#&        \">=\",!@#&        \"<=\",!@#&        \"+\",!@#&        \"-\",!@#&        \"*\",!@#&        \"/\",!@#&        \"%^\",!@#&        \"%.%.\",!@#&        \"%#\",!@#&}!@#& !@#&local sKeyWords = #KeyWords!@#&local sCompares = #Compares!@#& !@#&--   !@#&local function findAndReplace(x,y,text,pattern,color,obrezatSleva,obrezatSprava,vichestIzStartaPoiska)!@#&        local findPos = 1!@#&        while true do!@#&                local s,e = string.find(text,pattern,findPos)!@#&                if s ~= nil and e ~= nil then!@#&                        term.setTextColor(color)!@#&                        term.setCursorPos(1-x+s+obrezatSleva,y)!@#&                        term.write(string.sub(text,s+obrezatSleva,e-obrezatSprava))!@#&                else!@#&                        break!@#&                end!@#&                findPos = e + 1 - vichestIzStartaPoiska!@#&        end!@#&end!@#& !@#&--   !@#&function highlight(x,y,text)!@#&        --    !@#&        term.setTextColor(Colors[\"text\"])!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#& !@#&        --      .    !@#&        for i=1,sKeyWords do!@#&                findAndReplace(x,y,text,\" \"..KeyWords[i][\"pattern\"]..\" \",KeyWords[i][\"color\"],0,0,0)!@#&                findAndReplace(x,y,text,\" \"..KeyWords[i][\"pattern\"]..\"$\",KeyWords[i][\"color\"],0,0,0)!@#&                findAndReplace(x,y,text,\"^\"..KeyWords[i][\"pattern\"]..\" \",KeyWords[i][\"color\"],0,0,0)!@#&        end!@#& !@#&        -- !@#&        findAndReplace(x,y,text,\"[%a%d%_%-]*%(\",Colors[\"commands\"],0,1,0)!@#&        findAndReplace(x,y,text,\"%.(.*)%(\",Colors[\"commands\"],1,1,0)!@#& !@#&        --  !@#&        findAndReplace(x,y,text,\"os%.loadAPI%(\",Colors[\"api\"],0,1,0)   !@#& !@#&        -- END,    !@#&        findAndReplace(x,y,text,\"end$\",Colors[\"loops\"],0,0,0)  !@#& !@#&        --     =, ==, >=  ..!@#&        for i=1,sCompares do!@#&                findAndReplace(x,y,text,\" \"..Compares[i]..\" \",Colors[\"compares\"],0,0,0)!@#&                findAndReplace(x,y,text,\"(.)\"..Compares[i]..\"(.)\",Colors[\"compares\"],1,1,0)!@#&                findAndReplace(x,y,text,\"(.)\"..Compares[i],Colors[\"compares\"],1,0,0)!@#&                findAndReplace(x,y,text,Compares[i]..\"(.)\",Colors[\"compares\"],0,1,0)!@#&        end!@#& !@#&        -- !@#&        findAndReplace(x,y,text,\"[^%a%d](%d*)[^%a%d]\",Colors[\"number\"],1,1,1)!@#&        findAndReplace(x,y,text,\"[^%a%d](%d*)$\",Colors[\"number\"],1,0,0)!@#& !@#&        --    !@#&        findAndReplace(x,y,text,\"\\\".-[^\\\"\\\"]\\\"\",Colors[\"string\"],0,0,0)!@#& !@#&        --  !@#&        findAndReplace(x,y,text,\"%-%-.*\",Colors[\"comments\"],0,0,0)!@#& !@#&end!@#& !@#& !@#&------------------------------------------------------------------------------------------------------------------!@#& !@#& !@#&--[[term.setBackgroundColor(colors.white)!@#&term.setTextColor(colors.black)!@#&term.setCursorPos(1,1)!@#&term.clear()!@#& !@#&local strings = {!@#&        \"os.loadAPI(123)\",!@#&        \"term.setCursorPos(1,1)\",!@#&        \"while true do\",!@#&        \"  if x >= 12 then\",!@#&        \"    break\",!@#&        \"  end\",!@#&        \"end\",!@#&        \" \",!@#&        \"local function hehe(heh123, 123)\",!@#&        \"  print(heh123)\",!@#&        \"end\",!@#&        \" \",!@#&        \"print(\\\"Pruf Piru, chto ono ne laget\\\"..123..\\\"hehe\\\")\",!@#&        \"term.clear()\",!@#&        \"local input = cyka()\",!@#&        \" \",!@#&        \"--Comment, bitch!\",!@#&}!@#& !@#& !@#&local try = 1!@#&while true do!@#&        term.clear()!@#&        highlight(1,1,\"Popitka napisaniya: \"..try)!@#& !@#&        for i=1,#strings do!@#&                highlight(1,i+2,strings[i])!@#&        end!@#& !@#&        sleep(0.1)!@#&        try = try + 1!@#&end]]!@#& !@#& !@#&--[[print(\"Write something:\")!@#& !@#&local stro4ka = \"\"!@#&local CursorPosX = 1!@#&local CursorPosY = 3!@#&term.setCursorBlink(true)!@#&while true do!@#&        term.setCursorPos(CursorPosX,CursorPosY)!@#&        local event,side = os.pullEvent()!@#&        if event == \"char\" then!@#&                stro4ka = stro4ka..side!@#&                CursorPosX = CursorPosX + 1!@#&                highlight(1,CursorPosY,stro4ka)!@#&        elseif event == \"key\" then!@#&                if side == 28 then!@#&                        stro4ka = \"\"!@#&                        CursorPosX = 1!@#&                        CursorPosY = CursorPosY + 1!@#&                elseif side == 14 then!@#&                        if #stro4ka > 0 then!@#&                                highlight(1,CursorPosY,string.rep(\" \",#stro4ka))!@#&                                stro4ka = string.sub(stro4ka,1,-2)!@#&                                highlight(1,CursorPosY,stro4ka)!@#&                                CursorPosX = CursorPosX - 1!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&os.pullEvent(\"key\")]]",["context"]="unction menu(...)!@#&        --   < 3      TABLE,      API!@#&        if #arg < 3 or type(arg[3]) ~= \"table\" then error(\"Usage: menu(number x,number y,table Element1,table Element2, table Element3...) \\nReturns: string Action \\n<Element> structure: {string Name[, boolean isElementHidden][,number colorOfText]}\") end!@#&       !@#&        --  !@#&        local xSize, ySize = term.getSize()!@#& !@#&        --        !@#&        local function text(x,y,text1,color)!@#&                term.setTextColor(color)!@#&                term.setCursorPos(x,y)!@#&                term.write(text1)!@#&        end!@#& !@#&        --    (   ,     )!@#&        local Objects = {}!@#&        local function newObj(name,isHidden,xStart,xEnd,y)!@#&                Objects[name]={}!@#&                Objects[name][\"isHidden\"] = isHidden!@#&                Objects[name][\"xStart\"] = xStart!@#&                Objects[name][\"xEnd\"] = xEnd!@#&                Objects[name][\"y\"] = y!@#&        end!@#&       !@#&        --    -   !@#&        local theLongestElement = #arg[3][1]!@#&        for i=3,#arg do!@#&                if arg[i] ~= \"-\" and theLongestElement < #arg[i][1] then!@#&                        theLongestElement = #arg[i][1]!@#&                end!@#&        end!@#& !@#&        --  !@#&        local xSizeOfMenu = theLongestElement + 4!@#&        local ySizeOfMenu = #arg-2!@#& !@#&        local xStartToDisplay = nil!@#&        local yStartToDisplay = nil!@#& !@#&        --   !@#&        local function square(x1,y1,width,height,color)!@#&                local string = string.rep(\" \",width)!@#&                term.setBackgroundColor(color)!@#&                for y=y1,(y1+height-1) do!@#&                        term.setCursorPos(x1,y)!@#&                        term.write(string)!@#&                end!@#&        end!@#& !@#&        --   !@#&        local function drawSeparator(x,y,size)!@#&                term.setTextColor(colors.lightGray)!@#&                term.setCursorPos(x,y)!@#&                term.write(string.rep(\"-\",size))!@#&        end!@#&       !@#&        --   !@#&        local function drawMenu(xMenu,yMenu)!@#& !@#&                --  ,      !@#&                if yMenu+ySizeOfMenu - 1  >= ySize then yMenu = yMenu - (yMenu+ySizeOfMenu - 1 - ySize) - 1 end!@#&                if xMenu+xSizeOfMenu - 1  >= xSize then xMenu = xMenu - (xMenu+xSizeOfMenu - 1 - xSize) - 1 end!@#& !@#&                --      !@#&                xStartToDisplay = xMenu + 2!@#&                yStartToDisplay = yMenu!@#& !@#&                --  !@#&                square(xMenu+1,yMenu+1,xSizeOfMenu,ySizeOfMenu,colors.gray)!@#& !@#&                --   !@#&                square(xMenu,yMenu,xSizeOfMenu,ySizeOfMenu,colors.white)!@#& !@#&                --    ,    !@#&                for i=3,#arg do!@#&                        --     , !@#&                        if arg[i] ~= \"-\" then!@#&                                --      !@#&                                local contextColor = colors.black!@#&                                -- _2 (/ )  _3 (  )     , !@#&                                if arg[i][2] == nil and arg[i][3] == nil then!@#&                                        contextColor = colors.black!@#&                                --  2 = FALSE   3  , !@#&                                elseif arg[i][2] == false and arg[i][3] == nil then!@#&                                        contextColor = colors.black!@#&                                --  2 = FALSE   3 , !@#&                                elseif arg[i][2] == false and arg[i][3] ~= nil then!@#&                                        contextColor = arg[i][3]!@#&                                --  2 = TRUE,   !@#&                                elseif arg[i][2] == true then!@#&                                        contextColor = colors.lightGray!@#&                                end!@#& !@#&                                --     !@#&                                text(xStartToDisplay,yStartToDisplay+i-3,arg[i][1],contextColor)!@#&                                --    ,      !@#&                                newObj(arg[i][1],arg[i][2],xMenu,xMenu+xSizeOfMenu-1,yStartToDisplay+i-3)!@#& !@#&                        --  - , !@#&                        else!@#&                                drawSeparator(xMenu,yStartToDisplay+i-3,xSizeOfMenu)!@#&                        end!@#&                end!@#&        end!@#&       !@#&        -- ,  !@#&        drawMenu(arg[1],arg[2])!@#& !@#&        --  !@#&        local event,side,xClick,yClick = os.pullEvent()!@#&        if event == \"monitor_touch\" then side = 1 end!@#&        if event == \"mouse_click\" or event == \"monitor_touch\" then!@#&                --          ( = , KEY = VAL)!@#&                for key,val in pairs(Objects) do!@#&                        --    ,      , !@#&                        if xClick >= Objects[key][\"xStart\"] and xClick <= Objects[key][\"xEnd\"] and yClick == Objects[key][\"y\"] and Objects[key][\"isHidden\"] == false or xClick >= Objects[key][\"xStart\"] and xClick <= Objects[key][\"xEnd\"] and yClick == Objects[key][\"y\"] and Objects[key][\"isHidden\"] == nil then!@#&                                --    !@#&                                for i=Objects[key][\"xStart\"],Objects[key][\"xEnd\"] do!@#&                                        paintutils.drawPixel(i,Objects[key][\"y\"],colors.blue)!@#&                                end!@#&                                --   ,   !@#&                                text(xStartToDisplay,Objects[key][\"y\"],key,colors.white)!@#&                                --  !@#&                                sleep(0.3)!@#&                                --  KEY (     )    !@#&                                return key!@#&                        end!@#&                        --       ,    NIL!@#&                end!@#&        end!@#&end",["xml"]="function parseargs(s)!@#&  local arg = {}!@#&  string.gsub(s, \"([%-%w]+)=([\\\"'])(.-)%2\", function (w, _, a)!@#&    arg[w] = a!@#&  end)!@#&  return arg!@#&end!@#&   !@#&function collect(s)!@#&  local stack = {}!@#&  local top = {}!@#&  table.insert(stack, top)!@#&  local ni,c,label,xarg, empty!@#&  local i, j = 1, 1!@#&  while true do!@#&    ni,j,c,label,xarg, empty = string.find(s, \"<(%/?)([%w:]+)(.-)(%/?)>\", i)!@#&    if not ni then break end!@#&    local text = string.sub(s, i, ni-1)!@#&    if not string.find(text, \"^%s*$\") then!@#&      table.insert(top, text)!@#&    end!@#&    if empty == \"/\" then  -- empty element tag!@#&      table.insert(top, {label=label, xarg=parseargs(xarg), empty=1})!@#&    elseif c == \"\" then   -- start tag!@#&      top = {label=label, xarg=parseargs(xarg)}!@#&      table.insert(stack, top)   -- new level!@#&    else  -- end tag!@#&      local toclose = table.remove(stack)  -- remove top!@#&      top = stack[#stack]!@#&      if #stack < 1 then!@#&        error(\"nothing to close with \"..label)!@#&      end!@#&      if toclose.label ~= label then!@#&        error(\"trying to close \"..toclose.label..\" with \"..label)!@#&      end!@#&      table.insert(top, toclose)!@#&    end!@#&    i = j+1!@#&  end!@#&  local text = string.sub(s, i)!@#&  if not string.find(text, \"^%s*$\") then!@#&    table.insert(stack[#stack], text)!@#&  end!@#&  if #stack > 1 then!@#&    error(\"unclosed \"..stack[#stack].label)!@#&  end!@#&  return stack[1]!@#&end",["filemanager"]="os.loadAPI(\"System/API/windows\")!@#&os.loadAPI(\"System/API/image\")!@#&os.loadAPI(\"System/API/context\")!@#& !@#&local mode = \"open\"!@#&local workPath = \"\"!@#&local workPathHistory = {}!@#&local input = \"\"!@#& !@#&local xSize,ySize = term.getSize()!@#& !@#&local managerX = xSize-3!@#&local managerY = ySize-1!@#& !@#&local xStart = 2!@#&local yStart = 1!@#&local xEnd = xStart+managerX-1!@#&local yEnd = yStart+managerY-1!@#& !@#&local leftBarSize = 14!@#&local leftBarLimit = leftBarSize-3!@#& !@#&local sizeOfInputBar = 26!@#&local startOfInputBar = xStart+3!@#&local endOfInputBar = startOfInputBar+sizeOfInputBar-1!@#&local sizeOfSearchBar = managerX - sizeOfInputBar - 3 - 8 - 1!@#&local startOfSearchBar = xEnd-sizeOfSearchBar!@#& !@#&local xStartOfDrawingApps = xStart+leftBarSize+1!@#&local yStartOfDrawingApps = yStart+4!@#&local xSizeOfAppsArea = managerX-leftBarSize!@#&local ySizeOfAppsArea = managerY-3!@#&local xAppSize = 6!@#&local yAppSize = 6!@#&local xSpaceBetweenApps = 2!@#&local ySpaceBetweenApps = 1!@#&local countOfAppsByX = math.floor(xSizeOfAppsArea/(xAppSize+xSpaceBetweenApps))!@#&local countOfAppsByY = math.floor(ySizeOfAppsArea/(yAppSize+ySpaceBetweenApps))!@#&local countOfDesktops = 1!@#& !@#&local currentDesktop = 1!@#& !@#&local hideFileFormat = true!@#& !@#&--local main = window.create(term.native(),xStart,yStart,managerX+1,managerY+1)!@#& !@#&----------------------------------------!@#& !@#&local function clickedAtArea(x,y,sx,sy,ex,ey)!@#&    if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&    return false!@#&end!@#& !@#&local Favourites = {!@#&        [\"Root\"] = \"\",!@#&        [\"Applications\"] = \"/Applications\",!@#&        [\"Documents\"] = \"/Documents\",!@#&        [\"Images\"] = \"/Images\",!@#&        [\"rom\"] = \"/rom\",!@#&}!@#& !@#&local function saveConfig()!@#&        local path = \"System/Filemanager/Favourites.cfg\"!@#&        local f = fs.open(path,\"w\")!@#&        f.write(textutils.serialise(Favourites))!@#&        f.close()!@#&end!@#& !@#&local function loadConfig()!@#&        local path = \"System/Filemanager/Favourites.cfg\"!@#&        if fs.exists(path) then!@#&                local f = fs.open(path,\"r\")!@#&                local text = f.readAll()!@#&                Favourites = textutils.unserialise(text)!@#&                f.close()!@#&        end!@#&end!@#& !@#&local objects = {}!@#&local function newObj(class,name,key,value)!@#&        objects[class] = objects[class] or {}!@#&        objects[class][name] = objects[class][name] or {}!@#&        objects[class][name][key] = value!@#&end!@#& !@#&function drawSeparator(x1,y1,width,height,textColor,backColor,symbol)!@#&        local string = string.rep(symbol,width)!@#&        term.setBackgroundColor(backColor)!@#&        term.setTextColor(textColor)!@#&        for y=y1,(y1+height-1) do!@#&                windows.usualText(x1,y,string)!@#&        end!@#&end!@#& !@#&local function getFoldersList(workPath)!@#& !@#&end!@#& !@#&local function drawLeftBar()!@#&        objects[\"Favourites\"] = {}!@#& !@#&        windows.square(xStart,yStart+3,leftBarSize,yEnd-3,colors.white)!@#& !@#&        local y = yStart+4!@#&        local Peripherals = peripheral.getNames()!@#&        drawSeparator(xStart+leftBarSize-1,y-1,1,ySizeOfAppsArea,colors.lightGray,colors.white,\"|\")!@#& !@#&        local sFavourites = 0!@#&        for key,val in pairs(Favourites) do!@#&                sFavourites = sFavourites + 1!@#&        end!@#& !@#&        if sFavourites > 0 then!@#&                windows.colorText(xStart+1,y,\"Places\",colors.gray)!@#&                y = y + 1!@#& !@#&                for key,val in pairs(Favourites) do!@#&                        newObj(\"Favourites\",key,\"x1\",xStart)!@#&                        newObj(\"Favourites\",key,\"x2\",xStart+leftBarSize-1)!@#&                        newObj(\"Favourites\",key,\"y1\",y)!@#&                        newObj(\"Favourites\",key,\"path\",Favourites[key])!@#& !@#&                        if workPath == Favourites[key] then!@#&                                windows.square(xStart,y,leftBarSize-1,1,colors.blue)!@#&                                windows.colorText(xStart+2,y,windows.stringLimit(\"end\",key,leftBarLimit),colors.white)!@#&                        else!@#&                                windows.square(xStart,y,leftBarSize-1,1,colors.white)!@#&                                windows.colorText(xStart+2,y,windows.stringLimit(\"end\",key,leftBarLimit),colors.lightGray)!@#&                        end!@#& !@#&                        y = y + 1!@#&                end!@#& !@#&                y = y + 1!@#&        end!@#& !@#&        term.setBackgroundColor(colors.white)!@#&        if #Peripherals > 0 then!@#&                windows.colorText(xStart+1,y,\"Peripherals\",colors.gray)!@#&                y = y + 1!@#&                for i=1,#Peripherals do!@#&                        windows.colorText(xStart+2,y,windows.stringLimit(\"end\",Peripherals[i],leftBarLimit),colors.lightGray)!@#&                        y = y + 1!@#&                end!@#&        end!@#&end!@#& !@#&local function drawTopBar()!@#&        local posY = yStart + 1!@#&        windows.square(xStart,yStart,managerX,3,colors.lightGray)!@#&        windows.square(xStart+3,posY,sizeOfInputBar,1,colors.white)!@#&        windows.colorText(xStart+3,posY,windows.stringLimit(\"start\",input,sizeOfInputBar),colors.gray)!@#& !@#&        local text = mode!@#&        windows.colorTextWithBack(math.floor(xStart+managerX/2-#text/2-1),yStart,text,colors.white,colors.lightGray)!@#& !@#&        windows.square(startOfSearchBar,posY,sizeOfSearchBar,1,colors.white)!@#&        windows.colorText(startOfSearchBar,posY,\"Search\",colors.lightGray)!@#&        newObj(\"windowControls\",\"search\",\"x1\",startOfSearchBar);newObj(\"windowControls\",\"search\",\"x2\",startOfSearchBar+sizeOfSearchBar-1);newObj(\"windowControls\",\"search\",\"y\",posY)!@#&       !@#&        local colorCyka = nil!@#&        if #workPathHistory == 0 then colorCyka = colors.lightGray else colorCyka = colors.black end!@#&        windows.colorTextWithBack(xStart+1,posY,\"<\",colorCyka,colors.white)!@#& !@#&        local posX = startOfSearchBar - 7!@#&        windows.colorTextWithBack(posX,posY,\" \"..mode..\" \",colors.white,colors.lightBlue)!@#&        newObj(\"windowControls\",\"ok\",\"x1\",posX);newObj(\"windowControls\",\"ok\",\"x2\",posX+5);newObj(\"windowControls\",\"ok\",\"y\",posY)!@#&end!@#& !@#&local function drawWindow()!@#&        windows.square(xStart,yStart+3,managerX,ySizeOfAppsArea,colors.white)!@#&        drawTopBar()!@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+managerX) do!@#&                paintutils.drawPixel(x,yStart+managerY,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+managerY) do!@#&                paintutils.drawPixel(xStart+managerX,y,colors.gray)!@#&        end!@#&end!@#& !@#&------------------------------------------------------------------------------------------------------!@#& !@#&local function drawKonkretnoApp(x,y,name,backColor)!@#&        --  !@#&        newObj(\"apps\",name,\"x1\",x)!@#&        newObj(\"apps\",name,\"x2\",x+xAppSize-1)!@#&        newObj(\"apps\",name,\"y1\",y)!@#&        newObj(\"apps\",name,\"y2\",y+yAppSize-1)!@#&        newObj(\"apps\",name,\"fileFormat\",windows.getFileFormat(name))!@#& !@#&        -- !@#&        windows.drawOSIcon(x,y,workPath,name,objects[\"apps\"][name][\"fileFormat\"])!@#& !@#&        --  !@#&        term.setBackgroundColor(backColor)!@#&        if fs.isReadOnly(workPath..\"/\"..name) then!@#&                term.setTextColor(colors.red)!@#&        else!@#&                term.setTextColor(colors.black)!@#&        end!@#&        if windows.isFileHidden(name) then!@#&                term.setTextColor(colors.gray)!@#&        end!@#&        if hideFileFormat then!@#&                name = windows.hideFileFormat(name)!@#&        end!@#&        name = windows.stringLimit(\"end\",name,xAppSize,true)!@#&        windows.usualText(math.floor(x+xAppSize/2-#name/2),y+yAppSize-1,name)!@#&end!@#& !@#&local function drawApps(x,y,currentDesktop)!@#& !@#&        objects[\"apps\"] = {}!@#& !@#&        windows.square(x,y,xSizeOfAppsArea-2,ySizeOfAppsArea-2,colors.white)!@#& !@#&        local fileList = fs.list(workPath)!@#&        fileList = windows.reorganizeFilesAndFolders(workPath,fileList,true,true)!@#& !@#&        countOfDesktops = math.ceil(#fileList/(countOfAppsByY*countOfAppsByX))!@#&        local appCounter = 1 + currentDesktop * countOfAppsByY * countOfAppsByX - countOfAppsByY * countOfAppsByX!@#& !@#&        for j=1,countOfAppsByY do!@#&                for i=1,countOfAppsByX do!@#&                        if fileList[appCounter] then!@#&                                drawKonkretnoApp(x+i*(xAppSize+xSpaceBetweenApps)-(xAppSize+xSpaceBetweenApps),y+j*(yAppSize+ySpaceBetweenApps)-(yAppSize+ySpaceBetweenApps),fileList[appCounter],colors.white)!@#&                                appCounter = appCounter + 1!@#&                        else!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&------------------------------------------------------------------------------------------------------!@#& !@#&local function drawManager(x,y)!@#& !@#&        if x~=nil or y~=nil then!@#&                xStart = x!@#&                yStart = y!@#&                xStartOfDrawingApps = xStart+leftBarSize+1!@#&                yStartOfDrawingApps = yStart+4!@#&        end!@#& !@#&        currentDesktop = 1!@#&        --windows.emptyWindow(xStart,yStart,managerX,managerY,fs.getName(workPath))!@#&        drawWindow()!@#&        --windows.colorTextWithBack(xStart,yStart,\"x\",colors.black,colors.red);windows.colorTextWithBack(xStart+1,yStart,\"-\",colors.black,colors.orange);windows.colorTextWithBack(xStart+2,yStart,\"+\",colors.black,colors.lime)!@#&        drawLeftBar()!@#&        drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&        windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&end!@#& !@#&newObj(\"windowControls\",\"<\",\"x\",xStart+1);newObj(\"windowControls\",\"<\",\"y\",yStart+1)!@#& !@#&local function initializeProgram(mode1)!@#&        if mode1==\"open\" then mode = \"Open\" else mode = \"Save\" end!@#& !@#&        loadConfig()!@#&        saveConfig()!@#& !@#&        input = \"/\"..workPath!@#&        drawManager()!@#&       !@#&        local exit = false!@#&        while true do!@#& !@#&                local breakCycles = false!@#& !@#&                if exit then break end!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#& !@#&                        for key,val in pairs(objects[\"Favourites\"]) do!@#&                                if breakCycles then break end!@#& !@#&                                if clickedAtArea(x,y,objects[\"Favourites\"][key][\"x1\"],objects[\"Favourites\"][key][\"y1\"],objects[\"Favourites\"][key][\"x2\"],objects[\"Favourites\"][key][\"y1\"]) then!@#&                                       !@#&                                        if side == 1 then!@#&                                                if not fs.exists(objects[\"Favourites\"][key][\"path\"]) then fs.makeDir(key) end!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = objects[\"Favourites\"][key][\"path\"]!@#&                                                input = \"/\"..workPath!@#&                                                drawManager()!@#&                                        else!@#&                                                windows.square(xStart,objects[\"Favourites\"][key][\"y1\"],leftBarSize-1,1,colors.lightGray)!@#&                                                windows.colorText(xStart+2,objects[\"Favourites\"][key][\"y1\"],windows.stringLimit(\"end\",key,leftBarLimit),colors.white)!@#&                                                --sleep(0.2)!@#& !@#&                                                local action = context.menu(x,y,{\"Remove from sidebar\"})!@#&                                                if action == \"Remove from sidebar\" then!@#& !@#&                                                        Favourites[key] = nil!@#&                                                        saveConfig()!@#& !@#&                                                end!@#&                                                drawManager()!@#&                                        end!@#& !@#&                                        breakCycles = true!@#&                                        break!@#&                                end!@#&                        end!@#& !@#& !@#& !@#&                        for key,val in pairs(objects[\"apps\"]) do!@#&                                if breakCycles then break end!@#&                                if clickedAtArea(x,y,objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],objects[\"apps\"][key][\"x2\"],objects[\"apps\"][key][\"y2\"]) then!@#&                                       !@#&                                        if side == 1 then!@#&                                                if fs.isDir(workPath..\"/\"..key) and windows.getFileFormat(key) ~= \".app\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.blue)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.blue)!@#&                                                        sleep(0.2)!@#&                                                        workPathHistory[#workPathHistory+1] = workPath!@#&                                                        workPath = workPath..\"/\"..key!@#&                                                        input = \"/\"..workPath!@#&                                                        drawManager()!@#&                                                elseif not fs.isDir(workPath..\"/\"..key) and mode == \"Save\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.red)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.red)!@#&                                                        sleep(0.2)!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.white)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.white)!@#&                                                elseif not fs.isDir(workPath..\"/\"..key) and mode ~= \"Save\" or fs.isDir(workPath..\"/\"..key) and windows.getFileFormat(key) == \".app\" and mode ~= \"Save\" then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.blue)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.blue)!@#&                                                        sleep(0.2)!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.white)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.white)!@#&                                                        input = \"/\"..workPath..\"/\"..key!@#&                                                        drawTopBar()!@#&                                                end!@#&                                        else!@#&                                                if fs.isDir(workPath..\"/\"..key) then!@#&                                                        windows.square(objects[\"apps\"][key][\"x1\"]-1,objects[\"apps\"][key][\"y1\"],xAppSize+2,yAppSize,colors.lightGray)!@#&                                                        drawKonkretnoApp(objects[\"apps\"][key][\"x1\"],objects[\"apps\"][key][\"y1\"],key,colors.lightGray)!@#&                                               !@#&                                                        local action = context.menu(x,y,{\"Add to sidebar\"})!@#&                                                        if action == \"Add to sidebar\" then!@#& !@#&                                                                Favourites[key] = workPath..\"/\"..key!@#&                                                                saveConfig()!@#& !@#&                                                        end!@#&                                                        drawManager()!@#&                                                end!@#&                                        end!@#& !@#&                                        breakCycles = true!@#&                                        break!@#&                                end    !@#&                        end!@#& !@#&                        if clickedAtArea(x,y,objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"],objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"]) then!@#&                                if #workPathHistory > 0 then!@#&                                        windows.colorTextWithBack(objects[\"windowControls\"][\"<\"][\"x\"],objects[\"windowControls\"][\"<\"][\"y\"],\"<\",colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        workPath = workPathHistory[#workPathHistory]!@#&                                        input = \"/\"..workPath!@#&                                        workPathHistory[#workPathHistory] = nil!@#&                                        drawManager()!@#&                                end!@#&                        elseif clickedAtArea(x,y,objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],objects[\"windowControls\"][\"ok\"][\"x2\"],objects[\"windowControls\"][\"ok\"][\"y\"]) then!@#&                                windows.colorTextWithBack(objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],\" \"..mode..\" \",colors.white,colors.blue)!@#&                                sleep(0.3)!@#&                                return string.sub(input,2,-1)!@#&                        elseif clickedAtArea(x,y,objects[\"windowControls\"][\"search\"][\"x1\"],objects[\"windowControls\"][\"search\"][\"y\"],objects[\"windowControls\"][\"search\"][\"x2\"],objects[\"windowControls\"][\"search\"][\"y\"]) then!@#&                                local searchResult = windows.search(xEnd-27,yStart,28,2,\"Search\")!@#&                                if searchResult ~= nil then!@#&                                        --windows.error(\"=\"..searchResult)!@#&                                        if fs.isDir(searchResult) then!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = searchResult!@#&                                                input = \"/\"..workPath!@#&                                        else!@#&                                                workPathHistory[#workPathHistory+1] = workPath!@#&                                                workPath = string.sub(searchResult,1,#searchResult-#fs.getName(searchResult)-1)!@#&                                                input = \"/\"..workPath..\"/\"..fs.getName(searchResult)!@#&                                        end!@#&                                end!@#&                                drawManager()!@#& !@#&                        elseif clickedAtArea(x,y,startOfInputBar,yStart+1,endOfInputBar,yStart+1) and mode ~= \"Open\" then!@#& !@#&                                local cursor = nil!@#& !@#&                                input = input..\"/\"!@#&                                drawTopBar()!@#& !@#&                                local accept = false!@#& !@#&                                while true do!@#& !@#&                                        cursor = startOfInputBar+#input!@#&                                        if cursor > startOfInputBar+sizeOfInputBar then cursor = startOfInputBar+sizeOfInputBar-1 end!@#&                                       !@#&                                        term.setCursorPos(cursor,yStart+1)!@#&                                        term.setTextColor(colors.black)!@#&                                        term.setCursorBlink(true)!@#& !@#&                                        local event1,side1,x1,y1 = os.pullEvent()!@#&                                        if event1 == \"char\" then!@#& !@#&                                                input = input..side1!@#&                                                drawTopBar()!@#&                                        elseif event1 == \"key\" then!@#&                                                if side1 == 28 then!@#&                                                        windows.colorTextWithBack(objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],\" \"..mode..\" \",colors.white,colors.blue)!@#&                                                        sleep(0.3)!@#&                                                        accept = true!@#&                                                        break!@#&                                                elseif side1 == 14 then!@#&                                                        if #input > 1 then!@#&                                                                input = string.sub(input,1,-2)!@#&                                                                drawTopBar()!@#&                                                        end!@#& !@#&                                                end!@#&                                        elseif event1 == \"mouse_click\" then!@#&                                                if clickedAtArea(x1,y1,objects[\"windowControls\"][\"ok\"][\"x1\"],objects[\"windowControls\"][\"ok\"][\"y\"],objects[\"windowControls\"][\"ok\"][\"x2\"],objects[\"windowControls\"][\"ok\"][\"y\"]) then!@#&                                                        accept = true!@#&                                                        drawTopBar()!@#&                                                else!@#&                                                        drawTopBar()!@#&                                                        break!@#&                                                end!@#&                                        end!@#& !@#&                                        term.setCursorBlink(false)!@#&                                end!@#& !@#&                                term.setCursorBlink(false)!@#& !@#&                                if accept then return string.sub(input,2,-1) end!@#& !@#&                        end!@#& !@#&                elseif event == \"mouse_scroll\" then!@#&                        if clickedAtArea(x,y,xStart+leftBarSize,yStart+1,xEnd-1,yEnd) then!@#&                                if side == 1 then!@#&                                        currentDesktop = currentDesktop + 1!@#&                                        if currentDesktop > countOfDesktops then!@#&                                                currentDesktop = countOfDesktops!@#&                                        else!@#&                                                drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&                                                windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&                                        end!@#&                                else!@#&                                        currentDesktop = currentDesktop - 1!@#&                                        if currentDesktop < 1 then!@#&                                                currentDesktop = 1!@#&                                        else!@#&                                                drawApps(xStartOfDrawingApps,yStartOfDrawingApps,currentDesktop)!@#&                                                windows.scrollBar(xEnd,yStart+3,managerY-3,countOfDesktops,currentDesktop,colors.lightGray,colors.lightBlue)!@#&                                        end!@#&                                end!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                return string.sub(input,2,-1)!@#&                        end!@#&                end!@#&        end!@#& !@#&end!@#& !@#&function open(cykaWorkPath)!@#&        if cykaWorkPath then workPath = cykaWorkPath end!@#& !@#&        for i=(1-managerY),1,2 do!@#&                drawManager(2,i)!@#&                sleep(0)!@#&        end!@#& !@#&        return initializeProgram(\"open\")!@#&end!@#& !@#&function save(cykaWorkPath)!@#&        if cykaWorkPath then workPath = cykaWorkPath end!@#& !@#&        for i=(1-managerY),1,2 do!@#&                drawManager(2,i)!@#&                sleep(0)!@#&        end!@#& !@#&        return initializeProgram(\"save\")!@#&end!@#& !@#&-------------------------------------!@#& !@#&--[[windows.clearScreen(colors.black)!@#& !@#&local path = open(\"\")!@#& !@#&term.setTextColor(colors.white)!@#&windows.clearScreen(colors.black)!@#&if path == \"\" then!@#&        windows.usualText(2,2,\"NIL!!\")!@#&else!@#&        windows.usualText(2,2,\"Path=\"..path)!@#&end]]",["image"]="function draw(startX,startY,image)!@#&        local Colors = {!@#&                [\"0\"] = 1,!@#&                [\"1\"] = 2,!@#&                [\"2\"] = 4,!@#&                [\"3\"] = 8,!@#&                [\"4\"] = 16,!@#&                [\"5\"] = 32,!@#&                [\"6\"] = 64,!@#&                [\"7\"] = 128,!@#&                [\"8\"] = 256,!@#&                [\"9\"] = 512,!@#&                [\"a\"] = 1024,!@#&                [\"b\"] = 2048,!@#&                [\"c\"] = 4096,!@#&                [\"d\"] = 8192,!@#&                [\"e\"] = 16384,!@#&                [\"f\"] = 32768!@#&        }!@#&        local Pixels = {}!@#& !@#&        local function convert(mode,color)!@#&                if mode == \"from cc\" then!@#&                        for key,value in pairs(Colors) do!@#&                                if color == value then!@#&                                        return key!@#&                                end!@#&                        end!@#&                else!@#&                        if color == \"#\" then!@#&                                return \"0\"!@#&                        else!@#&                                return Colors[color]!@#&                        end!@#&                end!@#&        end!@#& !@#&        local function load(path)!@#&                local file = fs.open(path,\"r\")!@#&                local lineCounter = 1!@#&                while true do!@#&                        local line = file.readLine()!@#&                        Pixels[lineCounter]={}!@#&                        if line ~= nil then!@#&                                for i=1,#line,3 do!@#&                                        Pixels[lineCounter][(i+2)/3]={}!@#&                                        Pixels[lineCounter][(i+2)/3][\"symbol\"] = string.sub(line,i,i)!@#&                                        Pixels[lineCounter][(i+2)/3][\"textColor\"] = convert(\"to cc\",string.sub(line,i+1,i+1))!@#&                                        Pixels[lineCounter][(i+2)/3][\"backColor\"] = convert(\"to cc\",string.sub(line,i+2,i+2))!@#&                                end!@#&                                lineCounter = lineCounter + 1!@#&                        else!@#&                                break!@#&                        end!@#&                end!@#&                file.close()!@#&        end!@#& !@#&        load(image)!@#& !@#&        for y=1,#Pixels do!@#&                for x=1,#Pixels[y] do!@#&                        if Pixels[y][x][\"symbol\"] ~= \"#\" then!@#&                                term.setTextColor(Pixels[y][x][\"textColor\"])!@#&                                term.setBackgroundColor(Pixels[y][x][\"backColor\"])!@#&                                term.setCursorPos(startX+x-1,startY+y-1)!@#&                                term.write(Pixels[y][x][\"symbol\"])!@#&                        end!@#&                end!@#&        end!@#& !@#&end",["encryptor"]="os.loadAPI(\"System/API/config\")!@#& !@#&local symbols = {!@#&        \"a\",!@#&        \"b\",!@#&        \"c\",!@#&        \"d\",!@#&        \"e\",!@#&        \"f\",!@#&        \"g\",!@#&        \"h\",!@#&        \"i\",!@#&        \"j\",!@#&        \"k\",!@#&        \"l\",!@#&        \"m\",!@#&        \"n\",!@#&        \"o\",!@#&        \"p\",!@#&        \"q\",!@#&        \"r\",!@#&        \"s\",!@#&        \"t\",!@#&        \"u\",!@#&        \"v\",!@#&        \"w\",!@#&        \"x\",!@#&        \"y\",!@#&        \"z\",!@#&        \"0\",!@#&        \"1\",!@#&        \"2\",!@#&        \"3\",!@#&        \"4\",!@#&        \"5\",!@#&        \"6\",!@#&        \"7\",!@#&        \"8\",!@#&        \"9\",!@#&}!@#& !@#&local symbolsFromConfig = {}!@#&for i=1,#symbols do!@#&        symbolsFromConfig[symbols[i]] = config.read(\"System/API/encryptor.cfg\",symbols[i])!@#&end!@#& !@#&local function stringReplace(stroka,chto,nachto)!@#&        while true do!@#&                local starting = 1!@#&                local starting,ending = string.find(stroka,chto,starting)!@#&                if ending ~= nil then!@#&                        stroka = string.sub(stroka,1,starting-1)..nachto..string.sub(stroka,ending+1,-1)!@#&                        starting = starting + #nachto!@#&                else!@#&                        break!@#&                end!@#&        end!@#&        return stroka!@#&end!@#& !@#&function code(stroka)!@#&        local array = {}!@#&        for i=1,#stroka do!@#&                array[i] = string.sub(stroka,i,i)!@#&                for key,val in pairs(symbolsFromConfig) do!@#&                        if array[i] == key then array[i] = val end!@#&                end!@#&        end!@#&        local text = \"\"!@#&        for i=1,#array do!@#&                text = text..array[i]!@#&        end!@#&        return text!@#&end!@#& !@#&function decode(stroka)!@#&        for key,val in pairs(symbolsFromConfig) do!@#&                stroka = stringReplace(stroka,val,key)!@#&        end!@#&        return stroka!@#&end!@#& !@#& !@#&--[[print(\" \")!@#&local cyka = \"hello world! heh kek lol \"!@#&print(\"Standart=\"..cyka)!@#&print(\" \")!@#&local codedcyka = code(cyka)!@#&print(\"Coded=\"..codedcyka)!@#&print(\" \")!@#&local decodedcyka = decode(codedcyka)!@#&print(\"Encoded=\"..decodedcyka)!@#&print(\" \")]]",["config"]="function read(pathToConfig,whatToRead)!@#&        if not fs.exists(pathToConfig) then error(\"No such file\") end!@#&        local file = fs.open(pathToConfig,\"r\")!@#&        while true do!@#&                local line = file.readLine()!@#&                if line ~= nil then!@#&                        local key, value = string.match(line,\"(.*)=(.*)\")!@#&                        if value ~= nil and key == whatToRead then!@#&                                file.close()!@#&                                return value!@#&                        end!@#&                else!@#&                        file.close()!@#&                        break!@#&                end!@#&        end!@#&end!@#& !@#&function write(pathToConfig,key,value)!@#&        if not fs.exists(pathToConfig) then!@#&                local file = fs.open(pathToConfig,\"w\")!@#&                file.close()!@#&        end!@#& !@#&        local file = fs.open(pathToConfig,\"r\")!@#&        local Massiv = {}!@#&       !@#&        local lineCounter = 1!@#&        while true do!@#&                local line = file.readLine()!@#&                if line ~= nil then!@#&                        Massiv[lineCounter] = line!@#&                else!@#&                        file.close()!@#&                        break!@#&                end!@#&                lineCounter = lineCounter + 1!@#&        end!@#& !@#&        local success = false!@#&        for i=1,#Massiv do!@#&                local key1, value1 = string.match(Massiv[i],\"(.*)=(.*)\")!@#&                if value1 ~= nil and key1 == key then!@#&                        Massiv[i] = key..\"=\"..value!@#&                        success = true!@#&                end!@#&        end!@#& !@#&        if success == false then Massiv[#Massiv+1] = key..\"=\"..value end!@#& !@#&        local file = fs.open(pathToConfig,\"w\")!@#&        for i=1,#Massiv do!@#&                file.writeLine(Massiv[i])!@#&        end!@#&        file.close()!@#&end",["windows"]=" !@#& !@#&local xSize,ySize = term.getSize()!@#&local centerX,centerY = math.floor(xSize/2),math.floor(ySize/2)!@#& !@#&-- !@#&function findPeripheral(whatToFind)!@#&  local PeriList = peripheral.getNames()!@#&  for i=1,#PeriList do!@#&    if peripheral.getType(PeriList[i]) == whatToFind then!@#&      return PeriList[i]!@#&    end!@#&  end!@#&end!@#& !@#&--  !@#&function findWirelessModem()!@#&        local periList = rs.getSides() --peripheral.getNames()!@#&        for i=1,#periList do!@#&                if peripheral.getType(periList[i]) == \"modem\" then!@#&                        local govno = peripheral.wrap(periList[i])!@#&                        --if govno.isWireless() then!@#&                        return periList[i]!@#&                        --end!@#&                end!@#&        end!@#&end!@#& !@#&--   !@#&function clickedAtArea(x,y,sx,sy,ex,ey)!@#&    if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&    return false!@#&end!@#& !@#&-- ,  !@#&function toboolean(s)!@#&        if s == \"true\" then!@#&                return true!@#&        else!@#&                return false!@#&        end!@#&end!@#& !@#&-- !@#&function colorText(x,y,text,textColor)!@#&        term.setTextColor(textColor)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--   !@#&function colorTextWithBack(x,y,text,textColor,backColor)!@#&        term.setTextColor(textColor)!@#&        term.setBackgroundColor(backColor)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--    !@#&function usualText(x,y,text)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--       !@#&function centerText(how,coord,text,textColor,backColor)!@#&        term.setTextColor(textColor)!@#&        term.setBackgroundColor(backColor)!@#&        if how == \"xy\" then!@#&                term.setCursorPos(math.floor(xSize/2-#text/2),math.floor(ySize/2))!@#&        elseif how == \"x\" then!@#&                term.setCursorPos(math.floor(xSize/2-#text/2),coord)!@#&        elseif how == \"y\" then!@#&                term.setCursorPos(coord,math.floor(ySize/2))!@#&        end!@#&        term.write(text)!@#&end!@#& !@#&--   !@#&function square(x1,y1,width,height,color)!@#&        local string = string.rep(\" \",width)!@#&        term.setBackgroundColor(color)!@#&        for y=y1,(y1+height-1) do!@#&                usualText(x1,y,string)!@#&        end!@#&end!@#&function circle(cx, cy, radius, char, backColor, textColor)!@#&        local x = radius!@#&    local y = 0!@#&    local radiusError = 1 - x!@#&    term.setTextColor(textColor)!@#&    term.setBackgroundColor(backColor)!@#&    while (x >= y) do!@#&        usualText(x + cx, y + cy, char)!@#&        usualText(y + cx, x + cy, char)!@#&        usualText(-x + cx, y + cy, char)!@#&        usualText(-y + cx, x + cy, char)!@#&        usualText(-x + cx, -y + cy, char)!@#&        usualText(-y + cx, -x + cy, char)!@#&        usualText(x + cx, -y + cy, char)!@#&        usualText(y + cx, -x + cy, char)!@#&        y = y + 1!@#&        if (radiusError < 0) then!@#&            radiusError = radiusError + (2 * y + 1)!@#&        else!@#&            x = x - 1!@#&            radiusError = radiusError + (2 * (y - x + 1))!@#&        end!@#&    end!@#&end!@#& !@#&--  !@#&function clearScreen(color)!@#&        term.setBackgroundColor(color)!@#&        term.clear()!@#&end!@#& !@#&--  !@#&function fadeIn(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.white)!@#&        sleep(time)!@#&end!@#& !@#&--  !@#&function fadeOut(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.black)!@#&        sleep(time)!@#&        term.setCursorPos(1,1)!@#&        term.setTextColor(colors.white)!@#&end!@#& !@#&--    !@#&function emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#&        --DRAW WINDOW!@#&        square(xStart,yStart,xWindowSize,1,colors.lightGray)!@#&        colorText(math.floor(xStart+xWindowSize/2-#title/2),yStart,title,colors.white)!@#& !@#&        square(xStart,yStart+1,xWindowSize,yWindowSize-1,colors.white)!@#&       !@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+xWindowSize) do!@#&                paintutils.drawPixel(x,yStart+yWindowSize,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+yWindowSize) do!@#&                paintutils.drawPixel(xStart+xWindowSize,y,colors.gray)!@#&        end!@#&end!@#& !@#&--   !@#&function sampleWindow(xStart,yStart,xWindowSize,yWindowSize)!@#&        square(xStart,yStart,xWindowSize,yWindowSize,colors.white)!@#&        --DRAW SHADOW!@#&        for x=(xStart+1),(xStart+xWindowSize) do!@#&                paintutils.drawPixel(x,yStart+yWindowSize,colors.gray)!@#&        end!@#&        for y=(yStart+1),(yStart+yWindowSize) do!@#&                paintutils.drawPixel(xStart+xWindowSize,y,colors.gray)!@#&        end!@#&end!@#& !@#&--  !@#&function stringLimit(mode,text,size,noDots)!@#&        if string.len(text)<=size then return text end!@#&        if mode == \"start\" then!@#&                if noDots then!@#&                        return string.sub(text,#text-size+1,-1)!@#&                else!@#&                        return \"...\"..string.sub(text,#text-size+4,-1)!@#&                end!@#&        else!@#&                if noDots then!@#&                        return string.sub(text,1,size)!@#&                else!@#&                        return string.sub(text,1,size-3)..\"...\"!@#&                end!@#&        end!@#&end!@#& !@#&--  !@#&function getFileFormat(path)!@#&        local name = fs.getName(path)!@#&        local starting,ending = string.find(name,\"(.)%.[%d%w]*$\")!@#&        if starting == nil then!@#&                return nil!@#&        else!@#&                return string.sub(name,starting+1,-1)!@#&        end!@#&end!@#& !@#&--,   !@#&function isFileHidden(path)!@#&        local name = fs.getName(path)!@#&        local starting,ending = string.find(name,\"^%.(.*)$\")!@#&        if starting == nil then!@#&                return false!@#&        else!@#&                return true!@#&        end!@#&end!@#& !@#&--  !@#&function hideFileFormat(path)!@#&        local name = fs.getName(path)!@#&        local fileFormat = getFileFormat(name)!@#&        if fileFormat == nil then!@#&                return name!@#&        else!@#&                return string.sub(name,1,#name-#fileFormat)!@#&        end!@#&end!@#& !@#&--    !@#&function getFileSize(path)!@#&        local allFilesSize = 0!@#&        if fs.isDir(path) then!@#&                local fileList = fs.list(path)!@#&                for i=1,#fileList do!@#&                        allFilesSize = allFilesSize + getFileSize(path..\"/\"..fileList[i])!@#&                end!@#&        else!@#&                allFilesSize = allFilesSize + fs.getSize(path)!@#&        end!@#&        return allFilesSize!@#&end!@#& !@#&--  !@#&function getFileType(path)!@#&        local fileTypes = {!@#&                [\".png\"] = \"Image\",!@#&                [\".cfg\"] = \"Config\",!@#&                [\".zip\"] = \"Archive\",!@#&                [\".app\"] = \"Application\",!@#&        }!@#& !@#&        local currentFileType = nil!@#& !@#&        local fileFormat = getFileFormat(path)!@#&        if fileFormat == nil then!@#&                if fs.isDir(path) then!@#&                        currentFileType = \"Folder\"!@#&                else!@#&                        currentFileType = \"Lua script\"!@#&                end!@#&        else!@#&                currentFileType = fileTypes[fileFormat] or fileFormat!@#&        end!@#&       !@#&        return currentFileType!@#&end!@#& !@#&--   -!@#&function reorganizeFilesAndFolders(workPath,massivSudaPihay,showHiddenFiles,showSystemFolders)!@#&        local reorganizedMassiv = {}!@#&        local function doGovno(i)!@#&                if showHiddenFiles then!@#&                        reorganizedMassiv[#reorganizedMassiv+1] = massivSudaPihay[i]!@#&                else!@#&                        if not windows.isFileHidden(workPath..\"/\"..massivSudaPihay[i]) then!@#&                                reorganizedMassiv[#reorganizedMassiv+1] = massivSudaPihay[i]!@#&                        end!@#&                end!@#&        end!@#&        local filePath = nil!@#&        for i=1,#massivSudaPihay do!@#&                filePath = workPath..\"/\"..massivSudaPihay[i]!@#&                if fs.isDir(filePath) and windows.getFileFormat(filePath) ~= \".app\" then!@#&                        if showSystemFolders then!@#&                                doGovno(i)!@#&                        else!@#&                                if massivSudaPihay[i] ~= \"rom\" and massivSudaPihay[i] ~= \"System\" then!@#&                                        --windows.attention({\"massiv[i] = \"..massivSudaPihay[i]},{\"heh\"})!@#&                                        doGovno(i)!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        for i=1,#massivSudaPihay do!@#&                filePath = workPath..\"/\"..massivSudaPihay[i]!@#&                if not fs.isDir(filePath) and massivSudaPihay[i] ~= \"OS\" or fs.isDir(filePath) and windows.getFileFormat(filePath) == \".app\" then!@#&                        doGovno(i)!@#&                end!@#&        end!@#&        return reorganizedMassiv!@#&end!@#& !@#&--   !@#&function drawOSIcon(xIconPos,yIconPos,workPath,name,fileFormat)!@#&        --   !@#&        if not fs.isDir(workPath..\"/\"..name) then!@#&                if fileFormat == \".png\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/image.png\")!@#&                elseif fileFormat == \".cfg\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/config.png\")!@#&                elseif fileFormat == \".zip\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/zip.png\")!@#&                else!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/default.png\")!@#&                end!@#&        --  !@#&        else!@#&                local iconPath = workPath..\"/\"..name..\"/Resources/icon.png\"!@#&                if fileFormat == \".app\" and fs.exists(iconPath) then!@#&                        image.draw(xIconPos,yIconPos,iconPath)!@#&                elseif string.sub(name,1,4)==\"disk\" then!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/disk.png\")!@#&                else!@#&                        image.draw(xIconPos,yIconPos,\"System/OS/Icons/folder.png\")!@#&                end!@#&        end!@#&end!@#& !@#&--  !@#&local function correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#&        if xStart == \"auto\" then!@#&                xStart = math.floor(xSize/2 - xWindowSize/2)!@#&        end!@#&        if yStart == \"auto\" then!@#&                yStart = math.floor(ySize/2 - yWindowSize/2)!@#&        end!@#&        return xStart,yStart!@#&end!@#& !@#&-- !@#&function button(x,y,xOffset,yOffset,text,textColor,backColor)!@#&        local width = xOffset*2+#text!@#&        local height = yOffset*2+1!@#&        x,y = correctStartCoords(x,y,width,height)!@#&        square(x,y,width,height,backColor)!@#&        colorText(x+xOffset,y+yOffset,text,textColor)!@#&        return x,y,x+width-1,y+height-1!@#&end!@#& !@#&--  !@#&local function drawProgressBar(xStart,yStart,width,height,frontColor,backColor,percent)!@#&        local doneSize = math.ceil(percent/100*width)!@#& !@#&        square(xStart,yStart,width,height,backColor)!@#&        square(xStart,yStart,doneSize,height,frontColor)!@#&end!@#& !@#&--  !@#&function scrollBar(xStart,yStart,height,countOfAllElements,currentElement,backColor,frontColor)!@#&        local percent = 1/countOfAllElements!@#&        local sizeOfScrollBar = math.ceil(percent * height)!@#&        local displayBarFrom = math.floor(yStart + height*((currentElement-1)/countOfAllElements))!@#& !@#&        for i=yStart,(yStart+height-1) do!@#&                paintutils.drawPixel(xStart,i,backColor)!@#&        end!@#& !@#&        for i=displayBarFrom,(displayBarFrom+sizeOfScrollBar-1) do!@#&                paintutils.drawPixel(xStart,i,frontColor)!@#&        end!@#&end!@#& !@#&-- -   !@#&local function searchInAllFiles(path,whatToFind)!@#& !@#&        local function poiskSovpadeniya(name)!@#&                local starting,ending = string.find(string.lower(name),string.lower(whatToFind))!@#&                if starting == nil then!@#&                        return false!@#&                else!@#&                        return true!@#&                end!@#&        end!@#& !@#&        local searchMassiv = {}!@#& !@#&        local function createFileMassiv(path,whatToFind)!@#&                local fileList = fs.list(path)!@#&                for i=1,#fileList do!@#&                        if fs.isDir(path..\"/\"..fileList[i]) then!@#&                                if poiskSovpadeniya(fileList[i]) then!@#&                                        searchMassiv[#searchMassiv+1] = {[\"path\"]=path,[\"name\"]=fileList[i],[\"isDir\"]=true,[\"fileSize\"]=getFileSize(path..\"/\"..fileList[i]),[\"fileType\"]=getFileType(path..\"/\"..fileList[i]),[\"fileFormat\"]=getFileFormat(path..\"/\"..fileList[i])}!@#&                                end!@#&                                createFileMassiv(path..\"/\"..fileList[i],whatToFind)!@#&                        else!@#&                                if poiskSovpadeniya(fileList[i]) then!@#&                                        searchMassiv[#searchMassiv+1] = {[\"path\"]=path,[\"name\"]=fileList[i],[\"isDir\"]=false,[\"fileSize\"]=getFileSize(path..\"/\"..fileList[i]),[\"fileType\"]=getFileType(path..\"/\"..fileList[i]),[\"fileFormat\"]=getFileFormat(path..\"/\"..fileList[i])}!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        createFileMassiv(path,whatToFind)!@#&        return searchMassiv!@#& !@#&end!@#& !@#&--       &6, &c, &a  ..!@#&local colorCodes = {!@#&        {[\"code\"] = \"&0\", [\"color\"] = 1},!@#&        {[\"code\"] = \"&1\", [\"color\"] = 2},!@#&        {[\"code\"] = \"&2\", [\"color\"] = 4},!@#&        {[\"code\"] = \"&3\", [\"color\"] = 8},!@#&        {[\"code\"] = \"&4\", [\"color\"] = 16},!@#&        {[\"code\"] = \"&5\", [\"color\"] = 32},!@#&        {[\"code\"] = \"&6\", [\"color\"] = 64},!@#&        {[\"code\"] = \"&7\", [\"color\"] = 128},!@#&        {[\"code\"] = \"&8\", [\"color\"] = 256},!@#&        {[\"code\"] = \"&9\", [\"color\"] = 512},!@#&        {[\"code\"] = \"&a\", [\"color\"] = 1024},!@#&        {[\"code\"] = \"&b\", [\"color\"] = 2048},!@#&        {[\"code\"] = \"&c\", [\"color\"] = 4096},!@#&        {[\"code\"] = \"&d\", [\"color\"] = 8192},!@#&        {[\"code\"] = \"&e\", [\"color\"] = 16384},!@#&        {[\"code\"] = \"&f\", [\"color\"] = 32768},!@#&}!@#& !@#&function foramattedText(text)!@#&        local color = colors.white!@#&        term.setTextColor(color)!@#&        local sText = #text!@#&        local searchFrom = 1!@#& !@#&        local exit = false!@#&        while true do!@#&                if exit then break end!@#&                local founded = false!@#&                local s,e = string.find(text,\"&\",searchFrom)!@#&                if s then!@#&                        local code = string.sub(text,s,s+1)!@#&                        for i=1,16 do!@#&                                if code == colorCodes[i][\"code\"] then!@#& !@#&                                        local cyka = string.sub(text,searchFrom,s-1)!@#&                                        term.write(cyka)!@#& !@#&                                        color = colorCodes[i][\"color\"]!@#&                                        term.setTextColor(color)!@#& !@#&                                        founded = true!@#&                                        searchFrom = searchFrom + #cyka + 2!@#&                                        break!@#&                                end!@#&                        end!@#&                end!@#&               !@#&                if not founded then!@#&                        term.write(string.sub(text,searchFrom,-1))!@#&                        exit = true!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function error(text1)!@#&       !@#&        local title = \"Error\"!@#&        local limit = xSize - 16 - 11!@#&        local sizeOfText1 = #text1!@#& !@#&        local parsedErr = {}!@#&        for i=1,(math.ceil(sizeOfText1/limit)) do!@#&                parsedErr[#parsedErr+1] = string.sub(text1,i*limit+1-limit,i*limit)!@#&        end!@#& !@#&        local theLongestElement = #title!@#&        for i=1,#parsedErr do!@#&                local size = #parsedErr[i]!@#&                if size > theLongestElement then theLongestElement = size end!@#&        end!@#&       !@#&        local xWindowSize = 9 + theLongestElement + 2!@#&        local yWindowSize = 2 + 1 + 1 + #parsedErr + 3!@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --DRAW ICON!@#&        paintutils.drawPixel(xStart+4,yStart+2,colors.red)!@#&        paintutils.drawPixel(xStart+3,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+4,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+5,yStart+3,colors.red)!@#&        paintutils.drawPixel(xStart+2,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+3,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+4,yStart+4,colors.red)!@#&        paintutils.drawPixel(xStart+5,yStart+4,colors.red)!@#&       !@#&        paintutils.drawPixel(xStart+6,yStart+4,colors.red)!@#&        colorText(xStart+4,yStart+3,\"!\",colors.white)!@#&       !@#&        --ERROR TEXT!@#&        term.setBackgroundColor(colors.white)!@#& !@#&        colorText(xStart+9,yStart+2,title,colors.gray)!@#& !@#&        for i=1,#parsedErr do!@#&                colorText(xStart+9,yStart+3+i,parsedErr[i],colors.lightGray)!@#&        end!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&        drawButton(colors.lightBlue,colors.black)!@#&       !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function attention(text1,text2)!@#& !@#&        local sizeOfText1 = #text1!@#&        local sizeOfText2 = #text2!@#& !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #text1[i] > theLongestElement then theLongestElement = #text1[i] end!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if #text2[i] > theLongestElement then theLongestElement = #text2[i] end!@#&        end!@#& !@#&        local xWindowSize = 9 + theLongestElement + 2!@#&        local yWindowSize = 2 + sizeOfText1 + 1 + sizeOfText2 + 3!@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --DRAW ICON!@#&        paintutils.drawPixel(xStart+4,yStart+2,colors.yellow)!@#&        paintutils.drawPixel(xStart+3,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+4,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+5,yStart+3,colors.yellow)!@#&        paintutils.drawPixel(xStart+2,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+3,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+4,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+5,yStart+4,colors.yellow)!@#&        paintutils.drawPixel(xStart+6,yStart+4,colors.yellow)!@#&        colorText(xStart+4,yStart+3,\"!\",colors.white)!@#&       !@#&        --ERROR TEXT!@#&        term.setBackgroundColor(colors.white)!@#&        for i=1,sizeOfText1 do!@#&                colorText(xStart+9,yStart+1+i,text1[i],colors.gray)!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                colorText(xStart+9,yStart+3+i,text2[i],colors.lightGray)!@#&        end!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&        drawButton(colors.lightBlue,colors.black)!@#&       !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                elseif event == \"key\" then!@#&                        if side == 28 then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------!@#& !@#&function input(...)!@#&       !@#&        local xStart = arg[1]!@#&        local yStart = arg[2]!@#&        local title = arg[3]!@#&        local sizeOfInputRow = arg[4]!@#& !@#&        local sizeOfText1 = #arg-4!@#& !@#&        local Inputs = {}!@#& !@#&        local allowToPressOk = true!@#& !@#&        local inputCounter = 1!@#& !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #arg[i+4][1] > theLongestElement then theLongestElement = #arg[i+4][1] end!@#&        end!@#& !@#&        local xWindowSize = 2 + theLongestElement + 1 + sizeOfInputRow + 2!@#&        local yWindowSize = 2 + sizeOfText1 * 2 + 1 + 1!@#& !@#&        xStart, yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        --    , !@#&        for i=1,sizeOfText1 do!@#&                Inputs[i]=arg[i+4][2]!@#&        end!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        --BUTTON!@#&        local function drawButton(color,color2)!@#&                for x=(xStart+xWindowSize-8),(xStart+xWindowSize-3) do!@#&                        paintutils.drawPixel(x,yStart+yWindowSize-2,color)!@#&                end!@#&                colorText(xStart+xWindowSize-6,yStart+yWindowSize-2,\"OK\",color2)!@#&        end!@#&       !@#&        local function drawInputs()!@#&                for i=1,sizeOfText1 do!@#&                        local xPosOfInput = xStart+xWindowSize - 2 - sizeOfInputRow!@#&                        local yPosOfInput = yStart+i*2!@#& !@#&                        local inputArgument = arg[i+4]!@#& !@#&                        term.setBackgroundColor(colors.white)!@#&                        if inputCounter == i then!@#&                                colorText(xStart+2,yPosOfInput,inputArgument[1],colors.gray)!@#&                        else!@#&                                colorText(xStart+2,yPosOfInput,inputArgument[1],colors.lightGray)!@#&                        end!@#& !@#&                        square(xPosOfInput,yPosOfInput,sizeOfInputRow,1,colors.lightGray)!@#&                        newObj(\"inputs\",i,xPosOfInput,yPosOfInput,sizeOfInputRow,1)!@#& !@#&                        if Inputs[i] ~= nil then!@#&                                if inputArgument[3] == nil then!@#&                                        colorText(xPosOfInput,yPosOfInput,stringLimit(\"start\",Inputs[i],sizeOfInputRow),colors.black)!@#&                                else!@#&                                        colorText(xPosOfInput,yPosOfInput,stringLimit(\"start\",string.rep(\"*\",#Inputs[i]),sizeOfInputRow),colors.black)!@#&                                end!@#&                        end!@#&                       !@#&                        if inputCounter > sizeOfText1 then allowToPressOk = true end!@#&                end!@#& !@#&                if allowToPressOk then!@#&                        drawButton(colors.lightBlue,colors.black)!@#&                else!@#&                        drawButton(colors.lightGray,colors.black)!@#&                end!@#&        end!@#& !@#&        drawInputs()!@#&       !@#&        local currentInput = \"\"!@#& !@#&        while true do!@#&                if Inputs[inputCounter] ~= nil then currentInput = Inputs[inputCounter] end!@#& !@#&                term.setCursorBlink(false)!@#&                drawInputs(inputCounter)!@#&                term.setCursorBlink(true)!@#& !@#&                if #currentInput < sizeOfInputRow and inputCounter <= sizeOfText1 then!@#&                        term.setCursorPos(xStart+xWindowSize-2-sizeOfInputRow+#currentInput,yStart+inputCounter*2)!@#&                elseif #currentInput >= sizeOfInputRow and inputCounter <= sizeOfText1 then!@#&                        term.setCursorPos(xStart+xWindowSize-3,yStart+inputCounter*2)!@#&                else!@#&                        term.setCursorBlink(false)!@#&                end!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"key\" then!@#&                        --!@#&                        if side == 28 then!@#&                                if currentInput ~= \"\" then!@#&                                        currentInput = \"\"!@#&                                else!@#&                                        Inputs[inputCounter] = currentInput    !@#&                                end!@#& !@#&                                if inputCounter < sizeOfText1 then!@#&                                        inputCounter = inputCounter + 1!@#&                                else!@#&                                        term.setCursorBlink(false)!@#&                                        drawButton(colors.blue,colors.white)!@#&                                        sleep(0.2)!@#&                                        return Inputs!@#&                                end!@#&                        --!@#&                        elseif side == 14 then!@#&                                currentInput = string.sub(currentInput,1,-2)!@#&                                Inputs[inputCounter] = currentInput!@#&                        -- -!@#&                        elseif side == 200 then!@#&                                inputCounter = inputCounter - 1!@#&                                if inputCounter < 1 then inputCounter = 1 end!@#&                        elseif side == 208 then!@#&                                inputCounter = inputCounter + 1!@#&                                if inputCounter > #Inputs then inputCounter = #Inputs end!@#&                        end!@#&                elseif event == \"mouse_click\" then!@#&                        term.setCursorBlink(false)!@#&                        if x>=xStart+xWindowSize-8 and x<=xStart+xWindowSize-3 and y == yStart+yWindowSize-2 and allowToPressOk == true then!@#&                                drawButton(colors.blue,colors.white)!@#&                                sleep(0.2)!@#&                                return Inputs!@#&                        end!@#&                        for key,val in pairs(Objects[\"inputs\"]) do!@#&                                if x>=Objects[\"inputs\"][key][\"x1\"] and x<=Objects[\"inputs\"][key][\"x2\"] and y==Objects[\"inputs\"][key][\"y1\"] then!@#&                                        inputCounter = key!@#&                                        break!@#&                                end!@#&                        end!@#&                elseif event == \"char\" then!@#&                        currentInput = currentInput..side!@#&                        Inputs[inputCounter] = currentInput!@#&                elseif event == \"paste\" then!@#&                        currentInput = currentInput..side!@#&                        Inputs[inputCounter] = currentInput!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function tv(speed)!@#&        term.setBackgroundColor(colors.black)!@#&        for i=1,centerY do!@#&                term.setCursorPos(1,i)!@#&                term.clearLine()!@#&                term.setCursorPos(1,ySize-i+1)!@#&                term.clearLine()!@#&                sleep(speed)!@#&        end!@#&        for i=1,centerX do!@#&                paintutils.drawPixel(i,centerY+1,colors.black)!@#&                paintutils.drawPixel(xSize-i+1,centerY+1,colors.black)!@#&                sleep(speed)!@#&        end!@#&        sleep(0.2)!@#&        clearScreen(colors.black)!@#&        term.setTextColor(colors.white)!@#&        term.setCursorPos(1,1)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function select(...)!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                --if not Objects[class] then Objects[class] = {} end!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        local function drawButton(x,y,name,textColor,backColor)!@#&                local sizeOfButton = 2+#name+2!@#&                square(x,y,sizeOfButton,1,backColor)!@#&                colorText(x+2,y,name,textColor)!@#&                newObj(\"buttons\",name,x,y,sizeOfButton,1)!@#&        end!@#& !@#&        local text1 = arg[1]!@#&        local text2 = arg[2]!@#& !@#&        local sizeOfText1 = #text1!@#&        local sizeOfText2 = #text2!@#&        local hereIsOnlyOneElement = false!@#&        if sizeOfText1 == 0 then hereIsOnlyOneElement = true end!@#& !@#&        --     !@#&        local theLongestElement = 0!@#&        for i=1,sizeOfText1 do!@#&                if #text1[i] > theLongestElement then theLongestElement = #text1[i] end!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if #text2[i] > theLongestElement then theLongestElement = #text2[i] end!@#&        end!@#& !@#&        --      !@#&        local countOfButtons = #arg-2!@#&        local sizeOfAllButtons = 0!@#&        for i=1,countOfButtons do!@#&                sizeOfAllButtons = sizeOfAllButtons + 2+#arg[2+i][1]+2 + 1!@#&        end!@#&        sizeOfAllButtons = sizeOfAllButtons - 1!@#&        if sizeOfAllButtons>theLongestElement then theLongestElement=sizeOfAllButtons end!@#& !@#&        --     !@#&        local xWindowSize = 2 + theLongestElement + 2!@#&        local yWindowSize = nil!@#&        if hereIsOnlyOneElement then!@#&                yWindowSize = 2 + sizeOfText2 + 3!@#&        else!@#&                yWindowSize = 2 + sizeOfText1 + 1 + sizeOfText2 + 3!@#&        end!@#& !@#&        local xStart = math.floor(xSize/2-xWindowSize/2)!@#&        local yStart = math.floor(ySize/2-yWindowSize/2)!@#&       !@#&        --  !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,\" \")!@#& !@#&        --TEXTS!@#&        term.setBackgroundColor(colors.white)!@#&        for i=1,sizeOfText1 do!@#&                colorText(xStart+2,yStart+1+i,text1[i],colors.gray)!@#&        end!@#&        for i=1,sizeOfText2 do!@#&                if hereIsOnlyOneElement then!@#&                        colorText(xStart+2,yStart+1+sizeOfText1+i,text2[i],colors.lightGray)!@#&                else!@#&                        colorText(xStart+2,yStart+2+sizeOfText1+i,text2[i],colors.lightGray)!@#&                end!@#&        end!@#& !@#&        local xStartForButtons = xStart+xWindowSize-1 - sizeOfAllButtons - 1!@#&        local yStartForButtons = yStart+yWindowSize-2!@#&        for i=1,countOfButtons do!@#&                local text = arg[2+i][1]!@#&                local textColor = tonumber(arg[2+i][3])!@#&                local backColor = tonumber(arg[2+i][2])!@#& !@#&                drawButton(xStartForButtons,yStartForButtons,text,textColor,backColor)!@#&                xStartForButtons = xStartForButtons + 2+#arg[2+i][1]+2+1!@#&        end!@#& !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"buttons\"]) do!@#&                                if x>=Objects[\"buttons\"][key][\"x1\"] and x<=Objects[\"buttons\"][key][\"x2\"] and y==Objects[\"buttons\"][key][\"y1\"] then!@#&                                        drawButton(Objects[\"buttons\"][key][\"x1\"],Objects[\"buttons\"][key][\"y1\"],key,colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        return key!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function aboutFile(x,y,xWindowSize,path)!@#&        os.loadAPI(\"System/API/image\")!@#& !@#&        local name = fs.getName(path)!@#&        local limitOfText = xWindowSize - 2!@#&        local yWindowSize = 16!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&        end!@#& !@#&        -- !@#&        local function drawButton(x,y,name,textColor,backColor)!@#&                local sizeOfButton = 2+#name+2!@#&                square(x,y,sizeOfButton,1,backColor)!@#&                colorText(x+2,y,name,textColor)!@#&                newObj(\"buttons\",name,x,y,sizeOfButton,1)!@#&        end!@#& !@#&        --------------- , !@#& !@#&        local info = {}!@#& !@#&        info[\"fileFormat\"] = getFileFormat(path)!@#& !@#&        info[\"fileType\"] = getFileType(path)!@#& !@#&        info[\"fileSize\"] = math.ceil(getFileSize(path)/1024)..\"KB\"!@#& !@#&        info[\"readOnly\"] = tostring(fs.isReadOnly(path))!@#&        --------------- !@#& !@#&        --  GOVNA,      !@#&        if y+yWindowSize - 1  >= ySize then y = y - (y+yWindowSize - 1 - ySize) - 1 end!@#&        if x+xWindowSize - 1  >= xSize then x = x - (x+xWindowSize - 1 - xSize) - 1 end!@#& !@#&        -- !@#&        emptyWindow(x,y,xWindowSize,yWindowSize,\"Properties\")!@#& !@#&        --, !@#&        drawOSIcon(x+1,y+2,path,name,info[\"fileFormat\"])!@#& !@#&        --  !@#&        square(x,y+7,xWindowSize,1,colors.lightGray)!@#&        colorText(x+1,y+7,\"Info\",colors.white)!@#& !@#&        --   !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(x+8,y+3,stringLimit(\"start\",name,xWindowSize-9),colors.gray)!@#&        colorText(x+8,y+4,info[\"fileSize\"],colors.lightGray)!@#& !@#&        --  !@#&        local textStart = y+9!@#&        colorText(x+1,textStart,\"Type:\",colors.gray)!@#&        usualText(x+1,textStart+1,\"Size:\",colors.gray)!@#&        usualText(x+1,textStart+2,\"Path:\",colors.gray)!@#&        usualText(x+1,textStart+3,\"Read only:\",colors.gray)!@#& !@#&        colorText(x+7,textStart,info[\"fileType\"],colors.lightGray)!@#&        usualText(x+7,textStart+1,info[\"fileSize\"])!@#&        usualText(x+7,textStart+2,stringLimit(\"start\",path,xWindowSize-8))!@#&        usualText(x+12,textStart+3,info[\"readOnly\"])!@#& !@#&        --!@#&        drawButton(x+xWindowSize-11,y+yWindowSize-2,\"Close\",colors.black,colors.lightBlue)!@#& !@#&        --   !@#&        while true do!@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"buttons\"]) do!@#&                                if x>=Objects[\"buttons\"][key][\"x1\"] and x<=Objects[\"buttons\"][key][\"x2\"] and y==Objects[\"buttons\"][key][\"y1\"] then!@#&                                        drawButton(Objects[\"buttons\"][key][\"x1\"],Objects[\"buttons\"][key][\"y1\"],key,colors.white,colors.blue)!@#&                                        sleep(0.2)!@#&                                        return key!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function progressBar(xStart,yStart,xWindowSize,title,text,speed)!@#&        --  !@#&        if xWindowSize < 4+#text then!@#&                xWindowSize = 4+#text!@#&        end!@#& !@#&        local yWindowSize = 6!@#&        local sizeOfProgressBar = xWindowSize - 4!@#& !@#&        -- !@#&        xStart,yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        -- !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        -- !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(math.floor(xStart+(xWindowSize/2-#text/2)),yStart+2,text,colors.gray)!@#& !@#&        --  !@#&        local xProgressBarPos = xStart+2!@#&        local yProgressBarPos = yStart+4!@#&        drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,0)!@#&        sleep(0)!@#&        for i=1,100,speed do!@#&                drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,i)!@#&                sleep(0)!@#&        end!@#&        drawProgressBar(xProgressBarPos,yProgressBarPos,sizeOfProgressBar,1,colors.lightBlue,colors.lightGray,100)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function search(xStart,yStart,xWindowSize,limitOfElements,searchText)!@#& !@#&        os.loadAPI(\"System/API/image\")!@#& !@#&        local searchList = {}!@#& !@#&        local sizeOfOneElement = 5!@#&        local yWindowSize = 4 + sizeOfOneElement*limitOfElements!@#&        local sizeOfSearchBar = xWindowSize - #searchText - 3!@#&        local xStartOfSearchBar = xStart + 2 + #searchText!@#&        local yStartOfSearchBar = yStart + 1!@#&        local limitOfAllText = xWindowSize - 10!@#&        local xWindowEnd = xStart + xWindowSize - 1!@#&        local yWindowEnd = yStart + yWindowSize - 1!@#& !@#&        local fromElement = 1!@#&        local searchInput = \"\"!@#& !@#&        -- !@#&        local Objects = {}!@#&        local function newObj(class,name,x1,y1,width,height,fileType,fileSize,path,fileName,fileFormat)!@#&                Objects[class] = Objects[class] or {}!@#&                Objects[class][name] = {}!@#&                Objects[class][name][\"x1\"]=x1!@#&                Objects[class][name][\"y1\"]=y1!@#&                Objects[class][name][\"x2\"]=x1+width-1!@#&                Objects[class][name][\"y2\"]=y1+height-1!@#&                Objects[class][name][\"fileType\"]=fileType!@#&                Objects[class][name][\"fileSize\"]=fileSize!@#&                Objects[class][name][\"path\"]=path!@#&                Objects[class][name][\"fileName\"]=fileName!@#&                Objects[class][name][\"fileFormat\"]=fileFormat!@#&        end!@#& !@#&        local function drawConcretnoIcon(xStart,yStart,path,name,fileType,fileSize,backColor,fileFormat)!@#&                drawOSIcon(xStart,yStart,path,name,fileFormat)!@#&                term.setBackgroundColor(backColor)!@#&                colorText(xStart+8,yStart,stringLimit(\"end\",name,limitOfAllText),colors.gray)!@#&                colorText(xStart+8,yStart+1,stringLimit(\"start\",path,limitOfAllText),colors.lightGray)!@#&                colorText(xStart+8,yStart+2,stringLimit(\"start\",\"Type: \"..fileType,limitOfAllText),colors.lightGray)!@#&                colorText(xStart+8,yStart+3,stringLimit(\"start\",\"Size: \"..math.ceil(fileSize/1024)..\"KB\",limitOfAllText),colors.lightGray)!@#& !@#&                newObj(\"icon\",path..\"/\"..name,xStart,yStart,xWindowSize,4,fileType,fileSize,path,name,fileFormat)!@#&        end!@#& !@#&        local function drawSearches(fromElement)!@#&                -- !@#&                Objects = {}!@#&                newObj(\"icon\",\"cykaBlyad\",-5,-5,1,1,\"hehe\",5)          !@#& !@#&                --  !@#&                square(xStart,yStart+3,xWindowSize-1,yWindowSize-3,colors.white)!@#& !@#&                if #searchList == 0 then!@#&                        colorText(xStart+1,yStart+4,\"No mathes found.\",colors.lightGray)!@#&                else!@#&                        local iconCounter = 1!@#&                        for i=fromElement,#searchList do!@#&                                local yIconPos = yStart+4 + iconCounter*sizeOfOneElement - sizeOfOneElement!@#&                               !@#&                                drawConcretnoIcon(xStart+1,yIconPos,searchList[i][\"path\"],searchList[i][\"name\"],searchList[i][\"fileType\"],searchList[i][\"fileSize\"],colors.white,searchList[i][\"fileFormat\"])!@#& !@#&                                iconCounter = iconCounter + 1!@#&                                if iconCounter > limitOfElements then break end!@#&                        end!@#&                end!@#& !@#&                scrollBar(xWindowEnd,yStart+3,yWindowSize-3,#searchList,fromElement,colors.lightGray,colors.lightBlue)!@#&        end!@#& !@#&        local function textOnSearchBar()!@#&                term.setBackgroundColor(colors.white)!@#&                usualText(xStartOfSearchBar,yStartOfSearchBar,string.rep(\" \",sizeOfSearchBar))!@#&                colorText(xStartOfSearchBar,yStartOfSearchBar,stringLimit(\"start\",searchInput,sizeOfSearchBar),colors.black)!@#&        end!@#& !@#&        --!@#&        sampleWindow(xStart,yStart,xWindowSize,yWindowSize)!@#&        -- !@#&        square(xStart,yStart,xWindowSize,3,colors.blue)!@#&        colorText(xStart+1,yStart+1,searchText,colors.white)!@#&        square(xStartOfSearchBar,yStartOfSearchBar,sizeOfSearchBar,1,colors.white)!@#& !@#&        drawSearches(fromElement)!@#& !@#&        while true do!@#&                textOnSearchBar(searchInput)!@#&                if #searchInput > sizeOfSearchBar then!@#&                        term.setCursorPos(xStartOfSearchBar+sizeOfSearchBar-1,yStartOfSearchBar)!@#&                else!@#&                        term.setCursorPos(xStartOfSearchBar+#searchInput,yStartOfSearchBar)!@#&                end!@#& !@#&                term.setCursorBlink(true)!@#& !@#&                local event,side,x,y = os.pullEvent()!@#&                if event == \"mouse_scroll\" then!@#&                        term.setCursorBlink(false)!@#&                        if side == 1 then!@#&                                fromElement = fromElement + 1!@#&                                if fromElement > #searchList then!@#&                                        fromElement = #searchList!@#&                                else!@#&                                        drawSearches(fromElement)!@#&                                end!@#&                        else!@#&                                fromElement = fromElement - 1!@#&                                if fromElement < 1 then!@#&                                        fromElement = 1!@#&                                else!@#&                                        drawSearches(fromElement)!@#&                                end!@#&                        end!@#&                elseif event == \"mouse_click\" then!@#&                        for key,val in pairs(Objects[\"icon\"]) do!@#&                                if x>=Objects[\"icon\"][key][\"x1\"] and x<=Objects[\"icon\"][key][\"x2\"] and y>=Objects[\"icon\"][key][\"y1\"] and y<=Objects[\"icon\"][key][\"y2\"] then!@#&                                        square(Objects[\"icon\"][key][\"x1\"]-1,Objects[\"icon\"][key][\"y1\"],xWindowSize-1,4,colors.blue)!@#&                                        drawConcretnoIcon(Objects[\"icon\"][key][\"x1\"],Objects[\"icon\"][key][\"y1\"],Objects[\"icon\"][key][\"path\"],Objects[\"icon\"][key][\"fileName\"],Objects[\"icon\"][key][\"fileType\"],Objects[\"icon\"][key][\"fileSize\"],colors.blue,Objects[\"icon\"][key][\"fileFormat\"])!@#&                                        sleep(0.3)!@#&                                        term.setCursorBlink(false)!@#&                                        return string.sub(key,2,-1)!@#&                                end!@#&                        end!@#&                        term.setCursorBlink(false)!@#&                        return nil!@#& !@#&                elseif event == \"char\" then!@#&                        fromElement = 1!@#&                        searchInput = searchInput..side!@#&                        searchList = searchInAllFiles(\"/\",searchInput)!@#&                        drawSearches(fromElement)!@#&                elseif event == \"key\" then!@#&                        if side == 14 then!@#&                                fromElement = 1!@#&                                searchInput = string.sub(searchInput,1,-2)!@#&                                searchList = searchInAllFiles(\"/\",searchInput)!@#&                                drawSearches(fromElement)!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--print(\"You selected: \"..search(2,2,28,2,\"Search\"))!@#& !@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&function info(xStart,yStart,title,text)!@#&        local sizeOfText = #text!@#&        local xWindowSize = 4+sizeOfText!@#&        local yWindowSize = 4!@#&        local xStart,yStart = correctStartCoords(xStart,yStart,xWindowSize,yWindowSize)!@#& !@#&        emptyWindow(xStart,yStart,xWindowSize,yWindowSize,title)!@#& !@#&        term.setBackgroundColor(colors.white)!@#&        colorText(xStart+2,yStart+2,text,colors.gray)!@#&end!@#& !@#&---------------------------------------------------------------------------------------------------------------------!@#& !@#&--[[function fileManager(mode,workPath)!@#&        if workPath == nil then workPath = \"\" end!@#& !@#&        local xSize,ySize = term.getSize()!@#& !@#&        local managerX = xSize-3!@#&        local managerY = ySize-3!@#& !@#&        local xStart = 2!@#&        local yStart = 2!@#& !@#&        local main = window.create(term.native(),xStart,yStart,managerX+1,managerY+1)!@#&        term.redirect(main)!@#& !@#&        local function getFoldersList(workPath)!@#& !@#&        end!@#& !@#&        local function drawManager()!@#&                local currentPath = fs.getName(workPath)!@#&                emptyWindow(1,1,managerX,managerY,currentPath)!@#&                colorTextWithBack(1,1,\"x\",colors.black,colors.red);colorTextWithBack(2,1,\"-\",colors.black,colors.orange);colorTextWithBack(3,1,\"+\",colors.black,colors.lime)!@#&        end!@#& !@#&        local function clickedAtArea(x,y,sx,sy,ex,ey)!@#&        if (x >= sx) and (x <= ex) and (y >= sy) and (y <= ey) then return true end    !@#&        return false!@#&        end!@#& !@#&        drawManager()!@#& !@#&        term.redirect(term.native())!@#&end]]",["encryptor.cfg"]="1=eafazf!@#&2=ezffqq!@#&3=ezfvfp!@#&4=eafooz!@#&5=eafaiz!@#&6=ezviio!@#&7=ezvzvi!@#&8=eqfooz!@#&9=eommqo!@#&0=ezivup!@#&a=ealajo!@#&b=eopxzj!@#&c=evmsyo!@#&d=ebiiql!@#&e=epovuz!@#&f=efivmt!@#&g=ezvito!@#&h=ezlfbh!@#&i=eaquat!@#&j=etirra!@#&k=emorta!@#&l=etampl!@#&m=enodus!@#&n=ezviri!@#&o=eponis!@#&p=enuihu!@#&q=exyupi!@#&r=ezdads!@#&s=eigurd!@#&t=eamati!@#&u=ebalro!@#&v=etshat!@#&w=ealsis!@#&x=ekizli!@#&y=eltrya!@#&z=espopu",},},["OS"]="-----------------------                 ----------------------!@#&local Args = {...}!@#&os.loadAPI(\"SpeedAPI/context\")!@#&os.loadAPI(\"SpeedAPI/image\")!@#&os.loadAPI(\"SpeedAPI/windows\")!@#&os.loadAPI(\"SpeedAPI/config\")!@#&os.loadAPI(\"SpeedAPI/zip\")!@#&os.loadAPI(\"SpeedAPI/lddfm\")!@#&os.loadAPI(\"SpeedAPI/peripheral\")!@#& !@#&----------------------            !@#&!@#&if peripheral.find(\"modem\") then!@#&  rednet.close(peripheral.find(\"modem\"))!@#&end!@#&!@#&local function findPeripheral(whatToFind)!@#&  local PeriList = rs.getSides()!@#&  for i=1,#PeriList do!@#&    if peripheral.getType(PeriList[i]) == whatToFind then!@#&      return PeriList[i]!@#&    end!@#&  end!@#&end!@#& !@#&--               !@#&local m = findPeripheral(\"monitor\")!@#&if Args[1] == \"m\" then!@#&        if m ~= nil then!@#&                m = peripheral.wrap(m)!@#&                if Args[2] ~= nil then!@#&                        m.setTextScale(tonumber(Args[2]))!@#&                end!@#&                term.redirect(m)!@#&        end!@#&end!@#& !@#&if not term.isColor() then error(\"This program will work only on advanced computer.\") end!@#& !@#&--[[                     !@#&local standartErrorFunction = error!@#&error = windows.error]]!@#& !@#&----------------------           !@#&local xSize, ySize = term.getSize()!@#&local centerX = math.floor(xSize/2)!@#&local centerY = math.floor(ySize/2)!@#&local appWidth = 10!@#&local appHeight = 6!@#& !@#&local countOfAppsByX = math.floor((xSize-2)/(appWidth+2))!@#&local countOfAppsByY = math.floor((ySize-5)/(appHeight+1))!@#&local countOfAppsOnDesktop = countOfAppsByX*countOfAppsByY!@#& !@#&local countOfDesktops = nil!@#& !@#&local startDisplayAllAppsFromX = centerX - math.floor((countOfAppsByX*(appWidth+2)-2)/2) + 1!@#&local startDisplayAllAppsFromY = centerY - math.floor((countOfAppsByY*(appHeight+1)-1)/2) + 1!@#& !@#&local currentDesktop = 1!@#&local currentBackground = colors.lightBlue!@#&local topBarColor = colors.gray!@#& !@#&--                !@#&local Obj = {}!@#&local ObjBottom = {}!@#&local ObjApp = {}!@#& !@#&local clipboardName = nil!@#& !@#&local workPath = \"\"!@#&local workPathHistory = {}!@#& !@#&local hideFileFormat = true!@#&local showHiddenFiles = true!@#&local showSystemFolders = true!@#& !@#&local Notification = nil!@#&local sizeOfNotification = 24!@#& !@#&local findedModem = windows.findPeripheral(\"modem\")!@#&local modem = nil!@#& !@#&----------------------                  ----------------------!@#& !@#&--                            !@#&local function newObjApp(name,x1,y1,width,height,id,fileFormat)!@#&        ObjApp[name]={}!@#&        ObjApp[name][\"x1\"]=x1!@#&        ObjApp[name][\"y1\"]=y1!@#&        ObjApp[name][\"x2\"]=x1+width-1!@#&        ObjApp[name][\"y2\"]=y1+height-1!@#&        ObjApp[name][\"id\"]=id!@#&        ObjApp[name][\"fileFormat\"]=fileFormat!@#&end!@#& !@#&--                        !@#&local function newObj(name,x1,y1,width,height)!@#&        Obj[name]={}!@#&        Obj[name][\"x1\"]=x1!@#&        Obj[name][\"y1\"]=y1!@#&        Obj[name][\"x2\"]=x1+width-1!@#&        Obj[name][\"y2\"]=y1+height-1!@#&end!@#& !@#&--                      !@#&local function newObjBottom(name,x1,y1,width,height)!@#&        ObjBottom[name]={}!@#&        ObjBottom[name][\"x1\"]=x1!@#&        ObjBottom[name][\"y1\"]=y1!@#&        ObjBottom[name][\"x2\"]=x1+width-1!@#&        ObjBottom[name][\"y2\"]=y1+height-1!@#&end!@#& !@#&--                           !@#&local function pastebin(mode,paste,filename)!@#&        if mode == \"get\" then!@#&	    term.setBackgroundColor(colors.black)!@#&	    term.setTextColor(colors.white)!@#&	    term.setCursorPos(1,1)!@#&	    term.clear()!@#&            shell.run(\"pastebin \"..mode..\" \"..paste..\" \"..workPath..\"/\"..filename)!@#&        elseif mode == \"put\" then      !@#&	    term.setBackgroundColor(colors.black)!@#&	    term.setTextColor(colors.white)!@#&	    term.setCursorPos(1,1)!@#&	    term.clear()    !@#&            shell.run(\"pastebin put \"..workPath..\"/\"..filename)!@#&	elseif mode == \"run\" then !@#&            term.setBackgroundColor(colors.black)!@#&	    term.setTextColor(colors.white)!@#&	    term.setCursorPos(1,1)!@#&	    term.clear()         !@#&            shell.run(\"pastebin get \"..paste..\" cyka\")!@#&	    shell.run(\"cyka\")!@#&	    fs.delete(\"cyka\")!@#&        end!@#&end!@#& !@#&--                        !@#&local function stringLimit(text,size)!@#&        if string.len(text)<=size then return text end!@#&        return string.sub(text,1,size-3)..\"...\"!@#&end!@#& !@#&--                        !@#&local function stringLimitFromStart(text,size)!@#&        if string.len(text)<=size then return text end!@#&        return \"...\"..string.sub(text,string.len(text)-size+4,string.len(text))!@#&end!@#& !@#&--                                         !@#&local function usualText(x,y,text)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&--                             !@#&local function square(x1,y1,width,height,color)!@#&        local string = string.rep(\" \",width)!@#&        term.setBackgroundColor(color)!@#&        for y=y1,(y1+height-1) do!@#&                usualText(x1,y,string)!@#&        end!@#&end!@#& !@#&--                     !@#&local function clearScreen(color)!@#&        term.setBackgroundColor(color)!@#&        term.clear()!@#&end!@#& !@#&--                                      1, 1!@#&local function prepareToExit()!@#&        clearScreen(colors.black)!@#&        term.setTextColor(colors.white)!@#&        term.setCursorPos(1,1)!@#&	if peripheral.find(\"modem\") then!@#&		rednet.open(peripheral.find(\"modem\"))!@#&	end!@#&end!@#& !@#&--                        !@#&local function fadeIn(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.white)!@#&        sleep(time)!@#&end!@#& !@#&--                        !@#&local function fadeOut(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.black)!@#&        sleep(time)!@#&        term.setCursorPos(1,1)!@#&        term.setTextColor(colors.white)!@#&end!@#& !@#&--                                                  !@#&local function setWallpaper(path)!@#&        fs.delete(\"System/OS/wallpaper.png\")!@#&        fs.copy(path,\"System/OS/wallpaper.png\")!@#&end!@#& !@#&--                        ,            ,                     !@#&local function askForReplaceFile(path)!@#&        if fs.exists(path) then!@#&                local action = windows.select({\"File already exists.\"},{\"Do you want to replace it?\"},{\"No\",colors.lightGray,colors.black},{\"Yes\",colors.lightBlue,colors.black})!@#&                if action == \"Yes\" then!@#&                        return true!@#&                else!@#&                        return false!@#&                end!@#&        end!@#&        return true!@#&end!@#& !@#&--                                             !@#&local function copy(whatToCopy)!@#&        fs.delete(\"System/Clipboard.temp\")!@#&        fs.copy(whatToCopy,\"System/Clipboard.temp\")!@#&end!@#& !@#&local function paste(path,name)!@#&        local agree = askForReplaceFile(path..\"/\"..name)!@#&        if agree then!@#&                fs.delete(path..\"/\"..name)!@#&                fs.copy(\"System/Clipboard.temp\",path..\"/\"..name)!@#&        end!@#&end!@#& !@#&local function cut(path)!@#&        fs.delete(\"System/Clipboard.temp\")!@#&        fs.copy(path,\"System/Clipboard.temp\")!@#&        fs.delete(path)!@#&end!@#& !@#&local function rename(path,name,renameToName)!@#&        local agree = askForReplaceFile(path..\"/\"..renameToName)!@#&        if agree then!@#&                fs.delete(\"System/OS/rename.temp\")!@#&                fs.move(path..\"/\"..name,\"System/OS/rename.temp\")!@#&                fs.delete(path..\"/\"..renameToName)!@#&                fs.move(\"System/OS/rename.temp\",path..\"/\"..renameToName)!@#&        end!@#&end    !@#& !@#&--       ,                                              !@#&local function programFinished()!@#&        local xCusor,yCursor = term.getCursorPos()!@#&        term.setBackgroundColor(colors.black)!@#&        term.setTextColor(colors.white)!@#&	if peripheral.find(\"modem\") then!@#&		rednet.close(peripheral.find(\"modem\"))!@#&	end!@#&!@#&        usualText(1,yCursor+1,\"Press any key to quit.\")!@#& !@#&        while true do!@#&                local event = os.pullEvent()!@#&                if event == \"monitor_touch\" or event == \"mouse_click\" or event == \"key\" then break end!@#&        end!@#&end!@#& !@#&--                            !@#&local function topBar(topBarColor)!@#&        local time = textutils.formatTime(os.time(),true)!@#&        local string = \" OS \"..string.rep(\" \",xSize-6-#time)..time..\" S\"!@#&        term.setBackgroundColor(topBarColor)!@#&        windows.colorText(1,1,string,colors.white)!@#&        windows.colorText(6,1,\"View\",colors.lightGray) !@#&end!@#&newObj(\"OS\",1,1,4,1)!@#&newObj(\"Search\",xSize,1,1,1)!@#&newObj(\"View\",5,1,6,1)!@#& !@#&--                                                          !@#&local function drawKonkretnoApp(x,y,name,background,id)!@#& !@#&        --                           !@#&        newObjApp(name,x,y,appWidth,appHeight,id,windows.getFileFormat(name))!@#& !@#&        --                !@#&        windows.drawOSIcon(x+2,y,workPath,name,ObjApp[name][\"fileFormat\"],showSystemFolders)!@#& !@#&        --                          !@#&        term.setBackgroundColor(background)!@#&        if fs.isReadOnly(workPath..\"/\"..name) then!@#&                term.setTextColor(colors.red)!@#&        else!@#&                term.setTextColor(colors.black)!@#&        end!@#&        if windows.isFileHidden(name) then!@#&                term.setTextColor(colors.gray)!@#&        end!@#&        if hideFileFormat then!@#&                name = windows.hideFileFormat(name)!@#&        end!@#&        name = stringLimit(name,10)!@#&        usualText(math.floor(x+5-#name/2),y+5,name)!@#& !@#&end!@#& !@#&--                                                         !@#&local function displayApps(workPath,currentDesktop,background)!@#& !@#&        --                  !@#&        ObjApp = {}!@#&        ObjBottom = {}!@#& !@#&        --               !@#&        --clearScreen(background)!@#&        square(1,2,xSize,ySize-1,background)!@#&        if fs.exists(\"System/OS/wallpaper.png\") then!@#&		huy = paintutils.loadImage(\"System/OS/wallpaper.png\")!@#&                paintutils.drawImage(huy, 1,1)!@#&        end!@#& !@#&        --                       !@#&        topBar(topBarColor)!@#&       !@#&        --                                /       !@#&        local files = fs.list(workPath)!@#&        --                     ,                         !@#&        files = windows.reorganizeFilesAndFolders(workPath,files,showHiddenFiles,showSystemFolders)!@#& !@#&        local countOfFiles = #files!@#&        countOfDesktops = math.ceil(countOfFiles/(countOfAppsByY*countOfAppsByX))!@#& !@#&        --                       !@#&        local bottomButtonsStartX = nil!@#&        if #workPathHistory == 0 then!@#&                bottomButtonsStartX = centerX - math.floor((countOfDesktops*2+1)/2)!@#&        else!@#&                bottomButtonsStartX = centerX - math.floor((countOfDesktops*2-1)/2)!@#&        end!@#&        local bottomY = ySize-1!@#&        for i=1,countOfDesktops do!@#&                local bottomX = bottomButtonsStartX + i * 2!@#&                if currentDesktop == i then!@#&                        paintutils.drawPixel(bottomX,bottomY,colors.white)!@#&                else!@#&                        paintutils.drawPixel(bottomX,bottomY,colors.lightGray)!@#&                end!@#&                newObjBottom(i,bottomX,bottomY,1,1)!@#&        end!@#&        if #workPathHistory>0 then!@#&                paintutils.drawPixel(bottomButtonsStartX,bottomY,colors.white)!@#&                term.setTextColor(colors.black)!@#&                usualText(bottomButtonsStartX,bottomY,\"<\")!@#&                newObj(\"<\",bottomButtonsStartX,bottomY,1,1)!@#&        end!@#& !@#&        --                          !@#&        local appCounter = 1 + currentDesktop * countOfAppsByY * countOfAppsByX - countOfAppsByY * countOfAppsByX!@#&        for y = 1,countOfAppsByY do!@#&                for x = 1,countOfAppsByX do!@#&                        if files[appCounter] ~= nil then!@#&                                drawKonkretnoApp(startDisplayAllAppsFromX+x*(appWidth+2)-(appWidth+2),startDisplayAllAppsFromY+y*(appHeight+1)-(appHeight+1),files[appCounter],background,appCounter)!@#&                                appCounter = appCounter + 1!@#&                        else!@#&                                break!@#&                        end!@#&                end!@#&        end!@#& !@#&        --                    !@#&        if Notification then!@#&                local yNoti = 2!@#&                local xNoti = math.floor(centerX - sizeOfNotification/2)!@#&                windows.square(xNoti,yNoti,sizeOfNotification,2,colors.white)!@#&                windows.colorText(xNoti+1,yNoti,windows.stringLimit(\"end\",Notification[\"title\"],sizeOfNotification-2),colors.gray)!@#&                windows.colorText(xNoti+1,yNoti+1,windows.stringLimit(\"end\",Notification[\"text\"],sizeOfNotification-2),colors.lightGray)!@#&                windows.colorText(xNoti+sizeOfNotification-1,yNoti,\"x\",colors.black)!@#&                newObj(\"closeNoti\",xNoti+sizeOfNotification-1,yNoti,1,1)!@#&        end!@#&end!@#& !@#&local function askForMakingOSAsStartup()!@#&        local action = windows.select({\"Hello!\"},{\"Do you want to load OS\",\"when computer starts?\"},{\"No\",colors.lightGray,colors.black},{\"Yes\",colors.lightBlue,colors.black})!@#&        if action == \"Yes\" then!@#&                fs.copy(\"OS\",\"startup\")!@#&                config.write(\"System/OS/startup.cfg\",\"load when computer starts\",\"true\")!@#&        else!@#&                config.write(\"System/OS/startup.cfg\",\"load when computer starts\",\"false\")!@#&        end!@#&end!@#& !@#&--                                 !@#&local function launchFile(path,fileFormat,arguments)!@#&        if fileFormat == nil then!@#&                local success,err = loadfile(path)!@#&                if success ~= nil then!@#&                        fadeOut(0)!@#&                        prepareToExit()!@#&                        if arguments == nil then!@#&                                shell.run(path)!@#&                        else!@#&                                shell.run(path..\" \"..arguments)!@#&                        end!@#&                        programFinished()!@#&                        fadeIn(0)!@#&                else!@#&                        windows.error(err)!@#&                end!@#&        elseif fileFormat == \".nfp\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/Sketch \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".nfa\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/OLD_NPaint \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".skch\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/Sketch \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".ink\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/Word \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".txt\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/Word \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".cfg\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/SpeedCode \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".lua\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/SpeedCode \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&	elseif fileFormat == \".gif\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/GIFAnimator \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&	elseif fileFormat == \".png\" then!@#&                fadeOut(0)!@#&                shell.run(\"/SpeedOS/Applications/Sketch \"..path)!@#&		if peripheral.find(\"modem\") then!@#&			rednet.close(peripheral.find(\"modem\"))!@#&		end!@#&                fadeIn(0)!@#&        elseif fileFormat == \".app\" then!@#&                path = path..\"/main\"!@#&                local success,err = loadfile(path)!@#&                if success ~= nil then!@#&                        fadeOut(0)!@#&                        prepareToExit()!@#&                        if arguments == nil then!@#&                                shell.run(path)!@#&                        else!@#&                                shell.run(path..\" \"..arguments)!@#&                        end!@#&                        --programFinished()!@#&                        fadeIn(0)!@#&			if peripheral.find(\"modem\") then!@#&				rednet.close(peripheral.find(\"modem\"))!@#&			end!@#&                else!@#&                        windows.error(err)!@#&                end!@#&        end!@#&end!@#& !@#&--                              !@#&local function gotoDirectory(path)!@#&        workPathHistory[#workPathHistory+1] = workPath!@#&        workPath = path!@#&        currentDesktop = 1!@#&end!@#& !@#&----------------------------------               ----------------------------------------!@#& !@#&if fs.exists(\"System/OS/userdata.cfg\") then!@#&        showSystemFolders = windows.toboolean(config.read(\"System/OS/userdata.cfg\",\"showSystemFolders\"))!@#&        showHiddenFiles = windows.toboolean(config.read(\"System/OS/userdata.cfg\",\"showHiddenFiles\"))!@#&        hideFileFormat = windows.toboolean(config.read(\"System/OS/userdata.cfg\",\"hideFileFormat\"))!@#&else!@#&        config.write(\"System/OS/userdata.cfg\",\"showSystemFolders\",\"true\")!@#&        config.write(\"System/OS/userdata.cfg\",\"showHiddenFiles\",\"true\")!@#&        config.write(\"System/OS/userdata.cfg\",\"hideFileFormat\",\"true\")!@#&end!@#& !@#&--                            !@#&displayApps(workPath,currentDesktop,currentBackground)!@#& !@#&if not fs.exists(\"startup\") then!@#&        if not fs.exists(\"System/OS/startup.cfg\") then!@#&                askForMakingOSAsStartup()!@#&                displayApps(workPath,currentDesktop,currentBackground)!@#&        else!@#&                local govno = config.read(\"System/OS/startup.cfg\",\"load when computer starts\")!@#&                if govno ~= nil and govno ~= \"false\" then!@#&                        askForMakingOSAsStartup()!@#&                        displayApps(workPath,currentDesktop,currentBackground)!@#&                end!@#&        end!@#&end!@#& !@#&--                 !@#&local exitFromProgram = false!@#&while true do!@#& !@#&        if exitFromProgram then break end!@#& !@#&        --                  ,           1                         !@#&        local appCounter = 1 + currentDesktop * countOfAppsByY * countOfAppsByX - countOfAppsByY * countOfAppsByX!@#& !@#&        local event,side,x,y = os.pullEvent()!@#&        --                     ,                   ,                      !@#&        if event == \"monitor_touch\" then side = 1 end!@#&        if event == \"mouse_click\" or event == \"monitor_touch\" then!@#& !@#&                if side == 1 then!@#& !@#&                        --                                ,                                                      BREAK!@#&                        local exit1 = false!@#& !@#&                        --                     \"     \"!@#&                        if #workPathHistory > 0 then!@#&                                if x==Obj[\"<\"][\"x1\"] and y==Obj[\"<\"][\"y1\"] and #workPathHistory > 0 then!@#&                                                --   !@#&                                                term.setBackgroundColor(colors.blue)!@#&                                                term.setTextColor(colors.white)!@#&                                                usualText(Obj[\"<\"][\"x1\"],Obj[\"<\"][\"y1\"],\"<\")!@#&                                                sleep(0.2)!@#&                                                --      !@#&                                                workPath = workPathHistory[#workPathHistory]!@#&                                                workPathHistory[#workPathHistory] = nil!@#&                                                currentDesktop = 1!@#&                                                displayApps(workPath,currentDesktop,currentBackground)!@#&                                                exit1 = true!@#&                                end!@#&                        end!@#& !@#&                        --     ,      ,                                                               !@#&                        for i=1,#ObjBottom do!@#&                                if exit1 then break end!@#&                                if x==ObjBottom[i][\"x1\"] and y==ObjBottom[i][\"y1\"] then!@#&                                        currentDesktop = i!@#&                                        displayApps(workPath,currentDesktop,currentBackground)!@#&                                        exit1=true!@#&                                end!@#&                        end!@#& !@#&                        --              - - - - !@#&                        --     ,      !@#&                        --            !@#&                        --       !@#&                        --               ,                                                    !@#&                        --     ,          ,        !@#&                        for key,val in pairs(ObjApp) do!@#&                                if exit1 then break end!@#&                                for i=appCounter,(appCounter+countOfAppsOnDesktop-1) do!@#&                                        if exit1 then break end!@#&                                        if ObjApp[key][\"id\"] == i then!@#&                                                if x>=ObjApp[key][\"x1\"] and x<=ObjApp[key][\"x2\"] and y>=ObjApp[key][\"y1\"] and y<=ObjApp[key][\"y2\"] then!@#&                                                        square(ObjApp[key][\"x1\"],ObjApp[key][\"y1\"],appWidth,appHeight,colors.blue)!@#&                                                        drawKonkretnoApp(ObjApp[key][\"x1\"],ObjApp[key][\"y1\"],key,colors.blue,ObjApp[key][\"id\"])!@#&                                                        sleep(0.2)!@#& !@#&                                                        --     ,     !!@#&                                                        local fileFormat = ObjApp[key][\"fileFormat\"]!@#& !@#&                                                        if not fs.isDir(workPath..\"/\"..key) then!@#& !@#&                                                                if key ~= \"OS\" and key ~= \"os\" and fileFormat == nil then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#& !@#&                                                                elseif fileFormat == \".nfa\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&                                                                !@#&                                                                elseif fileFormat == \".nfp\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&!@#&                                                                elseif fileFormat == \".skch\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&!@#&                                                                elseif fileFormat == \".txt\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&!@#&                                                                elseif fileFormat == \".lua\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&!@#&                                                                elseif fileFormat == \".ink\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&!@#&								elseif fileFormat == \".gif\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#& !@#&                                                                elseif fileFormat == \".zip\" then!@#&                                                                        windows.progressBar(\"auto\",\"auto\",20,\" \",\"Unarchiving\",5)!@#&									shell.run(\"cd \"..workPath)!@#&                                                                        shell.run(workPath..\"/\"..key)!@#&									if peripheral.find(\"modem\") then!@#&										rednet.close(peripheral.find(\"modem\"))!@#&									end!@#&                                                                elseif fileFormat == \".cfg\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#& !@#&                                                                elseif key == \"OS\" or key == \"os\" then!@#&                                                                        windows.attention({\"Can't open OS\"},{\"Cause it's already\",\"running.\"})!@#& !@#&                                                                else!@#&                                                                        shell.run(\"SpeedOS/Applications/SpeedCode \"..workPath..\"/\"..key) --windows.attention({\"Can't open this\"},{\"Unknown file extension\"})!@#&									if peripheral.find(\"modem\") then!@#&										rednet.close(peripheral.find(\"modem\"))!@#&									end!@#&                                                                end!@#& !@#&                                                                exit1 = true!@#&                                                                displayApps(workPath,currentDesktop,currentBackground)!@#&                                                        else!@#&                                                                if fileFormat == \".app\" then!@#&                                                                        launchFile(workPath..\"/\"..key,fileFormat)!@#&                                                                        displayApps(workPath,currentDesktop,currentBackground)!@#&                                                                else!@#&                                                                        gotoDirectory(workPath..\"/\"..key)!@#&                                                                        appCounter = 1!@#&                                                                        displayApps(workPath,currentDesktop,currentBackground)!@#&                                                                end!@#&                                                                exit1 = true!@#&                                                        end!@#&                                                end!@#&                                        end!@#&                                end!@#&                        end!@#& !@#&                        if x>=Obj[\"OS\"][\"x1\"] and x<=Obj[\"OS\"][\"x2\"] and y>=Obj[\"OS\"][\"y1\"] and y<=Obj[\"OS\"][\"y2\"] then!@#&                                term.setBackgroundColor(colors.blue)!@#&                                term.setTextColor(colors.white)!@#&                                usualText(1,1,\" OS \")!@#& !@#&                                contextAction = context.menu(Obj[\"OS\"][\"x1\"]+1,Obj[\"OS\"][\"y1\"]+1,{\"About\"},{\"Update\"},\"-\",{\"Reboot\"},{\"Shutdown\"},\"-\",{\"Use Craft OS\"})!@#&                                if contextAction == \"About\" then!@#&                                        launchFile(\"SpeedOS/Applications/About\")!@#&                                        displayApps(workPath,currentDesktop,currentBackground)!@#& !@#&                                elseif contextAction == \"Update\" then!@#&                                        windows.clearScreen(colors.black)!@#&                                        shell.run(\"pastebin run VWYEMZAB\")!@#&                                        fadeOut(0)!@#&                                        os.reboot()!@#& !@#&                                elseif contextAction == \"Reboot\" then!@#&                                        fadeOut(0)!@#&                                        os.reboot()!@#& !@#&                                elseif contextAction == \"Shutdown\" then!@#&                                        windows.tv(0)!@#&                                        os.shutdown()!@#& !@#&                                elseif contextAction == \"Use Craft OS\" then!@#&                                        exitFromProgram = true!@#& !@#&                                elseif contextAction == nil then!@#&                                        displayApps(workPath,currentDesktop,currentBackground)!@#&                                end!@#& !@#&                        elseif x>=Obj[\"Search\"][\"x1\"] and x<=Obj[\"Search\"][\"x2\"] and y>=Obj[\"Search\"][\"y1\"] and y<=Obj[\"Search\"][\"y2\"] then!@#&                                term.setBackgroundColor(colors.blue)!@#&                                windows.colorText(xSize,1,\"S\",colors.white)!@#&                                local searchedPath = windows.search(xSize-27,2,28,2,\"Search\")!@#&                                if searchedPath ~= nil then!@#&                                        if fs.isDir(searchedPath) then!@#&                                                gotoDirectory(searchedPath)!@#&                                                displayApps(workPath,currentDesktop,currentBackground)!@#&                                        else!@#&                                                launchFile(searchedPath,windows.getFileFormat(searchedPath))!@#&                                        end!@#&                                end!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#& !@#&                        elseif x>=Obj[\"View\"][\"x1\"] and x<=Obj[\"View\"][\"x2\"] and y>=Obj[\"View\"][\"y1\"] and y<=Obj[\"View\"][\"y2\"] then!@#&                               !@#&                                term.setBackgroundColor(colors.blue)!@#&                                windows.colorText(Obj[\"View\"][\"x1\"],Obj[\"View\"][\"y1\"],\" View \",colors.white)!@#&                               !@#&                                local s1 = \"Show hidden files\"; if showHiddenFiles then s1 = \"Hide hidden files\" end!@#&                                local s2 = \"Show system files\"; if showSystemFolders then s2 = \"Hide system files\" end!@#&                                local s3 = \"Hide file format\"; if hideFileFormat then s3 = \"Show file format\" end!@#& !@#&                                local contextAction = context.menu(Obj[\"View\"][\"x1\"],Obj[\"OS\"][\"y1\"]+1,{s1},{s2},\"-\",{s3})!@#&                                if contextAction == \"Show hidden files\" then!@#&                                        showHiddenFiles = true!@#&                                        config.write(\"System/OS/userdata.cfg\",\"showHiddenFiles\",\"true\")!@#&                                elseif contextAction == \"Hide hidden files\" then!@#&                                        showHiddenFiles = false!@#&                                        config.write(\"System/OS/userdata.cfg\",\"showHiddenFiles\",\"false\")!@#&                                elseif contextAction == \"Show file format\" then!@#&                                        hideFileFormat = false!@#&                                        config.write(\"System/OS/userdata.cfg\",\"hideFileFormat\",\"false\")!@#&                                elseif contextAction == \"Hide file format\" then!@#&                                        hideFileFormat = true!@#&                                        config.write(\"System/OS/userdata.cfg\",\"hideFileFormat\",\"true\")!@#&                                elseif contextAction == \"Show system files\" then!@#&                                        showSystemFolders = true!@#&                                        config.write(\"System/OS/userdata.cfg\",\"showSystemFolders\",\"true\")!@#&                                elseif contextAction == \"Hide system files\" then!@#&                                        showSystemFolders = false!@#&                                        config.write(\"System/OS/userdata.cfg\",\"showSystemFolders\",\"false\")!@#&                                end!@#& !@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                       !@#&                        elseif Obj[\"closeNoti\"] ~= nil and x==Obj[\"closeNoti\"][\"x1\"] and y==Obj[\"closeNoti\"][\"y1\"] then!@#&                                term.setBackgroundColor(colors.blue)!@#&                                windows.colorText(Obj[\"closeNoti\"][\"x1\"],Obj[\"closeNoti\"][\"y1\"],\"x\",colors.white)!@#&                                sleep(0.2)!@#&                                Notification = nil!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        elseif x==xSize and y==ySize then!@#&                                Notification = {[\"type\"]=\"Notification\",[\"title\"]=\"Message\",[\"text\"]=\"Cyka, mat tvoy ebal, pidor!\"}!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        end!@#& !@#&                else!@#&                        local appSelected = false!@#&                        local exit1 = false!@#&                        for key,val in pairs(ObjApp) do!@#&                                if exit1 then break end!@#&                                for i=appCounter,(appCounter+countOfAppsOnDesktop-1) do!@#&                                        if exit1 then break end!@#&                                        if ObjApp[key][\"id\"] == i then!@#&                                                if x>=ObjApp[key][\"x1\"] and x<=ObjApp[key][\"x2\"] and y>=ObjApp[key][\"y1\"] and y<=ObjApp[key][\"y2\"] then!@#&                                                        square(ObjApp[key][\"x1\"],ObjApp[key][\"y1\"],appWidth,appHeight,colors.blue)!@#&                                                        drawKonkretnoApp(ObjApp[key][\"x1\"],ObjApp[key][\"y1\"],key,colors.blue,ObjApp[key][\"id\"])!@#&                                                       !@#&                                                        local fileFormat = ObjApp[key][\"fileFormat\"]!@#&                                                        local thisIsDir = fs.isDir(workPath..\"/\"..key)!@#&                                                        local thisIsReadOnly = fs.isReadOnly(workPath..\"/\"..key)!@#&                                                        local thisIsArchive = false; if fileFormat == \".zip\" then thisIsArchive = true end!@#&                                                        local contextAction = nil!@#&                                                        if fileFormat == \".png\" then!@#&                                                                contextAction = context.menu(x,y,{\"Set as wallpaper\"},\"-\",{\"Cut\"},{\"Copy\"},{\"Delete\"},{\"Rename\"},\"-\",{\"Upload to pastebin\",thisIsDir},{\"Add to archive\"},\"-\",{\"Properties\"})!@#&							elseif fileFormat == \".nfp\" then!@#&								contextAction = context.menu(x,y,{\"Set as wallpaper\"},\"-\",{\"Cut\"},{\"Copy\"},{\"Delete\"},{\"Rename\"},\"-\",{\"Upload to pastebin\",thisIsDir},{\"Add to archive\"},\"-\",{\"Properties\"})!@#&							elseif fileFormat == \".skch\" then!@#&								contextAction = context.menu(x,y,{\"Set as wallpaper\"},\"-\",{\"Cut\"},{\"Copy\"},{\"Delete\"},{\"Rename\"},\"-\",{\"Upload to pastebin\",thisIsDir},{\"Add to archive\"},\"-\",{\"Properties\"})!@#&!@#&                                                        elseif fileFormat == \".app\" then!@#&                                                                contextAction = context.menu(x,y,{\"Show content\"},{\"Run with arguments\"},\"-\",{\"Cut\",thisIsReadOnly},{\"Copy\"},{\"Delete\",thisIsReadOnly},{\"Rename\",thisIsReadOnly},\"-\",{\"Add to archive\",thisIsArchive},\"-\",{\"Properties\"})!@#&                                                        else!@#&                                                                contextAction = context.menu(x,y,{\"Edit\",thisIsDir},{\"Run with arguments\",thisIsDir},\"-\",{\"Cut\",thisIsReadOnly},{\"Copy\"},{\"Delete\",thisIsReadOnly},{\"Rename\",thisIsReadOnly},\"-\",{\"Upload to pastebin\",thisIsDir},{\"Add to archive\",thisIsArchive},\"-\",{\"Properties\"})!@#&                                                        end!@#& !@#&                                                        if contextAction == \"Edit\" then!@#&                                                                exit = true!@#&                                                                fadeOut(0)!@#&                                                                prepareToExit()!@#&                                                                shell.run(\"/SpeedOS/Applications/SpeedCode \"..workPath..\"/\"..key)!@#&								if peripheral.find(\"modem\") then!@#&									rednet.close(peripheral.find(\"modem\"))!@#&								end!@#&                                                                fadeIn(0)!@#& !@#&                                                        elseif contextAction == \"Cut\" then!@#&                                                                cut(workPath..\"/\"..key)!@#&                                                                clipboardName = key!@#& !@#&                                                        elseif contextAction == \"Copy\" then!@#&                                                                copy(workPath..\"/\"..key)!@#&                                                                clipboardName = key!@#& !@#&                                                        elseif contextAction == \"Delete\" then!@#&                                                                fs.delete(workPath..\"/\"..key)                                                          !@#& !@#&                                                        elseif contextAction == \"Rename\" then!@#&                                                                local fileFormat2 = windows.getFileFormat(key) or \"\"!@#&                                                                local data = windows.input(\"auto\",\"auto\",\"New name\",15,{\"Name\",windows.hideFileFormat(key)},{\"Format\",fileFormat2})!@#&                                                                data[1] = windows.hideFileFormat(data[1])!@#&                                                                if data[1] == \"\" then data[1] = \"MyProgram\" end!@#&                                                                rename(workPath,key,data[1]..data[2])!@#& !@#&                                                        elseif contextAction == \"Set as wallpaper\" then!@#&                                                                setWallpaper(workPath..\"/\"..key)!@#& !@#&                                                        elseif contextAction == \"Run with arguments\" then!@#&                                                                local arguments = windows.input(\"auto\",\"auto\",\"Run\",15,{\"Arguments\",\"\"})!@#&                                                                exit = true!@#&                                                                launchFile(workPath..\"/\"..key,fileFormat,arguments[1])!@#& !@#&                                                        elseif contextAction == \"Upload to pastebin\" then!@#&								term.setBackgroundColor(colors.black)!@#&								term.setTextColor(colors.white)!@#&								term.setCursorPos(1, 1)!@#&								term.clear()!@#&                                                                shell.run(\"pastebin put \"..workPath..\"/\"..key)!@#&								io.read()!@#&                                                                --windows.progressBar(\"auto\",\"auto\",5,\" \",\"Uploading to pastebin\",10)!@#&                                                                --pastebin(\"put\",\"cyka\",workPath..\"/\"..key)!@#& !@#&                                                        elseif contextAction == \"Add to archive\" then!@#&                                                                windows.progressBar(\"auto\",\"auto\",20,\" \",\"Archiving\",10)!@#&								term.setBackgroundColor(colors.black)!@#&								term.setTextColor(colors.white)!@#&								term.clear()!@#&								term.setCursorPos(1,1)!@#&								!@#&                                                                shell.run(\"pkg \"..workPath..\"/\"..key..\" \"..workPath..\"/\"..key..\".zip\")!@#&								sleep(3)!@#& !@#&                                                        elseif contextAction == \"Properties\" then!@#&                                                                displayApps(workPath,currentDesktop,currentBackground)!@#&                                                                windows.aboutFile(x,y,26,workPath..\"/\"..key)!@#& !@#&                                                        elseif contextAction == \"Show content\" then!@#&                                                                gotoDirectory(workPath..\"/\"..key)!@#&                                                        end!@#& !@#&                                                        exit1 = true!@#&                                                        appSelected = true!@#&                                                        displayApps(workPath,currentDesktop,currentBackground)!@#&                                                end!@#&                                        end!@#&                                end!@#&                        end!@#& !@#&                        if y>=2 and appSelected == false then!@#& !@#&                                local thisIsReadOnly = fs.isReadOnly(workPath)!@#&                                local isClipboardEmpty = true!@#&                                if clipboardName ~= nil then isClipboardEmpty = false end!@#&                                if isClipboardEmpty == false then isClipboardEmpty = thisIsReadOnly end!@#& !@#&                                local contextAction = context.menu(x,y,{\"New file\",thisIsReadOnly},{\"New folder\",thisIsReadOnly},{\"Paste\",isClipboardEmpty},\"-\",{\"Run from pastebin\"},{\"Get from pastebin\",thisIsReadOnly},{\"Make URL-file\",thisIsReadOnly})!@#& !@#&                                if contextAction == \"New file\" then!@#& !@#&                                        local filePath = windows.input(\"auto\",\"auto\",\"New file\",15,{\"Name\",\"\"})!@#&                                        fadeOut(0)!@#&                                        prepareToExit()!@#&                                        shell.run(\"/SpeedOS/Applications/SpeedCode \"..workPath..\"/\"..filePath[1])!@#&                                        fadeIn(0)!@#& !@#&                                elseif contextAction == \"New folder\" then!@#& !@#&                                        local filePath = windows.input(\"auto\",\"auto\",\"New folder\",15,{\"Name\",\"\"})!@#&                                        fs.makeDir(workPath..\"/\"..filePath[1])!@#&                               !@#&                                elseif contextAction == \"Paste\" then!@#& !@#&                                        if clipboardName ~= nil and fs.exists(\"System/Clipboard.temp\") then!@#&                                                paste(workPath,clipboardName)!@#&                                        end!@#& !@#&                                elseif contextAction == \"Run from pastebin\" then!@#&                                        local paste = windows.input(\"auto\",\"auto\",\"Run from pastebin\",15,{\"Paste name\",\"\"})!@#&                                        pastebin(\"run\",paste[1],\"cyka\")!@#& !@#&                                elseif contextAction == \"Get from pastebin\" then!@#&                                        local paste = windows.input(\"auto\",\"auto\",\"Get from pastebin\",15,{\"Paste name\",\"\"},{\"File name\",\"\"})!@#&                                        pastebin(\"get\",paste[1],paste[2])!@#&!@#&				elseif contextAction == \"Make URL-file\" then!@#& !@#&                                        local urlPath = windows.input(\"auto\",\"auto\",\"New URL-file\",15,{\"Name\",\"\"},{\"URL\",\"\"})!@#&                                        f = http.get(urlPath[2]).readAll()!@#&                  		        f2 = fs.open(workPath..\"/\"..urlPath[1], \"w\")!@#&					f2.write(f)!@#&					f2.close()!@#&				!@#&				end!@#& !@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        end!@#&                end!@#&                --                                                           !@#&                topBar(topBarColor)!@#&                --                                           ,                         !@#&                term.setCursorBlink(false)!@#& !@#&        --                     ,                              !@#&        elseif event == \"mouse_scroll\" then!@#&                if side == -1 then!@#&                        currentDesktop = currentDesktop + 1!@#&                        if currentDesktop > countOfDesktops then!@#&                                currentDesktop = countOfDesktops!@#&                        else!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        end!@#&                elseif side == 1 then!@#&                        currentDesktop = currentDesktop - 1!@#&                        if currentDesktop < 1 then!@#&                                currentDesktop = 1!@#&                        else!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        end!@#&                end!@#&        elseif event == \"disk\" then!@#&                displayApps(workPath,currentDesktop,currentBackground)!@#&        elseif event == \"disk_eject\" then!@#&                currentDesktop = 1!@#&                workPath = \"\"!@#&                workPathHistory = {}!@#&                displayApps(workPath,currentDesktop,currentBackground)!@#&        --[[elseif event == \"rednet_message\" then!@#&                local msg = textutils.unserialize(x)!@#&                if msg ~= nil then!@#&                        if msg[\"type\"] ~= nil and msg[\"type\"] == \"Notification\" then!@#&                                Notification = msg!@#&                                displayApps(workPath,currentDesktop,currentBackground)!@#&                        end!@#&                end]]!@#&        end!@#&end!@#& !@#&fadeOut(0)!@#&prepareToExit()!@#&--windows.tv(0)",["startup"]="local install_files = {\"VMYEMZAB\", \"installer2\"}!@#&local mon_cfg = \"System/OS/monitor.cfg\"!@#&local use_mon!@#&local side!@#&!@#&for _, value in pairs(install_files) do!@#&  if fs.exists(value) then!@#&    fs.delete(value)!@#&  end!@#&end!@#&!@#&if not fs.exists(mon_cfg) then!@#&  mon_cfg2 = fs.open(mon_cfg, \"w\")!@#&  mon_cfg2.write(\"false\")!@#&  mon_cfg2.close()!@#&!@#&else!@#&  mon_cfg2 = fs.open(mon_cfg, \"r\")!@#&  data_cfg = mon_cfg2.readAll()!@#&  if data_cfg == \"false\" then!@#&    use_mon = false!@#&  else!@#&    use_mon = true!@#&  end!@#&end!@#&!@#&if use_mon then!@#&  for _, value in pairs(rs.getSides()) do!@#&    if peripheral.getType(value) == \"monitor\" then!@#&      side = value     !@#&      break!@#&    end!@#&  end!@#&  !@#&  shell.run(\"monitor \"..side..\" SpeedOS/APILoader\")  !@#&  shell.run(\"monitor \"..side..\" os\")!@#&!@#&else!@#&  shell.run(\"SpeedOS/APILoader\")!@#&  shell.run(\"os\")!@#&end",["SpeedOS"]={["APILoader"]="local dir_api = \"/SpeedAPI/\"!@#&local dir_utils = \"/SpeedOS/Applications/Utils/\"!@#&!@#&-----????????? ?????-----!@#&os.loadAPI(dir_api..\"SpeedText\")!@#&!@#&local loading_api = 0.1!@#&local loading_utils = 0.1!@#&local sleep_before_start = 1!@#&!@#&local list_api = fs.list(dir_api)!@#&local list_utils = fs.list(dir_utils)!@#&!@#&term.setTextColor(colors.lightGray)!@#&term.setBackgroundColor(colors.gray)!@#&term.setCursorPos(1, 1)!@#&term.clear()!@#&!@#&for _, value in pairs(list_api) do!@#&  os.unloadAPI(dir_api..value)!@#&  if not value == \"SpeedText\" then!@#&    os.loadAPI(dir_api..value)!@#&  end!@#&  SpeedText.cPrint(\"API \"..value..\" loaded!\")!@#&  sleep(loading_api)!@#&  term.clear()!@#&end!@#&!@#&for _, value in pairs(list_utils) do!@#&  shell.setAlias(value, dir_utils..value)!@#&  SpeedText.cPrint(\"Alias \"..value..\" loading done!\")!@#&  sleep(loading_utils)  !@#&  term.clear()!@#&end!@#&!@#&sleep(sleep_before_start)!@#&SpeedText.cPrint(\"Done!\")!@#&sleep(0.5)",["Pictures"]={["Litva2.nfp"]="1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&1111111111111111111111111111111111111111111111111111111111111111111111111111111111!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",["TechWorld.nfp"]="0000000000000000000000000000000000000099999999800000000000000000000000000000000000!@#&0000000000000000000000000000000000000999999999999999999000000000000000000000000000!@#&0000000000000000000000099000000000000999999b000a9999999999990000000000000000000000!@#&0000000000000000000099999990000000000999999a0a999999996099999990000000000000000000!@#&0000000000000000009999999999000000009999999a0999999999a0b9999999990000000000000000!@#&000000000000000000099999999999999999999992060999999000a0a9999999999980000000000000!@#&00000000000000000000999999999999999999999999999999600aaa9999999a099999900000000000!@#&00000000000000000000099999999999999999999999999999999a0b99960a90a99999990000000000!@#&000000000000000000009999999999999800000000000000099999999999a200999999999900000000!@#&000000099999b0000099999999999000000000000000000000000899999bb999999999999990000000!@#&00000099999999999999999999000000000000000000000000000000899999999ba900990999900000!@#&000009999999999999999999000000000000008b99bb80000000000000099999920990069999990000!@#&00000099999999999999990000000000899999999999999999000000000009999000a9999999998000!@#&00000000009999999999800000000099999999999999999999999000000000999999999999aa999000!@#&000000000009999999900000000099999999999999999999999999900000000999999a000a99999900!@#&0000000000099999990000000099999999999999999999999999999900000000999990a99ba0299980!@#&000000000099999999000000099999999999000000000009999999999000000009990002a999999990!@#&000000000999999990000000999999999b000000000000000999999999000000099999999999999990!@#&0999999999999999900000009999999980000000000000000099999999b00000009999999999a99990!@#&099999999999999990000000999999990000000000000000000999999990000000999920a0a0099999!@#&0999999999999999900000009999999900000000000000000009999999900000009990062206999999!@#&0899999999999999900000009999999900000000000000000089999999900000009999999999999990!@#&00000000099999999000000089999999900000000000000000999999990000000b9999999999999990!@#&00000000009999999b00000009999999999000000000000099999999900000000999a60006a9999990!@#&000000000009999999000000009999999999990000000999999999990000000099999900a960a99900!@#&00000000000999999990000000009999999999999999999999999990000000099999999900a9999900!@#&0000000009999999999990000000009999999999999999999999900000000099999999999999999000!@#&000000999999999999999900000000000999999999999999990000000000999999a009999999990000!@#&0000099999999999999999990000000000000009bbb80000000000000089999996a6002a0999980000!@#&00000099999999999999999999000000000000000000000000000000999999999999600a9999800000!@#&0000000899990000009999999999980000000000000000000000099999999aa2999999999990000000!@#&0000000000000000000099999999999999800000000000009999999999920a99999999999900000000!@#&0000000000000000000009999999999999999999999999999999999a9999900a099999990000000000!@#&00000000000000000000999999999999999999999999999999990000a99999a0a99999000000000000!@#&00000000000000000009999999999999999999999999209999999990a9999999a99900000000000000!@#&000000000000000000999999999900000000999999990009999999a090099999990000000000000000!@#&00000000000000000000b99999b000000000099999900960b999996099999990000000000000000000!@#&000000000000000000000008900000000000099999a0a00a0a99999999900000000000000000000000!@#&0000000000000000000000000000000000000999999999999999990000000000000000000000000000!@#&0000000000000000000000000000000000000009999980000000000000000000000000000000000000",["SpeedOS_SECRET.nfp"]="eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeee000000000000000eeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeee0000000000000000000000eeeeeeeeeeeeee!@#&eeeeeeeeeee00000000000000000000000000000eeeeeeeeeee!@#&eeeeeeeee000000000000000000000000000000000eeeeeeeee!@#&eeeeeee0000000000000000000000000000000000000eeeeeee!@#&eeeee00000000fff70ffffff0ff7ff0fffff0ff7ff0000eeeee!@#&eeeee07707700ff7f0ffffff0f7fff0fffff0f7fff0770eeeee!@#&eeeee0ff0ff00f7000ff00ff07f0000ff00007f0000ff0eeeee!@#&eeeee0f00f0007fff0ffffff0ff7f00ffff00ff7f00f00eeeee!@#&eeeee0ff0ff00fff707fffff0f7ff00ffff00f7ff00ff0eeeee!@#&eeeee0f00f000007f07ff00007f0000ff00007f0000f00eeeee!@#&eeeee0ff0ff007fff07f70000fff7f0fffff0fff7f0ff0eeeee!@#&eeeeeee0000007fff07f70000ff7ff0fffff0ff7ff00eeeeeee!@#&eeeeeeeee000000000000000000000000000000000eeeeeeeee!@#&eeeeeeeeeee00000000000000000000000000000eeeeeeeeeee!@#&eeeeeeeeeeeeeee000000000000000000000eeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeee00000000000000000eeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",["Logo.skch"]="",["Computer.skch"]="{[1]={[\"Visible\"]=true,[\"Pixels\"]={[1]=\"4f               \",[2]=\"4f f             4 \",[3]=\"4f f 4> 0eblan4     4 \",[4]=\"4f f   4 f         4 \",[5]=\"4f f             4 \",[6]=\"4f f             4 \",[7]=\"4f f             4 \",[8]=\"4f f             4 \",[9]=\"4f f        5.e .f  4 \",[10]=\"4f               \",},[\"Index\"]=1,[\"Name\"]=\"Background\",[\"BackgroundColour\"]=-1,},}",["GrammatikFrei.nfp"]="eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeee000000000000000000eeeeeeeeeeeeeeee!@#&eeeeeeeeeeeee0000000000fff000000000000eeeeeeeeeeeee!@#&eeeeeeeeeee0000000008ffffff00000000000000eeeeeeeeee!@#&eeeeeeeeee00000000ffffff0000000ff000000000eeeeeeeee!@#&eeeeeeeee000000ffffff0000000ffffffff0000000eeeeeeee!@#&eeeeeeee0000fffffff0000000fffffffffffff00000eeeeeee!@#&eeeeeeee000fffffff00000fffffff000007ffffff00eeeeeee!@#&eeeeeeee000000fffffff0000ff00000000fffff000eeeeeeee!@#&eeeeeeeee00000000fffffff00000000fffff700000eeeeeeee!@#&eeeeeeeeee000000000ffffffff00ffffff0000006eeeeeeeee!@#&eeeeeeeeeeee0000000000ffffffffff00000000eeeeeeeeeee!@#&eeeeeeeeeeeeee60000000000ffff00000000eeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeee00000000000000eeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",["Litva.nfp"]="111111111111111111111111111111111111111111111111111!@#&111111111111111111111111111111111111111111111111111!@#&111111111111111111111111111111111111111111111111111!@#&111111111111111111111111111111111111111111111111111!@#&111111111111111111111111111111111111111111111111111!@#&111111111111111111111111111111111111111111111111111!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&ddddddddddddddddddddddddddddddddddddddddddddddddddd!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee!@#&eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",["Smile.nfp"]="000000000000000!@#&0000f00000f0000!@#&000000000000000!@#&000000000000000!@#&00f000000000f00!@#&000ff00000ff000!@#&00000fffff00000!@#&000000000000000!@#&000000000000000!@#&000000000000000",["Penguin.gif"]="GIF89a2\0002\000\000\000\"\"\"***333;;;DDDLLLfff\000\000 4Sz\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000!NETSCAPE2.0\000\000\000!100% by Angelishi\000!d\000\000,\000\000\000\0002\0002\000\000 \"dIhfeJt=pv>KGD\000j@r	#2'`mouzBynzV|}0^h7Q3jJ\\5\000u'4^{c3(@g72		e\"x+^	!@#&!@#&4*54!@#&!@#&	!@#&!@#&	he3!@#&~-\"06+eC`l+)/%BrKNBZI:bBzt4#!@#&AJ<R`LCJ-z$p\000Q_!@#&:K]5BW1=S-Af%#x7^LH80a\000rE`sR-mjYF(hM4C]63  _g }\000c]g>3k>-o=|~.gL3Q`ra~tSL7(D p!`\000$`5	(#.?f$O>;&0\000\000!\000\000,\000\000$\000\000\000( hhj-!(/)g\000!\000\000,\000\000$\000\000\000 A Hl;g\000IKDm \000!\000\000,\000\000$\000\000\000! Q\000 hl:'\000Mbx+6 ?& GL\000!\000\000,\000\000$\000\000\0002 @ h)BS4,$t?:G,\000F#R\000L<M!U\000!\000\000,\000\000$\000\000\000( hhj-!(/)g\000!\000\000,\000\000$\000\000\000 A Hl;g\000IKDm \000!\000\000,\000\000$\000\000\000! Q\000 hl:'\000Mbx+6 ?& GL\000!2\000\000,\000\000$\000\000\0002 @ h)BS4,$t?:G,\000F#R\000L<M!U\000!\000\000,\000\000$\000\000\000( hhj-!(/)g\000!\000\000,\000\000$\000\000\000 A Hl;g\000IKDm \000!\000\000,\000\000$\000\000\000! Q\000 hl:'\000Mbx+6 ?& GL\000;",},["Downloads"]={},["Songs"]={["EvasiveAction"]="9gkKQgoJwcKbeYthmSvlbn9UAUmPdz1a!@#&ThinkInvisible - CTracker song file!@#&You probably shouldn't change this manually!@#&1.0!@#&6.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&75.0!@#&-2.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&77.0!@#&-2.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&75.0!@#&-2.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&77.0!@#&-2.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&55.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&55.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&75.0!@#&-2.0!@#&72.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&77.0!@#&-2.0!@#&54.0!@#&48.0!@#&-2.0!@#&-1.0!@#&55.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&48.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&55.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&66.0!@#&60.0!@#&-2.0!@#&-1.0!@#&67.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&60.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&67.0!@#&63.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&66.0!@#&-1.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&67.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&75.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&55.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&55.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&75.0!@#&72.0!@#&-2.0!@#&-1.0!@#&75.0!@#&72.0!@#&-2.0!@#&-1.0!@#&75.0!@#&72.0!@#&-2.0!@#&-1.0!@#&75.0!@#&72.0!@#&-2.0!@#&-1.0!@#&60.0!@#&60.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0!@#&-1.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-1.0!@#&51.0!@#&-1.0!@#&55.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&65.0!@#&67.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&65.0!@#&67.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&60.0!@#&-2.0!@#&-1.0!@#&63.0!@#&60.0!@#&-2.0!@#&-1.0!@#&63.0!@#&60.0!@#&-2.0!@#&-1.0!@#&63.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&60.0!@#&60.0!@#&60.0!@#&63.0!@#&60.0!@#&60.0!@#&60.0!@#&63.0!@#&60.0!@#&60.0!@#&60.0!@#&66.0!@#&65.0!@#&63.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&67.0!@#&63.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&67.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&55.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&67.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&67.0!@#&60.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&53.0!@#&55.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&67.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&66.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&60.0!@#&-2.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&55.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&65.0!@#&67.0!@#&-2.0!@#&-1.0!@#&72.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&62.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&61.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&63.0!@#&-2.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-2.0!@#&-2.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-2.0!@#&-2.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-2.0!@#&-2.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&60.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&63.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&65.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&24.0!@#&-1.0!@#&36.0!@#&-1.0!@#&48.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&27.0!@#&-1.0!@#&39.0!@#&-1.0!@#&51.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&-2.0!@#&-1.0!@#&29.0!@#&-1.0!@#&41.0!@#&-1.0!@#&53.0!@#&-1.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&48.0!@#&-2.0!@#&48.0!@#&-2.0!@#&48.0!@#&63.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&60.0!@#&-2.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&-1.0!@#&54.0",},["Documents"]={["House2.nfa"]="        !@#&        !@#&        !@#&        !@#&   44444!@#&   4ccc4!@#&   4ccc4!@#&   4ccc4!@#&   44444!@#&     1  !@#&~!@#&        !@#&        !@#&        !@#&        !@#&   44444!@#&   4   4!@#&   4   4!@#&   4   4!@#&   44 44!@#&        !@#&~!@#&        !@#&        !@#&        !@#&        !@#&   44944!@#&   4   4!@#&   9   9!@#&   4   4!@#&   44 44!@#&        !@#&~!@#&        !@#&        !@#&        !@#&        !@#&   44444!@#&   4   4!@#&   4   4!@#&   4   4!@#&   44444!@#&        !@#&~!@#&        !@#&        !@#&        !@#&        !@#&   44444!@#&   4cc 4!@#&   4ccc4!@#&   4ccc4!@#&   44444!@#&        !@#&~!@#&        !@#&        !@#&        !@#&        !@#&   fffff!@#&   f   f!@#&   f   f!@#&   f   f!@#&   fffff!@#&        ",["House.nfa"]="!@#&!@#&!@#&!@#&!@#&     4444444!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4444444!@#&~!@#&!@#&!@#&!@#&!@#&!@#&     4444444!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4444444!@#&~!@#&!@#&!@#&!@#&!@#&!@#&     4444444!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4444444!@#&~!@#&!@#&!@#&!@#&!@#&!@#&     4444444!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4     4!@#&     4444444!@#&~!@#&!@#&!@#&!@#&!@#&!@#&     4444444!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4ccccc4!@#&     4444444",},["Applications"]={["PastebinClient"]="os.loadAPI(\"/SpeedAPI/SpeedGUI\")!@#&os.loadAPI(\"/SpeedAPI/lddfm\")!@#&term.setBackgroundColor(colors.gray)!@#&term.setCursorPos(18, 2)!@#&term.clear()!@#&print(\"Pastebin client\")!@#&!@#&function download()!@#&!@#&  term.setBackgroundColor(colors.gray)!@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(2, 2)!@#&  term.clear()!@#&  !@#&  print(\"Enter code: \")!@#&  term.setCursorPos(25, 2)!@#&  term.setBackgroundColor(colors.lightGray)!@#&  term.setTextColor(colors.white)!@#&  print(\"          \")!@#&  !@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(25, 2)!@#&  code = io.read()!@#&!@#&  term.setBackgroundColor(colors.gray)!@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(2, 4)!@#&  !@#&  print(\"Enter filename: \")!@#&  term.setCursorPos(25, 4)!@#&  term.setBackgroundColor(colors.lightGray)!@#&  term.setTextColor(colors.white)!@#&  print(\"          \")!@#&  !@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(25, 4)!@#&  fn = io.read()!@#&  !@#&  term.setBackgroundColor(colors.gray)!@#&  term.setTextColor(colors.lime)!@#&  term.setCursorPos(2, 6)!@#&!@#&  shell.run(\"pastebin get \"..tostring(code)..\" /SpeedOS/Downloads/\"..tostring(fn))!@#&  !@#&  sleep(1)!@#&  term.setTextColor(colors.white)!@#&  term.setBackgroundColor(colors.black)!@#&  term.clear()!@#&  error()!@#&end!@#&!@#&function upload()!@#&!@#&  term.setBackgroundColor(colors.gray)!@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(2, 2)!@#&  term.clear()!@#&  !@#&  print(\"Enter filename: \")!@#&  term.setCursorPos(25, 2)!@#&  term.setBackgroundColor(colors.lightGray)!@#&  term.setTextColor(colors.white)!@#&  print(\"          \")!@#&  !@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(25, 2)!@#&  f_n = tostring(lddfm.makeMenu())!@#&!@#&  term.setBackgroundColor(colors.gray)!@#&  term.setTextColor(colors.lime)!@#&  term.setCursorPos(2, 4)!@#&  term.clear()!@#&!@#&  shell.run(\"pastebin put \"..tostring(f_n))!@#&  !@#&  sleep(3)!@#&  term.setTextColor(colors.white)!@#&  term.setBackgroundColor(colors.black)!@#&  term.clear()!@#&  error()!@#&end!@#&!@#&SpeedGUI.gui.button.add(\"Upload to pastebin\",upload,15,5,2,3,colors.white,colors.orange)!@#&SpeedGUI.gui.button.add(\"Download from pastebin\",download,13,9,2,3,colors.white,colors.orange)!@#&SpeedGUI.start()",["Logs"]={},["OLD_NPaint"]="--[[!@#&                NPaintPro!@#&                By NitrogenFingers!@#&]]--!@#& !@#&--The screen size!@#&local w,h = term.getSize()!@#&--Whether or not the program is currently waiting on user input!@#&local inMenu = false!@#&--Whether or not a drop down menu is active!@#&local inDropDown = false!@#&--Whether or not animation tools are enabled (use -a to turn them on)!@#&local animated = false!@#&--Whether or not the text tools are enabled (use -t to turn them on)!@#&local textual = false!@#&--Whether or not \"blueprint\" display mode is on!@#&local blueprint = false!@#&--Whether or not the \"layer\" display is on!@#&local layerDisplay = false!@#&--Whether or not the interface is presently hidden!@#&local interfaceHidden = false!@#&--Whether or not the \"direction\" display is on!@#&local printDirection = false!@#&--The tool/mode npaintpro is currently in. Default is \"paint\"!@#&--For a list of modes, check out the help file!@#&local state = \"paint\"!@#&--Whether or not the program is presently running!@#&local isRunning = true!@#&--The rednet address of the 3D printer, if one has been attached!@#&local printer = nil!@#& !@#&--The list of every frame, containing every image in the picture/animation!@#&--Note: nfp files always have the picture at frame 1!@#&local frames = { }!@#&--How many frames are currently in the given animation.!@#&local frameCount = 1!@#&--The Colour Picker column!@#&local column = {}!@#&--The offset of visible colours in the picker column, if the screen cannot fit all 16!@#&local columnoffset = 0!@#&--The currently selected left and right colours!@#&local lSel,rSel = colours.white,nil!@#&--The amount of scrolling on the X and Y axis!@#&local sx,sy = 0,0!@#&--The alpha channel colour!@#&--Change this to change default canvas colour!@#&local alphaC = colours.black!@#&--The currently selected frame. Default is 1!@#&local sFrame = 1!@#&--The contents of the image buffer- contains contents, width and height!@#&local buffer = nil!@#&--The position, width and height of the selection rectangle!@#&local selectrect = nil!@#& !@#&--Whether or not text tools are enabled for this document!@#&local textEnabled = false!@#&--The X and Y positions of the text cursor!@#&local textCurX, textCurY = 1,1!@#& !@#&--The currently calculated required materials!@#&local requiredMaterials = {}!@#&--Whether or not required materials are being displayed in the pallette!@#&local requirementsDisplayed = false!@#&--A list of the rednet ID's all in-range printers located!@#&local printerList = { }!@#&--A list of the names of all in-range printers located. Same as the printerList in reference!@#&local printerNames = { }!@#&--The selected printer!@#&local selectedPrinter = 1!@#&--The X,Y,Z and facing of the printer!@#&local px,py,pz,pfx,pfz = 0,0,0,0,0!@#&--The form of layering used!@#&local layering = \"up\"!@#& !@#&--The animation state of the selection rectangle and image buffer!@#&local rectblink = 0!@#&--The ID for the timer!@#&local recttimer = nil!@#&--The radius of the brush tool!@#&local brushsize = 3!@#&--Whether or not \"record\" mode is activated (animation mode only)!@#&local record = false!@#&--The time between each frame when in play mode (animation mode only)!@#&local animtime = 0.3!@#& !@#&--The current \"cursor position\" in text mode!@#&local cursorTexX,cursorTexY = 1,1!@#& !@#&--A list of hexidecimal conversions from numbers to hex digits!@#&local hexnums = { [10] = \"a\", [11] = \"b\", [12] = \"c\", [13] = \"d\", [14] = \"e\" , [15] = \"f\" }!@#&--The NPaintPro logo (divine, isn't it?)!@#&local logo = {!@#&\"fcc              3   339\";!@#&\" fcc          9333    33\";!@#&\"  fcc        933 333  33\";!@#&\"   fcc       933  33  33\";!@#&\"    fcc      933   33 33\";!@#&\"     c88     333   93333\";!@#&\"     888     333    9333\";!@#&\"      333 3  333     939\";!@#&}!@#&--The Layer Up and Layer Forward printing icons!@#&local layerUpIcon = {!@#&        \"0000000\";!@#&        \"0088880\";!@#&        \"0888870\";!@#&        \"07777f0\";!@#&        \"0ffff00\";!@#&        \"0000000\";!@#&}!@#&local layerForwardIcon = {!@#&        \"0000000\";!@#&        \"000fff0\";!@#&        \"00777f0\";!@#&        \"0888700\";!@#&        \"0888000\";!@#&        \"0000000\";!@#&}!@#&--The available menu options in the ctrl menu!@#&local mChoices = {\"Save\",\"Exit\"}!@#&--The available modes from the dropdown menu- tables indicate submenus (include a name!)!@#&local ddModes = { { \"paint\", \"brush\", \"pippette\", \"flood\", \"move\", \"clear\", \"select\", name = \"painting\" }, { \"alpha to left\", \"alpha to right\", \"hide interface\", name = \"display\" }, \"help\", { \"print\", \"save\", \"exit\", name = \"file\" }, name = \"menu\" }!@#&--The available modes from the selection right-click menu!@#&local srModes = { \"cut\", \"copy\", \"paste\", \"clear\", \"hide\", name = \"selection\" }!@#&--The list of available help topics for each mode 127!@#&local helpTopics = {!@#&        [1] = {!@#&                name = \"Paint Mode\",!@#&                key = nil,!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"The default mode for NPaintPro, for painting pixels.\"!@#&                ..\" Controls here that are not overridden will apply for all other modes. Leaving a mode by selecting that mode \"!@#&                ..\" again will always send the user back to paint mode.\",!@#&                controls = {!@#&                        { \"Arrow keys\", \"Scroll the canvas\" },!@#&                        { \"Left Click\", \"Paint/select left colour\" },!@#&                        { \"Right Click\", \"Paint/select right colour\" },!@#&                        { \"Z Key\", \"Clear image on screen\" },!@#&                        { \"Tab Key\", \"Hide selection rectangle if visible\" },!@#&                        { \"Q Key\", \"Set alpha mask to left colour\" },!@#&                        { \"W Key\", \"Set alpha mask to right colour\" },!@#&                        { \"Number Keys\", \"Swich between frames 1-9\" },!@#&                        { \"</> keys\", \"Move to the next/last frame\" },!@#&                        { \"R Key\", \"Removes every frame after the current frame\"}!@#&                }!@#&        },!@#&        [2] = {!@#&                name = \"Brush Mode\",!@#&                key = \"b\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Brush mode allows painting a circular area of variable diameter rather than a single pixel, working in \"..!@#&                \"the exact same way as paint mode in all other regards.\",!@#&                controls = {!@#&                        { \"Left Click\", \"Paints a brush blob with the left colour\" },!@#&                        { \"Right Click\", \"Paints a brush blob with the right colour\" },!@#&                        { \"Number Keys\", \"Changes the radius of the brush blob from 2-9\" }!@#&                }!@#&        },!@#&        [3] = {!@#&                name = \"Pippette Mode\",!@#&                key = \"p\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Pippette mode allows the user to click the canvas and set the colour clicked to the left or right \"..!@#&                \"selected colour, for later painting.\",!@#&                controls = {!@#&                        { \"Left Click\", \"Sets clicked colour to the left selected colour\" },!@#&                        { \"Right Click\", \"Sets clicked colour to the right selected colour\" }!@#&                }!@#&        },!@#&        [4] = {!@#&                name = \"Move Mode\",!@#&                key = \"m\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Mode mode allows the moving of the entire image on the screen. This is especially useful for justifying\"..!@#&                \" the image to the top-left for animations or game assets.\",!@#&                controls = {!@#&                        { \"Left/Right Click\", \"Moves top-left corner of image to selected square\" },!@#&                        { \"Arrow keys\", \"Moves image one pixel in any direction\" }!@#&                }!@#&        },!@#&        [5] = {!@#&                name = \"Flood Mode\",!@#&                key = \"f\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Flood mode allows the changing of an area of a given colour to that of the selected colour. \"..!@#&                \"The tool uses a flood4 algorithm and will not fill diagonally. Transparency cannot be flood filled.\",!@#&                controls = {!@#&                        { \"Left Click\", \"Flood fills selected area to left colour\" },!@#&                        { \"Right Click\", \"Flood fills selected area to right colour\" }!@#&                }!@#&        },!@#&        [6] = {!@#&                name = \"Select Mode\",!@#&                key = \"s\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Select mode allows the creation and use of the selection rectangle, to highlight specific areas on \"..!@#&                \"the screen and perform operations on the selected area of the image. The selection rectangle can contain an \"..!@#&                \"image on the clipboard- if it does, the image will flash inside the rectangle, and the rectangle edges will \"..!@#&                \"be light grey instead of dark grey.\",!@#&                controls = {!@#&                        { \"C Key\", \"Copy: Moves selection into the clipboard\" },!@#&                        { \"X Key\", \"Cut: Clears canvas under the rectangle, and moves it into the clipboard\" },!@#&                        { \"V Key\", \"Paste: Copys clipboard to the canvas\" },!@#&                        { \"Z Key\", \"Clears clipboard\" },!@#&                        { \"Left Click\", \"Moves top-left corner of rectangle to selected pixel\" },!@#&                        { \"Right Click\", \"Opens selection menu\" },!@#&                        { \"Arrow Keys\", \"Moves rectangle one pixel in any direction\" }!@#&                }!@#&        },!@#&        [7] = {!@#&                name = \"Corner Select Mode\",!@#&                key = nil,!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"If a selection rectangle isn't visible, this mode is selected automatically. It allows the \"..!@#&                \"defining of the corners of the rectangle- one the top-left and bottom-right corners have been defined, \"..!@#&                \"NPaintPro switches to selection mode. Note rectangle must be at least 2 pixels wide and high.\",!@#&                controls = {!@#&                        { \"Left/Right Click\", \"Defines a corner of the selection rectangle\" }!@#&                }!@#&        },!@#&        [8] = {!@#&                name = \"Play Mode\",!@#&                key = \"space\",!@#&                animonly = true,!@#&                textonly = false,!@#&                message = \"Play mode will loop through each frame in your animation at a constant rate. Editing tools are \"..!@#&                \"locked in this mode, and the coordinate display will turn green to indicate it is on.\",!@#&                controls = {!@#&                        { \"</> Keys\", \"Increases/Decreases speed of the animation\" },!@#&                        { \"Space Bar\", \"Returns to paint mode\" }!@#&                }!@#&        },!@#&        [9] = {!@#&                name = \"Record Mode\",!@#&                key = \"\\\\\",!@#&                animonly = true,!@#&                textonly = false,!@#&                message = \"Record mode is not a true mode, but influences how other modes work. Changes made that modify the \"..!@#&                \"canvas in record mode will affect ALL frames in the animation. The coordinates will turn red to indicate that \"..!@#&                \"record mode is on.\",!@#&                controls = {!@#&                        { \"\", \"Affects:\" },!@#&                        { \"- Paint Mode\", \"\" },!@#&                        { \"- Brush Mode\", \"\" },!@#&                        { \"- Cut and Paste in Select Mode\", \"\"},!@#&                        { \"- Move Mode\", \"\"}!@#&                }!@#&        },!@#&		[10] = {!@#&				name = \"Hide Interface\",!@#&				key = \"~\",!@#&				animonly = false,!@#&				textonly = false,!@#&				message = \"Hides the sidebar and colour picker so only the image is visible.\"..!@#&				\" The program can be started with the interface hidden using the -d command line option.\"..!@#&				\" When hidden, if a file is animated it will automatically go to play mode.\\n\"..!@#&				\"Note that all other input is locked until the display is revealed again in this\"..!@#&				\" mode.\",!@#&				controls = {!@#&                    { \"</> Keys\", \"Increases/Decreases speed of the animation\" },!@#&					{ \"~ Key\", \"Shows interface\"}!@#&				}!@#&		},!@#&        [11] = {!@#&                name = \"Help Mode\",!@#&                key = \"h\",!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Displays this help screen. Clicking on options will display help on that topic. Clicking out of the screen\"..!@#&                \" will leave this mode.\",!@#&                controls = {!@#&                        { \"Left/Right Click\", \"Displays a topic/Leaves the mode\" }!@#&                }!@#&        },!@#&        [12] = {!@#&                name = \"File Mode\",!@#&                key = nil,!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"Clicking on the mode display at the bottom of the screen will open the options menu. Here you can\"..!@#&                \" activate all of the modes in the program with a simple mouse click. Pressing left control will open up the\"..!@#&                \" file menu automatically.\",!@#&                controls = {!@#&                        { \"leftCtrl\", \"Opens the file menu\" },!@#&                        { \"leftAlt\", \"Opens the paint menu\" }!@#&                }!@#&        },!@#&        [13] = {!@#&                name = \"Text Mode\",!@#&                key = \"t\",!@#&                animonly = false,!@#&                textonly = true,!@#&                message = \"In this mode, the user is able to type letters onto the document for display. The left colour \"..!@#&                \"pallette value determines what colour the text will be, and the right determines what colour the background \"..!@#&                \"will be (set either to nil to keep the same colours as already there).\",!@#&                controls = {!@#&                        { \"Backspace\", \"Deletes the character on the previous line\" },!@#&                        { \"Arrow Keys\", \"Moves the cursor in any direction\" },!@#&                        { \"Left Click\", \"Moves the cursor to beneath the mouse cursor\" }!@#&                }!@#&        },!@#&        [14] = {!@#&                name = \"Textpaint Mode\",!@#&                key = \"y\",!@#&                animonly = false,!@#&                textonly = true,!@#&                message = \"Allows the user to paint any text on screen to the desired colour with the mouse. If affects the text colour\"..!@#&                \" values rather than the background values, but operates identically to paint mode in all other regards.\",!@#&                controls = {!@#&                        { \"Left Click\", \"Paints the text with the left colour\" },!@#&                        { \"Right Click\", \"Paints the text with the right colour\" }!@#&                }!@#&        },!@#&        [15] = {!@#&                name = \"About NPaintPro\",!@#&                keys = nil,!@#&                animonly = false,!@#&                textonly = false,!@#&                message = \"NPaintPro: The feature-bloated paint program for SpeedOS.\",!@#&                controls = {!@#&                        { \"Testers:\", \" \"},!@#&                        { \" \", \"Faubiguy\"},!@#&                        { \" \", \"TheOriginalBIT\"}!@#&                }!@#&        }!@#&}!@#&--The \"bounds\" of the image- the first/last point on both axes where a pixel appears!@#&local toplim,botlim,leflim,riglim = nil,nil,nil,nil!@#&--The selected path!@#&local sPath = nil!@#&!@#&!@#&--Screen Size Parameters- decided dynamically further down the program!@#&--Whether or not the help screen is available!@#&local helpAvailable = true!@#&--Whether or not the main menu is available!@#&local mainAvailable = true!@#&--Whether or not selection box dropdowns are available!@#&local boxdropAvailable = true!@#&--Whether or not a manual file descriptor option is available (part of the title)!@#&local filemakerAvailable = true!@#& !@#&--[[  !@#&                        Section:  Helpers              !@#&]]--!@#& !@#&--[[Converts a colour parameter into a single-digit hex coordinate for the colour!@#&    Params: colour:int = The colour to be converted!@#&        Returns:string A string conversion of the colour!@#&]]--!@#&local function getHexOf(colour)!@#&        if not colour or not tonumber(colour) then!@#&                return \" \"!@#&        end!@#&        local value = math.log(colour)/math.log(2)!@#&        if value > 9 then!@#&                value = hexnums[value]!@#&        end!@#&        return value!@#&end!@#& !@#&--[[Converts a hex digit into a colour value!@#&        Params: hex:?string = the hex digit to be converted!@#&        Returns:string A colour value corresponding to the hex, or nil if the character is invalid!@#&]]--!@#&local function getColourOf(hex)!@#&        local value = tonumber(hex, 16)!@#&        if not value then return nil end!@#&        value = math.pow(2,value)!@#&        return value!@#&end!@#& !@#&--[[Finds the largest width and height of the text in a given menu. Should conform to the format!@#&	of all standard menus (number indexed values and a 'name' field).!@#&	This is done recursively. It's just easier that way.!@#&	Params: menu:table = the table being tested for the max width and height!@#&	Returns:number,number = the max width and height of the text or names of any menu or submenu.!@#&]]--!@#&local function findMaxWH(menu)!@#&	local wmax,hmax = #menu.name, #menu!@#&	for _,entry in pairs(menu) do!@#&		if type(entry) == \"table\" then!@#&			local nw,nh = findMaxWH(entry)!@#&			wmax = math.max(wmax,nw)!@#&			hmax = math.max(hmax,nh)!@#&		else!@#&			wmax = math.max(wmax,#entry)!@#&		end!@#&	end!@#&	return wmax,hmax!@#&end!@#& !@#&--[[Determines what services are available depending on the size of the screen. Certain features!@#&	may be disabled with screen real estate does not allow for it.!@#&	Params: none!@#&	Returns:nil!@#&]]--!@#&local function determineAvailableServices()!@#&	--Help files were designed to fit a 'standard' CC screen, of 51 x 19. The height of the screen!@#&	--needs to match the number of available options plus white space, but for consistency with!@#&	--the files themselves, a natural size of 51 is required for the screen width as well.!@#&	if w < 51 or h < #helpTopics+3 then helpAvailable = false end!@#&	if not helpAvailable then table.remove(ddModes,3) end!@#&	--These hard-coded values mirror the drawLogo values, with extra consideration for the !@#&	--additional menu options!@#&	if h < 14 or w < 24 then filemakerAvailable = false end!@#&	!@#&	--Menus can't cover the picker and need 2 spaces for branches. 4 whitespace on X total.!@#&	--Menus need a title and can't eclipse the footer. 2 whitespace on Y total.!@#&	local wmin,hmin = findMaxWH(ddModes)!@#&	if w < wmin+4 or h < hmin+2 then mainAvailable = false end!@#&	wmin,hmin = findMaxWH(srModes)!@#&	if w < wmin+4 or h < hmin+2 then boxdropAvailable = false end!@#&end!@#& !@#&--[[Finds the biggest and smallest bounds of the image- the outside points beyond which pixels do not appear!@#&        These values are assigned to the \"lim\" parameters for access by other methods!@#&        Params: forAllFrames:bool = True if all frames should be used to find bounds, otherwise false or nil!@#&        Returns:nil!@#&]]--!@#&local function updateImageLims(forAllFrames)!@#&        local f,l = sFrame,sFrame!@#&        if forAllFrames == true then f,l = 1,framecount end!@#&       !@#&        toplim,botlim,leflim,riglim = nil,nil,nil,nil!@#&        for locf = f,l do!@#&                for y,_ in pairs(frames[locf]) do!@#&                        if type(y) == \"number\" then!@#&                                for x,_ in pairs(frames[locf][y]) do!@#&                                        if frames[locf][y][x] ~= nil then!@#&                                                if leflim == nil or x < leflim then leflim = x end!@#&                                                if toplim == nil or y < toplim then toplim = y end!@#&                                                if riglim == nil or x > riglim then riglim = x end!@#&                                                if botlim == nil or y > botlim then botlim = y end!@#&                                        end!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&       !@#&        --There is just... no easier way to do this. It's horrible, but necessary!@#&        if textEnabled then!@#&                for locf = f,l do!@#&                        for y,_ in pairs(frames[locf].text) do!@#&                                for x,_ in pairs(frames[locf].text[y]) do!@#&                                        if frames[locf].text[y][x] ~= nil then!@#&                                                if leflim == nil or x < leflim then leflim = x end!@#&                                                if toplim == nil or y < toplim then toplim = y end!@#&                                                if riglim == nil or x > riglim then riglim = x end!@#&                                                if botlim == nil or y > botlim then botlim = y end!@#&                                        end!@#&                                end!@#&                        end!@#&                        for y,_ in pairs(frames[locf].textcol) do!@#&                                for x,_ in pairs(frames[locf].textcol[y]) do!@#&                                        if frames[locf].textcol[y][x] ~= nil then!@#&                                                if leflim == nil or x < leflim then leflim = x end!@#&                                                if toplim == nil or y < toplim then toplim = y end!@#&                                                if riglim == nil or x > riglim then riglim = x end!@#&                                                if botlim == nil or y > botlim then botlim = y end!@#&                                        end!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--[[Determines how much of each material is required for a print. Done each time printing is called.!@#&        Params: none!@#&        Returns:table A complete list of how much of each material is required.!@#&]]--!@#&function calculateMaterials()!@#&        updateImageLims(animated)!@#&        requiredMaterials = {}!@#&        for i=1,16 do!@#&                requiredMaterials[i] = 0!@#&        end!@#&       !@#&        if not toplim then return end!@#&       !@#&        for i=1,#frames do!@#&                for y = toplim, botlim do!@#&                        for x = leflim, riglim do!@#&                                if type(frames[i][y][x]) == \"number\" then!@#&                                        requiredMaterials[math.log10(frames[i][y][x])/math.log10(2) + 1] =!@#&                                                requiredMaterials[math.log10(frames[i][y][x])/math.log10(2) + 1] + 1!@#&                                end    !@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#& !@#&--[[Updates the rectangle blink timer. Should be called anywhere events are captured, along with a timer capture.!@#&        Params: nil!@#&        Returns:nil!@#&]]--!@#&local function updateTimer(id)!@#&        if id == recttimer then!@#&                recttimer = os.startTimer(0.5)!@#&                rectblink = (rectblink % 2) + 1!@#&        end!@#&end!@#& !@#&--[[Constructs a message based on the state currently selected!@#&        Params: nil!@#&        Returns:string A message regarding the state of the application!@#&]]--!@#&local function getStateMessage()!@#&        local msg = \" \"..string.upper(string.sub(state, 1, 1))..string.sub(state, 2, #state)..\" mode\"!@#&        if state == \"brush\" then msg = msg..\", size=\"..brushsize end!@#&        return msg!@#&end!@#& !@#&--[[Calls the rednet_message event, but also looks for timer events to keep then!@#&        system timer ticking.!@#&        Params: timeout:number how long before the event times out!@#&        Returns:number the id of the sender!@#&                   :number the message send!@#&]]--!@#&local function rsTimeReceive(timeout)!@#&        local timerID!@#&        if timeout then timerID = os.startTimer(timeout) end!@#&       !@#&        local id,key,msg = nil,nil!@#&        while true do!@#&                id,key,msg = os.pullEvent()!@#&               !@#&                if id == \"timer\" then!@#&                        if key == timerID then return!@#&                        else updateTimer(key) end!@#&                end!@#&                if id == \"rednet_message\" then!@#&                        return key,msg!@#&                end!@#&        end!@#&end!@#& !@#&--[[Draws a picture, in paint table format on the screen!@#&        Params: image:table = the image to display!@#&                        xinit:number = the x position of the top-left corner of the image!@#&                        yinit:number = the y position of the top-left corner of the image!@#&                        alpha:number = the color to display for the alpha channel. Default is white.!@#&        Returns:nil!@#&]]--!@#&local function drawPictureTable(image, xinit, yinit, alpha)!@#&        if not alpha then alpha = 1 end!@#&        for y=1,#image do!@#&                for x=1,#image[y] do!@#&                        term.setCursorPos(xinit + x-1, yinit + y-1)!@#&                        local col = getColourOf(string.sub(image[y], x, x))!@#&                        if not col then col = alpha end!@#&                        term.setBackgroundColour(col)!@#&                        term.write(\" \")!@#&                end!@#&        end!@#&end!@#& !@#&--[[  !@#&                        Section: Loading  !@#&]]--!@#& !@#&--[[Loads a non-animted paint file into the program!@#&        Params: path:string = The path in which the file is located!@#&        Returns:nil!@#&]]--!@#&local function loadNFP(path)!@#&        sFrame = 1!@#&        frames[sFrame] = { }!@#&        if fs.exists(path) then!@#&                local file = io.open(path, \"r\" )!@#&                local sLine = file:read()!@#&                local num = 1!@#&                while sLine do!@#&                        table.insert(frames[sFrame], num, {})!@#&                        for i=1,#sLine do!@#&                                frames[sFrame][num][i] = getColourOf(string.sub(sLine,i,i))!@#&                        end!@#&                        num = num+1!@#&                        sLine = file:read()!@#&                end!@#&                file:close()!@#&        end!@#&end!@#& !@#&--[[Loads a text-paint file into the program!@#&        Params: path:string = The path in which the file is located!@#&        Returns:nil!@#&]]--!@#&local function loadNFT(path)!@#&        sFrame = 1!@#&        frames[sFrame] = { }!@#&        frames[sFrame].text = { }!@#&        frames[sFrame].textcol = { }!@#&       !@#&        if fs.exists(path) then!@#&                local file = io.open(path, \"r\")!@#&                local sLine = file:read()!@#&                local num = 1!@#&                while sLine do!@#&                        table.insert(frames[sFrame], num, {})!@#&                        table.insert(frames[sFrame].text, num, {})!@#&                        table.insert(frames[sFrame].textcol, num, {})!@#&                       !@#&                        --As we're no longer 1-1, we keep track of what index to write to!@#&                        local writeIndex = 1!@#&                        --Tells us if we've hit a 30 or 31 (BG and FG respectively)- next char specifies the curr colour!@#&                        local bgNext, fgNext = false, false!@#&                        --The current background and foreground colours!@#&                        local currBG, currFG = nil,nil!@#&                        term.setCursorPos(1,1)!@#&                        for i=1,#sLine do!@#&                                local nextChar = string.sub(sLine, i, i)!@#&                                if nextChar:byte() == 30 then!@#&                                        bgNext = true!@#&                                elseif nextChar:byte() == 31 then!@#&                                        fgNext = true!@#&                                elseif bgNext then!@#&                                        currBG = getColourOf(nextChar)!@#&                                        bgNext = false!@#&                                elseif fgNext then!@#&                                        currFG = getColourOf(nextChar)!@#&                                        fgNext = false!@#&                                else!@#&                                        if nextChar ~= \" \" and currFG == nil then!@#&                                                currFG = colours.white!@#&                                        end!@#&                                        frames[sFrame][num][writeIndex] = currBG!@#&                                        frames[sFrame].textcol[num][writeIndex] = currFG!@#&                                        frames[sFrame].text[num][writeIndex] = nextChar!@#&                                        writeIndex = writeIndex + 1!@#&                                end!@#&                        end!@#&                        num = num+1!@#&                        sLine = file:read()!@#&                end!@#&                file:close()!@#&        end!@#&end!@#& !@#&--[[Loads an animated paint file into the program!@#&        Params: path:string = The path in which the file is located!@#&        Returns:nil!@#&]]--!@#&local function loadNFA(path)!@#&        frames[sFrame] = { }!@#&        if fs.exists(path) then!@#&                local file = io.open(path, \"r\" )!@#&                local sLine = file:read()!@#&                local num = 1!@#&                while sLine do!@#&                        table.insert(frames[sFrame], num, {})!@#&                        if sLine == \"~\" then!@#&                                sFrame = sFrame + 1!@#&                                frames[sFrame] = { }!@#&                                num = 1!@#&                        else!@#&                                for i=1,#sLine do!@#&                                        frames[sFrame][num][i] = getColourOf(string.sub(sLine,i,i))!@#&                                end!@#&                                num = num+1!@#&                        end!@#&                        sLine = file:read()!@#&                end!@#&                file:close()!@#&        end!@#&        framecount = sFrame!@#&        sFrame = 1!@#&end!@#& !@#&--[[Saves a non-animated paint file to the specified path!@#&        Params: path:string = The path to save the file to!@#&        Returns:nil!@#&]]--!@#&local function saveNFP(path)!@#&        local sDir = string.sub(sPath, 1, #sPath - #fs.getName(sPath))!@#&        if not fs.exists(sDir) then!@#&                fs.makeDir(sDir)!@#&        end!@#& !@#&        local file = io.open(path, \"w\")!@#&        updateImageLims(false)!@#&        if not toplim then!@#&                file:close()!@#&                return!@#&        end!@#&        for y=1,botlim do!@#&                local line = \"\"!@#&                if frames[sFrame][y] then!@#&                        for x=1,riglim do!@#&                                line = line..getHexOf(frames[sFrame][y][x])!@#&                        end!@#&                end!@#&                file:write(line..\"\\n\")!@#&        end!@#&        file:close()!@#&end!@#& !@#&--[[Saves a text-paint file to the specified path!@#&        Params: path:string = The path to save the file to!@#&        Returns:nil!@#&]]--!@#&local function saveNFT(path)!@#&        local sDir = string.sub(sPath, 1, #sPath - #fs.getName(sPath))!@#&        if not fs.exists(sDir) then!@#&                fs.makeDir(sDir)!@#&        end!@#&       !@#&        local file = io.open(path, \"w\")!@#&        updateImageLims(false)!@#&        if not toplim then!@#&                file:close()!@#&                return!@#&        end!@#&        for y=1,botlim do!@#&                local line = \"\"!@#&                local currBG, currFG = nil,nil!@#&                for x=1,riglim do!@#&                        if frames[sFrame][y] and frames[sFrame][y][x] ~= currBG then!@#&                                line = line..string.char(30)..getHexOf(frames[sFrame][y][x])!@#&                                currBG = frames[sFrame][y][x]!@#&                        end!@#&                        if frames[sFrame].textcol[y] and frames[sFrame].textcol[y][x] ~= currFG then!@#&                                line = line..string.char(31)..getHexOf(frames[sFrame].textcol[y][x])!@#&                                currFG = frames[sFrame].textcol[y][x]!@#&                        end!@#&                        if frames[sFrame].text[y] then!@#&                                local char = frames[sFrame].text[y][x]!@#&                                if not char then char = \" \" end!@#&                                line = line..char!@#&                        end!@#&                end!@#&                file:write(line..\"\\n\")!@#&        end!@#&        file:close()!@#&end!@#& !@#&--[[Saves a animated paint file to the specified path!@#&        Params: path:string = The path to save the file to!@#&        Returns:nil!@#&]]--!@#&local function saveNFA(path)!@#&        local sDir = string.sub(sPath, 1, #sPath - #fs.getName(sPath))!@#&        if not fs.exists(sDir) then!@#&                fs.makeDir(sDir)!@#&        end!@#&       !@#&        local file = io.open(path, \"w\")!@#&        updateImageLims(true)!@#&        if not toplim then!@#&                file:close()!@#&                return!@#&        end!@#&        for i=1,#frames do!@#&                for y=1,botlim do!@#&                        local line = \"\"!@#&                        if frames[i][y] then!@#&                                for x=1,riglim do!@#&                                        line = line..getHexOf(frames[i][y][x])!@#&                                end!@#&                        end!@#&                        file:write(line..\"\\n\")!@#&                end!@#&                if i < #frames then file:write(\"~\\n\") end!@#&        end!@#&        file:close()!@#&end!@#&!@#&--[[Runs a special pre-program dialogue to determine the filename and filepath. Done if!@#&	there's room, and a file name hasn't been specified!@#&	Params: none!@#&	Returns:bool= true if file is created; false otherwise!@#&]]--!@#&local function runFileMaker()!@#&	local newFName = \"\"!@#&	local fileType = 1!@#&	if animated then fileType = 2!@#&	elseif textEnabled then fileType = 3 end!@#&	!@#&	local tlx,tly = math.floor(w/2 - #logo[1]/2), math.floor(h/2 + #logo/2 + 1)!@#&!@#&	--This is done on top of the logo, so it backpedals a bit.!@#&	term.setCursorPos(tlx, tly)!@#&	term.clearLine()!@#&	term.write(\"Name: \")!@#&	term.setCursorPos(tlx, tly + 1)!@#&	term.clearLine()!@#&	term.write(\"Filetype:   Sprite\")!@#&	term.setCursorPos(tlx + 12, tly + 2)!@#&	term.write(\"Animation\")!@#&	term.setCursorPos(tlx + 12, tly + 3)!@#&	term.write(\"Text\")!@#&	!@#&	while true do!@#&		term.setCursorPos(tlx + 6, tly)!@#&		term.setBackgroundColour(colours.lightGrey)!@#&		term.setTextColour(colours.grey)!@#&		term.write(newFName..string.rep(\" \", 15-#newFName))!@#&		term.setBackgroundColour(colours.white)!@#&		term.setTextColour(colours.black)!@#&		local extension = \".nfp\"!@#&		if fileType == 2 then extension = \".nfa\"!@#&		elseif fileType == 3 then extension = \".nft\" end!@#&		term.write(extension)!@#&		!@#&		term.setBackgroundColour(colours.lightGrey)!@#&		term.setTextColour(colours.grey)!@#&		for i=1,3 do!@#&			term.setCursorPos(tlx + 24, tly + i)!@#&			if i==fileType then term.write(\"X\")!@#&			else term.write(\" \") end!@#&		end!@#&		!@#&		local fPath = shell.resolve(newFName..extension)!@#&		term.setCursorPos(tlx, tly + 3)!@#&		local fileValid = true!@#&		if (fs.exists(fPath) and fs.isDir(fPath)) or newFName == \"\" then!@#&			term.setBackgroundColour(colours.white)!@#&			term.setTextColour(colours.red)!@#&			term.write(\"Invalid \")!@#&			fileValid = false!@#&		elseif fs.exists(fPath) then!@#&			term.setBackgroundColour(colours.grey)!@#&			term.setTextColour(colours.lightGrey)!@#&			term.write(\" Edit  \")!@#&		else!@#&			term.setBackgroundColour(colours.grey)!@#&			term.setTextColour(colours.lightGrey)!@#&			term.write(\" Create \")!@#&		end!@#&		!@#&		term.setTextColour(colours.grey)!@#&		term.setCursorPos(tlx + 6 + #newFName, tly)!@#&		term.setCursorBlink(true)!@#&		!@#&		local id,p1,p2,p3 = os.pullEvent()!@#&		if id == \"key\" then!@#&			if p1 == keys.backspace and #newFName > 0 then !@#&				newFName = string.sub(newFName, 1, #newFName-1)!@#&			elseif p1 == keys.enter and fileValid then!@#&				sPath = fPath!@#&				return true!@#&			end!@#&		elseif id == \"char\" and p1 ~= \".\" and p1 ~= \" \" and #newFName < 15 then!@#&			newFName = newFName..p1!@#&		elseif id == \"mouse_click\" then!@#&			--The option boxes. Man, hardcoding is ugly...!@#&			if p2 == tlx + 24 then!@#&				for i=1,3 do !@#&					if p3 == tly+i then fileType = i end !@#&				end!@#&			end!@#&			if p3 == tly + 3 and p2 >= tlx and p2 <= tlx + 8 and fileValid then!@#&				sPath = fPath!@#&				return true!@#&			end!@#&		end!@#&	end!@#&end!@#& !@#&--[[Initializes the program, by loading in the paint file. Called at the start of each program.!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function init()!@#&        if textEnabled then!@#&                loadNFT(sPath)!@#&                table.insert(ddModes, 2, { \"text\", \"textpaint\", name = \"text\"})!@#&        elseif animated then!@#&                loadNFA(sPath)!@#&                table.insert(ddModes, #ddModes, { \"record\", \"play\", name = \"anim\" })!@#&                table.insert(ddModes, #ddModes, { \"go to\", \"remove\", name = \"frames\"})!@#&                table.insert(ddModes[2], #ddModes[2], \"blueprint on\")!@#&                table.insert(ddModes[2], #ddModes[2], \"layers on\")!@#&        else!@#&                loadNFP(sPath)!@#&                table.insert(ddModes[2], #ddModes[2], \"blueprint on\")!@#&        end!@#&		!@#&        for i=0,15 do!@#&                table.insert(column, math.pow(2,i))!@#&        end!@#&end!@#& !@#&--[[  !@#&                        Section: Drawing  !@#&]]--!@#& !@#& !@#&--[[Draws the rather superflous logo. Takes about 1 second, before user is able to move to the!@#&        actual program.!@#&        Params: none!@#&        Returns:bool= true if the file select ran successfully; false otherwise.!@#&]]--!@#&local function drawLogo()!@#&        term.setBackgroundColour(colours.white)!@#&        term.clear()!@#&		if h >= 12 and w >= 24 then!@#&			drawPictureTable(logo, w/2 - #logo[1]/2, h/2 - #logo/2, colours.white)!@#&			term.setBackgroundColour(colours.white)!@#&			term.setTextColour(colours.black)!@#&			local msg = \"NPaintPro\"!@#&			term.setCursorPos(w/2 - #msg/2, h/2 + #logo/2 + 1)!@#&			term.write(msg)!@#&			msg = \"For SpeedOS\"!@#&			term.setCursorPos(w/2 - #msg/2, h/2 + #logo/2 + 2)!@#&			term.write(msg)!@#&        elseif w >= 15 then!@#&			local msg = \"NPaintPro\"!@#&			term.setCursorPos(math.ceil(w/2 - #msg/2), h/2)!@#&			term.setTextColour(colours.cyan)!@#&			term.write(msg)!@#&			msg = \"Ma3rX\"!@#&			term.setCursorPos(math.ceil(w/2 - #msg/2), h/2 + 1)!@#&			term.setTextColour(colours.black)!@#&			term.write(msg)!@#&		else!@#&			local msg = \"NPP\"!@#&			term.setCursorPos(math.ceil(w/2 - #msg/2), math.floor(h/2))!@#&			term.setTextColour(colours.cyan)!@#&			term.write(msg)!@#&			msg = \"By NF\"!@#&			term.setCursorPos(math.ceil(w/2 - #msg/2), math.ceil(h/2))!@#&			term.setTextColour(colours.black)!@#&			term.write(msg)!@#&		end!@#&        os.pullEvent()!@#&end!@#& !@#&--[[Clears the display to the alpha channel colour, draws the canvas, the image buffer and the selection!@#&        rectanlge if any of these things are present.!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function drawCanvas()!@#&        --We have to readjust the position of the canvas if we're printing!@#&        turtlechar = \"@\"!@#&        if state == \"active print\" then!@#&                if layering == \"up\" then!@#&                        if py >= 1 and py <= #frames then!@#&                                sFrame = py!@#&                        end!@#&                        if pz < sy then sy = pz!@#&                        elseif pz > sy + h - 1 then sy = pz + h - 1 end!@#&                        if px < sx then sx = px!@#&                        elseif px > sx + w - 2 then sx = px + w - 2 end!@#&                else!@#&                        if pz >= 1 and pz <= #frames then!@#&                                sFrame = pz!@#&                        end!@#&                       !@#&                        if py < sy then sy = py!@#&                        elseif py > sy + h - 1 then sy = py + h - 1 end!@#&                        if px < sx then sx = px!@#&                        elseif px > sx + w - 2 then sx = px + w - 2 end!@#&                end!@#&               !@#&                if pfx == 1 then turtlechar = \">\"!@#&                elseif pfx == -1 then turtlechar = \"<\"!@#&                elseif pfz == 1 then turtlechar = \"V\"!@#&                elseif pfz == -1 then turtlechar = \"^\"!@#&                end!@#&        end!@#& !@#&        --Picture next!@#&        local topLayer, botLayer!@#&        if layerDisplay then!@#&                topLayer = sFrame!@#&                botLayer = 1!@#&        else!@#&                topLayer,botLayer = sFrame,sFrame!@#&        end!@#&       !@#&	    --How far the canvas draws. If the interface is visible, it stops short of that.!@#&	    local wlim,hlim = 0,0!@#&		if not interfaceHidden then!@#&			wlim = 2!@#&			hlim = 1!@#&		end!@#&	   !@#&        for currframe = botLayer,topLayer,1 do!@#&                for y=sy+1,sy+h-hlim do!@#&                        if frames[currframe][y] then!@#&                                for x=sx+1,sx+w-wlim do!@#&                                        term.setCursorPos(x-sx,y-sy)!@#&                                        if frames[currframe][y][x] then!@#&                                                term.setBackgroundColour(frames[currframe][y][x])!@#&                                                if textEnabled and frames[currframe].textcol[y][x] and frames[currframe].text[y][x] then!@#&                                                        term.setTextColour(frames[currframe].textcol[y][x])!@#&                                                        term.write(frames[currframe].text[y][x])!@#&                                                else!@#&                                                        term.write(\" \")!@#&                                                end!@#&                                        else!@#&                                                tileExists = false!@#&                                                for i=currframe-1,botLayer,-1 do!@#&                                                        if frames[i][y][x] then!@#&                                                                tileExists = true!@#&                                                                break!@#&                                                        end!@#&                                                end!@#&                                               !@#&                                                if not tileExists then!@#&                                                        if blueprint then!@#&                                                                term.setBackgroundColour(colours.blue)!@#&                                                                term.setTextColour(colours.white)!@#&                                                                if x == sx+1 and y % 4 == 1 then!@#&                                                                        term.write(\"\"..((y/4) % 10))!@#&                                                                elseif y == sy + 1 and x % 4 == 1 then!@#&                                                                        term.write(\"\"..((x/4) % 10))!@#&                                                                elseif x % 2 == 1 and y % 2 == 1 then!@#&                                                                        term.write(\"+\")!@#&                                                                elseif x % 2 == 1 then!@#&                                                                        term.write(\"|\")!@#&                                                                elseif y % 2 == 1 then!@#&                                                                        term.write(\"-\")!@#&                                                                else!@#&                                                                        term.write(\" \")!@#&                                                                end!@#&                                                        else!@#&                                                                term.setBackgroundColour(alphaC)!@#&                                                                if textEnabled and frames[currframe].textcol[y][x] and frames[currframe].text[y][x] then!@#&                                                                        term.setTextColour(frames[currframe].textcol[y][x])!@#&                                                                        term.write(frames[currframe].text[y][x])!@#&                                                                else!@#&                                                                        term.write(\" \")!@#&                                                                end!@#&                                                        end!@#&                                                end!@#&                                        end!@#&                                end!@#&                        else!@#&                                for x=sx+1,sx+w-wlim do!@#&                                        term.setCursorPos(x-sx,y-sy)!@#&                                       !@#&                                        tileExists = false!@#&                                        for i=currframe-1,botLayer,-1 do!@#&                                                if frames[i][y] and frames[i][y][x] then!@#&                                                        tileExists = true!@#&                                                        break!@#&                                                end!@#&                                        end!@#&                                       !@#&                                        if not tileExists then!@#&                                                if blueprint then!@#&                                                        term.setBackgroundColour(colours.blue)!@#&                                                        term.setTextColour(colours.white)!@#&                                                        if x == sx+1 and y % 4 == 1 then!@#&                                                                term.write(\"\"..((y/4) % 10))!@#&                                                        elseif y == sy + 1 and x % 4 == 1 then!@#&                                                                term.write(\"\"..((x/4) % 10))!@#&                                                        elseif x % 2 == 1 and y % 2 == 1 then!@#&                                                                term.write(\"+\")!@#&                                                        elseif x % 2 == 1 then!@#&                                                                term.write(\"|\")!@#&                                                        elseif y % 2 == 1 then!@#&                                                                term.write(\"-\")!@#&                                                        else!@#&                                                                term.write(\" \")!@#&                                                        end!@#&                                                else!@#&                                                        term.setBackgroundColour(alphaC)!@#&                                                        term.write(\" \")!@#&                                                end!@#&                                        end!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&       !@#&        --Then the printer, if he's on!@#&        if state == \"active print\" then!@#&                local bgColour = alphaC!@#&                if layering == \"up\" then!@#&                        term.setCursorPos(px-sx,pz-sy)!@#&                        if frames[sFrame] and frames[sFrame][pz-sy] and frames[sFrame][pz-sy][px-sx] then!@#&                                bgColour = frames[sFrame][pz-sy][px-sx]!@#&                        elseif blueprint then bgColour = colours.blue end!@#&                else!@#&                        term.setCursorPos(px-sx,py-sy)!@#&                        if frames[sFrame] and frames[sFrame][py-sy] and frames[sFrame][py-sy][px-sx] then!@#&                                bgColour = frames[sFrame][py-sy][px-sx]!@#&                        elseif blueprint then bgColour = colours.blue end!@#&                end!@#&               !@#&                term.setBackgroundColour(bgColour)!@#&                if bgColour == colours.black then term.setTextColour(colours.white)!@#&                else term.setTextColour(colours.black) end!@#&               !@#&                term.write(turtlechar)!@#&        end!@#&       !@#&        --Then the buffer!@#&        if selectrect then!@#&                if buffer and rectblink == 1 then!@#&                for y=selectrect.y1, math.min(selectrect.y2, selectrect.y1 + buffer.height-1) do!@#&                        for x=selectrect.x1, math.min(selectrect.x2, selectrect.x1 + buffer.width-1) do!@#&                                if buffer.contents[y-selectrect.y1+1][x-selectrect.x1+1] then!@#&                                        term.setCursorPos(x+sx,y+sy)!@#&                                        term.setBackgroundColour(buffer.contents[y-selectrect.y1+1][x-selectrect.x1+1])!@#&                                        term.write(\" \")!@#&                                end!@#&                        end!@#&                end!@#&                end!@#&       !@#&                --This draws the \"selection\" box!@#&                local add = nil!@#&                if buffer then!@#&                        term.setBackgroundColour(colours.lightGrey)!@#&                else!@#&                        term.setBackgroundColour(colours.grey)!@#&                end!@#&                for i=selectrect.x1, selectrect.x2 do!@#&                        add = (i + selectrect.y1 + rectblink) % 2 == 0!@#&                        term.setCursorPos(i-sx,selectrect.y1-sy)!@#&                        if add then term.write(\" \") end!@#&                        add = (i + selectrect.y2 + rectblink) % 2 == 0!@#&                        term.setCursorPos(i-sx,selectrect.y2-sy)!@#&                        if add then term.write(\" \") end!@#&                end!@#&                for i=selectrect.y1 + 1, selectrect.y2 - 1 do!@#&                        add = (i + selectrect.x1 + rectblink) % 2 == 0!@#&                        term.setCursorPos(selectrect.x1-sx,i-sy)!@#&                        if add then term.write(\" \") end!@#&                        add = (i + selectrect.x2 + rectblink) % 2 == 0!@#&                        term.setCursorPos(selectrect.x2-sx,i-sy)!@#&                        if add then term.write(\" \") end!@#&                end!@#&        end!@#&end!@#& !@#&--[[Draws the colour picker on the right side of the screen, the colour pallette and the footer with any!@#&        messages currently being displayed!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function drawInterface()!@#&        --Picker!@#&		local coffset,ioffset = 0,0!@#&		local maxcsize = h-2!@#&		if h < #column + 2 then!@#&			maxcsize = h-4!@#&			coffset = columnoffset!@#&			ioffset = 1!@#&			term.setBackgroundColour(colours.lightGrey)!@#&			term.setTextColour(colours.grey)!@#&			term.setCursorPos(w-1,1)!@#&			term.write(\"^^\")!@#&			term.setCursorPos(w-1,h-2)!@#&			term.write(\"VV\")!@#&		end!@#&        for i=1,math.min(#column+1,maxcsize) do!@#&			term.setCursorPos(w-1, i + ioffset)!@#&			local ci = i+coffset!@#&			if ci == #column+1 then!@#&				term.setBackgroundColour(colours.black)!@#&				term.setTextColour(colours.red)!@#&				term.write(\"XX\")!@#&			elseif state == \"print\" then!@#&				term.setBackgroundColour(column[ci])!@#&				if column[ci] == colours.black then!@#&					term.setTextColour(colours.white)!@#&				else term.setTextColour(colours.black) end!@#&				!@#&				if requirementsDisplayed then!@#&						if requiredMaterials[i] < 10 then term.write(\" \") end!@#&						term.setCursorPos(w-#tostring(requiredMaterials[i])+1, i)!@#&						term.write(requiredMaterials[i])!@#&				else!@#&						if i+coffset < 10 then term.write(\" \") end!@#&						term.write(i+coffset)!@#&				end!@#&			else!@#&				term.setBackgroundColour(column[ci])!@#&				term.write(\"  \")!@#&			end!@#&        end!@#&		--Filling the whitespace with... 'greyspace' *shudder*!@#&		if h > #column+3 then!@#&			term.setTextColour(colours.grey)!@#&			term.setBackgroundColour(colours.lightGrey)!@#&			for y=#column+2,h-2 do!@#&				term.setCursorPos(w-1,y)!@#&				term.write(\"| \")!@#&			end!@#&		end!@#&        --Pallette!@#&        term.setCursorPos(w-1,h-1)!@#&        if not lSel then!@#&                term.setBackgroundColour(colours.black)!@#&                term.setTextColour(colours.red)!@#&                term.write(\"X\")!@#&        else!@#&                term.setBackgroundColour(lSel)!@#&                term.setTextColour(lSel)!@#&                term.write(\" \")!@#&        end!@#&        if not rSel then!@#&                term.setBackgroundColour(colours.black)!@#&                term.setTextColour(colours.red)!@#&                term.write(\"X\")!@#&        else!@#&                term.setBackgroundColour(rSel)!@#&                term.setTextColour(rSel)!@#&                term.write(\" \")!@#&        end!@#&        --Footer!@#&        if inMenu then return end!@#&       !@#&        term.setCursorPos(1, h)!@#&        term.setBackgroundColour(colours.lightGrey)!@#&        term.setTextColour(colours.grey)!@#&        term.clearLine()!@#&		if mainAvailable then!@#&			if inDropDown then!@#&					term.write(string.rep(\" \", #ddModes.name + 2))!@#&			else!@#&					term.setBackgroundColour(colours.grey)!@#&					term.setTextColour(colours.lightGrey)!@#&					term.write(ddModes.name..\"  \")!@#&			end!@#&		end!@#&        term.setBackgroundColour(colours.lightGrey)!@#&        term.setTextColour(colours.grey)!@#&        term.write(getStateMessage())!@#&       !@#&        local coords=\"X:\"..sx..\" Y:\"..sy!@#&        if animated then coords = coords..\" Frame:\"..sFrame..\"/\"..framecount..\"   \" end!@#&        term.setCursorPos(w-#coords+1,h)!@#&        if state == \"play\" then term.setBackgroundColour(colours.lime)!@#&        elseif record then term.setBackgroundColour(colours.red) end!@#&        term.write(coords)!@#&       !@#&        if animated then!@#&                term.setCursorPos(w-1,h)!@#&                term.setBackgroundColour(colours.grey)!@#&                term.setTextColour(colours.lightGrey)!@#&                term.write(\"<>\")!@#&        end!@#&end!@#& !@#&--[[Runs an interface where users can select topics of help. Will return once the user quits the help screen.!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function drawHelpScreen()!@#&        local selectedHelp = nil!@#&        while true do!@#&                term.setBackgroundColour(colours.lightGrey)!@#&                term.clear()!@#&                if not selectedHelp then!@#&                        term.setCursorPos(4, 1)!@#&                        term.setTextColour(colours.brown)!@#&                        term.write(\"Available modes (click for info):\")!@#&                        for i=1,#helpTopics do!@#&                                term.setCursorPos(2, 2 + i)!@#&                                term.setTextColour(colours.black)!@#&                                term.write(helpTopics[i].name)!@#&                                if helpTopics[i].key then!@#&                                        term.setTextColour(colours.red)!@#&                                        term.write(\" (\"..helpTopics[i].key..\")\")!@#&                                end!@#&                        end!@#&                        term.setCursorPos(4,h)!@#&                        term.setTextColour(colours.black)!@#&                        term.write(\"Press any key to exit\")!@#&                else!@#&                        term.setCursorPos(4,1)!@#&                        term.setTextColour(colours.brown)!@#&                        term.write(helpTopics[selectedHelp].name)!@#&                        if helpTopics[selectedHelp].key then!@#&                                term.setTextColour(colours.red)!@#&                                term.write(\" (\"..helpTopics[selectedHelp].key..\")\")!@#&                        end!@#&                        term.setCursorPos(1,3)!@#&                        term.setTextColour(colours.black)!@#&                        print(helpTopics[selectedHelp].message..\"\\n\")!@#&                        for i=1,#helpTopics[selectedHelp].controls do!@#&                                term.setTextColour(colours.brown)!@#&                                term.write(helpTopics[selectedHelp].controls[i][1]..\" \")!@#&                                term.setTextColour(colours.black)!@#&                                print(helpTopics[selectedHelp].controls[i][2])!@#&                        end!@#&                end!@#&               !@#&                local id,p1,p2,p3 = os.pullEvent()!@#&               !@#&                if id == \"timer\" then updateTimer(p1)!@#&                elseif id == \"key\" then!@#&                        if selectedHelp then selectedHelp = nil!@#&                        else break end!@#&                elseif id == \"mouse_click\" then!@#&                        if not selectedHelp then!@#&                                if p3 >=3 and p3 <= 2+#helpTopics then!@#&                                        selectedHelp = p3-2!@#&                                else break end!@#&                        else!@#&                                selectedHelp = nil!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--[[Draws a message in the footer bar. A helper for DrawInterface, but can be called for custom messages, if the!@#&        inMenu paramter is set to true while this is being done (remember to set it back when done!)!@#&        Params: message:string = The message to be drawn!@#&        Returns:nil!@#&]]--!@#&local function drawMessage(message)!@#&        term.setCursorPos(1,h)!@#&        term.setBackgroundColour(colours.lightGrey)!@#&        term.setTextColour(colours.grey)!@#&        term.clearLine()!@#&        term.write(message)!@#&end!@#& !@#&--[[!@#&                        Section: Generic Interfaces!@#&]]--!@#& !@#& !@#&--[[One of my generic text printing methods, printing a message at a specified position with width and offset.!@#&        No colour materials included.!@#&        Params: msg:string = The message to print off-center!@#&                        height:number = The starting height of the message!@#&                        width:number = The limit as to how many characters long each line may be!@#&                        offset:number = The starting width offset of the message!@#&        Returns:number the number of lines used in printing the message!@#&]]--!@#&local function wprintOffCenter(msg, height, width, offset)!@#&        local inc = 0!@#&        local ops = 1!@#&        while #msg - ops > width do!@#&                local nextspace = 0!@#&                while string.find(msg, \" \", ops + nextspace) and!@#&                                string.find(msg, \" \", ops + nextspace) - ops < width do!@#&                        nextspace = string.find(msg, \" \", nextspace + ops) + 1 - ops!@#&                end!@#&                local ox,oy = term.getCursorPos()!@#&                term.setCursorPos(width/2 - (nextspace)/2 + offset, height + inc)!@#&                inc = inc + 1!@#&                term.write(string.sub(msg, ops, nextspace + ops - 1))!@#&                ops = ops + nextspace!@#&        end!@#&        term.setCursorPos(width/2 - #string.sub(msg, ops)/2 + offset, height + inc)!@#&        term.write(string.sub(msg, ops))!@#&       !@#&        return inc + 1!@#&end!@#& !@#&--[[Draws a message that must be clicked on or a key struck to be cleared. No options, so used for displaying!@#&        generic information.!@#&        Params: ctitle:string = The title of the confirm dialogue!@#&                        msg:string = The message displayed in the dialogue!@#&        Returns:nil!@#&]]--!@#&local function displayConfirmDialogue(ctitle, msg)!@#&        local dialogoffset = 8!@#&        --We actually print twice- once to get the lines, second time to print proper. Easier this way.!@#&        local lines = wprintOffCenter(msg, 5, w - (dialogoffset+2) * 2, dialogoffset + 2)!@#&       !@#&        term.setCursorPos(dialogoffset, 3)!@#&        term.setBackgroundColour(colours.grey)!@#&        term.setTextColour(colours.lightGrey)!@#&        term.write(string.rep(\" \", w - dialogoffset * 2))!@#&        term.setCursorPos(dialogoffset + (w - dialogoffset * 2)/2 - #ctitle/2, 3)!@#&        term.write(ctitle)!@#&        term.setTextColour(colours.grey)!@#&        term.setBackgroundColour(colours.lightGrey)!@#&        term.setCursorPos(dialogoffset, 4)!@#&        term.write(string.rep(\" \", w - dialogoffset * 2))!@#&        for i=5,5+lines do!@#&                term.setCursorPos(dialogoffset, i)!@#&                term.write(\" \"..string.rep(\" \", w - (dialogoffset) * 2 - 2)..\" \")!@#&        end!@#&        wprintOffCenter(msg, 5, w - (dialogoffset+2) * 2, dialogoffset + 2)!@#&       !@#&        --In the event of a message, the player hits anything to continue!@#&        while true do!@#&                local id,key = os.pullEvent()!@#&                if id == \"timer\" then updateTimer(key);!@#&                elseif id == \"key\" or id == \"mouse_click\" or id == \"mouse_drag\" then break end!@#&        end!@#&end!@#& !@#&--[[Produces a nice dropdown menu based on a table of strings. Depending on the position, this will auto-adjust the position!@#&        of the menu drawn, and allows nesting of menus and sub menus. Clicking anywhere outside the menu will cancel and return nothing!@#&        Params: x:int = the x position the menu should be displayed at!@#&                        y:int = the y position the menu should be displayed at!@#&                        options:table = the list of options available to the user, as strings or submenus (tables of strings, with a name parameter)!@#&        Returns:string the selected menu option.!@#&]]--!@#&local function displayDropDown(x, y, options)!@#&        inDropDown = true!@#&        --Figures out the dimensions of our thing!@#&        local longestX = #options.name!@#&        for i=1,#options do!@#&                local currVal = options[i]!@#&                if type(currVal) == \"table\" then currVal = currVal.name end!@#&               !@#&                longestX = math.max(longestX, #currVal)!@#&        end!@#&        local xOffset = math.max(0, longestX - ((w-2) - x) + 1)!@#&        local yOffset = math.max(0, #options - ((h-1) - y))!@#&       !@#&        local clickTimes = 0!@#&        local tid = nil!@#&        local selection = nil!@#&        while clickTimes < 2 do!@#&                drawCanvas()!@#&                drawInterface()!@#&               !@#&                term.setCursorPos(x-xOffset,y-yOffset)!@#&                term.setBackgroundColour(colours.grey)!@#&                term.setTextColour(colours.lightGrey)!@#&                term.write(options.name..string.rep(\" \", longestX-#options.name + 2))!@#&       !@#&                for i=1,#options do!@#&                        term.setCursorPos(x-xOffset, y-yOffset+i)!@#&                        if i==selection and clickTimes % 2 == 0 then!@#&                                term.setBackgroundColour(colours.grey)!@#&                                term.setTextColour(colours.lightGrey)!@#&                        else!@#&                                term.setBackgroundColour(colours.lightGrey)!@#&                                term.setTextColour(colours.grey)!@#&                        end!@#&                        local currVal = options[i]!@#&                        if type(currVal) == \"table\" then!@#&                                term.write(currVal.name..string.rep(\" \", longestX-#currVal.name + 1))!@#&                                term.setBackgroundColour(colours.grey)!@#&                                term.setTextColour(colours.lightGrey)!@#&                                term.write(\">\")!@#&                        else!@#&                                term.write(currVal..string.rep(\" \", longestX-#currVal + 2))!@#&                        end!@#&                end!@#&               !@#&                local id, p1, p2, p3 = os.pullEvent()!@#&                if id == \"timer\" then!@#&                        if p1 == tid then!@#&                                clickTimes = clickTimes + 1!@#&                                if clickTimes > 2 then!@#&                                        break!@#&                                else!@#&                                        tid = os.startTimer(0.1)!@#&                                end!@#&                        else!@#&                                updateTimer(p1)!@#&                                drawCanvas()!@#&                                drawInterface()!@#&                        end!@#&                elseif id == \"mouse_click\" then!@#&                        if p2 >=x-xOffset and p2 <= x-xOffset + longestX + 1 and p3 >= y-yOffset+1 and p3 <= y-yOffset+#options then!@#&                                selection = p3-(y-yOffset)!@#&                                tid = os.startTimer(0.1)!@#&                        else!@#&                                selection = \"\"!@#&                                break!@#&                        end!@#&                end!@#&        end!@#&       !@#&        if type(selection) == \"number\" then!@#&                selection = options[selection]!@#&        end!@#&       !@#&        if type(selection) == \"string\" then!@#&                inDropDown = false!@#&                return selection!@#&        elseif type(selection) == \"table\" then!@#&                return displayDropDown(x, y, selection)!@#&        end!@#&end!@#& !@#&--[[A custom io.read() function with a few differences- it limits the number of characters being printed,!@#&        waits a 1/100th of a second so any keys still in the event library are removed before input is read and!@#&        the timer for the selectionrectangle is continuously updated during the process.!@#&        Params: lim:int = the number of characters input is allowed!@#&        Returns:string the inputted string, trimmed of leading and tailing whitespace!@#&]]--!@#&local function readInput(lim)!@#&        term.setCursorBlink(true)!@#& !@#&        local inputString = \"\"!@#&        if not lim or type(lim) ~= \"number\" or lim < 1 then lim = w - ox end!@#&        local ox,oy = term.getCursorPos()!@#&        --We only get input from the footer, so this is safe. Change if recycling!@#&        term.setBackgroundColour(colours.lightGrey)!@#&        term.setTextColour(colours.grey)!@#&        term.write(string.rep(\" \", lim))!@#&        term.setCursorPos(ox, oy)!@#&        --As events queue immediately, we may get an unwanted key... this will solve that problem!@#&        local inputTimer = os.startTimer(0.01)!@#&        local keysAllowed = false!@#&       !@#&        while true do!@#&                local id,key = os.pullEvent()!@#&               !@#&                if keysAllowed then!@#&                        if id == \"key\" and key == 14 and #inputString > 0 then!@#&                                inputString = string.sub(inputString, 1, #inputString-1)!@#&                                term.setCursorPos(ox + #inputString,oy)!@#&                                term.write(\" \")!@#&                        elseif id == \"key\" and key == 28 and inputString ~= string.rep(\" \", #inputString) then!@#&                                break!@#&                        elseif id == \"key\" and key == keys.leftCtrl then!@#&                                return \"\"!@#&                        elseif id == \"char\" and #inputString < lim then!@#&                                inputString = inputString..key!@#&                        end!@#&                end!@#&               !@#&                if id == \"timer\" then!@#&                        if key == inputTimer then!@#&                                keysAllowed = true!@#&                        else!@#&                                updateTimer(key)!@#&                                drawCanvas()!@#&                                drawInterface()!@#&                                term.setBackgroundColour(colours.lightGrey)!@#&                                term.setTextColour(colours.grey)!@#&                        end!@#&                end!@#&                term.setCursorPos(ox,oy)!@#&                term.write(inputString)!@#&                term.setCursorPos(ox + #inputString, oy)!@#&        end!@#&       !@#&        while string.sub(inputString, 1, 1) == \" \" do!@#&                inputString = string.sub(inputString, 2, #inputString)!@#&        end!@#&        while string.sub(inputString, #inputString, #inputString) == \" \" do!@#&                inputString = string.sub(inputString, 1, #inputString-1)!@#&        end!@#&        term.setCursorBlink(false)!@#&       !@#&        return inputString!@#&end!@#& !@#&--[[  !@#&                        Section: Image tools!@#&]]--!@#& !@#& !@#&--[[Copies all pixels beneath the selection rectangle into the image buffer. Empty buffers are converted to nil.!@#&        Params: removeImage:bool = true if the image is to be erased after copying, false otherwise!@#&        Returns:nil!@#&]]--!@#&local function copyToBuffer(removeImage)!@#&        buffer = { width = selectrect.x2 - selectrect.x1 + 1, height = selectrect.y2 - selectrect.y1 + 1, contents = { } }!@#&       !@#&        local containsSomething = false!@#&        for y=1,buffer.height do!@#&                buffer.contents[y] = { }!@#&                local f,l = sFrame,sFrame!@#&                if record then f,l = 1, framecount end!@#&               !@#&                for fra = f,l do!@#&                        if frames[fra][selectrect.y1 + y - 1] then!@#&                                for x=1,buffer.width do!@#&                                        buffer.contents[y][x] = frames[sFrame][selectrect.y1 + y - 1][selectrect.x1 + x - 1]!@#&                                        if removeImage then frames[fra][selectrect.y1 + y - 1][selectrect.x1 + x - 1] = nil end!@#&                                        if buffer.contents[y][x] then containsSomething = true end!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        --I don't classify an empty buffer as a real buffer- confusing to the user.!@#&        if not containsSomething then buffer = nil end!@#&end!@#& !@#&--[[Replaces all pixels under the selection rectangle with the image buffer (or what can be seen of it). Record-dependent.!@#&        Params: removeBuffer:bool = true if the buffer is to be emptied after copying, false otherwise!@#&        Returns:nil!@#&]]--!@#&local function copyFromBuffer(removeBuffer)!@#&        if not buffer then return end!@#& !@#&        for y = 1, math.min(buffer.height,selectrect.y2-selectrect.y1+1) do!@#&                local f,l = sFrame, sFrame!@#&                if record then f,l = 1, framecount end!@#&               !@#&                for fra = f,l do!@#&                        if not frames[fra][selectrect.y1+y-1] then frames[fra][selectrect.y1+y-1] = { } end!@#&                        for x = 1, math.min(buffer.width,selectrect.x2-selectrect.x1+1) do!@#&                                frames[fra][selectrect.y1+y-1][selectrect.x1+x-1] = buffer.contents[y][x]!@#&                        end!@#&                end!@#&        end!@#&       !@#&        if removeBuffer then buffer = nil end!@#&end!@#& !@#&--[[Moves the entire image (or entire animation) to the specified coordinates. Record-dependent.!@#&        Params: newx:int = the X coordinate to move the image to!@#&                        newy:int = the Y coordinate to move the image to!@#&        Returns:nil!@#&]]--!@#&local function moveImage(newx,newy)!@#&        if not leflim or not toplim then return end!@#&        if newx <=0 or newy <=0 then return end!@#&        local f,l = sFrame,sFrame!@#&        if record then f,l = 1,framecount end!@#&       !@#&        for i=f,l do!@#&                local newlines = { }!@#&                for y=toplim,botlim do!@#&                        local line = frames[i][y]!@#&                        if line then!@#&                                newlines[y-toplim+newy] = { }!@#&                                for x,char in pairs(line) do!@#&                                        newlines[y-toplim+newy][x-leflim+newx] = char!@#&                                end!@#&                        end!@#&                end!@#&                --Exceptions that allow us to move the text as well!@#&                if textEnabled then!@#&                        newlines.text = { }!@#&                        for y=toplim,botlim do!@#&                                local line = frames[i].text[y]!@#&                                if line then!@#&                                        newlines.text[y-toplim+newy] = { }!@#&                                        for x,char in pairs(line) do!@#&                                                newlines.text[y-toplim+newy][x-leflim+newx] = char!@#&                                        end!@#&                                end!@#&                        end!@#&                       !@#&                        newlines.textcol = { }!@#&                        for y=toplim,botlim do!@#&                                local line = frames[i].textcol[y]!@#&                                if line then!@#&                                        newlines.textcol[y-toplim+newy] = { }!@#&                                        for x,char in pairs(line) do!@#&                                                newlines.textcol[y-toplim+newy][x-leflim+newx] = char!@#&                                        end!@#&                                end!@#&                        end!@#&                end!@#&               !@#&                frames[i] = newlines!@#&        end!@#&end!@#& !@#&--[[Prompts the user to clear the current frame or all frames. Record-dependent.,!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function clearImage()!@#&        inMenu = true!@#&        if not animated then!@#&                drawMessage(\"Clear image? Y/N: \")!@#&        elseif record then!@#&                drawMessage(\"Clear ALL frames? Y/N: \")!@#&        else!@#&                drawMessage(\"Clear current frame? Y/N :\")!@#&        end!@#&        if string.find(string.upper(readInput(1)), \"Y\") then!@#&                local f,l = sFrame,sFrame!@#&                if record then f,l = 1,framecount end!@#&               !@#&                for i=f,l do!@#&                        frames[i] = { }!@#&                end!@#&        end!@#&        inMenu = false!@#&end!@#& !@#&--[[A recursively called method (watch out for big calls!) in which every pixel of a set colour is!@#&        changed to another colour. Does not work on the nil colour, for obvious reasons.!@#&        Params: x:int = The X coordinate of the colour to flood-fill!@#&                        y:int = The Y coordinate of the colour to flood-fill!@#&                        targetColour:colour = the colour that is being flood-filled!@#&                        newColour:colour = the colour with which to replace the target colour!@#&        Returns:nil!@#&]]--!@#&local function floodFill(x, y, targetColour, newColour)!@#&        if not newColour or not targetColour then return end!@#&        local nodeList = { }!@#&       !@#&        table.insert(nodeList, {x = x, y = y})!@#&       !@#&        while #nodeList > 0 do!@#&                local node = nodeList[1]!@#&                if frames[sFrame][node.y] and frames[sFrame][node.y][node.x] == targetColour then!@#&                        frames[sFrame][node.y][node.x] = newColour!@#&                        table.insert(nodeList, { x = node.x + 1, y = node.y})!@#&                        table.insert(nodeList, { x = node.x, y = node.y + 1})!@#&                        if x > 1 then table.insert(nodeList, { x = node.x - 1, y = node.y}) end!@#&                        if y > 1 then table.insert(nodeList, { x = node.x, y = node.y - 1}) end!@#&                end!@#&                table.remove(nodeList, 1)!@#&        end!@#&end!@#& !@#&--[[  !@#&                        Section: Animation Tools  !@#&]]--!@#& !@#&--[[Enters play mode, allowing the animation to play through. Interface is restricted to allow this,!@#&        and method only leaves once the player leaves play mode.!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function playAnimation()!@#&        state = \"play\"!@#&        selectedrect = nil!@#&       !@#&        local animt = os.startTimer(animtime)!@#&        repeat!@#&                drawCanvas()!@#&                drawInterface()!@#&               !@#&                local id,key,_,y = os.pullEvent()!@#&               !@#&                if id==\"timer\" then!@#&                        if key == animt then!@#&                                animt = os.startTimer(animtime)!@#&                                sFrame = (sFrame % framecount) + 1!@#&                        else!@#&                                updateTimer(key)!@#&                        end!@#&                elseif id==\"key\" then!@#&                        if key == keys.comma and animtime > 0.1 then animtime = animtime - 0.05!@#&                        elseif key == keys.period and animtime < 0.5 then animtime = animtime + 0.05!@#&                        elseif key == keys.space then state = \"paint\" end!@#&                elseif id==\"mouse_click\" and y == h then!@#&                        state = \"paint\"!@#&                end!@#&        until state ~= \"play\"!@#&        os.startTimer(0.5)!@#&end!@#& !@#&--[[Changes the selected frame (sFrame) to the chosen frame. If this frame is above the framecount,!@#&        additional frames are created with a copy of the image on the selected frame.!@#&        Params: newframe:int = the new frame to move to!@#&        Returns:nil!@#&]]--!@#&local function changeFrame(newframe)!@#&        inMenu = true!@#&        if not tonumber(newframe) then!@#&                term.setCursorPos(1,h)!@#&                term.setBackgroundColour(colours.lightGrey)!@#&                term.setTextColour(colours.grey)!@#&                term.clearLine()!@#&       !@#&                term.write(\"Go to frame: \")!@#&                newframe = tonumber(readInput(2))!@#&                if not newframe or newframe <= 0 then!@#&                        inMenu = false!@#&                        return!@#&                end!@#&        elseif newframe <= 0 then return end!@#&       !@#&        if newframe > framecount then!@#&                for i=framecount+1,newframe do!@#&                        frames[i] = {}!@#&                        for y,line in pairs(frames[sFrame]) do!@#&                                frames[i][y] = { }!@#&                                for x,v in pairs(line) do!@#&                                        frames[i][y][x] = v!@#&                                end!@#&                        end!@#&                end!@#&                framecount = newframe!@#&        end!@#&        sFrame = newframe!@#&        inMenu = false!@#&end!@#& !@#&--[[Removes every frame leading after the frame passed in!@#&        Params: frame:int the non-inclusive lower bounds of the delete!@#&        Returns:nil!@#&]]--!@#&local function removeFramesAfter(frame)!@#&        inMenu = true!@#&        if frame==framecount then return end!@#&        drawMessage(\"Remove frames \"..(frame+1)..\"/\"..framecount..\"? Y/N :\")!@#&        local answer = string.upper(readInput(1))!@#&       !@#&        if string.find(answer, string.upper(\"Y\")) ~= 1 then!@#&                inMenu = false!@#&                return!@#&        end!@#&       !@#&        for i=frame+1, framecount do!@#&                frames[i] = nil!@#&        end!@#&        framecount = frame!@#&        inMenu = false!@#&end!@#& !@#&--[[!@#&                        Section: Printing Tools!@#&]]--!@#& !@#&--[[Constructs a new facing to the left of the current facing!@#&        Params: curx:number = The facing on the X axis!@#&                        curz:number = The facing on the Z axis!@#&                        hand:string = The hand of the axis (\"right\" or \"left\")!@#&        Returns:number,number = the new facing on the X and Z axis after a left turn!@#&]]--!@#&local function getLeft(curx, curz)!@#&        local hand = \"left\"!@#&        if layering == \"up\" then hand = \"right\" end!@#&       !@#&        if hand == \"right\" then!@#&                if curx == 1 then return 0,-1 end!@#&                if curx == -1 then return 0,1 end!@#&                if curz == 1 then return 1,0 end!@#&                if curz == -1 then return -1,0 end!@#&        else!@#&                if curx == 1 then return 0,1 end!@#&                if curx == -1 then return 0,-1 end!@#&                if curz == 1 then return -1,0 end!@#&                if curz == -1 then return 1,0 end!@#&        end!@#&end!@#& !@#&--[[Constructs a new facing to the right of the current facing!@#&        Params: curx:number = The facing on the X axis!@#&                        curz:number = The facing on the Z axis!@#&                        hand:string = The hand of the axis (\"right\" or \"left\")!@#&        Returns:number,number = the new facing on the X and Z axis after a right turn!@#&]]--!@#&local function getRight(curx, curz)!@#&        local hand = \"left\"!@#&        if layering == \"up\" then hand = \"right\" end!@#&       !@#&        if hand == \"right\" then!@#&                if curx == 1 then return 0,1 end!@#&                if curx == -1 then return 0,-1 end!@#&                if curz == 1 then return -1,0 end!@#&                if curz == -1 then return 1,0 end!@#&        else!@#&                if curx == 1 then return 0,-1 end!@#&                if curx == -1 then return 0,1 end!@#&                if curz == 1 then return 1,0 end!@#&                if curz == -1 then return -1,0 end!@#&        end!@#&end!@#& !@#& !@#&--[[Sends out a rednet signal requesting local printers, and will listen for any responses. Printers found are added to the!@#&        printerList (for ID's) and printerNames (for names)!@#&        Params: nil!@#&        Returns:nil!@#&]]--!@#&local function locatePrinters()!@#&        printerList = { }!@#&        printerNames = { name = \"Printers\" }!@#&        local oldState = state!@#&        state = \"Locating printers, please wait...   \"!@#&        drawCanvas()!@#&        drawInterface()!@#&        state = oldState!@#&       !@#&        local modemOpened = false!@#&        for k,v in pairs(rs.getSides()) do!@#&                if peripheral.isPresent(v) and peripheral.getType(v) == \"modem\" then!@#&                        rednet.open(v)!@#&                        modemOpened = true!@#&                        break!@#&                end!@#&        end!@#&       !@#&        if not modemOpened then!@#&                displayConfirmDialogue(\"Modem not found!\", \"No modem peripheral. Must have network modem to locate printers.\")!@#&                return false!@#&        end!@#&       !@#&        rednet.broadcast(\"$3DPRINT IDENTIFY\")!@#&       !@#&        while true do!@#&                local id, msg = rsTimeReceive(1)!@#&               !@#&                if not id then break end!@#&                if string.find(msg, \"$3DPRINT IDACK\") == 1 then!@#&                        msg = string.gsub(msg, \"$3DPRINT IDACK \", \"\")!@#&                        table.insert(printerList, id)!@#&                        table.insert(printerNames, msg)!@#&                end!@#&        end!@#&       !@#&        if #printerList == 0 then!@#&                displayConfirmDialogue(\"Printers not found!\", \"No active printers found in proximity of this computer.\")!@#&                return false!@#&        else!@#&                return true!@#&        end!@#&end!@#& !@#&--[[Sends a request to the printer. Waits on a response and updates the state of the application accordingly.!@#&        Params: command:string the command to send!@#&                        param:string a parameter to send, if any!@#&        Returns:nil!@#&]]--!@#&local function sendPC(command,param)!@#&        local msg = \"$PC \"..command!@#&        if param then msg = msg..\" \"..param end!@#&        rednet.send(printerList[selectedPrinter], msg)!@#&       !@#&        while true do!@#&                local id,key = rsTimeReceive()!@#&                if id == printerList[selectedPrinter] then!@#&                        if key == \"$3DPRINT ACK\" then!@#&                                break!@#&                        elseif key == \"$3DPRINT DEP\" then!@#&                                displayConfirmDialogue(\"Printer Empty\", \"The printer has exhasted a material. Please refill slot \"..param..!@#&                                        \", and click this message when ready to continue.\")!@#&                                rednet.send(printerList[selectedPrinter], msg)!@#&                        elseif key == \"$3DPRINT OOF\" then!@#&                                displayConfirmDialogue(\"Printer Out of Fuel\", \"The printer has no fuel. Please replace the material \"..!@#&                                        \"in slot 1 with a fuel source, then click this message.\")!@#&                                rednet.send(printerList[selectedPrinter], \"$PC SS 1\")!@#&                                id,key = rsTimeReceive()!@#&                                rednet.send(printerList[selectedPrinter], \"$PC RF\")!@#&                                id,key = rsTimeReceive()!@#&                                rednet.send(printerList[selectedPrinter], msg)!@#&                        end!@#&                end!@#&        end!@#&       !@#&        --Changes to position are handled after the event has been successfully completed!@#&        if command == \"FW\" then!@#&                px = px + pfx!@#&                pz = pz + pfz!@#&        elseif command == \"BK\" then!@#&                px = px - pfx!@#&                pz = pz - pfz!@#&        elseif command == \"UP\" then!@#&                if layering == \"up\" then!@#&                        py = py + 1!@#&                else!@#&                        py = py - 1!@#&                end!@#&        elseif command == \"DW\" then!@#&                if layering == \"up\" then!@#&                        py = py - 1!@#&                else    !@#&                        py = py + 1!@#&                end!@#&        elseif command == \"TL\" then!@#&                pfx,pfz = getLeft(pfx,pfz)!@#&        elseif command == \"TR\" then!@#&                pfx,pfz = getRight(pfx,pfz)!@#&        elseif command == \"TU\" then!@#&                pfx = -pfx!@#&                pfz = -pfz!@#&        end!@#&       !@#&        drawCanvas()!@#&        drawInterface()!@#&end!@#& !@#&--[[A printing function that commands the printer to turn to face the desired direction, if it is not already doing so!@#&        Params: desx:number = the normalized x direction to face!@#&                        desz:number = the normalized z direction to face!@#&        Returns:nil!@#&]]--!@#&local function turnToFace(desx,desz)!@#&        if desx ~= 0 then!@#&                if pfx ~= desx then!@#&                        local temppfx,_ = getLeft(pfx,pfz)!@#&                        if temppfx == desx then!@#&                                sendPC(\"TL\")!@#&                        elseif temppfx == -desx then!@#&                                sendPC(\"TR\")!@#&                        else!@#&                                sendPC(\"TU\")!@#&                        end!@#&                end!@#&        else!@#&                print(\"on the z axis\")!@#&                if pfz ~= desz then!@#&                        local _,temppfz = getLeft(pfx,pfz)!@#&                        if temppfz == desz then!@#&                                sendPC(\"TL\")!@#&                        elseif temppfz == -desz then!@#&                                sendPC(\"TR\")!@#&                        else!@#&                                sendPC(\"TU\")!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--[[Performs the print!@#&        Params: nil!@#&        Returns:nil!@#&]]--!@#&local function performPrint()!@#&        state = \"active print\"!@#&        if layering == \"up\" then!@#&                --An up layering starts our builder bot on the bottom left corner of our build!@#&                px,py,pz = leflim, 0, botlim + 1!@#&                pfx,pfz = 0,-1!@#&               !@#&                --We move him forward and up a bit from his original position.!@#&                sendPC(\"FW\")!@#&                sendPC(\"UP\")!@#&                --For each layer that needs to be completed, we go up by one each time!@#&                for layers=1,#frames do!@#&                        --We first decide if we're going forwards or back, depending on what side we're on!@#&                        local rowbot,rowtop,rowinc = nil,nil,nil!@#&                        if pz == botlim then!@#&                                rowbot,rowtop,rowinc = botlim,toplim,-1!@#&                        else!@#&                                rowbot,rowtop,rowinc = toplim,botlim,1!@#&                        end!@#&                       !@#&                        for rows = rowbot,rowtop,rowinc do!@#&                                --Then we decide if we're going left or right, depending on what side we're on!@#&                                local linebot,linetop,lineinc = nil,nil,nil!@#&                                if px == leflim then!@#&                                        --Facing from the left side has to be easterly- it's changed here!@#&                                        turnToFace(1,0)!@#&                                        linebot,linetop,lineinc = leflim,riglim,1!@#&                                else!@#&                                        --Facing from the right side has to be westerly- it's changed here!@#&                                        turnToFace(-1,0)!@#&                                        linebot,linetop,lineinc = riglim,leflim,-1!@#&                                end!@#&                               !@#&                                for lines = linebot,linetop,lineinc do!@#&                                        --We move our turtle forward, placing the right material at each step!@#&                                        local material = frames[py][pz][px]!@#&                                        if material then!@#&                                                material = math.log10(frames[py][pz][px])/math.log10(2) + 1!@#&                                                sendPC(\"SS\", material)!@#&                                                sendPC(\"PD\")!@#&                                        end!@#&                                        if lines ~= linetop then!@#&                                                sendPC(\"FW\")!@#&                                        end!@#&                                end!@#&                               !@#&                                --The printer then has to do a U-turn, depending on which way he's facing and!@#&                                --which way he needs to go!@#&                                local temppfx,temppfz = getLeft(pfx,pfz)!@#&                                if temppfz == rowinc and rows ~= rowtop then!@#&                                        sendPC(\"TL\")!@#&                                        sendPC(\"FW\")!@#&                                        sendPC(\"TL\")!@#&                                elseif temppfz == -rowinc and rows ~= rowtop then!@#&                                        sendPC(\"TR\")!@#&                                        sendPC(\"FW\")!@#&                                        sendPC(\"TR\")!@#&                                end!@#&                        end!@#&                        --Now at the end of a run he does a 180 and moves up to begin the next part of the print!@#&                        sendPC(\"TU\")!@#&                        if layers ~= #frames then!@#&                                sendPC(\"UP\")!@#&                        end!@#&                end!@#&                --All done- now we head back to where we started.!@#&                if px ~= leflim then!@#&                        turnToFace(-1,0)!@#&                        while px ~= leflim do!@#&                                sendPC(\"FW\")!@#&                        end!@#&                end!@#&                if pz ~= botlim then!@#&                        turnToFace(0,-1)!@#&                        while pz ~= botlim do!@#&                                sendPC(\"BK\")!@#&                        end!@#&                end!@#&                turnToFace(0,-1)!@#&                sendPC(\"BK\")!@#&                while py > 0 do!@#&                        sendPC(\"DW\")!@#&                end!@#&        else!@#&                --The front facing is at the top-left corner, facing south not north!@#&                px,py,pz = leflim, botlim, 1!@#&                pfx,pfz = 0,1!@#&                --We move the printer to the last layer- he prints from the back forwards!@#&                while pz < #frames do!@#&                        sendPC(\"FW\")!@#&                end!@#&               !@#&                --For each layer in the frame we build our wall, the move back!@#&                for layers = 1,#frames do!@#&                        --We first decide if we're going left or right based on our position!@#&                        local rowbot,rowtop,rowinc = nil,nil,nil!@#&                        if px == leflim then!@#&                                rowbot,rowtop,rowinc = leflim,riglim,1!@#&                        else!@#&                                rowbot,rowtop,rowinc = riglim,leflim,-1!@#&                        end!@#&                       !@#&                        for rows = rowbot,rowtop,rowinc do!@#&                                --Then we decide if we're going up or down, depending on our given altitude!@#&                                local linebot,linetop,lineinc = nil,nil,nil!@#&                                if py == botlim then!@#&                                        linebot,linetop,lineinc = botlim,toplim,-1!@#&                                else!@#&                                        linebot,linetop,lineinc = toplim,botlim,1!@#&                                end!@#&                               !@#&                                for lines = linebot,linetop,lineinc do!@#&                                --We move our turtle up/down, placing the right material at each step!@#&                                        local material = frames[pz][py][px]!@#&                                        if material then!@#&                                                material = math.log10(frames[pz][py][px])/math.log10(2) + 1!@#&                                                sendPC(\"SS\", material)!@#&                                                sendPC(\"PF\")!@#&                                        end!@#&                                        if lines ~= linetop then!@#&                                                if lineinc == 1 then sendPC(\"DW\")!@#&                                                else sendPC(\"UP\") end!@#&                                        end!@#&                                end!@#&                                       !@#&                                if rows ~= rowtop then!@#&                                        turnToFace(rowinc,0)!@#&                                        sendPC(\"FW\")!@#&                                        turnToFace(0,1)!@#&                                end!@#&                        end!@#&                       !@#&                        if layers ~= #frames then!@#&                                sendPC(\"TU\")!@#&                                sendPC(\"FW\")!@#&                                sendPC(\"TU\")!@#&                        end!@#&                end!@#&                --He's easy to reset!@#&                while px ~= leflim do!@#&                        turnToFace(-1,0)!@#&                        sendPC(\"FW\")!@#&                end!@#&                turnToFace(0,1)!@#&        end!@#&       !@#&        sendPC(\"DE\")!@#&       !@#&        displayConfirmDialogue(\"Print complete\", \"The 3D print was successful.\")!@#&end!@#& !@#&--[[  !@#&                        Section: Interface  !@#&]]--!@#& !@#&--[[Runs the printing interface. Allows users to find/select a printer, the style of printing to perform and to begin the operation!@#&        Params: none!@#&        Returns:boolean true if printing was started, false otherwse!@#&]]--!@#&local function runPrintInterface()!@#&        calculateMaterials()!@#&        --There's nothing on canvas yet!!@#&        if not botlim then!@#&                displayConfirmDialogue(\"Cannot Print Empty Canvas\", \"There is nothing on canvas that \"..!@#&                                \"can be printed, and the operation cannot be completed.\")!@#&                return false!@#&        end!@#&        --No printers nearby!@#&        if not locatePrinters() then!@#&                return false!@#&        end!@#&       !@#&        layering = \"up\"!@#&        requirementsDisplayed = false!@#&        selectedPrinter = 1!@#&        while true do!@#&                drawCanvas()!@#&                term.setBackgroundColour(colours.lightGrey)!@#&                for i=1,10 do!@#&                        term.setCursorPos(1,i)!@#&                        term.clearLine()!@#&                end!@#&                drawInterface()!@#&                term.setBackgroundColour(colours.lightGrey)!@#&                term.setTextColour(colours.black)!@#&               !@#&                local msg = \"3D Printing\"!@#&                term.setCursorPos(w/2-#msg/2 - 2, 1)!@#&                term.write(msg)!@#&                term.setBackgroundColour(colours.grey)!@#&                term.setTextColour(colours.lightGrey)!@#&                if(requirementsDisplayed) then!@#&                        msg = \"Count:\"!@#&                else!@#&                        msg = \" Slot:\"!@#&                end!@#&                term.setCursorPos(w-3-#msg, 1)!@#&                term.write(msg)!@#&                term.setBackgroundColour(colours.lightGrey)!@#&                term.setTextColour(colours.black)!@#&               !@#&                term.setCursorPos(7, 2)!@#&                term.write(\"Layering\")!@#&                drawPictureTable(layerUpIcon, 3, 3, colours.white)!@#&                drawPictureTable(layerForwardIcon, 12, 3, colours.white)!@#&                if layering == \"up\" then!@#&                        term.setBackgroundColour(colours.red)!@#&                else!@#&                        term.setBackgroundColour(colours.lightGrey)!@#&                end!@#&                term.setCursorPos(3, 9)!@#&                term.write(\"Upwards\")!@#&                if layering == \"forward\" then!@#&                        term.setBackgroundColour(colours.red)!@#&                else!@#&                        term.setBackgroundColour(colours.lightGrey)!@#&                end!@#&                term.setCursorPos(12, 9)!@#&                term.write(\"Forward\")!@#&               !@#&                term.setBackgroundColour(colours.lightGrey)!@#&                term.setTextColour(colours.black)!@#&                term.setCursorPos(31, 2)!@#&                term.write(\"Printer ID\")!@#&                term.setCursorPos(33, 3)!@#&                if #printerList > 1 then!@#&                        term.setBackgroundColour(colours.grey)!@#&                        term.setTextColour(colours.lightGrey)!@#&                else!@#&                        term.setTextColour(colours.red)!@#&                end!@#&                term.write(\" \"..printerNames[selectedPrinter]..\" \")!@#&               !@#&                term.setBackgroundColour(colours.grey)!@#&                term.setTextColour(colours.lightGrey)!@#&                term.setCursorPos(25, 10)!@#&                term.write(\" Cancel \")!@#&                term.setCursorPos(40, 10)!@#&                term.write(\" Print \")!@#&               !@#&                local id, p1, p2, p3 = os.pullEvent()!@#&               !@#&                if id == \"timer\" then!@#&                        updateTimer(p1)!@#&                elseif id == \"mouse_click\" then!@#&                        --Layering Buttons!@#&                        if p2 >= 3 and p2 <= 9 and p3 >= 3 and p3 <= 9 then!@#&                                layering = \"up\"!@#&                        elseif p2 >= 12 and p2 <= 18 and p3 >= 3 and p3 <= 9 then!@#&                                layering = \"forward\"!@#&                        --Count/Slot!@#&                        elseif p2 >= w - #msg - 3 and p2 <= w - 3 and p3 == 1 then!@#&                                requirementsDisplayed = not requirementsDisplayed!@#&                        --Printer ID!@#&                        elseif p2 >= 33 and p2 <= 33 + #printerNames[selectedPrinter] and p3 == 3 and #printerList > 1 then!@#&                                local chosenName = displayDropDown(33, 3, printerNames)!@#&                                for i=1,#printerNames do!@#&                                        if printerNames[i] == chosenName then!@#&                                                selectedPrinter = i!@#&                                                break;!@#&                                        end!@#&                                end!@#&                        --Print and Cancel!@#&                        elseif p2 >= 25 and p2 <= 32 and p3 == 10 then!@#&                                break!@#&                        elseif p2 >= 40 and p2 <= 46 and p3 == 10 then!@#&                                rednet.send(printerList[selectedPrinter], \"$3DPRINT ACTIVATE\")!@#&                                ready = false!@#&                                while true do!@#&                                        local id,msg = rsTimeReceive(10)!@#&                                       !@#&                                        if id == printerList[selectedPrinter] and msg == \"$3DPRINT ACTACK\" then!@#&                                                ready = true!@#&                                                break!@#&                                        end!@#&                                end!@#&                                if ready then!@#&                                        performPrint()!@#&                                        break!@#&                                else!@#&                                        displayConfirmDialogue(\"Printer Didn't Respond\", \"The printer didn't respond to the activation command. Check to see if it's online\")!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        state = \"paint\"!@#&end!@#&!@#&--[[Performs a legacy save. When the dropdown menu is unavailable, it requests the user to save!@#&	or exit using keyboard shortcuts rather than selecting a menu option from the dropdown.!@#&	Pressing the control key again will cancel the save operation.!@#&	Params: none!@#&	Returns:string = the selection made!@#&]]--!@#&local function performLegacySaveExit()!@#&	local saveMsg = \"(S)ave/(E)xit?\"!@#&	if w < #saveMsg then saveMsg = \"S/E?\" end!@#&	!@#&	term.setCursorPos(1,h)!@#&	term.setBackgroundColour(colours.lightGrey)!@#&	term.setTextColour(colours.grey)!@#&	term.clearLine()!@#&	term.write(saveMsg)!@#&	!@#&	while true do!@#&		local id,val = os.pullEvent()!@#&		if id == \"timer\" then updateTimer(val)!@#&		elseif id == \"key\" then!@#&			if val == keys.s then return \"save\" !@#&			elseif val == keys.e then!@#&				--Get rid of the extra event!@#&				os.pullEvent(\"char\")!@#&				return \"exit\"!@#&			elseif val == keys.leftCtrl then return nil!@#&			end!@#&		end!@#&	end!@#&end!@#& !@#&--[[This function changes the current paint program to another tool or mode, depending on user input. Handles!@#&        any necessary changes in logic involved in that.!@#&        Params: mode:string = the name of the mode to change to!@#&        Returns:nil!@#&]]--!@#&local function performSelection(mode)!@#&        if not mode or mode == \"\" then return!@#&       !@#&        elseif mode == \"help\" and helpAvailable then!@#&                drawHelpScreen()!@#&               !@#&        elseif mode == \"blueprint on\" then!@#&                blueprint = true!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"blueprint on\" then!@#&					ddModes[2][i] = \"blueprint off\"!@#&				end end!@#&               !@#&        elseif mode == \"blueprint off\" then!@#&                blueprint = false!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"blueprint off\" then!@#&					ddModes[2][i] = \"blueprint on\"!@#&				end end!@#&               !@#&        elseif mode == \"layers on\" then!@#&                layerDisplay = true!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"layers on\" then!@#&					ddModes[2][i] = \"layers off\"!@#&				end end!@#&       !@#&        elseif mode == \"layers off\" then!@#&                layerDisplay = false!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"layers off\" then!@#&					ddModes[2][i] = \"layers on\"!@#&				end end!@#&       !@#&        elseif mode == \"direction on\" then!@#&                printDirection = true!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"direction on\" then!@#&					ddModes[2][i] = \"direction off\"!@#&				end end!@#&               !@#&        elseif mode == \"direction off\" then!@#&                printDirection = false!@#&				for i=1,#ddModes[2] do if ddModes[2][i] == \"direction off\" then!@#&					ddModes[2][i] = \"direction on\"!@#&				end end!@#&		!@#&		elseif mode == \"hide interface\" then!@#&				interfaceHidden = true!@#&			!@#&		elseif mode == \"show interface\" then!@#&				interfaceHidden = false!@#&       !@#&        elseif mode == \"go to\" then!@#&                changeFrame()!@#&       !@#&        elseif mode == \"remove\" then!@#&                removeFramesAfter(sFrame)!@#&       !@#&        elseif mode == \"play\" then!@#&                playAnimation()!@#&               !@#&        elseif mode == \"copy\" then!@#&                if selectrect and selectrect.x1 ~= selectrect.x2 then!@#&                        copyToBuffer(false)!@#&                end!@#&       !@#&        elseif mode == \"cut\" then!@#&                if selectrect and selectrect.x1 ~= selectrect.x2 then!@#&                        copyToBuffer(true)!@#&                end!@#&               !@#&        elseif mode == \"paste\" then!@#&                if selectrect and selectrect.x1 ~= selectrect.x2 then!@#&                        copyFromBuffer(false)!@#&                end!@#&               !@#&        elseif mode == \"hide\" then!@#&                selectrect = nil!@#&                if state == \"select\" then state = \"corner select\" end!@#&			   !@#&        elseif mode == \"alpha to left\" then!@#&                if lSel then alphaC = lSel end!@#&               !@#&        elseif mode == \"alpha to right\" then!@#&                if rSel then alphaC = rSel end!@#&               !@#&        elseif mode == \"record\" then!@#&                record = not record!@#&               !@#&        elseif mode == \"clear\" then!@#&                if state==\"select\" then buffer = nil!@#&                else clearImage() end!@#&       !@#&        elseif mode == \"select\" then!@#&                if state==\"corner select\" or state==\"select\" then!@#&                        state = \"paint\"!@#&                elseif selectrect and selectrect.x1 ~= selectrect.x2 then!@#&                        state = \"select\"!@#&                else!@#&                        state = \"corner select\"!@#&                end!@#&               !@#&        elseif mode == \"print\" then!@#&                state = \"print\"!@#&                runPrintInterface()!@#&                state = \"paint\"!@#&               !@#&        elseif mode == \"save\" then!@#&                if animated then saveNFA(sPath)!@#&                elseif textEnabled then saveNFT(sPath)!@#&                else saveNFP(sPath) end!@#&               !@#&        elseif mode == \"exit\" then!@#&                isRunning = false!@#&       !@#&        elseif mode ~= state then state = mode!@#&        else state = \"paint\"!@#&        end!@#&end!@#& !@#&--[[The main function of the program, reads and handles all events and updates them accordingly. Mode changes,!@#&        painting to the canvas and general selections are done here.!@#&        Params: none!@#&        Returns:nil!@#&]]--!@#&local function handleEvents()!@#&        recttimer = os.startTimer(0.5)!@#&        while isRunning do!@#&                drawCanvas()!@#&                if not interfaceHidden then drawInterface() end!@#&               !@#&                if state == \"text\" then!@#&                        term.setCursorPos(textCurX - sx, textCurY - sy)!@#&                        term.setCursorBlink(true)!@#&                end!@#&               !@#&                local id,p1,p2,p3 = os.pullEvent()!@#&                term.setCursorBlink(false)!@#&                if id==\"timer\" then!@#&                        updateTimer(p1)!@#&                elseif (id==\"mouse_click\" or id==\"mouse_drag\") and not interfaceHidden then!@#&                        if p2 >=w-1 and p3 < #column+1 then!@#&								local off = 0!@#&								local cansel = true!@#&								if h < #column + 2 then!@#&									if p3 == 1 then !@#&										if columnoffset > 0 then columnoffset = columnoffset-1 end!@#&										cansel = false!@#&									elseif p3 == h-2 then!@#&										if columnoffset < #column-(h-4)+1 then columnoffset = columnoffset+1 end!@#&										cansel = false!@#&									else!@#&										off = columnoffset - 1!@#&									end!@#&								end!@#&								--This rather handily accounts for the nil case (p3+off=#column+1)!@#&								if p1==1 and cansel then lSel = column[p3+off]!@#&                                elseif p1==2 and cansel then rSel = column[p3+off] end!@#&                        elseif p2 >=w-1 and p3==#column+1 then!@#&                                if p1==1 then lSel = nil!@#&                                else rSel = nil end!@#&                        elseif p2==w-1 and p3==h and animated then!@#&                                changeFrame(sFrame-1)!@#&                        elseif p2==w and p3==h and animated then!@#&                                changeFrame(sFrame+1)!@#&                        elseif p2 <= #ddModes.name + 2 and p3==h and mainAvailable then!@#&                                local sel = displayDropDown(1, h-1, ddModes)!@#&                                performSelection(sel)!@#&                        elseif p2 < w-1 and p3 <= h-1 then!@#&                                if state==\"pippette\" then!@#&                                        if p1==1 then!@#&                                                if frames[sFrame][p3+sy] and frames[sFrame][p3+sy][p2+sx] then!@#&                                                        lSel = frames[sFrame][p3+sy][p2+sx]!@#&                                                end!@#&                                        elseif p1==2 then!@#&                                                if frames[sFrame][p3+sy] and frames[sFrame][p3+sy][p2+sx] then!@#&                                                        rSel = frames[sFrame][p3+sy][p2+sx]!@#&                                                end!@#&                                        end!@#&                                elseif state==\"move\" then!@#&                                        updateImageLims(record)!@#&                                        moveImage(p2,p3)!@#&                                elseif state==\"flood\" then!@#&                                        if p1 == 1 and lSel and frames[sFrame][p3+sy]  then!@#&                                                floodFill(p2,p3,frames[sFrame][p3+sy][p2+sx],lSel)!@#&                                        elseif p1 == 2 and rSel and frames[sFrame][p3+sy] then!@#&                                                floodFill(p2,p3,frames[sFrame][p3+sy][p2+sx],rSel)!@#&                                        end!@#&                                elseif state==\"corner select\" then!@#&                                        if not selectrect then!@#&                                                selectrect = { x1=p2+sx, x2=p2+sx, y1=p3+sy, y2=p3+sy }!@#&                                        elseif selectrect.x1 ~= p2+sx and selectrect.y1 ~= p3+sy then!@#&                                                if p2+sx<selectrect.x1 then selectrect.x1 = p2+sx!@#&                                                else selectrect.x2 = p2+sx end!@#&                                               !@#&                                                if p3+sy<selectrect.y1 then selectrect.y1 = p3+sy!@#&                                                else selectrect.y2 = p3+sy end!@#&                                               !@#&                                                state = \"select\"!@#&                                        end!@#&                                elseif state==\"textpaint\" then!@#&                                        local paintCol = lSel!@#&                                        if p1 == 2 then paintCol = rSel end!@#&                                        if frames[sFrame].textcol[p3+sy] then!@#&                                                frames[sFrame].textcol[p3+sy][p2+sx] = paintCol!@#&                                        end!@#&                                elseif state==\"text\" then!@#&                                        textCurX = p2 + sx!@#&                                        textCurY = p3 + sy!@#&                                elseif state==\"select\" then!@#&                                        if p1 == 1 then!@#&                                                local swidth = selectrect.x2 - selectrect.x1!@#&                                                local sheight = selectrect.y2 - selectrect.y1!@#&                                       !@#&                                                selectrect.x1 = p2 + sx!@#&                                                selectrect.y1 = p3 + sy!@#&                                                selectrect.x2 = p2 + swidth + sx!@#&                                                selectrect.y2 = p3 + sheight + sy!@#&                                        elseif p1 == 2 and p2 < w-2 and p3 < h-1 and boxdropAvailable then!@#&                                                inMenu = true!@#&                                                local sel = displayDropDown(p2, p3, srModes)!@#&                                                inMenu = false!@#&                                                performSelection(sel)!@#&                                        end!@#&                                else!@#&                                        local f,l = sFrame,sFrame!@#&                                        if record then f,l = 1,framecount end!@#&                                        local bwidth = 0!@#&                                        if state == \"brush\" then bwidth = brushsize-1 end!@#&                               !@#&                                        for i=f,l do!@#&                                                for x = math.max(1,p2+sx-bwidth),p2+sx+bwidth do!@#&                                                        for y = math.max(1,p3+sy-bwidth), p3+sy+bwidth do!@#&                                                                if math.abs(x - (p2+sx)) + math.abs(y - (p3+sy)) <= bwidth then!@#&                                                                        if not frames[i][y] then frames[i][y] = {} end!@#&                                                                        if p1==1 then frames[i][y][x] = lSel!@#&                                                                        else frames[i][y][x] = rSel end!@#&                                                                       !@#&                                                                        if textEnabled then!@#&                                                                                if not frames[i].text[y] then frames[i].text[y] = { } end!@#&                                                                                if not frames[i].textcol[y] then frames[i].textcol[y] = { } end!@#&                                                                        end!@#&                                                                end!@#&                                                        end!@#&                                                end!@#&                                        end!@#&                                end!@#&                        end!@#&                elseif id==\"char\" then!@#&                        if state==\"text\" then!@#&                                if not frames[sFrame][textCurY] then frames[sFrame][textCurY] = { } end!@#&                                if not frames[sFrame].text[textCurY] then frames[sFrame].text[textCurY] = { } end!@#&                                if not frames[sFrame].textcol[textCurY] then frames[sFrame].textcol[textCurY] = { } end!@#&                               !@#&                                if rSel then frames[sFrame][textCurY][textCurX] = rSel end!@#&                                if lSel then!@#&                                        frames[sFrame].text[textCurY][textCurX] = p1!@#&                                        frames[sFrame].textcol[textCurY][textCurX] = lSel!@#&                                else!@#&                                        frames[sFrame].text[textCurY][textCurX] = \" \"!@#&                                        frames[sFrame].textcol[textCurY][textCurX] = rSel!@#&                                end!@#&                               !@#&                                textCurX = textCurX+1!@#&                                if textCurX > w + sx - 2 then sx = textCurX - w + 2 end!@#&                        elseif tonumber(p1) then!@#&                                if state==\"brush\" and tonumber(p1) > 1 then!@#&                                        brushsize = tonumber(p1)!@#&                                elseif animated and tonumber(p1) > 0 then!@#&                                        changeFrame(tonumber(p1))!@#&                                end!@#&                        end!@#&                elseif id==\"key\" then!@#&						--All standard interface methods are locked when the interface is hidden!@#&						if interfaceHidden then!@#&							if p1==keys.grave then!@#&								performSelection(\"show interface\") !@#&							end!@#&                        --Text needs special handlers (all other keyboard shortcuts are of course reserved for typing)!@#&                        elseif state==\"text\" then!@#&                                if p1==keys.backspace and textCurX > 1 then!@#&                                        textCurX = textCurX-1!@#&                                        if frames[sFrame].text[textCurY] then!@#&                                                frames[sFrame].text[textCurY][textCurX] = nil!@#&                                                frames[sFrame].textcol[textCurY][textCurX] = nil!@#&                                        end!@#&                                        if textCurX < sx then sx = textCurX end!@#&                                elseif p1==keys.left and textCurX > 1 then!@#&                                        textCurX = textCurX-1!@#&                                        if textCurX-1 < sx then sx = textCurX-1 end!@#&                                elseif p1==keys.right then!@#&                                        textCurX = textCurX+1!@#&                                        if textCurX > w + sx - 2 then sx = textCurX - w + 2 end!@#&                                elseif p1==keys.up and textCurY > 1 then!@#&                                        textCurY = textCurY-1!@#&                                        if textCurY-1 < sy then sy = textCurY-1 end!@#&                                elseif p1==keys.down then!@#&                                        textCurY = textCurY+1!@#&                                        if textCurY > h + sy - 1 then sy = textCurY - h + 1 end!@#&                                end!@#&                       !@#&                        elseif p1==keys.leftCtrl then!@#&                                local sel = nil!@#&								if mainAvailable then !@#&									sel = displayDropDown(1, h-1, ddModes[#ddModes])!@#&								else sel = performLegacySaveExit() end!@#&                                performSelection(sel)!@#&                        elseif p1==keys.leftAlt then!@#&                                local sel = displayDropDown(1, h-1, ddModes[1])!@#&                                performSelection(sel)!@#&                        elseif p1==keys.h then!@#&                                performSelection(\"help\")!@#&                        elseif p1==keys.x then!@#&                                performSelection(\"cut\")!@#&                        elseif p1==keys.c then!@#&                                performSelection(\"copy\")!@#&                        elseif p1==keys.v then!@#&                                performSelection(\"paste\")!@#&                        elseif p1==keys.z then!@#&                                performSelection(\"clear\")!@#&                        elseif p1==keys.s then!@#&                                performSelection(\"select\")!@#&                        elseif p1==keys.tab then!@#&                                performSelection(\"hide\")!@#&                        elseif p1==keys.q then!@#&                                performSelection(\"alpha to left\")!@#&                        elseif p1==keys.w then!@#&                                performSelection(\"alpha to right\")!@#&                        elseif p1==keys.f then!@#&                                performSelection(\"flood\")!@#&                        elseif p1==keys.b then!@#&                                performSelection(\"brush\")!@#&                        elseif p1==keys.m then!@#&                                performSelection(\"move\")!@#&                        elseif p1==keys.backslash and animated then!@#&                                performSelection(\"record\")!@#&                        elseif p1==keys.p then!@#&                                performSelection(\"pippette\")!@#&                        elseif p1==keys.g and animated then!@#&                                performSelection(\"go to\")!@#&						elseif p1==keys.grave then !@#&								performSelection(\"hide interface\")!@#&                        elseif p1==keys.period and animated then!@#&                                changeFrame(sFrame+1)!@#&                        elseif p1==keys.comma and animated then!@#&                                changeFrame(sFrame-1)!@#&                        elseif p1==keys.r and animated then!@#&                                performSelection(\"remove\")!@#&                        elseif p1==keys.space and animated then!@#&                                performSelection(\"play\")!@#&                        elseif p1==keys.t and textEnabled then!@#&                                performSelection(\"text\")!@#&                                sleep(0.01)!@#&                        elseif p1==keys.y and textEnabled then!@#&                                performSelection(\"textpaint\")!@#&                        elseif p1==keys.left then!@#&                                if state == \"move\" and toplim then!@#&                                        updateImageLims(record)!@#&                                        if toplim and leflim then!@#&                                                moveImage(leflim-1,toplim)!@#&                                        end!@#&                                elseif state==\"select\" and selectrect.x1 > 1 then!@#&                                        selectrect.x1 = selectrect.x1-1!@#&                                        selectrect.x2 = selectrect.x2-1!@#&                                elseif sx > 0 then sx=sx-1 end!@#&                        elseif p1==keys.right then!@#&                                if state == \"move\" then!@#&                                        updateImageLims(record)!@#&                                        if toplim and leflim then!@#&                                                moveImage(leflim+1,toplim)!@#&                                        end!@#&                                elseif state==\"select\" then!@#&                                        selectrect.x1 = selectrect.x1+1!@#&                                        selectrect.x2 = selectrect.x2+1!@#&                                else sx=sx+1 end!@#&                        elseif p1==keys.up then!@#&                                if state == \"move\" then!@#&                                        updateImageLims(record)!@#&                                        if toplim and leflim then!@#&                                                moveImage(leflim,toplim-1)!@#&                                        end!@#&                                elseif state==\"select\" and selectrect.y1 > 1 then!@#&                                        selectrect.y1 = selectrect.y1-1!@#&                                        selectrect.y2 = selectrect.y2-1!@#&                                elseif sy > 0 then sy=sy-1 end!@#&                        elseif p1==keys.down then!@#&                                if state == \"move\" then!@#&                                        updateImageLims(record)!@#&                                        if toplim and leflim then!@#&                                                moveImage(leflim,toplim+1)!@#&                                        end!@#&                                elseif state==\"select\" then!@#&                                        selectrect.y1 = selectrect.y1+1!@#&                                        selectrect.y2 = selectrect.y2+1!@#&                                else sy=sy+1 end!@#&                        end!@#&                end!@#&        end!@#&end!@#& !@#&--[[!@#&                        Section: Main  !@#&]]--!@#& !@#&--The first thing done is deciding what features we actually have, given the screen size!@#&if w < 7 or h < 4 then!@#&	--NPaintPro simply doesn't work at certain configurations!@#&	shell.run(\"clear\")!@#&	print(\"Screen too small\")!@#&	os.pullEvent(\"key\")!@#&	return!@#&end!@#&--And reduces the number of features in others.!@#&determineAvailableServices()!@#& !@#&--There is no b&w support for NPP.!@#&if not term.isColour() then!@#&	shell.run(\"clear\")!@#&	print(\"NPaintPro\\nBy Ma3rX\\n\\nNPaintPro can only be run on advanced \"..!@#&	\"computers. Please reinstall on an advanced computer.\")!@#&    return!@#&end!@#& !@#&--Taken almost directly from edit (for consistency)!@#&local tArgs = {...}!@#& !@#&--Command line options can appear before the file path to specify the file format!@#&local ca = 1!@#&while ca <= #tArgs do!@#&	if tArgs[ca] == \"-a\" then animated = true!@#&	elseif tArgs[ca] == \"-t\" then textEnabled = true!@#&	elseif tArgs[ca] == \"-d\" then interfaceHidden = true!@#&	elseif string.sub(tArgs[ca], 1, 1) == \"-\" then!@#&		print(\"Unrecognized option: \"..tArgs[ca])!@#&		return!@#&	else break end!@#&	ca = ca + 1!@#&end!@#&!@#&--Presently, animations and text files are not supported!@#&if animated and textEnabled then!@#&    print(\"No support for animated text files- cannot have both -a and -t\")!@#&	return!@#&end!@#&!@#&--Filepaths must be added if the screen is too small!@#&if #tArgs < ca then!@#&	if not filemakerAvailable then!@#&		print(\"Usage: npaintpro [-a,-t,-d] <path>\")!@#&		return!@#&	else!@#&		--Otherwise do the logo draw early, to determine the file.!@#&		drawLogo()!@#&		if not runFileMaker() then return end!@#&	end!@#&else!@#&	if not interfaceHidden then drawLogo() end!@#&	sPath = shell.resolve(tArgs[ca])!@#&end!@#& !@#&if fs.exists(sPath) then!@#&        if fs.isDir(sPath) then!@#&                print(\"Cannot edit a directory.\")!@#&                return!@#&        elseif string.find(sPath, \".nfp\") ~= #sPath-3 and string.find(sPath, \".nfa\") ~= #sPath-3 and!@#&                        string.find(sPath, \".nft\") ~= #sPath-3 then!@#&                print(\"Can only edit .nfp, .nft and .nfa files:\",string.find(sPath, \".nfp\"),#sPath-3)!@#&                return!@#&        end!@#&       !@#&        if string.find(sPath, \".nfa\") == #sPath-3 then!@#&                animated = true!@#&        end!@#&       !@#&        if string.find(sPath, \".nft\") == #sPath-3 then!@#&                textEnabled = true!@#&        end    !@#&       !@#&        if string.find(sPath, \".nfp\") == #sPath-3 and animated then!@#&                print(\"Convert to nfa? Y/N\")!@#&                if string.find(string.lower(io.read()), \"y\") then!@#&                        local nsPath = string.sub(sPath, 1, #sPath-1)..\"a\"!@#&                        fs.move(sPath, nsPath)!@#&                        sPath = nsPath!@#&                else!@#&                        animated = false!@#&                end!@#&        end!@#&       !@#&        --Again this is possible, I just haven't done it. Maybe I will?!@#&        if textEnabled and (string.find(sPath, \".nfp\") == #sPath-3 or string.find(sPath, \".nfa\") == #sPath-3) then!@#&                print(\"Cannot convert to nft\")!@#&        end!@#&else!@#&        if not animated and not textEnabled and string.find(sPath, \".nfp\") ~= #sPath-3 then!@#&                sPath = sPath..\".nfp\"!@#&        elseif animated and string.find(sPath, \".nfa\") ~= #sPath-3 then!@#&                sPath = sPath..\".nfa\"!@#&        elseif textEnabled and string.find(sPath, \".nft\") ~= #sPath-3 then!@#&                sPath = sPath..\".nft\"!@#&        end!@#&end!@#& !@#&init()!@#&handleEvents()!@#& !@#&term.setBackgroundColour(colours.black)!@#&shell.run(\"clear\")",["GIFAnimator"]="os.loadAPI(\"/SpeedAPI/GIF\")!@#&os.loadAPI(\"/SpeedAPI/lddfm\")!@#&os.loadAPI(\"/SpeedAPI/peripheral\")!@#&!@#&local args = {...}!@#&!@#&local mon = peripheral.wrap(peripheral.find(\"monitor\"))!@#&mon.setTextScale(0.5)!@#&local x, y = mon.getSize()!@#&local image_name!@#&!@#&if args[1] then!@#&  image_name = args[1]!@#&!@#&else!@#&  image_name = tostring(lddfm.makeMenu())!@#&end!@#&!@#&local image = GIF.loadGIF(image_name)!@#&mon.setBackgroundColour(image[1].transparentCol or image.backgroundCol)!@#&mon.clear()!@#&	!@#&GIF.animateGIF(image, math.floor((x - image.width) / 2) + 1, math.floor((y - image.height) / 2) + 1, mon)",["Calculator"]="--[[Smart Calculator by Cranium]]--!@#& !@#&local tX, tY = term.getSize()!@#&local calc = {}!@#& !@#&--equation states!@#&calc.mode = false!@#&calc.inverse = false!@#&calc.hyp = false!@#&calc.sqrt = false !@#&calc.exp = false!@#&calc.asin = false!@#&calc.sin = false!@#&calc.sinh = false!@#&calc.atan = false!@#&calc.tan = false!@#&calc.tanh = false!@#&calc.acos = false!@#&calc.cos = false!@#&calc.cosh = false!@#&calc.log = false!@#&calc.pos = false!@#& !@#&-- characters!@#&local charList = {!@#&    [\"0\"] = {!@#&        \".-.\",!@#&        \"| |\",!@#&        \"'-'\"!@#&    },!@#&    [\"1\"] = {!@#&        \" . \",!@#&        \"'| \",!@#&        \"---\"!@#&    },!@#&    [\"2\"] = {!@#&        \".-.\",!@#&        \".-'\",!@#&        \"'- \"!@#&    },!@#&    [\"3\"] = {!@#&        \" -.\",!@#&        \" -|\",!@#&        \" -'\"!@#&    },!@#&    [\"4\"] = {!@#&        \". .\",!@#&        \"'-|\",!@#&        \"  '\"!@#&    },!@#&    [\"5\"] = {!@#&        \".- \",!@#&        \"'-.\",!@#&        \" -'\"!@#&    },!@#&    [\"6\"] = {!@#&        \".-.\",!@#&        \"|-.\",!@#&        \"'-'\"!@#&    },!@#&    [\"7\"] = {!@#&        \".-.\",!@#&        \"  |\",!@#&        \"  '\"!@#&    },!@#&    [\"8\"] = {!@#&        \".-.\",!@#&        \"|-|\",!@#&        \"'-'\"!@#&    },!@#&    [\"9\"] = {!@#&        \".-.\",!@#&        \"'-|\",!@#&        \" -'\"!@#&    },!@#&    [\".\"] = {!@#&        \"   \",!@#&        \"   \",!@#&        \" . \"!@#&    },!@#&    [\"-\"] = {!@#&        \"   \",!@#&        \" --\",!@#&        \"   \"!@#&    },!@#&}!@#&-- lay out the button labels!@#&local labels = {!@#&    ' + ', ' 1 ', ' 2 ', ' 3 ', '<--', 'sin', 'x^y', 'DEG', 'OFF',!@#&    ' - ', ' 4 ', ' 5 ', ' 6 ', 'CLR', 'cos', 'srt', 'RAD', '   ',!@#&    ' x ', ' 7 ', ' 8 ', ' 9 ', '   ', 'tan', 'Pi ', 'inv', '   ',!@#&    ' / ', ' 0 ', '-/+', ' . ', ' = ', 'log', 'exp', 'hyp', '   '!@#&}!@#& !@#& !@#&-- generate the objects!@#&local function objGen()!@#&    local _objects = {}!@#&    local width = 9!@#&    for i=1, #labels do!@#&        table.insert(_objects, {!@#&            x = (((i - 1)%width + 1)*5) - 1;!@#&            y = (math.ceil(i/width) * 3) + 4;!@#&            label = labels[i];!@#&            -- make operators different colors!@#&            color =!@#&            i == 1 and colors.blue or!@#&            i == 5 and colors.red or!@#&            i == 6 and colors.yellow or!@#&            i == 7 and colors.orange or!@#&            i == 8 and colors.white or!@#&            i == 9 and colors.red or!@#&            i == 10 and colors.blue or!@#&            i == 14 and colors.red or!@#&            i == 15 and colors.yellow or!@#&            i == 16 and colors.orange or!@#&            i == 17 and colors.white or!@#&            i == 18 and colors.white or!@#&            i == 19 and colors.blue or!@#&            i == 24 and colors.yellow or!@#&            i == 25 and colors.orange or!@#&            i == 26 and colors.white or!@#&            i == 27 and colors.white or!@#&            i == 28 and colors.blue or!@#&            i == 30 and colors.red or!@#&            i == 32 and colors.white or!@#&            i == 33 and colors.yellow or!@#&            i == 34 and colors.orange or!@#&            i == 35 and colors.white or!@#&            i == 36 and colors.white or!@#&            colors.lightGray;!@#&            -- controls the highlight colors for operators!@#&            back =!@#&            i == 6 and!@#&                calc.sin == true and colors.red or!@#&                calc.asin == true and colors.red or!@#&                calc.sinh == true and colors.red or!@#&            i == 8 and calc.mode == \"deg\" and colors.blue or!@#&            i == 15 and!@#&                calc.cos == true and colors.red or!@#&                calc.acos == true and colors.red or!@#&                calc.cosh == true and colors.red or!@#&            i == 16 and calc.sqrt == true and colors.lightBlue or!@#&            i == 17 and calc.mode == \"rad\" and colors.blue or!@#&            i == 24 and!@#&                calc.tan == true and colors.red or!@#&                calc.atan == true and colors.red or!@#&                calc.tanh == true and colors.red or!@#&            i == 26 and calc.inverse == true and colors.blue or!@#&            i == 30 and calc.pos == true and colors.white or!@#&            i == 33 and calc.log == true and colors.red or!@#&            i == 34 and calc.exp == true and colors.lightBlue or!@#&            i == 35 and calc.hyp == true and colors.blue or!@#&            colors.black;!@#&        })!@#&    end!@#&return _objects!@#&end!@#& !@#&local function draw()!@#&    term.setBackgroundColor(colors.black)!@#&    term.clear()!@#&    local objects = objGen()!@#&    for i=1, #objects do!@#&        local obj = objects[i]!@#&        term.setTextColor(colors.gray)!@#&        term.setBackgroundColor(colors.black)!@#&        --draw the grid!@#&        for num, line in pairs{'+---+','|   |','+---+'} do!@#&            term.setCursorPos(obj.x, obj.y + num - 1)!@#&            write(line)!@#&        end!@#&        --draw the button text and colors!@#&        term.setCursorPos(obj.x+1, obj.y+1)!@#&        term.setTextColor(obj.color)!@#&        term.setBackgroundColor(obj.back)!@#&        write(obj.label)!@#&    end!@#&end!@#&--draw border and screen!@#&local function display()!@#&    term.setBackgroundColor(colors.black)!@#&    term.setTextColor(colors.gray)!@#&    term.setCursorPos(2,1)!@#&    write(\"+\"..string.rep(\"-\", tX - 4)..\"+\")!@#&    for i = 2, tY - 1 do!@#&        term.setCursorPos(2,i)!@#&        write(\"|\")!@#&        term.setCursorPos(tX - 1,i)!@#&        write(\"|\")!@#&    end!@#&    term.setCursorPos(2,tY)!@#&    write(\"+\"..string.rep(\"-\", tX - 4)..\"+\")!@#&    term.setBackgroundColor(colors.lightGray)!@#&    for i = 2, 6 do!@#&        term.setCursorPos(4,i)!@#&        write(string.rep(\" \", tX - 6))!@#&    end!@#&end!@#&--run the equation passed by the user.!@#&local function calculate(eq)!@#&    if table.concat(eq) == \"()\" then!@#&        eq = {\"0\"}!@#&    elseif table.concat(eq) == \"(.)\" then!@#&        eq = {\"0\"}!@#&    end!@#&    local sExpr = table.concat(eq)!@#&    local fnMath, sErr = loadstring(\"return \"..sExpr)!@#&    if not fnMath then!@#&        return \"ERROR! Check syntax!\"!@#&    end!@#&    --setfenv(fnMath, math)!@#&    local bSucc, vRes = pcall(fnMath)!@#&    if not bSucc then!@#&        return \"ERROR! Check syntax!\"!@#&    else!@#&        return vRes!@#&    end!@#&end!@#& !@#&-- function loop!@#&local equation = {\"(\", \")\"}!@#&local result = \"0\"!@#&while true do!@#&    local rLen = 0!@#&    draw()!@#&    display()!@#&    term.setBackgroundColor(colors.lightGray)!@#&    term.setTextColor(colors.white)!@#&    term.setCursorPos(4,2)!@#&    --write the equation!@#&    write(table.concat(equation))!@#&    --write the result!@#&    if tonumber(result) ~= inf then!@#&        if string.len(result) >= 15 then!@#&            term.setCursorPos(5, 4)!@#&            term.setTextColor(colors.black)!@#&            write(\"= \")!@#&            for num in string.gmatch(result, \".\") do!@#&                rLen = rLen + 1!@#&                local pX,pY = term.getCursorPos()!@#&                if pX >= 4 and pX <= 48 then!@#&                    term.setCursorPos(rLen + 5, 4)!@#&                    write(num)!@#&                else!@#&                    term.setCursorPos(rLen + 5 - 48, 5)!@#&                    write(num)!@#&                end!@#&            end!@#&        else!@#&            for num in string.gmatch(result, \".\") do!@#&                rLen = rLen + 1!@#&                for i = 1, #charList[num] do!@#&                    term.setTextColor(colors.black)!@#&                    term.setCursorPos((rLen * 3) + 1, i + 3)!@#&                    write(charList[num][i])!@#&                end!@#&            end!@#&        end!@#&    elseif result == nil then!@#&        term.setCursorPos(5, 4)!@#&        term.setTextColor(colors.black)!@#&        write(\"= ERROR\")!@#&    else!@#&        term.setCursorPos(5, 4)!@#&        term.setTextColor(colors.black)!@#&        write(\"= INFINITY\")!@#&    end!@#&    local events = {os.pullEvent()}!@#&    --mouse click filter!@#&    if events[1] == \"mouse_click\" and events[2] == 1 then!@#&        if events[3] >= 44 and events[3] <= 48 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                term.setBackgroundColor(colors.black)!@#&                term.clear()!@#&                term.setCursorPos(1,1)!@#&                break!@#&            end!@#&        elseif events[3] >= 39 and events[3] <= 43 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                if calc.mode == false then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = \"deg\"!@#&                    table.insert(equation, 1, \"math.deg(\")!@#&                elseif calc.mode == \"deg\" then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = false!@#&                elseif calc.mode == \"rad\" then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = \"deg\"!@#&                    table.insert(equation, 1, \"math.deg(\")!@#&                end!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                if calc.mode == false then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = \"rad\"!@#&                    table.insert(equation, 1, \"math.rad(\")!@#&                elseif calc.mode == \"rad\" then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = false!@#&                elseif calc.mode == \"deg\" then!@#&                    table.remove(equation, 1)!@#&                    calc.mode = \"rad\"!@#&                    table.insert(equation, 1, \"math.rad(\")!@#&                end!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                if calc.inverse == true and calc.hyp == false then!@#&                    calc.inverse = false!@#&                elseif calc.inverse == false and calc.hyp == true then!@#&                    calc.inverse = true!@#&                    calc.hyp = false!@#&                elseif calc.inverse == false and calc.hyp == false then!@#&                    calc.inverse = true!@#&                end!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                if calc.hyp == true and calc.inverse == false then!@#&                    calc.hyp = false!@#&                elseif calc.hyp == false and calc.inverse == true then!@#&                    calc.hyp = true!@#&                    calc.inverse = false!@#&                elseif calc.hyp == false and calc.inverse == false then!@#&                    calc.hyp = true!@#&                end!@#&            end!@#&        elseif events[3] >= 34 and events[3] <= 38 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                table.insert(equation, #equation, \"^\")!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                if calc.sqrt == false then!@#&                    table.insert(equation, #equation, \"math.sqrt(\")!@#&                    calc.sqrt = true!@#&                elseif calc.sqrt == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.sqrt = false!@#&                end!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                table.insert(equation, #equation, \"math.pi\")!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                if calc.exp == false then!@#&                    table.insert(equation, #equation, \"math.exp(\")!@#&                    calc.exp = true!@#&                elseif calc.exp == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.exp = false!@#&                end!@#&            end!@#&        elseif events[3] >= 29 and events[3] <= 33 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                if calc.inverse == true and calc.asin == false then!@#&                    table.insert(equation, #equation, \"math.asin(\")!@#&                    calc.asin = true!@#&                elseif calc.inverse == false and calc.hyp == false and calc.sin == false then!@#&                    table.insert(equation, #equation, \"math.sin(\")!@#&                    calc.sin = true!@#&                elseif calc.hyp == true and calc.sinh == false then!@#&                    table.insert(equation, #equation, \"math.sinh(\")!@#&                    calc.sinh = true!@#&                elseif calc.asin == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.asin = false!@#&                elseif calc.sin == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.sin = false!@#&                elseif calc.sinh == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.sinh = false!@#&                end!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                if calc.inverse == true and calc.acos == false then!@#&                    table.insert(equation, #equation, \"math.acos(\")!@#&                    calc.acos = true!@#&                elseif calc.inverse == false and calc.hyp == false and calc.cos == false then!@#&                    table.insert(equation, #equation, \"math.cos(\")!@#&                    calc.cos = true!@#&                elseif calc.hyp == true and calc.cosh == false then!@#&                    table.insert(equation, #equation, \"math.cosh(\")!@#&                    calc.cosh = true!@#&                elseif calc.acos == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.acos = false!@#&                elseif calc.cos == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.cos = false!@#&                elseif calc.cosh == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.cosh = false!@#&                end!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                if calc.inverse == true and calc.atan == false then!@#&                    table.insert(equation, #equation, \"math.atan(\")!@#&                    calc.atan = true!@#&                elseif calc.inverse == false and calc.hyp == false and calc.tan == false then!@#&                    table.insert(equation, #equation, \"math.tan(\")!@#&                    calc.tan = true!@#&                elseif calc.hyp == true and calc.tanh == false then!@#&                    table.insert(equation, #equation, \"math.tanh(\")!@#&                    calc.tanh = true!@#&                elseif calc.atan == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.atan = false!@#&                elseif calc.tan == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.tan = false!@#&                elseif calc.tanh == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.tanh = false!@#&                end!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                if calc.log == false then!@#&                    table.insert(equation, #equation, \"math.log10(\")!@#&                    calc.log = true!@#&                elseif calc.log == true then!@#&                    table.insert(equation, \")\")!@#&                    calc.log = false!@#&                end!@#&            end!@#&        -- backspace, clear, equals!@#&        elseif events[3] >= 24 and events[3] <= 28 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                if table.concat(equation) ~= \"()\" then!@#&                    table.remove(equation, #equation - 1)!@#&                end!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                calc.mode = false!@#&                calc.inverse = false!@#&                calc.hyp = false!@#&                calc.sqrt = false !@#&                calc.exp = false!@#&                calc.asin = false!@#&                calc.sin = false!@#&                calc.sinh = false!@#&                calc.atan = false!@#&                calc.tan = false!@#&                calc.tanh = false!@#&                calc.acos = false!@#&                calc.cos = false!@#&                calc.cosh = false!@#&                calc.log = false!@#&                calc.pos = false!@#&                equation = {\"(\", \")\"}!@#&                result = \"0\"!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                if equation[#equation-1] == \"+\" or!@#&                    equation[#equation-1] == \"-\" or!@#&                    equation[#equation-1] == \"*\" or!@#&                    equation[#equation-1] == \"/\" then!@#&                    table.insert(equation, #equation, \"0\")!@#&                elseif equation[#equation-1] == \"^\" then!@#&                    table.insert(equation, #equation, \"1\")!@#&                end!@#&                for i, v in pairs(calc) do!@#&                    if calc[i] == true then!@#&                        table.insert(equation, #equation, \")\")!@#&                        calc[i] = false!@#&                    end!@#&                end!@#&                result = tostring(calculate(equation))!@#&            end!@#&        -- 3, 6, 9, decimal!@#&        elseif events[3] >= 19 and events[3] <= 23 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                table.insert(equation, #equation, \"3\")!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                table.insert(equation, #equation, \"6\")!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                table.insert(equation, #equation, \"9\")!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                table.insert(equation, #equation, \".\")!@#&            end!@#&        -- 2, 5, 8, positive/negative!@#&        elseif events[3] >= 14 and events[3] <= 18 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                table.insert(equation, #equation, \"2\")!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                table.insert(equation, #equation, \"5\")!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                table.insert(equation, #equation, \"8\")!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                if calc.pos == false then!@#&                    table.insert(equation, #equation, \"(-\")!@#&                    calc.pos = true!@#&                elseif calc.pos == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc.pos = false!@#&                end!@#&            end!@#&        -- 1, 4, 7, 0!@#&        elseif events[3] >= 9 and events[3] <= 13 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                table.insert(equation, #equation, \"1\")!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                table.insert(equation, #equation, \"4\")!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                table.insert(equation, #equation, \"7\")!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                table.insert(equation, #equation, \"0\")!@#&            end!@#&        -- add, subtract, multiply, divide!@#&        elseif events[3] >= 4 and events[3] <= 8 then!@#&            if events[4] >= 7 and events[4] <= 9 then!@#&                table.insert(equation, #equation, \"+\")!@#&            elseif events[4] >= 10 and events[4] <= 12 then!@#&                table.insert(equation, #equation, \"-\")!@#&            elseif events[4] >= 13 and events[4] <= 15 then!@#&                table.insert(equation, #equation, \"*\")!@#&            elseif events[4] >= 16 and events[4] <= 18 then!@#&                table.insert(equation, #equation, \"/\")!@#&            end!@#&        end!@#&    -- filter for keyboard presses!@#&    elseif events[1] == \"key\" then!@#&        if events[2] == 79 then!@#&            table.insert(equation, #equation, \"1\")!@#&        elseif events[2] == 80 then!@#&            table.insert(equation, #equation, \"2\")!@#&        elseif events[2] == 81 then!@#&            table.insert(equation, #equation, \"3\")!@#&        elseif events[2] == 75 then!@#&            table.insert(equation, #equation, \"4\")!@#&        elseif events[2] == 76 then!@#&            table.insert(equation, #equation, \"5\")!@#&        elseif events[2] == 77 then!@#&            table.insert(equation, #equation, \"6\")!@#&        elseif events[2] == 71 then!@#&            table.insert(equation, #equation, \"7\")!@#&        elseif events[2] == 72 then!@#&            table.insert(equation, #equation, \"8\")!@#&        elseif events[2] == 73 then!@#&            table.insert(equation, #equation, \"9\")!@#&        elseif events[2] == 82 then!@#&            table.insert(equation, #equation, \"0\")!@#&        elseif events[2] == 83 then!@#&            table.insert(equation, #equation, \".\")!@#&        elseif events[2] == 78 then!@#&            table.insert(equation, #equation, \"+\")!@#&        elseif events[2] == 74 then!@#&            table.insert(equation, #equation, \"-\")!@#&        elseif events[2] == 55 then!@#&            table.insert(equation, #equation, \"*\")!@#&        elseif events[2] == 181 then!@#&            table.insert(equation, #equation, \"/\")!@#&        elseif events[2] == 14 then!@#&            if table.concat(equation) ~= \"()\" then!@#&                table.remove(equation, #equation - 1)!@#&            end!@#&        elseif events[2] == 28 or events[2] == 156 then!@#&            if equation[#equation-1] == \"+\" or!@#&                equation[#equation-1] == \"-\" or!@#&                equation[#equation-1] == \"*\" or!@#&                equation[#equation-1] == \"/\" then!@#&                table.insert(equation, #equation, \"0\")!@#&            elseif equation[#equation-1] == \"^\" then!@#&                table.insert(equation, #equation, \"1\")!@#&            end!@#&            for i, v in pairs(calc) do!@#&                if calc[i] == true then!@#&                    table.insert(equation, #equation, \")\")!@#&                    calc[i] = false!@#&                end!@#&            end!@#&            result = tostring(calculate(equation))!@#&        end!@#&    end!@#&end!@#&!@#&term.setTextColor(colors.white)",["Utils"]={["ping"]="-- pastebin get R4DKXbzm ping!@#&-- std pb R4DKXbzm ping!@#&!@#&function displayHelp()!@#&	print(\"ping <url> <times>\")!@#&end!@#&!@#&function averageTable(tab)!@#&	temp = 0!@#&	for a = 1, #tab do!@#&		temp = temp + tab[a]!@#&	end!@#&	temp = temp / #tab!@#&	return temp!@#&end!@#&!@#&tArg = {...}!@#&url = tArg[1]!@#&times = tonumber(tArg[2])!@#&if not url then!@#&	displayHelp()!@#&	return false!@#&end!@#&if not times then times = 4 end!@#&!@#&if times <= 0 then!@#&	error(\"must be greater than 0.\")!@#&elseif times >= 200 then!@#&	error(\"Seriously?\")!@#&end!@#&!@#&if not string.find(url, \"://\") then!@#&	url = \"http://\"..url!@#&end!@#&!@#&print(\"Pinging \"..url..\"...\")!@#&completeRatio = {}!@#&pingList = {}!@#&for a = 1, times do!@#&	sleep(0)!@#&	oldtime = os.time()!@#&	b = http.get(url)!@#&	newtime = os.time()!@#&	diff = math.ceil((newtime - oldtime)*1000)!@#&	table.insert(pingList, diff)!@#&	write(\" delay: \"..diff..\" ticks...(\"..a..\")\")!@#&	if b then!@#&		table.insert(completeRatio,1)!@#&		print(\"\")!@#&	else!@#&		table.insert(completeRatio,0)!@#&		print(\"fail\")!@#&	end!@#&end!@#&print(\"done with \"..(averageTable(completeRatio)*100)..\"% success\")!@#&print(\"average ping is \"..(averageTable(pingList))..\" ticks\")",["sp"]="local tArg = {...} if realID == nil then realID = os.getComputerID() end if tArg[1] == \"reset\" then os.getComputerID = function() return realID end end if not tonumber(tArg[1]) then return false else newID = tonumber(tArg[1]) end os.getComputerID = function() return newID end",["fileinfo"]="os.loadAPI(\"/SpeedAPI/lddfm\")!@#&!@#&local tArgs = {...}!@#&if #tArgs ~= 1 then!@#&	tArgs[1] = tostring(lddfm.makeMenu())!@#&	term.clear()!@#&end!@#&print(\"-----Infomation------\")!@#&if fs.exists(tArgs[1]) then!@#&	if not fs.isDir(tArgs[1]) then!@#&		print(\"Name : \"..fs.getName(tArgs[1]))!@#&		local sizBytes = fs.getSize(tArgs[1])!@#&		local one,two = math.modf(sizBytes/1024)!@#&		print(\"Size : \"..tostring(one)..\".\"..string.sub(tostring(two),3,4)..\" KB (\"..sizBytes..\" bytes )\")!@#&		local where = fs.getDrive(tArgs[1])!@#&		if where == \"hdd\" or where == \"rom\" then!@#&			print(\"Location : \"..where)!@#&		else!@#&			print(\"Location : \"..where..\" disk drive\")!@#&		end!@#&		if fs.isReadOnly(tArgs[1]) then!@#&			print(\"File is read only\")!@#&		else!@#&			print([[Read / write enabled]])!@#&		end!@#&	else!@#&		print(\"This is a directory\")!@#&	end!@#&else!@#&	print(\"Not file or Folder\")!@#&end!@#&print(\"---------------------\")",["pkg"]="sPackage = \"local pkg = %@1 local function makeFile(_path, _content) local file = fs.open(_path, \\\"w\\\") _content = _content:gsub(\\\"\\!@\\\"..\\\"#&\\\", \\\"%\\\\n\\\") _content = textutils.unserialize(_content) file.write(_content) file.close() end local function makeFolder(_path, _content) fs.makeDir(_path) for k,v in pairs(_content) do if type(v) == \\\"table\\\" then makeFolder(_path .. \\\"/\\\" .. k, v) else makeFile(_path .. \\\"/\\\" .. k, v) end end end local sDest = shell.resolve( \\\"%@2\\\" ) or \\\"/\\\" if sDest == \\\"root\\\" then sDest = \\\"/\\\" end local tPackage = pkg makeFolder(sDest, tPackage) print(\\\"Package Extracted to '\\\" .. sDest .. \\\"'!\\\")\"!@#&!@#&function addFile(_package, _path)!@#&	if fs.getName(_path) == \".DS_Store\" then!@#&		return _package!@#&	end!@#&	local file, err = fs.open(_path, \"r\")!@#&	local content = file.readAll()!@#&	content = content:gsub(\"%\\n\", \"\\!@\"..\"#&\")!@#&	content = content:gsub(\"%%\", \"%%%%\")!@#&	_package[fs.getName(_path)] = content!@#&	file.close()!@#&	print(\"Added file '\".._path..\"'\")!@#&	return _package!@#&end!@#&!@#&function addFolder(_package, _path)!@#&	if string.sub(_path,1,string.len(\"rom\"))==\"rom\" or string.sub(_path,1,string.len(\"/rom\"))==\"/rom\" then!@#&		print(\"Ignored 'rom' folder. (\".._path..\")\")!@#&		return!@#&	end!@#&	_package = _package or {}!@#&	for _,f in ipairs(fs.list(_path)) do!@#&		local path = _path..\"/\"..f!@#&		if fs.isDir(path) then!@#&			_package[fs.getName(f)] = addFolder(_package[fs.getName(f)], path)!@#&		else!@#&			_package =  addFile(_package, path)!@#&		end!@#&	end!@#&	return _package!@#&end!@#&!@#&local tArgs = { ... }!@#&if #tArgs < 2 then!@#&	print( \"Usage: pkg <source> <destination>\" )!@#&	return!@#&end!@#&!@#&local sSource = shell.resolve( tArgs[1] )!@#&local sDest = shell.resolve( tArgs[2] )!@#&!@#&if fs.isDir( sDest ) then!@#&	error(\"Destination must not be a folder.\")!@#&end!@#&!@#&if sSource == sDest then!@#&	error(\"Source can not be equal to destination.\")!@#&end!@#&!@#&if fs.exists( sSource ) and fs.isDir( sSource ) then!@#&	tPackage = {}!@#&	tPackage = addFolder(tPackage, sSource)!@#&	fPackage = fs.open(sDest,\"w\")!@#&!@#&	sPackage = string.gsub(sPackage, \"%%@2\", fs.getName(sSource))!@#&	sPackage = string.gsub(sPackage, \"%%@1\", textutils.serialize(tPackage))!@#&	fPackage.write(sPackage)!@#&	fPackage.close()!@#&	print(\"Package Done! ('\" .. sDest .. \"')\")!@#&	print(\"Type '\" .. sDest .. \"' to run it.\")!@#&else!@#&	error(\"Source does not exist or is not a folder.\")!@#&end",["VNC"]="local args = { ... }!@#&!@#&local connections = {}!@#&!@#&local nshAPI = {!@#&	connList = connections!@#&}!@#&!@#&local bufferDirs = {\"/\",\"/LyqydOS/\",\"/usr/apis/\",\"/disk/\"}!@#&!@#&if not framebuffer then!@#&	for i = 1, #bufferDirs do!@#&		if fs.exists(bufferDirs[i]..\"framebuffer\") and os.loadAPI(bufferDirs[i]..\"framebuffer\") then!@#&			break!@#&		end!@#&	end!@#&end!@#&if not framebuffer then!@#&	print(\"Couldn't find framebuffer API, using fallback\")!@#&end!@#&!@#&local function rawSend(id, msg)!@#&	if term.current then!@#&		return rednet.send(id, msg, \"tror\")!@#&	else!@#&		return rednet.send(id, msg)!@#&	end!@#&end!@#&!@#&local function rawRecv(id, timeout)!@#&	if type(timeout) == \"number\" then timeout = os.startTimer(timeout) end!@#&	while true do!@#&		event = {os.pullEvent()}!@#&		if event[1] == \"rednet_message\" and (id == nil and true or event[2] == id) and (not term.current and true or event[4] == \"tror\") then!@#&			return event[3]!@#&		elseif event[1] == \"timer\" and event[2] == timeout then!@#&			return nil!@#&		end!@#&	end!@#&end!@#&!@#&!@#&nshAPI.getRemoteID = function()!@#&	--check for connected clients with matching threads.!@#&	for cNum, cInfo in pairs(nshAPI.connList) do!@#&		if cInfo and type(cInfo) == \"table\" and cInfo.thread == coroutine.running() then!@#&			if cNum == \"localShell\" then!@#&				--if we are a client running on the server, return the remote server ID.!@#&				if nshAPI.serverNum then!@#&					return nshAPI.serverNum!@#&				else!@#&					return nil!@#&				end!@#&			end!@#&			return cNum!@#&		end!@#&	end!@#&	--client running without local server, return remote server ID.!@#&	if nshAPI.serverNum then return nshAPI.serverNum end!@#&	return nil!@#&end!@#&!@#&nshAPI.send = function(msg)!@#&	local id = nshAPI.getRemoteID()!@#&	if id then!@#&		return rawSend(id, msg)!@#&	end!@#&	return nil!@#&end!@#&!@#&nshAPI.receive = function(timeout)!@#&	return rawRecv(nshAPI.getRemoteID(), timeout)!@#&end!@#&!@#&nshAPI.getClientCapabilities = function()!@#&	if nshAPI.clientCapabilities then return nshAPI.clientCapabilities end!@#&	nshAPI.send(\"SP:;clientCapabilities\")!@#&	return nshAPI.receive(1)!@#&end!@#&!@#&nshAPI.getRemoteConnections = function()!@#&	local remotes = {}!@#&	for cNum, cInfo in pairs(nshAPI.connList) do!@#&		table.insert(remotes, cNum)!@#&		if cInfo.outbound then!@#&			table.insert(remotes, cInfo.outbound)!@#&		end!@#&	end!@#&	return remotes!@#&end!@#&!@#&nshAPI.packFile = function(path)!@#&	local data = {}!@#&	local count = 0!@#&	local handle = io.open(path, \"rb\")!@#&	if handle then!@#&		local byte = handle:read()!@#&		repeat!@#&			data[#data + 1] = byte!@#&			count = count + 1!@#&			if count % 1000 == 0 then!@#&				os.queueEvent(\"yield\")!@#&				os.pullEvent(\"yield\")!@#&			end!@#&			byte = handle:read()!@#&		until not byte!@#&		handle:close()!@#&	else!@#&		return false!@#&	end!@#&	local outputTable = {}!@#&	for i = 1, #data, 3 do!@#&		local num1, num2, num3 = data[i], data[i + 1] or 0, data[i + 2] or 0!@#&		table.insert(outputTable, string.char(bit.band(bit.brshift(num1, 2), 63)))!@#&		table.insert(outputTable, string.char(bit.bor(bit.band(bit.blshift(num1, 4), 48), bit.band(bit.brshift(num2, 4), 15))))!@#&		table.insert(outputTable, string.char(bit.bor(bit.band(bit.blshift(num2, 2), 60), bit.band(bit.brshift(num3, 6), 3))))!@#&		table.insert(outputTable, string.char(bit.band(num3, 63)))!@#&	end!@#&	--mark non-data (invalid) bytes!@#&	if #data % 3 == 1 then!@#&		outputTable[#outputTable] = \"=\"!@#&		outputTable[#outputTable - 1] = \"=\"!@#&	elseif #data % 3 == 2 then!@#&		outputTable[#outputTable] = \"=\"!@#&	end!@#&	return table.concat(outputTable, \"\")!@#&end!@#&!@#&nshAPI.unpackAndSaveFile = function(path, data)!@#&	local outputTable = {}!@#&	for i=1, #data, 4 do!@#&		local char1, char2, char3, char4 = string.byte(string.sub(data, i, i)), string.byte(string.sub(data, i + 1, i + 1)), string.byte(string.sub(data, i + 2, i + 2)), string.byte(string.sub(data, i + 3, i + 3))!@#&		table.insert(outputTable, bit.band(bit.bor(bit.blshift(char1, 2), bit.brshift(char2, 4)), 255))!@#&		table.insert(outputTable, bit.band(bit.bor(bit.blshift(char2, 4), bit.brshift(char3, 2)), 255))!@#&		table.insert(outputTable, bit.band(bit.bor(bit.blshift(char3, 6), char4), 255))!@#&	end!@#&	--clean invalid bytes if marked!@#&	if string.sub(data, #data, #data) == \"=\" then!@#&		table.remove(outputTable)!@#&		if string.sub(data, #data - 1, #data - 1) == \"=\" then!@#&			table.remove(outputTable)!@#&		end!@#&	end!@#&	local handle = io.open(path, \"wb\")!@#&	if handle then!@#&		for i = 1, #outputTable do!@#&			handle:write(outputTable[i])!@#&			if i % 10 == 0 then!@#&				os.startTimer(0.1)!@#&				os.pullEvent(\"timer\")!@#&			end!@#&		end!@#&		handle:close()!@#&	end!@#&end!@#&!@#&local packetConversion = {!@#&	query = \"SQ\",!@#&	response = \"SR\",!@#&	data = \"SP\",!@#&	close = \"SC\",!@#&	fileQuery = \"FQ\",!@#&	fileSend = \"FS\",!@#&	fileResponse = \"FR\",!@#&	fileHeader = \"FH\",!@#&	fileData = \"FD\",!@#&	fileEnd = \"FE\",!@#&	textWrite = \"TW\",!@#&	textCursorPos = \"TC\",!@#&	textGetCursorPos = \"TG\",!@#&	textGetSize = \"TD\",!@#&	textInfo = \"TI\",!@#&	textClear = \"TE\",!@#&	textClearLine = \"TL\",!@#&	textScroll = \"TS\",!@#&	textBlink = \"TB\",!@#&	textColor = \"TF\",!@#&	textBackground = \"TK\",!@#&	textIsColor = \"TA\",!@#&	textTable = \"TT\",!@#&	event = \"EV\",!@#&	SQ = \"query\",!@#&	SR = \"response\",!@#&	SP = \"data\",!@#&	SC = \"close\",!@#&	FQ = \"fileQuery\",!@#&	FS = \"fileSend\",!@#&	FR = \"fileResponse\",!@#&	FH = \"fileHeader\",!@#&	FD = \"fileData\",!@#&	FE = \"fileEnd\",!@#&	TW = \"textWrite\",!@#&	TC = \"textCursorPos\",!@#&	TG = \"textGetCursorPos\",!@#&	TD = \"textGetSize\",!@#&	TI = \"textInfo\",!@#&	TE = \"textClear\",!@#&	TL = \"textClearLine\",!@#&	TS = \"textScroll\",!@#&	TB = \"textBlink\",!@#&	TF = \"textColor\",!@#&	TK = \"textBackground\",!@#&	TA = \"textIsColor\",!@#&	TT = \"textTable\",!@#&	EV = \"event\",!@#&}!@#&!@#&local function openModem()!@#&	local modemFound = false!@#&	for _, side in ipairs(rs.getSides()) do!@#&		if peripheral.getType(side) == \"modem\" then!@#&			if not rednet.isOpen(side) then rednet.open(side) end!@#&			modemFound = true!@#&			break!@#&		end!@#&	end!@#&	return modemFound!@#&end!@#&!@#&local function send(id, pType, message)!@#&	if pType and message then!@#&		return rawSend(id, packetConversion[pType]..\":;\"..message)!@#&	end!@#&end!@#&!@#&local function awaitResponse(id, time)!@#&	id = tonumber(id)!@#&	local listenTimeOut = nil!@#&	local messRecv = false!@#&	if time then listenTimeOut = os.startTimer(time) end!@#&	while not messRecv do!@#&		local event, p1, p2 = os.pullEvent()!@#&		if event == \"timer\" and p1 == listenTimeOut then!@#&			return false!@#&		elseif event == \"rednet_message\" then!@#&			sender, message = p1, p2!@#&			if id == sender and message then!@#&				if packetConversion[string.sub(message, 1, 2)] then packetType = packetConversion[string.sub(message, 1, 2)] end!@#&				message = string.match(message, \";(.*)\")!@#&				messRecv = true!@#&			end!@#&		end!@#&	end!@#&	return packetType, message!@#&end!@#&!@#&local function processText(conn, pType, value)!@#&	if not pType then return false end!@#&	if pType == \"textWrite\" and value then!@#&		term.write(value)!@#&	elseif pType == \"textClear\" then!@#&		term.clear()!@#&	elseif pType == \"textClearLine\" then!@#&		term.clearLine()!@#&	elseif pType == \"textGetCursorPos\" then!@#&		local x, y = term.getCursorPos()!@#&		send(conn, \"textInfo\", math.floor(x)..\",\"..math.floor(y))!@#&	elseif pType == \"textCursorPos\" then!@#&		local x, y = string.match(value, \"(%-?%d+),(%-?%d+)\")!@#&		term.setCursorPos(tonumber(x), tonumber(y))!@#&	elseif pType == \"textBlink\" then!@#&		if value == \"true\" then!@#&			term.setCursorBlink(true)!@#&		else!@#&			term.setCursorBlink(false)!@#&		end!@#&	elseif pType == \"textGetSize\" then!@#&		x, y = term.getSize()!@#&		send(conn, \"textInfo\", x..\",\"..y)!@#&	elseif pType == \"textScroll\" and value then!@#&		term.scroll(tonumber(value))!@#&	elseif pType == \"textIsColor\" then!@#&		send(conn, \"textInfo\", tostring(term.isColor()))!@#&	elseif pType == \"textColor\" and value then!@#&		value = tonumber(value)!@#&		if (value == 1 or value == 32768) or term.isColor() then!@#&			term.setTextColor(value)!@#&		end!@#&	elseif pType == \"textBackground\" and value then!@#&		value = tonumber(value)!@#&		if (value == 1 or value == 32768) or term.isColor() then!@#&			term.setBackgroundColor(value)!@#&		end!@#&	elseif pType == \"textTable\" then!@#&		local linesTable = textutils.unserialize(value)!@#&		for i=1, linesTable.sizeY do!@#&			term.setCursorPos(1,i)!@#&			local lineEnd = false!@#&			local offset = 1!@#&			while not lineEnd do!@#&				local textColorString = string.match(string.sub(linesTable.textColor[i], offset), string.sub(linesTable.textColor[i], offset, offset)..\"*\")!@#&				local backColorString = string.match(string.sub(linesTable.backColor[i], offset), string.sub(linesTable.backColor[i], offset, offset)..\"*\")!@#&				term.setTextColor(2 ^ tonumber(string.sub(textColorString, 1, 1), 16))!@#&				term.setBackgroundColor(2 ^ tonumber(string.sub(backColorString, 1, 1), 16))!@#&				term.write(string.sub(linesTable.text[i], offset, offset + math.min(#textColorString, #backColorString) - 1))!@#&				offset = offset + math.min(#textColorString, #backColorString)!@#&				if offset > linesTable.sizeX then lineEnd = true end!@#&			end!@#&		end!@#&		term.setCursorPos(linesTable.cursorX, linesTable.cursorY)!@#&		term.setCursorBlink(linesTable.cursorBlink)!@#&	end!@#&	return!@#&end!@#&!@#&local function textRedirect(id)!@#&	local textTable = {}!@#&	textTable.id = id!@#&	textTable.write = function(text)!@#&		return send(textTable.id, \"textWrite\", text)!@#&	end!@#&	textTable.clear = function()!@#&		return send(textTable.id, \"textClear\", \"nil\")!@#&	end!@#&	textTable.clearLine = function()!@#&		return send(textTable.id, \"textClearLine\", \"nil\")!@#&	end!@#&	textTable.getCursorPos = function()!@#&		send(textTable.id, \"textGetCursorPos\", \"nil\")!@#&		local pType, message = awaitResponse(textTable.id, 2)!@#&		if pType and pType == \"textInfo\" then!@#&			local x, y = string.match(message, \"(%-?%d+),(%-?%d+)\")!@#&			return tonumber(x), tonumber(y)!@#&		end!@#&	end!@#&	textTable.setCursorPos = function(x, y)!@#&		return send(textTable.id, \"textCursorPos\", math.floor(x)..\",\"..math.floor(y))!@#&	end!@#&	textTable.setCursorBlink = function(b)!@#&		if b then!@#&			return send(textTable.id, \"textBlink\", \"true\")!@#&		else!@#&			return send(textTable.id, \"textBlink\", \"false\")!@#&		end!@#&	end!@#&	textTable.getSize = function()!@#&		send(textTable.id, \"textGetSize\", \"nil\")!@#&		local pType, message = awaitResponse(textTable.id, 2)!@#&		if pType and pType == \"textInfo\" then!@#&			local x, y = string.match(message, \"(%d+),(%d+)\")!@#&			return tonumber(x), tonumber(y)!@#&		end!@#&	end!@#&	textTable.scroll = function(lines)!@#&		return send(textTable.id, \"textScroll\", lines)!@#&	end!@#&	textTable.isColor = function()!@#&		send(textTable.id, \"textIsColor\", \"nil\")!@#&		local pType, message = awaitResponse(textTable.id, 2)!@#&		if pType and pType == \"textInfo\" then!@#&			if message == \"true\" then!@#&				return true!@#&			end!@#&		end!@#&		return false!@#&	end!@#&	textTable.isColour = textTable.isColor!@#&	textTable.setTextColor = function(color)!@#&		return send(textTable.id, \"textColor\", tostring(color))!@#&	end!@#&	textTable.setTextColour = textTable.setTextColor!@#&	textTable.setBackgroundColor = function(color)!@#&		return send(textTable.id, \"textBackground\", tostring(color))!@#&	end!@#&	textTable.setBackgroundColour = textTable.setBackgroundColor!@#&	return textTable!@#&end!@#&!@#&local function getServerID(server)!@#&	if tonumber(server) then!@#&		return tonumber(server)!@#&	elseif term.current then!@#&		return rednet.lookup(\"tror\", args[1])!@#&	end!@#&end!@#&!@#&local function resumeThread(conn, event)!@#&	local cInfo = connections[conn]!@#&	if connections[conn] and (not connections[conn].filter or event[1] == connections[conn].filter) then!@#&		connections[conn].filter = nil!@#&		local _oldTerm = term.redirect(connections[conn].target)!@#&		local passback = {coroutine.resume(connections[conn].thread, unpack(event))}!@#&		if passback[1] and passback[2] then!@#&			connections[conn].filter = passback[2]!@#&		end!@#&		if coroutine.status(connections[conn].thread) == \"dead\" then!@#&			send(conn, \"close\", \"disconnect\")!@#&			connections[conn] = false!@#&		end!@#&		if _oldTerm then!@#&			term.redirect(_oldTerm)!@#&		else!@#&			term.restore()!@#&		end!@#&		if connections[conn] and conn ~= \"localShell\" and framebuffer and connections[conn].target.changed then!@#&			send(conn, \"textTable\", textutils.serialize(connections[conn].target.buffer))!@#&			connections[conn].target.changed = false!@#&		end!@#&	end!@#&end!@#&!@#&local eventFilter = {!@#&	key = true,!@#&	char = true,!@#&	mouse_click = true,!@#&	mouse_drag = true,!@#&	mouse_scroll = true,!@#&}!@#&!@#&local function newSession(conn, x, y, color)!@#&	local session = {}!@#&	local path = \"/rom/programs/shell\"!@#&	if #args >= 2 and shell.resolveProgram(args[2]) then path = shell.resolveProgram(args[2]) end!@#&	session.thread = coroutine.create(function() shell.run(path) end)!@#&	if framebuffer then!@#&		local target = {}!@#&		local _target = framebuffer.new(x, y, color)!@#&		for k, v in pairs(_target) do!@#&			if type(k) == \"string\" and type(v) == \"function\" then!@#&				target[k] = function(...)!@#&					target.changed = true!@#&					return _target[k](...)!@#&				end!@#&			else!@#&				target[k] = _target[k]!@#&			end!@#&		end!@#&		session.target = target!@#&	else!@#&		session.target = textRedirect(conn)!@#&	end!@#&	session.status = \"open\"!@#&	_oldTerm = term.redirect(session.target)!@#&	coroutine.resume(session.thread)!@#&	if _oldTerm then!@#&		term.redirect(_oldTerm)!@#&	else!@#&		term.restore()!@#&	end!@#&	if framebuffer then!@#&		send(conn, \"textTable\", textutils.serialize(session.target.buffer))!@#&		session.target.changed = false!@#&	end!@#&	return session!@#&end!@#&!@#&if #args >= 1 and args[1] == \"host\" then!@#&	_G.nsh = nshAPI!@#&	if not openModem() then return end!@#&	if term.current then!@#&		if args[4] then!@#&			rednet.host(\"tror\", args[4])!@#&		elseif os.getComputerLabel() then!@#&			rednet.host(\"tror\", os.getComputerLabel())!@#&		else!@#&			print(\"No label or hostname provided!\")!@#&			return!@#&		end!@#&	end!@#&	local connInfo = {}!@#&	connInfo.target = term.current and term.current() or term.native!@#&	local path = \"/rom/programs/shell\"!@#&	if #args >= 3 and shell.resolveProgram(args[3]) then path = shell.resolveProgram(args[3]) end!@#&	connInfo.thread = coroutine.create(function() shell.run(path) end)!@#&	connections.localShell = connInfo!@#&	term.clear()!@#&	term.setCursorPos(1,1)!@#&	coroutine.resume(connections.localShell.thread)!@#&!@#&	while true do!@#&		event = {os.pullEventRaw()}!@#&		if event[1] == \"rednet_message\" then!@#&			if type(event[3]) == \"string\" and packetConversion[string.sub(event[3], 1, 2)] then!@#&				--this is a packet meant for us.!@#&				conn = event[2]!@#&				packetType = packetConversion[string.sub(event[3], 1, 2)]!@#&				message = string.match(event[3], \";(.*)\")!@#&				if connections[conn] and connections[conn].status == \"open\" then!@#&					if packetType == \"event\" or string.sub(packetType, 1, 4) == \"text\" then!@#&						local eventTable = {}!@#&						if packetType == \"event\" then!@#&							eventTable = textutils.unserialize(message)!@#&						else!@#&							--we can pass the packet in raw, since this is not an event packet.!@#&							eventTable = event!@#&						end!@#&						resumeThread(conn, eventTable)!@#&					elseif packetType == \"query\" then!@#&						local connType, color, x, y = string.match(message, \"(%a+):(%a+);(%d+),(%d+)\")!@#&						if connType == \"connect\" or (connType == \"resume\" and (not framebuffer)) then!@#&							--reset connection!@#&							send(conn, \"response\", \"OK\")!@#&							connections[conn] = newSession(conn, tonumber(x), tonumber(y), color == \"true\")!@#&						elseif connType == \"resume\" and connections[conn] and tonumber(x) == connections[conn].target.buffer.sizeX and tonumber(y) == connections[conn].target.buffer.sizeY then!@#&							--restore connection!@#&							send(conn, \"response\", \"OK\")!@#&							send(conn, \"textTable\", textutils.serialize(connections[conn].target.buffer))!@#&						end!@#&					elseif packetType == \"close\" then!@#&						connections[conn] = nil!@#&						send(conn, \"close\", \"disconnect\")!@#&						--close connection!@#&					else!@#&						--we got a packet, have an open connection, but despite it being in the conversion table, don't handle it ourselves. Send it onward.!@#&						resumeThread(conn, event)!@#&					end!@#&				elseif packetType ~= \"query\" then!@#&					--usually, we would send a disconnect here, but this prevents one from hosting nsh and connecting to other computers.  Pass these to all shells as well.!@#&					for cNum, cInfo in pairs(connections) do!@#&						resumeThread(cNum, event)!@#&					end!@#&				else!@#&					--open new connection!@#&					send(conn, \"response\", \"OK\")!@#&					local color, x, y = string.match(message, \"connect:(%a+);(%d+),(%d+)\")!@#&					local connInfo = newSession(conn, tonumber(x), tonumber(y), color == \"true\")!@#&					connections[conn] = connInfo!@#&				end!@#&			else!@#&				--rednet message, but not in the correct format, so pass to all shells.!@#&				for cNum, cInfo in pairs(connections) do!@#&					resumeThread(cNum, event)!@#&				end!@#&			end!@#&		elseif eventFilter[event[1]] then!@#&			--user interaction.!@#&			coroutine.resume(connections.localShell.thread, unpack(event))!@#&			if coroutine.status(connections.localShell.thread) == \"dead\" then!@#&				for cNum, cInfo in pairs(connections) do!@#&					if cNum ~= \"localShell\" then!@#&						send(cNum, \"close\", \"disconnect\")!@#&					end!@#&				end!@#&				return!@#&			end!@#&		else!@#&			--dispatch all other events to all shells!@#&			for cNum, cInfo in pairs(connections) do!@#&				resumeThread(cNum, event)!@#&			end!@#&		end!@#&	end!@#&!@#&elseif #args <= 2 and nsh and nsh.getRemoteID() then!@#&	print(nsh.getRemoteID())!@#&	--forwarding mode!@#&	local conns = nsh.getRemoteConnections()!@#&	for i = 1, #conns do!@#&		if conns[i] == serverNum then!@#&			print(\"Cyclic connection refused.\")!@#&			return!@#&		end!@#&	end!@#&	local fileTransferState = nil!@#&	local fileData = nil!@#&	local serverNum = getServerID(args[1])!@#&	if not serverNum then!@#&		print(\"Server Not Found\")!@#&		return!@#&	end!@#&	send(serverNum, \"query\", \"connect\")!@#&	local pType, message = awaitResponse(serverNum, 2)!@#&	if pType ~= \"response\" then!@#&		print(\"Connection Failed\")!@#&		return!@#&	else!@#&		nsh.connList[nsh.getRemoteID()].outbound = serverNum!@#&		term.clear()!@#&		term.setCursorPos(1,1)!@#&	end!@#&	local clientID = nsh.getRemoteID()!@#&	local serverID = tonumber(args[1])!@#&	while true do!@#&		event = {os.pullEvent()}!@#&		if event[1] == \"rednet_message\" then!@#&			if event[2] == clientID or event[2] == serverID then!@#&				if event[2] == serverID and string.sub(event[3], 1, 2) == \"SC\" then break end!@#&				rednet.send((event[2] == clientID and serverID or clientID), event[3])!@#&			end!@#&		elseif eventFilter[event[1]] then!@#&			rednet.send(serverID, \"EV:;\"..textutils.serialize(event))!@#&		end!@#&	end!@#&	nsh.connList[nsh.getRemoteID()].outbound = nil!@#&	term.clear()!@#&	term.setCursorPos(1, 1)!@#&	print(\"Connection closed by server\")!@#&!@#&elseif #args >= 1 then --either no server running or we are the local shell on the server.!@#&	if not openModem() then return end!@#&	local serverNum = getServerID(args[1])!@#&	if not serverNum then!@#&		print(\"Server Not Found\")!@#&		return!@#&	end!@#&	if nsh then!@#&		local conns = nsh.getRemoteConnections()!@#&		for i = 1, #conns do!@#&			if conns[i] == serverNum then!@#&				print(\"Connection refused.\")!@#&				return!@#&			end!@#&		end!@#&	end!@#&	local fileTransferState = nil!@#&	local fileData = nil!@#&	local fileBinaryData = nil!@#&	local unpackCo = {}!@#&	local color = term.isColor()!@#&	local x, y = term.getSize()!@#&	if args[2] == \"resume\" then!@#&		send(serverNum, \"query\", \"resume:\"..tostring(color)..\";\"..tostring(x)..\",\"..tostring(y))!@#&	else!@#&		send(serverNum, \"query\", \"connect:\"..tostring(color)..\";\"..tostring(x)..\",\"..tostring(y))!@#&	end!@#&	local timeout = os.startTimer(2)!@#&	while true do!@#&		local event = {os.pullEvent()}!@#&		if event[1] == \"timer\" and event[2] == timeout then!@#&			print(\"Connection failed.\")!@#&			return!@#&		elseif event[1] == \"rednet_message\" and event[2] == serverNum and type(event[3]) == \"string\" and string.sub(event[3], 1, 2) == \"SR\" then!@#&			if nsh then nshAPI = nsh end!@#&			if nshAPI.connList and nshAPI.connList.localShell then nshAPI.connList.localShell.outbound = serverNum end!@#&			nshAPI.serverNum = serverNum!@#&			nshAPI.clientCapabilities = \"-fileTransfer-extensions-\"!@#&			term.clear()!@#&			term.setCursorPos(1,1)!@#&			break!@#&		end!@#&	end!@#&!@#&	while true do!@#&		event = {os.pullEventRaw()}!@#&		if #unpackCo > 0 then!@#&			for i = #unpackCo, 1, -1 do!@#&				if coroutine.status(unpackCo[i]) ~= \"dead\" then!@#&					coroutine.resume(unpackCo[i], unpack(event))!@#&				else!@#&					table.remove(unpackCo, i)!@#&				end!@#&			end!@#&		end!@#&		if event[1] == \"rednet_message\" and event[2] == serverNum and type(event[3]) == \"string\" then!@#&			if packetConversion[string.sub(event[3], 1, 2)] then!@#&				packetType = packetConversion[string.sub(event[3], 1, 2)]!@#&				message = string.match(event[3], \";(.*)\")!@#&				if string.sub(packetType, 1, 4) == \"text\" then!@#&					processText(serverNum, packetType, message)!@#&				elseif packetType == \"data\" then!@#&					if message == \"clientCapabilities\" then!@#&						rednet.send(serverNum, nshAPI.clientCapabilities)!@#&					end!@#&				elseif packetType == \"fileQuery\" then!@#&					--send a file to the server!@#&					local mode, file = string.match(message, \"^(%a)=(.*)\")!@#&					if fs.exists(file) then!@#&						send(serverNum, \"fileHeader\", file)!@#&						if mode == \"b\" then!@#&							local fileString = nshAPI.packFile(file)!@#&							send(serverNum, \"fileData\", \"b=\"..fileString)!@#&						else!@#&							local handle = io.open(file, \"r\")!@#&							if handle then!@#&								send(serverNum, \"fileData\", \"t=\"..handle:read(\"*a\"))!@#&								handle:close()!@#&							end!@#&						end!@#&					else!@#&						send(serverNum, \"fileHeader\", \"fileNotFound\")!@#&					end!@#&					send(serverNum, \"fileEnd\", \"end\")!@#&				elseif packetType == \"fileSend\" then!@#&					--receive a file from the server, but don't overwrite existing files.!@#&					local mode, file = string.match(message, \"^(%a)=(.*)\")!@#&					if not fs.exists(file) then!@#&						fileTransferState = \"receive_wait:\"..file!@#&						send(serverNum, \"fileResponse\", \"ok\")!@#&						if mode == \"b\" then!@#&							fileBinaryData = \"\"!@#&							fileData = nil!@#&						else!@#&							fileData = \"\"!@#&							fileBinaryData = nil!@#&						end!@#&					else!@#&						send(serverNum, \"fileResponse\", \"reject\")!@#&					end!@#&				elseif packetType == \"fileHeader\" then!@#&					if message == \"fileNotFound\" then!@#&						fileTransferState = nil!@#&					end!@#&				elseif packetType == \"fileData\" then!@#&					if fileTransferState and string.match(fileTransferState, \"(.-):\") == \"receive_wait\" then!@#&						if string.match(message, \"^(%a)=\") == \"b\" then!@#&							fileBinaryData = fileBinaryData..string.match(message, \"^b=(.*)\")!@#&						else!@#&							fileData = fileData..string.match(message, \"^t=(.*)\")!@#&						end!@#&					end!@#&				elseif packetType == \"fileEnd\" then!@#&					if fileTransferState and string.match(fileTransferState, \"(.-):\") == \"receive_wait\" then!@#&						if fileBinaryData then!@#&							local co = coroutine.create(nshAPI.unpackAndSaveFile)!@#&							coroutine.resume(co, string.match(fileTransferState, \":(.*)\"), fileBinaryData)!@#&							if coroutine.status(co) ~= \"dead\" then!@#&								table.insert(unpackCo, co)!@#&							end!@#&						elseif fileData then!@#&							local handle = io.open(string.match(fileTransferState, \":(.*)\"), \"w\")!@#&							if handle then!@#&								handle:write(fileData)!@#&								handle:close()!@#&							end!@#&						end!@#&						fileTransferState = nil!@#&					end!@#&				elseif packetType == \"close\" then!@#&					if term.isColor() then!@#&						term.setBackgroundColor(colors.black)!@#&						term.setTextColor(colors.white)!@#&					end!@#&					term.clear()!@#&					term.setCursorPos(1, 1)!@#&					print(\"Connection closed by server.\")!@#&					nshAPI.serverNum = nil!@#&					if nshAPI.connList and nshAPI.connList.localShell then nshAPI.connList.localShell.outbound = nil end!@#&					return!@#&				end!@#&			end!@#&		elseif event[1] == \"mouse_click\" or event[1] == \"mouse_drag\" or event[1] == \"mouse_scroll\" or event[1] == \"key\" or event[1] == \"char\" then!@#&			--pack up event!@#&			send(serverNum, \"event\", textutils.serialize(event))!@#&		elseif event[1] == \"terminate\" then!@#&			nshAPI.serverNum = nil!@#&			if nshAPI.localShell then nshAPI.localShell.outbound = nil end!@#&			term.clear()!@#&			term.setCursorPos(1, 1)!@#&			print(\"Connection closed locally.\")!@#&			return!@#&		end!@#&	end!@#&else!@#&	print(\"Usage: VNC <serverID> [resume]\")!@#&	print(\"       VNC host [remote [local [name]]]\")!@#&end",["wget"]="local args = {...}!@#&!@#&if args[1] and args[2] then!@#&  f = http.get(args[1]).readAll()!@#&  f2 = fs.open(args[2], \"w\")!@#&  f2.write(f)!@#&  f2.close()!@#&  print(\"Downloaded \"..args[1]..\" to \"..args[2])!@#&!@#&else!@#&  print(\"Usage: wget <link> <filename>\")!@#&end",["get"]="if not nsh then print(\"No nsh session!\") return end!@#&!@#&local args = {...}!@#&!@#&if #args < 2 then!@#&	print(\"Usage: get <remote> <local>\")!@#&	print(\"<remote>: any file on the server\")!@#&	print(\"<local>: any non-existant file on the client\")!@#&	return!@#&end!@#&!@#&if fs.exists(args[1]) then!@#&	nsh.send(\"FS:;t=\"..args[2])!@#&	local message = nsh.receive()!@#&	if message == \"FR:;ok\" then!@#&		nsh.send(\"FH:;\"..args[1])!@#&		local handle = io.open(args[1], \"r\")!@#&		if handle then!@#&			nsh.send(\"FD:;t=\"..handle:read(\"*a\"))!@#&			handle:close()!@#&		end!@#&		nsh.send(\"FE:;end\")!@#&	else!@#&		print(\"Client rejected file!\")!@#&	end!@#&end",["clone"]="local args = {...}!@#&local allowExit = false!@#&!@#&local function setColor(color)!@#&	-- shorthand color setting!@#&	if term.isColor() then!@#&		term.setTextColor(color)!@#&	end!@#&end!@#&!@#&local function writeColor(...)!@#&	-- shorthand color writing!@#&	-- format: printColor(color1, 'text', color2, 'text', ...)!@#&	local curColor!@#&	for _, v in pairs{...} do!@#&		if type(v) == 'number' then!@#&			curColor = v!@#&		else!@#&			if curColor then!@#&				setColor(curColor)!@#&			end!@#&			write(tostring(v))!@#&		end!@#&	end!@#&end!@#&!@#&local function printColor(...)!@#&	-- same as writeColor but with a \\n!@#&	writeColor(...)!@#&	print()!@#&end!@#&!@#&local function openRednet()!@#&	-- shorthand rednet opening!@#&	for _, side in pairs(rs.getSides()) do!@#&		if peripheral.getType(side) == 'modem' then!@#&			rednet.open(side)!@#&			return side!@#&		end!@#&	end!@#&	printColor(colors.red, 'Please attach rednet modem')!@#&end!@#&!@#&local function client(server)!@#&	-- password get!@#&	writeColor(colors.magenta, 'Password: ')	!@#&	setColor(colors.white)!@#&	local pass = read('*')!@#&	!@#&	printColor(colors.yellow, 'Sending clone request')!@#&	!@#&	-- request files from the server while sending pass as well!@#&	rednet.send(server, 'clone_req '..pass)!@#&	!@#&	-- listen for a sendback!@#&	-- only allow max 10 seconds of delay!@#&	local msg!@#&	repeat!@#&		local id, _msg = rednet.receive(10)!@#&		msg = _msg!@#&	until id == server or not id!@#&	!@#&	-- no message? probably timed out!@#&	if not msg then!@#&		printColor(colors.red, 'Request timed out')!@#&		return!@#&	end!@#&	!@#&	-- the uSER SHOULD STOP TRYING TO HACK THE SERVER oMG!@#&	if msg == 'clone_failed_pass' then!@#&		printColor(colors.red, 'Wrong password')!@#&		return!@#&	end!@#&	!@#&	printColor(colors.lime, 'Request successful')!@#&	printColor(colors.yellow, 'Writing files')!@#&	!@#&	-- get the program list and establish a directory for our new files!@#&	local programs = textutils.unserialize(msg)!@#&	local clonepath = 'SpeedOS/Downloads/cloned/'..server!@#&	!@#&	-- erase the current clone, then make a new one!@#&	if fs.exists(clonepath) then!@#&		fs.delete(clonepath)!@#&	end!@#&	fs.makeDir(clonepath)!@#&	!@#&	-- write ALL OF THE PROGRAMS!!@#&	for i=1, #programs do!@#&		local prog = programs[i]!@#&		local path = clonepath..'/'..prog.path!@#&	!@#&	-- because i can't directly write \"cloned/254/stuff/stuff/more_stuff\"!@#&	-- gotta make the directory for it first!@#&	local pathfolder = path:match('(.+)/')!@#&	if not fs.exists(pathfolder) then!@#&		fs.makeDir(pathfolder)!@#&	end!@#&	!@#&	-- PROCEED WITH THE WRITING!@#&		local file = fs.open(path, 'w')!@#&		if file then!@#&			file.write(prog.contents)!@#&			file.close()!@#&			!@#&			setColor(colors.lime)!@#&			printColor(colors.lime, 'Successfully wrote '..prog.path)!@#&		else!@#&		-- wtf why? :C!@#&			printColor(colors.red, 'Could not write '..prog.path)!@#&		end!@#&	end!@#&	!@#&	shell.setDir(clonepath)!@#&end!@#&!@#&local function files()!@#&	printColor(colors.yellow, 'Generating file list')!@#&	!@#&	-- recursively make a file list!@#&	-- exclude specific directories!@#&	local filelist = {}!@#&	!@#&	local function genFiles(cdir)!@#&		for _, localpath in pairs(fs.list(cdir)) do!@#&			local path = fs.combine(cdir, localpath)!@#&		!@#&			if fs.isDir(path) then!@#&				if not path:find('rom')!@#&				and not path:find('SpeedOS/Downloads/cloned') then!@#&					genFiles(path)!@#&				end!@#&			else!@#&				if not localpath:match('^/?%.') then!@#&					local file = fs.open(path,'r')!@#&					if file then!@#&						table.insert(filelist, {!@#&							path = path;!@#&							contents = file.readAll()!@#&						})!@#&						file.close()!@#&					else!@#&						printColor(colors.red, 'Could not read '..path)!@#&					end!@#&				end!@#&			end!@#&		end!@#&	end!@#&	!@#&	genFiles '/'!@#&	return filelist!@#&end!@#&!@#&local function server()!@#&	-- if there's a password file!@#&	-- read it and key it in to the read() function!@#&	-- by abusing events!@#&	local passfile = fs.open('.clone_pass','r')!@#&	if passfile then!@#&		for v in (passfile.readAll()):gmatch('.') do!@#&			os.queueEvent('char',v)!@#&		end!@#&		passfile.close()!@#&	end!@#&	!@#&	-- get a server password!@#&	writeColor(colors.magenta, 'Password: ')!@#&	setColor(colors.white)!@#&	local password = read('*')!@#&	!@#&	-- go ahead and key in a y if the saved password exists,!@#&	-- and n if otherwise!@#&	-- for convenience!@#&	os.queueEvent('char', passfile and 'y' or 'n')!@#&	!@#&	-- save the password to the file!@#&	-- if the user chooses to remember it!@#&	writeColor(colors.magenta, 'Remember password? [y/n] ')!@#&	setColor(colors.white)!@#&	local answer = read():lower():sub(1,1)!@#&	!@#&	if answer == 'y' then!@#&		local passfile = fs.open('.clone_pass','w')!@#&		if passfile then!@#&			passfile.write(password)!@#&			passfile.close()!@#&		end!@#&		!@#&	-- otherwise, delete the file!@#&	-- to prevent rememberance!@#&	elseif answer == 'n' then!@#&		if fs.exists('.clone_pass') then!@#&			fs.delete('.clone_pass')!@#&		end!@#&	end!@#&	!@#&	printColor(colors.lime, 'Hosting clone server')!@#&	printColor(colors.yellow, 'Press backspace to quit.')!@#&	allowExit = true!@#&	!@#&	-- loooOOOOOOOoooop!@#&	while true do!@#&		local id, msg = rednet.receive()!@#&		!@#&		printColor(colors.yellow, 'Request from '..id)!@#&		!@#&		local pass = msg:match('clone_req (.+)')!@#&		if pass == password then!@#&			printColor(colors.lime, 'Successful authentication')!@#&			local files = textutils.serialize(files())!@#&			printColor(colors.yellow, 'Sending files')!@#&			rednet.send(id, files)!@#&			printColor(colors.lime, 'Done')!@#&		else!@#&			printColor(colors.red, 'Access denied')!@#&			rednet.send(id, 'clone_failed_pass')!@#&		end!@#&	end!@#&end!@#&!@#&local function exit()!@#&	-- when used with parallel,!@#&	-- allows exiting the program!@#&	-- at any time :D (when allowExit is true)!@#&	!@#&	repeat!@#&		local _, k = os.pullEvent('key')!@#&	until k == keys.backspace!@#&	and allowExit!@#&end!@#&!@#&printColor(colors.yellow, 'Opening rednet')!@#&local modemSide = openRednet()!@#&if not modemSide then return end!@#&!@#&if args[1] == 'host' then!@#&	parallel.waitForAny(server, exit)!@#&elseif tonumber(args[1]) then!@#&	client(tonumber(args[1]))!@#&else!@#&	print 'Usage: \"clone <id>\" or \"clone host\"'!@#&end!@#&!@#&rednet.close(modemSide)",["compress"]="local inFN, outFN!@#&!@#&local args = {...}!@#&if #args ~= 2 then!@#&	error(\"Usage: \"..shell.getRunningProgram()..\" <input file> <output file>\", 0)!@#&end!@#&inFN = args[1]!@#&outFN = args[2]!@#&!@#&local function countTabs(l)!@#&	for k = 1, #l do!@#&		if l:sub(k, k) ~= \"\\t\" then!@#&			return k - 1!@#&		end!@#&	end!@#&	return #l!@#&end!@#&!@#&local compressNonIdentGroups = false!@#&local huffmanEncode = true!@#&!@#&-- read input file!@#&local f = fs.open(inFN, \"r\")!@#&local lines = {}!@#&for line in f.readLine do!@#&	lines[#lines+1] = line!@#&end!@#&f.close()!@#&!@#&-- convert indentation!@#&local inText = \"\"!@#&local lastIndent = 0!@#&for lineNo, line in ipairs(lines) do!@#&	local thisIndent = countTabs(line)!@#&	local nextIndent = lines[lineNo+1] and countTabs(lines[lineNo+1]) or thisIndent!@#&	local prevIndent = lines[lineNo-1] and countTabs(lines[lineNo-1]) or 0!@#&	!@#&	if thisIndent > nextIndent and thisIndent > prevIndent then!@#&		thisIndent = math.min(nextIndent, prevIndent)!@#&	end!@#&	!@#&	while lastIndent < thisIndent do!@#&		inText = inText .. \"&+\"!@#&		lastIndent = lastIndent + 1!@#&	end!@#&	while lastIndent > thisIndent do!@#&		inText = inText .. \"&-\"!@#&		lastIndent = lastIndent - 1!@#&	end!@#&	!@#&	if line:sub(1,1) == \"&\" then!@#&		line = \"&\" .. line!@#&	end!@#&	!@#&	inText = inText .. line:sub(lastIndent+1) .. \"\\n\"!@#&end!@#&!@#&!@#&-- parse into alternating strings of alphanumerics and non-alphanumerics!@#&local parsed = {}!@#&local idents = \"abcdefghijklmnopqrstvuwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_\"!@#&local lastIdent = nil!@#&!@#&local function isIdentString(s)!@#&	return idents:find(s:sub(1,1), 1, true) ~= nil!@#&end!@#&!@#&local groupCounts = {}!@#&!@#&local function onFinishSegment(isIdent, segment)!@#&	if isIdent or compressNonIdentGroups then!@#&		groupCounts[segment] = (groupCounts[segment] or 0) + 1!@#&	end!@#&end!@#&!@#&for k = 1, #inText do!@#&	local ch = inText:sub(k, k)!@#&	local isIdent = idents:find(ch, 1, true) ~= nil!@#&	if isIdent ~= lastIdent then!@#&		if #parsed > 0 then!@#&			onFinishSegment(lastIdent, parsed[#parsed])!@#&		end!@#&		parsed[#parsed+1] = \"\"!@#&	end!@#&	lastIdent = isIdent!@#&	parsed[#parsed] = parsed[#parsed]..ch!@#&end!@#&if #parsed > 0 then!@#&	onFinishSegment(isIdent, parsed[#parsed])!@#&end!@#&!@#&--print(table.concat(parsed,\" \"))!@#&!@#&local id_literal_escape = \"_\"!@#&local pc_literal_escape = \"$\"!@#&!@#&local nextCompressed!@#&do!@#&	local validchars_id = idents:gsub(id_literal_escape,\"\")!@#&	local validchars_pc = \"\"!@#&	!@#&	for n=32,126 do!@#&		local ch = string.char(n)!@#&		if not idents:find(ch,1,true) and ch ~= pc_literal_escape then!@#&			validchars_pc = validchars_pc .. ch!@#&		end!@#&	end!@#&	!@#&	local function encode(n, isIdent)!@#&		local s = \"\"!@#&		local validchars = isIdent and validchars_id or validchars_pc!@#&		while n > 0 do!@#&			local digit = (n % #validchars) + 1!@#&			s = s .. validchars:sub(digit, digit)!@#&			n = math.floor(n / #validchars)!@#&		end!@#&		return s!@#&	end!@#&	!@#&	local next = {[true]=0,[false]=0}!@#&	function nextCompressed(isIdent)!@#&		next[isIdent] = next[isIdent] + 1!@#&		return encode(next[isIdent], isIdent)!@#&	end!@#&end!@#&!@#&!@#&!@#&!@#&!@#&!@#&local groupsSorted = {}!@#&local groups = {}!@#&for k, v in pairs(groupCounts) do!@#&	if (#k > 1 and v > 1) or k:find(isIdentString(k) and id_literal_escape or pc_literal_escape) then!@#&		local t = {k, v}!@#&		groups[k] = t!@#&		table.insert(groupsSorted, t)!@#&	end!@#&end!@#&!@#&local avgCompressedLength = 2!@#&!@#&local function estSavings(a)!@#&	local str = a[1]!@#&	local count = a[2]!@#&	local compressedLength = a[3] and #a[3] or avgCompressedLength!@#&	!@#&	-- estimates the number of chars saved by compressing this group!@#&	!@#&	-- it costs #str+1 chars to encode the group literally, or about compressedLength chars to compress it!@#&	-- so by compressing it, each time the group occurs we save (#str + 1 - compressedLength) chars!@#&	local saved = (#str + 1 - compressedLength) * count!@#&	!@#&	-- but we also use about #str + 1 chars in the name table if we compress it.!@#&	saved = saved - (#str + 1)!@#&	!@#&	return saved!@#&end!@#&!@#&table.sort(groupsSorted, function(a, b)!@#&	return estSavings(a) > estSavings(b)!@#&end)!@#&!@#&--local total = 0!@#&for _, v in ipairs(groupsSorted) do!@#&	v[3] = nextCompressed(isIdentString(v[1]))!@#&	--total = total + estSavings(v)!@#&	--[[if estSavings(v) > 0 then!@#&		print(v[1]:gsub(\"\\n\",\"\\\\n\"),\" \",v[2],\" \",v[3],\" \",estSavings(v))!@#&	end]]!@#&end!@#&!@#&--print(total,\" \",#inText,\" \",#inText-total)!@#&!@#&!@#&!@#&!@#&!@#&local out = #groupsSorted .. \"^\"!@#&for _, v in ipairs(groupsSorted) do!@#&	local encoded = v[1]:gsub(\"&\", \"&a\"):gsub(\"%^\",\"&b\")!@#&	out = out .. encoded .. \"^\"!@#&end!@#&for _, v in pairs(parsed) do!@#&	if groups[v] then!@#&		out = out .. groups[v][3]!@#&	elseif isIdentString(v) then!@#&		out = out .. id_literal_escape .. v!@#&	elseif compressNonIdentGroups then!@#&		out = out .. pc_literal_escape .. v!@#&	else!@#&		out = out .. v!@#&	end!@#&end!@#&!@#&if huffmanEncode then!@#&	-- generate a huffman tree - first we need to count the number of times each symbol occurs!@#&	local symbolCounts = {}!@#&	local numSymbols = 0!@#&	for k = 1, #out do!@#&		local sym = out:sub(k,k)!@#&		if not symbolCounts[sym] then!@#&			numSymbols = numSymbols + 1!@#&			symbolCounts[sym] = 1!@#&		else!@#&			symbolCounts[sym] = symbolCounts[sym] + 1!@#&		end!@#&	end!@#&	!@#&	-- convert them to tree nodes and sort them by count, ascending order!@#&	-- a tree node is either {symbol, count} or {{subtree_0, subtree_1}, count}!@#&	local treeFragments = {}!@#&	for sym, count in pairs(symbolCounts) do!@#&		treeFragments[#treeFragments + 1] = {sym, count}!@#&	end!@#&	table.sort(treeFragments, function(a, b)!@#&		return a[2] < b[2]!@#&	end)!@#&	!@#&	while #treeFragments > 1 do!@#&		-- take the two lowest-count fragments and combine them!@#&		local a = table.remove(treeFragments, 1)!@#&		local b = table.remove(treeFragments, 1)!@#&		!@#&		local newCount = a[2] + b[2]!@#&		local new = {{a, b}, newCount}!@#&		!@#&		-- insert the new fragment in the right place!@#&		if #treeFragments == 0 or newCount > treeFragments[#treeFragments][2] then!@#&			table.insert(treeFragments, new)!@#&		else!@#&			local ok = false!@#&			for k=1,#treeFragments do!@#&				if treeFragments[k][2] >= newCount then!@#&					table.insert(treeFragments, k, new)!@#&					ok = true!@#&					break!@#&				end!@#&			end!@#&			assert(ok, \"internal error: couldn't find place for tree fragment\")!@#&		end!@#&	end!@#&	!@#&	local symbolCodes = {}!@#&	!@#&	local function shallowCopyTable(t)!@#&		local rv = {}!@#&		for k,v in pairs(t) do!@#&			rv[k] = v!@#&		end!@#&		return rv!@#&	end!@#&	!@#&	-- now we have a huffman tree (codes -> symbols) but we need a map of symbols -> codes, so do that!@#&	local function iterate(root, path)!@#&		if type(root[1]) == \"table\" then!@#&			local t = shallowCopyTable(path)!@#&			t[#t+1] = false!@#&			iterate(root[1][1], t)!@#&			path[#path+1] = true!@#&			iterate(root[1][2], path)!@#&		else!@#&			symbolCodes[root[1]] = path!@#&		end!@#&	end!@#&	iterate(treeFragments[1], {})!@#&	!@#&	local rv = {}!@#&	!@#&	local symbolBitWidth = 8!@#&	!@#&	--print(\"#syms: \",numSymbols)!@#&	--print(\"sbw: \",symbolBitWidth)!@#&	!@#&	local function writeTree(tree)!@#&		if type(tree[1]) == \"table\" then!@#&			rv[#rv+1] = false!@#&			writeTree(tree[1][1])!@#&			writeTree(tree[1][2])!@#&		else!@#&			rv[#rv+1] = true!@#&			local symbol = tree[1]:byte()!@#&			for k = 0, symbolBitWidth - 1 do!@#&				!@#&				local testBit = 2 ^ k!@#&				!@#&				-- local bit = ((symbol & testBit) != 0)!@#&				local bit = (symbol % (2 * testBit)) >= testBit!@#&				rv[#rv+1] = bit!@#&			end!@#&		end!@#&	end!@#&	!@#&	writeTree(treeFragments[1])!@#&	!@#&	--print(\"tree size: \",#rv)!@#&	!@#&	for k = 1, #out do!@#&		local symbol = out:sub(k,k)!@#&		--print(symbol,\" \",#symbolCodes[symbol])!@#&		for _, bit in ipairs(symbolCodes[symbol] or error(\"internal error: symbol \"..symbol..\" has no code\")) do!@#&			rv[#rv+1] = bit!@#&		end!@#&	end!@#&	!@#&	--print(\"total size: \",#rv)!@#&	!@#&	!@#&	-- convert the array of bits (rv) back to characters!@#&	!@#&	!@#&	local s = \"\"!@#&	!@#&	-- write 6 bits per byte because LuaJ (and/or CC)	!@#&	local bitsPerByte = 6!@#&	local firstCharacter = 32!@#&	!@#&	-- pad to an integral number of bytes!@#&	local padbit = not rv[#rv]!@#&	repeat!@#&		rv[#rv+1] = padbit!@#&	until (#rv % bitsPerByte) == 0!@#&	!@#&	!@#&	for k = 1, #rv, bitsPerByte do!@#&		local byte = firstCharacter!@#&		for i = 0, bitsPerByte-1 do!@#&			if rv[k+i] then 	!@#&				byte = byte + 2 ^ i!@#&			end!@#&		end!@#&		s = s .. string.char(byte)!@#&	end!@#&	!@#&	out = s!@#&end!@#&!@#&local f = fs.open(outFN, \"w\")!@#&f.write(out)!@#&f.close()!@#&!@#&print(\"uncompressed size: \",inText:len())!@#&print(\"compressed size: \",out:len())!@#&print(\"compression ratio: \",out:len()/inText:len())",["decompress"]="local inFN, outFN!@#&!@#&local args = {...}!@#&if #args ~= 2 then!@#&	error(\"Usage: \"..shell.getRunningProgram()..\" <input file> <output file>\")!@#&end!@#&inFN = args[1]!@#&outFN = args[2]!@#&!@#&local f = fs.open(inFN, \"r\")!@#&local inText = f.readAll()!@#&f.close()!@#&!@#&local inPos = 1!@#&!@#&local huffmanCompression = true!@#&!@#&if huffmanCompression then!@#&	-- convert characters to bits!@#&	local inBits = {}!@#&	for k = 1, #inText do!@#&		local byte = inText:sub(k, k):byte() - 32!@#&		for i = 0, 5 do!@#&			local testBit = 2 ^ i!@#&			inBits[#inBits + 1] = (byte % (2 * testBit)) >= testBit!@#&		end!@#&	end!@#&	!@#&	-- remove padding!@#&	local padbit = inBits[#inBits]!@#&	while inBits[#inBits] == padbit do!@#&		inBits[#inBits] = nil!@#&	end!@#&	!@#&	local pos = 1!@#&	local function readBit()!@#&		if pos > #inBits then error(\"end of stream\", 2) end!@#&		pos = pos + 1!@#&		return inBits[pos - 1]!@#&	end!@#&	!@#&	-- read huffman tree!@#&	local function readTree()!@#&		if readBit() then!@#&			local byte = 0!@#&			for i = 0, 7 do!@#&				if readBit() then!@#&					byte = byte + 2 ^ i!@#&				end!@#&			end!@#&			--write(string.char(byte))!@#&			return string.char(byte)!@#&		else!@#&			local subtree_0 = readTree()!@#&			local subtree_1 = readTree()!@#&			return {[false]=subtree_0, [true]=subtree_1}!@#&		end!@#&	end!@#&	local tree = readTree()!@#&	!@#&	inText = \"\"!@#&	!@#&	local treePos = tree!@#&	while pos <= #inBits do!@#&		local bit = readBit()!@#&		treePos = treePos[bit]!@#&		if type(treePos) ~= \"table\" then!@#&			inText = inText .. treePos!@#&			treePos = tree!@#&		end!@#&	end!@#&	if treePos ~= tree then!@#&		error(\"unexpected end of stream\")!@#&	end!@#&end!@#&!@#&local function readTo(delim)!@#&	local start = inPos!@#&	local nextCaret = inText:find(delim, inPos, true)!@#&	if not nextCaret then!@#&		inPos = #inText + 1!@#&		return inText:sub(start)!@#&	end!@#&	inPos = nextCaret + 1!@#&	return inText:sub(start, nextCaret - 1)!@#&end!@#&!@#&-- returns iterator!@#&local function splitString(str, delim)!@#&	local pos = 1!@#&	return function()!@#&		if pos > #str then return end!@#&		local start = pos!@#&		local nextDelim = str:find(delim, pos, true)!@#&		if not nextDelim then!@#&			pos = #str + 1!@#&			return str:sub(start)!@#&		end!@#&		pos = nextDelim + 1!@#&		return str:sub(start, nextDelim - 1)!@#&	end!@#&end!@#&!@#&local nameTable = {}!@#&!@#&local idents = \"abcdefghijklmnopqrstvuwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_\"!@#&local nextCompressed!@#&do!@#&	local validchars = idents:gsub(\"_\",\"\")!@#&	!@#&	local function encode(n)!@#&		local s = \"\"!@#&		while n > 0 do!@#&			local digit = (n % #validchars) + 1!@#&			s = s .. validchars:sub(digit, digit)!@#&			n = math.floor(n / #validchars)!@#&		end!@#&		return s!@#&	end!@#&	!@#&	local next = 0!@#&	function nextCompressed()!@#&		next = next + 1!@#&		return encode(next)!@#&	end!@#&end!@#&!@#&for k = 1, tonumber(readTo(\"^\")) do!@#&	local key = nextCompressed()!@#&	local value = readTo(\"^\")!@#&	--print(key,\" -> \",value)!@#&	nameTable[key] = value!@#&	--assert(readTo(\"^\") == tostring(k), \"mismatch at \"..k)!@#&end!@#&!@#&local out = \"\"!@#&!@#&local function onFinishSegment(isIdent, segment)!@#&	if isIdent then!@#&		if segment:sub(1, 1) == \"_\" then!@#&			out = out .. segment:sub(2)!@#&		else!@#&			out = out .. tostring(nameTable[segment])!@#&		end!@#&	else!@#&		out = out .. segment!@#&	end!@#&end!@#&!@#&local parsed = {}!@#&local idents = \"abcdefghijklmnopqrstvuwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_\"!@#&local lastIdent = nil!@#&!@#&for k = inPos, #inText do!@#&	local ch = inText:sub(k, k)!@#&	local isIdent = idents:find(ch, 1, true) ~= nil!@#&	if isIdent ~= lastIdent then!@#&		if #parsed > 0 then!@#&			onFinishSegment(lastIdent, parsed[#parsed])!@#&		end!@#&		parsed[#parsed+1] = \"\"!@#&	end!@#&	lastIdent = isIdent!@#&	parsed[#parsed] = parsed[#parsed]..ch!@#&end!@#&if #parsed > 0 then!@#&	onFinishSegment(isIdent, parsed[#parsed])!@#&end!@#&!@#&-- convert indentation back!@#&local out2 = \"\"!@#&local lastIndent = \"\"!@#&for line in splitString(out, \"\\n\") do!@#&	while line:sub(1,2) == \"&+\" do!@#&		lastIndent = lastIndent .. \"\\t\"!@#&		line = line:sub(3)!@#&	end!@#&	while line:sub(1,2) == \"&-\" do!@#&		lastIndent = lastIndent:sub(1, #lastIndent - 1)!@#&		line = line:sub(3)!@#&	end!@#&	if line:sub(1,2) == \"&&\" then!@#&		line = line:sub(2)!@#&	end!@#&	!@#&	out2 = out2 .. lastIndent .. line .. \"\\n\"!@#&end!@#&!@#&--print(out2)!@#&!@#&local f = fs.open(outFN, \"w\")!@#&f.write(out2)!@#&f.close()",["put"]="if not nsh then print(\"No nsh session!\") return end!@#&!@#&local args = {...}!@#&!@#&if #args < 2 then!@#&	print(\"Usage: put <local> <remote>\")!@#&	print(\"<local>: any file on the client\")!@#&	print(\"<remote>: any file on the server\")!@#&	return!@#&end!@#&!@#&local fileData = \"\"!@#&!@#&nsh.send(\"FQ:;t=\"..args[1])!@#&local message = nsh.receive()!@#&if message ~= \"fileNotFound\" then!@#&	while true do!@#&		message = nsh.receive()!@#&		pType = string.sub(message, 1, 2)!@#&		if pType == \"FD\" then!@#&			fileData = fileData..string.match(message, \"^FD:;t=(.*)\")!@#&		elseif pType == \"FE\" then!@#&			break!@#&		end!@#&	end!@#&	if #fileData > 0 then!@#&		local handle = io.open(args[2], \"w\")!@#&		if handle then!@#&			handle:write(fileData)!@#&			handle:close()!@#&		end!@#&	else!@#&		print(\"Empty file not written!\")!@#&	end!@#&end",},["DoorLock"]="!@#&--rawdownloadcloneembedreportprintLua 10.32 KB!@#&os.loadAPI(\"SpeedAPI/windows\")!@#&os.loadAPI(\"SpeedAPI/peripheral\")!@#& !@#&--????????? ????? ???????!@#&if peripheral.find(\"modem\") then!@#&      rednet.open(peripheral.find(\"modem\")) !@#&end!@#&!@#&--!@#&io.write(\"Enter password: \")!@#&local password = io.read()!@#& !@#&--   !@#&local doorOpenTime = 5!@#& !@#&--   !@#&local buttonPressTime = 0.2!@#& !@#&-- !@#&local changePasswordTimer = nil!@#& !@#&--  !@#&local mode = \"default\"!@#& !@#&--   !@#&local hidePassword = \"false\"!@#& !@#&--   ,   !@#&io.write(\"Enter redstone side: \")!@#&local redstoneSide = io.read()!@#&-- ,   !@#&io.write(\"Enter alarm side: \")!@#&local redstoneSideOnWrongPassword = io.read() --\"right\"!@#& !@#&--!@#&local buttons = {!@#&        {\"1\",\"2\",\"3\"},!@#&        {\"4\",\"5\",\"6\"},!@#&        {\"7\",\"8\",\"9\"},!@#&        {\"C\",\"0\",\"#\"},!@#&}!@#& !@#&-- !@#&local Obj = {}!@#& !@#&-- ,    !@#&local inputCode = {}!@#& !@#&--  !@#&local xSize, ySize = term.getSize()!@#& !@#&-- !@#&local function findPeripheral(whatToFind)!@#&      local PeriList = rs.getSides() --peripheral.getNames()!@#&      for i=1,#PeriList do!@#&            if peripheral.getType(PeriList[i]) == whatToFind then!@#&                  return PeriList[i]!@#&            end!@#&      end!@#&end!@#& !@#&--       !@#&local function centerText(how,coord,text,textColor,backColor)!@#&            term.setTextColor(textColor)!@#&            term.setBackgroundColor(backColor)!@#&            if how == \"xy\" then!@#&                        term.setCursorPos(math.floor(xSize/2-#text/2),math.floor(ySize/2))!@#&            elseif how == \"x\" then!@#&                        term.setCursorPos(math.floor(xSize/2-#text/2),coord)!@#&            elseif how == \"y\" then!@#&                        term.setCursorPos(coord,math.floor(ySize/2))!@#&            end!@#&            term.write(text)!@#&end!@#& !@#&-- !@#&function configRead(pathToConfig,whatToRead)!@#&            if not fs.exists(pathToConfig) then error(\"No such file\") end!@#&            local file = fs.open(pathToConfig,\"r\")!@#&            while true do!@#&                        local line = file.readLine()!@#&                        if line ~= nil then!@#&                                    local key, value = string.match(line,\"(.*)=(.*)\")!@#&                                    if value ~= nil and key == whatToRead then!@#&                                                file.close()!@#&                                                return value!@#&                                    end!@#&                        else!@#&                                    file.close()!@#&                                    break!@#&                        end!@#&            end!@#&end!@#& !@#&--  !@#&local function configWrite(pathToConfig,key,value)!@#&            if not fs.exists(pathToConfig) then!@#&                        local file = fs.open(pathToConfig,\"w\")!@#&                        file.close()!@#&            end!@#&     !@#&            local file = fs.open(pathToConfig,\"r\")!@#&            local Massiv = {}!@#&           !@#&            local lineCounter = 1!@#&            while true do!@#&                        local line = file.readLine()!@#&                        if line ~= nil then!@#&                                    Massiv[lineCounter] = line!@#&                        else!@#&                                    file.close()!@#&                                    break!@#&                        end!@#&                        lineCounter = lineCounter + 1!@#&            end!@#&     !@#&            local success = false!@#&            for i=1,#Massiv do!@#&                        local key1, value1 = string.match(Massiv[i],\"(.*)=(.*)\")!@#&                        if value1 ~= nil and key1 == key then!@#&                                    Massiv[i] = key..\"=\"..value!@#&                                    success = true!@#&                        end!@#&            end!@#&     !@#&            if success == false then Massiv[#Massiv+1] = key..\"=\"..value end!@#&     !@#&            local file = fs.open(pathToConfig,\"w\")!@#&            for i=1,#Massiv do!@#&                        file.writeLine(Massiv[i])!@#&            end!@#&            file.close()!@#&end!@#& !@#&--!@#&local function newObj(name,x,y)!@#&            Obj[name]={}!@#&            Obj[name][\"x\"]=x!@#&            Obj[name][\"y\"]=y!@#&end!@#& !@#&--   !@#&local function clearScreen(color)!@#&            term.setBackgroundColor(color)!@#&            term.clear()!@#&end!@#& !@#&-- !@#&local function usualText(x,y,text)!@#&            term.setCursorPos(x,y)!@#&            term.write(text)!@#&end!@#& !@#&--  !@#&local function drawTab(textColor,backColor)!@#&            term.setBackgroundColor(backColor)!@#&            term.setTextColor(textColor)!@#&            term.setCursorPos(2,1)!@#&            term.clearLine()!@#&            term.write(\"-----\")!@#&     !@#&            for i=1,#inputCode do!@#&                        if hidePassword == \"true\" then!@#&                                    usualText(i+1,1,\"*\")!@#&                        else!@#&                                    usualText(i+1,1,inputCode[i])!@#&                        end!@#&            end!@#&end!@#& !@#&--  !@#&local function drawButton(name,textColor,backColor)!@#&            term.setBackgroundColor(backColor)!@#&            term.setTextColor(textColor)!@#&            usualText(Obj[name][\"x\"],Obj[name][\"y\"],name)!@#&end!@#& !@#& !@#&--  !@#&local function gui()!@#&            -- !@#&            term.setCursorBlink(false)!@#&            clearScreen(colors.white)!@#&            term.setTextColor(colors.black)!@#&     !@#&            -- !@#&            for j=1,#buttons do!@#&                        for i=1,#buttons[j] do!@#&                                    local xPos = i*2!@#&                                    local yPos = 1+j!@#&                                    usualText(xPos,yPos,buttons[j][i])!@#&                                    newObj(buttons[j][i],xPos,yPos)!@#&                        end!@#&            end!@#&     !@#&            --  !@#&            drawTab(colors.white,colors.black)!@#&end!@#& !@#&------------------------------C ------------------------------------!@#& !@#&if not term.isColor() then!@#&            error(\"This program requires an advanced computer.\")!@#&end!@#& !@#&--   !@#&clearScreen(colors.white)!@#&centerText(\"xy\",0,\"Program started.\",colors.lightGray,colors.white)!@#& !@#&-- !@#&local m = findPeripheral(\"monitor\")!@#&if m ~= nil then!@#&            m = peripheral.wrap(m)!@#&            if not m.isColor() then!@#&                        windows.error(\"This program works only with advanced monitor.\")!@#&                    do return end!@#&        end!@#&        m.setTextScale(1)!@#&        term.redirect(m)!@#&else!@#&            windows.error(\"This program requires advanced external monitor.\")!@#&        do return end!@#&end!@#& !@#&-- !@#&if fs.exists(\"System/CodeDoor.cfg\") then!@#&            password = configRead(\"System/CodeDoor.cfg\",\"password\")!@#&            redstoneSide = configRead(\"System/CodeDoor.cfg\",\"redstone side\")!@#&            redstoneSideOnWrongPassword = configRead(\"System/CodeDoor.cfg\",\"redstone side on wrong password\")!@#&            doorOpenTime = configRead(\"System/CodeDoor.cfg\",\"door open time\")!@#&            hidePassword = configRead(\"System/CodeDoor.cfg\",\"hide password\")!@#&else!@#&            configWrite(\"System/CodeDoor.cfg\",\"password\",password)!@#&            configWrite(\"System/CodeDoor.cfg\",\"redstone side\",redstoneSide)!@#&            configWrite(\"System/CodeDoor.cfg\",\"redstone side on wrong password\",redstoneSideOnWrongPassword)!@#&            configWrite(\"System/CodeDoor.cfg\",\"door open time\",doorOpenTime)!@#&            configWrite(\"System/CodeDoor.cfg\",\"hide password\",hidePassword)!@#&end!@#& !@#&-- !@#&gui()!@#& !@#&--  !@#&while true do!@#&            --    !@#&            rs.setOutput(redstoneSide,false)!@#&            rs.setOutput(redstoneSideOnWrongPassword,false)!@#&     !@#&            local event,side,x,y = os.pullEvent()!@#&            if event == \"monitor_touch\" then!@#&                        --    !@#&                        for key,val in pairs(Obj) do!@#&                                    --      !@#&                                    if x==Obj[key][\"x\"] and y==Obj[key][\"y\"] then!@#&                                                --  !@#&                                                drawButton(key,colors.white,colors.green)!@#&                                                sleep(buttonPressTime)!@#&                                                drawButton(key,colors.black,colors.white)!@#&                 !@#&                                                --,     -    !@#&                                                if key == \"C\" then!@#&                                                            inputCode = {}!@#&                                                            if mode == \"edit\" then!@#&                                                                        drawTab(colors.white,colors.orange)!@#&                                                            else!@#&                                                                        drawTab(colors.white,colors.black)!@#&                                                            end!@#&                     !@#&                                                elseif key == \"#\" then!@#&                                                            --       !@#&                                                            local inputPass = \"\"!@#&                                                            for i=1,#inputCode do!@#&                                                                        inputPass = inputPass..inputCode[i]!@#&                                                            end!@#&                     !@#&                                                            -- !@#&                                                            if mode == \"edit\" then!@#&                                                                        -- !@#&                                                                        password = inputPass!@#&                                                                        configWrite(\"System/CodeDoor.cfg\",\"password\",password)!@#&                                                                        inputCode = {}!@#&                                                                        term.setCursorPos(3,1)!@#&                                                                        term.setBackgroundColor(colors.orange)!@#&                                                                        term.clearLine()!@#&                                                                        term.setTextColor(colors.white)!@#&                                                                        term.write(\"Ok!\")!@#&                         !@#&                                                                        sleep(2)!@#&                         !@#&                                                                        drawTab(colors.white,colors.black)!@#&                                                                        mode = \"default\"!@#&                                                            else!@#&                                                                        --     !@#&                                                                        if inputPass == password then!@#&                                                                                    drawTab(colors.white,colors.green)!@#&                                                                                    rs.setOutput(redstoneSide,true)!@#&                                                                                    rs.setOutput(redstoneSideOnWrongPassword,false)!@#&                             !@#&                                                                                    --    !@#&                                                                                    changePasswordTimer = os.startTimer(tonumber(doorOpenTime))!@#&                                                                                    while true do!@#&                                                                                                local event2,side2,x2,y2 = os.pullEvent()!@#&                                                                                                --   ,    !@#&                                                                                                if event2 == \"timer\" then!@#&                                                                                                            if side2 == changePasswordTimer then!@#&                                                                                                                        break!@#&                                                                                                            end!@#&                                                                                                    --   \"\",     !@#&                                                                                                elseif event2 == \"monitor_touch\" then!@#&                                                                                                            if x2==Obj[\"C\"][\"x\"] and y2==Obj[\"C\"][\"y\"] then!@#&                                                                                                                        drawButton(\"C\",colors.white,colors.green)!@#&                                                                                                                        sleep(buttonPressTime)!@#&                                                                                                                        drawButton(\"C\",colors.black,colors.white)!@#&                                                                                                                        mode = \"edit\"!@#&                                                                                                                        os.queueEvent(\"timer\",changePasswordTimer)!@#&                                                                                                            end!@#&                                                                                                end    !@#&                                                                                    end!@#&                             !@#&                                                                                    --     !@#&                                                                                    inputCode = {}!@#&                                                                                    rs.setOutput(redstoneSide,false)!@#&                             !@#&                                                                                    --        !@#&                                                                                    if mode == \"edit\" then!@#&                                                                                                drawTab(colors.white,colors.orange)!@#&                                                                                    else!@#&                                                                                                drawTab(colors.white,colors.black)!@#&                                                                                    end!@#&                                                                            --   !@#&                                                                        else!@#&                                                                                    drawTab(colors.white,colors.red)!@#&                                                                                    rs.setOutput(redstoneSide,false)!@#&                                                                                    rs.setOutput(redstoneSideOnWrongPassword,true)!@#&                                                                                    sleep(3)!@#&                                                                                    rs.setOutput(redstoneSideOnWrongPassword,false)!@#&                                                                                    inputCode = {}!@#&                                                                                    drawTab(colors.white,colors.black)!@#&                                                                        end!@#&                                                            end!@#&                                                    --   !@#&                                                else!@#&                                                            if #inputCode < 5 then!@#&                                                                        inputCode[#inputCode+1] = key!@#&                                                                        if mode == \"edit\" then!@#&                                                                                    drawTab(colors.white,colors.orange)!@#&                                                                        else!@#&                                                                                    drawTab(colors.white,colors.black)!@#&                                                                        end!@#&                                                            end!@#&                                                end!@#&                                                --    !@#&                                                break!@#&                                    end!@#&                        end!@#&         !@#&                --   ENTER!@#&            elseif event == \"key\" and side == 28 then!@#&                        break!@#&            end!@#&end!@#& !@#&clearScreen(colors.black)!@#&term.setTextColor(colors.white)!@#& !@#&term.redirect(term.native())!@#& !@#&clearScreen(colors.black)!@#&term.setTextColor(colors.white)!@#&term.setCursorPos(1,1)",["SensorView"]="os.loadAPI(\"SpeedAPI/windows\")!@#&os.loadAPI(\"SpeedAPI/graph\")!@#&os.loadAPI(\"SpeedAPI/sensor\")!@#&!@#&local sideNames = rs.getSides()!@#&windows.clearScreen(colors.white)!@#&hui = windows.input(\"auto\", \"auto\", \"Additional side\", 10, {\"Side\", \"\"})!@#&windows.clearScreen(colors.black)!@#&table.insert(sideNames,  hui[1])!@#&local sensorSides = {}!@#&local sideSelection, targetSelection, targetOffset, detailOffset = 1, 1, 1, 1!@#&local detailLines, targetNameMenuTable!@#&local graphing, graphSide, graphTarget, graphMatch, graphInstance = false!@#&!@#&local function checkSensors()!@#&	for _,side in ipairs(sideNames) do!@#&		if peripheral.getType(side) == \"sensor\" then!@#&			sensorSides[side] = true!@#&		else!@#&			sensorSides[side] = false!@#&		end	!@#&	end!@#&end!@#&!@#&local function writeEntry(menuTable, index, cursorPos)!@#&	if cursorPos == index then!@#&		term.setBackgroundColor(term.isColor() and colors.blue or colors.white)!@#&		term.setTextColor(term.isColor() and colors.white or colors.black)!@#&		term.write(string.sub(menuTable[index], 1, 16))!@#&		term.setBackgroundColor(colors.black)!@#&		term.setTextColor(colors.white)!@#&	else!@#&		term.write(string.sub(menuTable[index], 1, 16))!@#&	end!@#&end!@#&!@#&local function toLines(currTable, linesTable, trackingTable, depth)!@#&	for k,v in pairs(currTable) do!@#&		if type(v) == \"table\" then!@#&			table.insert(linesTable, string.rep(\" \", depth)..tostring(k)..\":\")!@#&			if trackingTable[v] then!@#&				table.insert(linesTable, string.rep(\" \", depth + 1)..\"<Cyclic Reference: \"..trackingTable[v]..\">\")!@#&			else!@#&				trackingTable[v] = #linesTable!@#&				toLines(v, linesTable, trackingTable, depth + 1)!@#&			end!@#&		else!@#&			table.insert(linesTable, string.rep(\" \", depth)..tostring(k)..\"> \"..tostring(v))!@#&		end!@#&	end!@#&end!@#&!@#&local function drawDividerDown(startY)!@#&	local w, h = term.getSize()!@#&	for i=startY, h do!@#&		term.setCursorPos(17, i)!@#&		term.write(\"|\")!@#&	end!@#&end!@#&!@#&local function redraw()!@#&	w, h = term.getSize()!@#&	--pre-fetch sensor targets and detailed target information.!@#&	local targetNames = nil!@#&	detailLines = {}!@#&	checkSensors()!@#&	if sensorSides[sideNames[sideSelection]] then!@#&		targetNames = sensor.call(sideNames[sideSelection], \"getSensorName\") and sensor.call(sideNames[sideSelection], \"getTargets\")!@#&		targetNameMenuTable = {}!@#&		if targetNames then!@#&			for k,v in pairs(targetNames) do!@#&				table.insert(targetNameMenuTable, k)!@#&			end!@#&			table.sort(targetNameMenuTable)!@#&			if #targetNameMenuTable > 0 then!@#&				toLines(sensor.call(sideNames[sideSelection], \"getTargetDetails\", targetNameMenuTable[targetSelection]), detailLines, {}, 0)!@#&			end!@#&		end!@#&	end!@#&	--now draw the screen.!@#&	term.clear()!@#&	term.setCursorPos(1, 1)!@#&	term.write(\"=Sensor Info Viewer=\"..string.rep(\"=\", w - 20))!@#&	term.setCursorPos(1, 2)!@#&	for n,side in ipairs(sideNames) do!@#&		if n == sideSelection then!@#&			term.setBackgroundColor(term.isColor() and colors.blue or colors.white)!@#&			term.setTextColor(term.isColor() and colors.white or colors.black)!@#&			term.write(side)!@#&			term.setBackgroundColor(colors.black)!@#&			term.setTextColor(colors.white)!@#&			term.write(\" \")!@#&		else!@#&			term.write(side..\" \")!@#&		end!@#&	end!@#&	term.setCursorPos(1, 3)!@#&	term.write(\"-Targets--------+-Info-\"..string.rep(\"-\", w - 23))!@#&!@#&	if targetNames then!@#&		--make sure we have valid targets, even if we have a valid sensor.!@#&		if #targetNameMenuTable > 0 then!@#&			term.setCursorPos(1, 4)!@#&			if targetOffset > 1 then!@#&				term.write(\"/\\\\\")!@#&			else!@#&				writeEntry(targetNameMenuTable, 1, targetSelection)	!@#&			end!@#&			--h-5 to leave room for top and bottom entries.!@#&			for i=1, math.min(h - 5, #targetNameMenuTable - 1) do!@#&				term.setCursorPos(1, i + 4)!@#&				writeEntry(targetNameMenuTable, targetOffset + i, targetSelection)!@#&			end!@#&			if #targetNameMenuTable >= h then!@#&				term.setCursorPos(1, h)!@#&				if #targetNameMenuTable > targetOffset + h - 4 then!@#&					term.write(\"\\\\/\")!@#&				else!@#&					writeEntry(targetNameMenuTable, #targetNameMenuTable, targetSelection)!@#&				end!@#&			end!@#&!@#&			--detailed info.!@#&			for i=1, math.min(h - 3, #detailLines - ((detailOffset - 1) * (h - 3))) do!@#&				term.setCursorPos(17, i + 3)!@#&				term.write(\"|\"..string.sub(detailLines[(detailOffset - 1) * (h - 3) + i], 1, w - 17))!@#&			end!@#&			local currX, currY = term.getCursorPos()!@#&			drawDividerDown(currY + 1)!@#&		else!@#&			term.setCursorPos(1, 4)!@#&			term.write(\"No targets found|\")!@#&			drawDividerDown(5)!@#&		end!@#&	else!@#&		if peripheral.getType(sideNames[sideSelection]) == \"sensor\" then!@#&			term.setCursorPos(1, 4)!@#&			term.write(\"No sensor card  |\")!@#&			drawDividerDown(5)!@#&		else!@#&			term.setCursorPos(1, 4)!@#&			term.write(\"No sensor found |\")!@#&			drawDividerDown(5)!@#&		end!@#&	end!@#&	term.setCursorPos(1, h)!@#&end!@#&!@#&local function findGraphMatch(currTable, target, matchCount, trackingTable)!@#&	for k, v in pairs(currTable) do!@#&		if type(v) == \"table\" then!@#&			if trackingTable[v] then return false end!@#&			trackingTable[v] = true!@#&			ret, path, count = findGraphMatch(v, target, matchCount, trackingTable)!@#&			if ret and path then!@#&				return ret, tostring(k)..\"-\"..path!@#&			elseif count then!@#&				matchCount = count!@#&			end!@#&		elseif type(v) == \"number\" then!@#&			matchCount = matchCount + 1!@#&			if matchCount == target then return v, tostring(k) end!@#&		end!@#&	end!@#&	return false, nil, matchCount!@#&end!@#&!@#&local function createGraph(targetNum)!@#&	local monSide = \"\"!@#&	for k, side in ipairs(rs.getSides()) do!@#&		if peripheral.getType(side) == \"monitor\" then!@#&			monSide = side!@#&			break!@#&		end!@#&	end!@#&	if monSide and targetNum >= 1 and findGraphMatch(sensor.call(graphSide, \"getTargetDetails\", graphTarget), targetNum, 0, {}) then!@#&		graphMatch = targetNum!@#&		local val, name = findGraphMatch(sensor.call(graphSide, \"getTargetDetails\", graphTarget), targetNum, 0, {})!@#&		local updateFunc = function() return (findGraphMatch(sensor.call(graphSide, \"getTargetDetails\", graphTarget), graphMatch, 0, {})) end!@#&		graphInst = graph.new(peripheral.wrap(monSide), updateFunc, name)!@#&		return graphInst!@#&	end!@#&end!@#&!@#&while true do!@#&	redraw()!@#&	local e, p1 = os.pullEvent()!@#&	if e == \"key\" then!@#&		local w, h = term.getSize()!@#&		if p1 == 203 then!@#&			--left, selects previous side!@#&			if sideSelection > 1 then!@#&				sideSelection = sideSelection - 1!@#&				targetSelection = 1!@#&				targetOffset = 1!@#&				detailOffset = 1!@#&				detailLines = nil!@#&			end!@#&		elseif p1 == 205 then!@#&			--right, selects next side!@#&			if true then!@#&				sideSelection = sideSelection + 1!@#&				targetSelection = 1!@#&				targetOffset = 1!@#&				detailOffset = 1!@#&				detailLines = nil!@#&			end!@#&		elseif p1 == 200 then!@#&			--up, selects previous target, adjusting offset if necessary.!@#&			if targetSelection > 1 then!@#&				if targetSelection - targetOffset + 1 == 2 and targetOffset > 1 then!@#&					targetOffset = targetOffset - 1!@#&				end!@#&				targetSelection = targetSelection - 1!@#&				detailOffset = 1!@#&				detailLines = nil!@#&			end!@#&		elseif p1 == 208 then!@#&			--down, selects next target, adjusting offset if necessary.!@#&			if targetNameMenuTable and targetSelection < #targetNameMenuTable then!@#&				if targetSelection - targetOffset + 1 == h - 4 and targetSelection ~= #targetNameMenuTable - 1 then!@#&					targetOffset = targetOffset + 1!@#&				end!@#&				targetSelection = targetSelection + 1!@#&				detailOffset = 1!@#&				detailLines = nil!@#&			end!@#&		elseif p1 == 201 then!@#&			--pgup, moves detail!@#&			if detailOffset > 1 then!@#&				detailOffset = detailOffset - 1!@#&			end!@#&		elseif p1 == 209 then!@#&			--pgdown, moves detail!@#&			local w, h = term.getSize()!@#&			if detailLines and detailOffset < math.ceil(#detailLines / (h - 3)) then!@#&				detailOffset = detailOffset + 1!@#&			end!@#&		--and now, since redraw() will eat char events with the change to sensor.call:!@#&		elseif p1 == 31 then --s!@#&			if detailLines then!@#&				local fileHandle = io.open(\"sensorDetailed-\"..sideNames[sideSelection]..\"-\"..targetNameMenuTable[targetSelection], \"w\")!@#&				if fileHandle then!@#&					for k, v in ipairs(detailLines) do!@#&						fileHandle:write(v..\"\\n\")!@#&					end!@#&					fileHandle:close()!@#&				end!@#&			end!@#&		elseif p1 == 16 then --q!@#&			sleep(0)!@#&			return!@#&		elseif p1 == 34 then --g!@#&			if graph then!@#&				graphing = not graphing!@#&				if not graphing then!@#&					graphSide = nil!@#&					graphTarget = nil!@#&					graphUpdate = nil!@#&				else!@#&					graphSide = sideNames[sideSelection]!@#&					graphTarget = targetNameMenuTable[targetSelection]!@#&					graphInstance = createGraph(1)!@#&					graphUpdate = os.startTimer(0.5)!@#&				end!@#&			end!@#&		elseif p1 == 49 then --n!@#&			if graphing then!@#&				local newGraph = createGraph(graphMatch + 1)!@#&				if newGraph then!@#&					graphInstance = newGraph!@#&					graphUpdate = os.startTimer(0.5)!@#&				end!@#&			end!@#&		elseif p1 == 25 then --p!@#&			if graphing then!@#&				local newGraph = createGraph(graphMatch - 1)!@#&				if newGraph then!@#&					graphInstance = newGraph!@#&					graphUpdate = os.startTimer(0.5)!@#&				end!@#&			end!@#&		end!@#&	elseif e == \"timer\" then!@#&		if p1 == graphUpdate then!@#&			graphInstance:draw()!@#&			graphUpdate = os.startTimer(0.5)!@#&		end!@#&	end!@#&end",["SpeedCode"]="--  -------- Variables!@#&!@#&os.loadAPI(\"/SpeedAPI/lddfm\")!@#&!@#&-- Version!@#&local version = \"1.0\"!@#&local args = {...}!@#&!@#&-- Editing!@#&local w, h = term.getSize()!@#&local tabWidth = 2!@#&!@#&local autosaveInterval = 20!@#&local allowEditorEvent = true!@#&local keyboardShortcutTimeout = 0.4!@#&!@#&-- Clipboard!@#&local clipboard = nil!@#&!@#&-- Theme!@#&local theme = {}!@#&!@#&-- Language!@#&local languages = {}!@#&local curLanguage = {}!@#&!@#&-- Events!@#&local event_distract = \"luaide_distractionEvent\"!@#&!@#&-- Locations!@#&local updateURL = \"https://raw.github.com/GravityScore/LuaIDE/master/luaide.lua\"!@#&local ideLocation = \"/\" .. shell.getRunningProgram()!@#&local themeLocation = \"/.LuaIDE-Theme\"!@#&!@#&local function isAdvanced() return term.isColor and term.isColor() end!@#&!@#&!@#&--  -------- Utilities!@#&!@#&local function modRead(properties)!@#&	local w, h = term.getSize()!@#&	local defaults = {replaceChar = nil, history = nil, visibleLength = nil, textLength = nil, !@#&		liveUpdates = nil, exitOnKey = nil}!@#&	if not properties then properties = {} end!@#&	for k, v in pairs(defaults) do if not properties[k] then properties[k] = v end end!@#&	if properties.replaceChar then properties.replaceChar = properties.replaceChar:sub(1, 1) end!@#&	if not properties.visibleLength then properties.visibleLength = w end!@#&!@#&	local sx, sy = term.getCursorPos()!@#&	local line = \"\"!@#&	local pos = 0!@#&	local historyPos = nil!@#&!@#&	local function redraw(repl)!@#&		local scroll = 0!@#&		if properties.visibleLength and sx + pos > properties.visibleLength + 1 then !@#&			scroll = (sx + pos) - (properties.visibleLength + 1)!@#&		end!@#&!@#&		term.setCursorPos(sx, sy)!@#&		local a = repl or properties.replaceChar!@#&		if a then term.write(string.rep(a, line:len() - scroll))!@#&		else term.write(line:sub(scroll + 1, -1)) end!@#&		term.setCursorPos(sx + pos - scroll, sy)!@#&	end!@#&!@#&	local function sendLiveUpdates(event, ...)!@#&		if type(properties.liveUpdates) == \"function\" then!@#&			local ox, oy = term.getCursorPos()!@#&			local a, data = properties.liveUpdates(line, event, ...)!@#&			if a == true and data == nil then!@#&				term.setCursorBlink(false)!@#&				return line!@#&			elseif a == true and data ~= nil then!@#&				term.setCursorBlink(false)!@#&				return data!@#&			end!@#&			term.setCursorPos(ox, oy)!@#&		end!@#&	end!@#&!@#&	term.setCursorBlink(true)!@#&	while true do!@#&		local e, but, x, y, p4, p5 = os.pullEvent()!@#&!@#&		if e == \"char\" then!@#&			local s = false!@#&			if properties.textLength and line:len() < properties.textLength then s = true!@#&			elseif not properties.textLength then s = true end!@#&!@#&			local canType = true!@#&			if not properties.grantPrint and properties.refusePrint then!@#&				local canTypeKeys = {}!@#&				if type(properties.refusePrint) == \"table\" then!@#&					for _, v in pairs(properties.refusePrint) do!@#&						table.insert(canTypeKeys, tostring(v):sub(1, 1))!@#&					end!@#&				elseif type(properties.refusePrint) == \"string\" then!@#&					for char in properties.refusePrint:gmatch(\".\") do!@#&						table.insert(canTypeKeys, char)!@#&					end!@#&				end!@#&				for _, v in pairs(canTypeKeys) do if but == v then canType = false end end!@#&			elseif properties.grantPrint then!@#&				canType = false!@#&				local canTypeKeys = {}!@#&				if type(properties.grantPrint) == \"table\" then!@#&					for _, v in pairs(properties.grantPrint) do!@#&						table.insert(canTypeKeys, tostring(v):sub(1, 1))!@#&					end!@#&				elseif type(properties.grantPrint) == \"string\" then!@#&					for char in properties.grantPrint:gmatch(\".\") do!@#&						table.insert(canTypeKeys, char)!@#&					end!@#&				end!@#&				for _, v in pairs(canTypeKeys) do if but == v then canType = true end end!@#&			end!@#&!@#&			if s and canType then!@#&				line = line:sub(1, pos) .. but .. line:sub(pos + 1, -1)!@#&				pos = pos + 1!@#&				redraw()!@#&			end!@#&		elseif e == \"key\" then!@#&			if but == keys.enter then break!@#&			elseif but == keys.left then if pos > 0 then pos = pos - 1 redraw() end!@#&			elseif but == keys.right then if pos < line:len() then pos = pos + 1 redraw() end!@#&			elseif (but == keys.up or but == keys.down) and properties.history then!@#&				redraw(\" \")!@#&				if but == keys.up then!@#&					if historyPos == nil and #properties.history > 0 then !@#&						historyPos = #properties.history!@#&					elseif historyPos > 1 then !@#&						historyPos = historyPos - 1!@#&					end!@#&				elseif but == keys.down then!@#&					if historyPos == #properties.history then historyPos = nil!@#&					elseif historyPos ~= nil then historyPos = historyPos + 1 end!@#&				end!@#&!@#&				if properties.history and historyPos then!@#&					line = properties.history[historyPos]!@#&					pos = line:len()!@#&				else!@#&					line = \"\"!@#&					pos = 0!@#&				end!@#&!@#&				redraw()!@#&				local a = sendLiveUpdates(\"history\")!@#&				if a then return a end!@#&			elseif but == keys.backspace and pos > 0 then!@#&				redraw(\" \")!@#&				line = line:sub(1, pos - 1) .. line:sub(pos + 1, -1)!@#&				pos = pos - 1!@#&				redraw()!@#&				local a = sendLiveUpdates(\"delete\")!@#&				if a then return a end!@#&			elseif but == keys.home then!@#&				pos = 0!@#&				redraw()!@#&			elseif but == keys.delete and pos < line:len() then!@#&				redraw(\" \")!@#&				line = line:sub(1, pos) .. line:sub(pos + 2, -1)!@#&				redraw()!@#&				local a = sendLiveUpdates(\"delete\")!@#&				if a then return a end!@#&			elseif but == keys[\"end\"] then!@#&				pos = line:len()!@#&				redraw()!@#&			elseif properties.exitOnKey then !@#&				if but == properties.exitOnKey or (properties.exitOnKey == \"control\" and !@#&						(but == 29 or but == 157)) then !@#&					term.setCursorBlink(false)!@#&					return nil!@#&				end!@#&			end!@#&		end!@#&		local a = sendLiveUpdates(e, but, x, y, p4, p5)!@#&		if a then return a end!@#&	end!@#&!@#&	term.setCursorBlink(false)!@#&	if line ~= nil then line = line:gsub(\"^%s*(.-)%s*$\", \"%1\") end!@#&	return line!@#&end!@#&!@#&!@#&--  -------- Themes!@#&!@#&local defaultTheme = {!@#&	background = \"gray\",!@#&	backgroundHighlight = \"lightGray\",!@#&	prompt = \"cyan\",!@#&	promptHighlight = \"lightBlue\",!@#&	err = \"red\",!@#&	errHighlight = \"pink\",!@#&!@#&	editorBackground = \"black\",!@#&	editorLineHightlight = \"gray\",!@#&	editorLineNumbers = \"gray\",!@#&	editorLineNumbersHighlight = \"lightGray\",!@#&	editorError = \"pink\",!@#&	editorErrorHighlight = \"red\",!@#&!@#&	textColor = \"white\",!@#&	conditional = \"yellow\",!@#&	constant = \"orange\",!@#&	[\"function\"] = \"magenta\",!@#&	string = \"cyan\",!@#&	comment = \"lime\"!@#&}!@#&!@#&local normalTheme = {!@#&	background = \"black\",!@#&	backgroundHighlight = \"black\",!@#&	prompt = \"black\",!@#&	promptHighlight = \"black\",!@#&	err = \"black\",!@#&	errHighlight = \"black\",!@#&!@#&	editorBackground = \"black\",!@#&	editorLineHightlight = \"black\",!@#&	editorLineNumbers = \"black\",!@#&	editorLineNumbersHighlight = \"white\",!@#&	editorError = \"black\",!@#&	editorErrorHighlight = \"black\",!@#&!@#&	textColor = \"white\",!@#&	conditional = \"white\",!@#&	constant = \"white\",!@#&	[\"function\"] = \"white\",!@#&	string = \"cyan\",!@#&	comment = \"white\"!@#&}!@#&!@#&local availableThemes = {!@#&	{\"Water (Default)\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/default.txt\"},!@#&	{\"Fire\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/fire.txt\"},!@#&	{\"Sublime Text 2\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/st2.txt\"},!@#&	{\"Midnight\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/midnight.txt\"},!@#&	{\"TheOriginalBIT\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/bit.txt\"},!@#&	{\"Superaxander\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/superaxander.txt\"},!@#&	{\"Forest\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/forest.txt\"},!@#&	{\"Night\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/night.txt\"},!@#&	{\"Original\", \"https://raw.github.com/GravityScore/LuaIDE/master/themes/original.txt\"},!@#&}!@#&!@#&local function loadTheme(path)!@#&	local f = io.open(path)!@#&	local l = f:read(\"*l\")!@#&	local config = {}!@#&	while l ~= nil do!@#&		local k, v = string.match(l, \"^(%a+)=(%a+)\")!@#&		if k and v then config[k] = v end!@#&		l = f:read(\"*l\")!@#&	end!@#&	f:close()!@#&	return config!@#&end!@#&!@#&-- Load Theme!@#&if isAdvanced() then theme = defaultTheme!@#&else theme = normalTheme end!@#&!@#&!@#&--  -------- Drawing!@#&!@#&local function centerPrint(text, ny)!@#&	if type(text) == \"table\" then for _, v in pairs(text) do centerPrint(v) end!@#&	else!@#&		local x, y = term.getCursorPos()!@#&		local w, h = term.getSize()!@#&		term.setCursorPos(w/2 - text:len()/2 + (#text % 2 == 0 and 1 or 0), ny or y)!@#&		print(text)!@#&	end!@#&end!@#&!@#&local function title(t)!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.background])!@#&	term.clear()!@#&!@#&	term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&	for i = 2, 4 do term.setCursorPos(1, i) term.clearLine() end!@#&	term.setCursorPos(3, 3)!@#&	term.write(t)!@#&end!@#&!@#&local function centerRead(wid, begt)!@#&	local function liveUpdate(line, e, but, x, y, p4, p5)!@#&		if isAdvanced() and e == \"mouse_click\" and x >= w/2 - wid/2 and x <= w/2 - wid/2 + 10 !@#&				and y >= 13 and y <= 15 then!@#&			return true, \"\"!@#&		end!@#&	end!@#&!@#&	if not begt then begt = \"\" end!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.promptHighlight])!@#&	for i = 8, 10 do!@#&		term.setCursorPos(w/2 - wid/2, i)!@#&		term.write(string.rep(\" \", wid))!@#&	end!@#&!@#&	if isAdvanced() then!@#&		term.setBackgroundColor(colors[theme.errHighlight])!@#&		for i = 13, 15 do!@#&			term.setCursorPos(w/2 - wid/2 + 1, i)!@#&			term.write(string.rep(\" \", 10))!@#&		end!@#&		term.setCursorPos(w/2 - wid/2 + 2, 14)!@#&		term.write(\"> Cancel\")!@#&	end!@#&!@#&	term.setBackgroundColor(colors[theme.promptHighlight])!@#&	term.setCursorPos(w/2 - wid/2 + 1, 9)!@#&	term.write(\"> \" .. begt)!@#&	return modRead({visibleLength = w/2 + wid/2, liveUpdates = liveUpdate})!@#&end!@#&!@#&!@#&--  -------- Prompt!@#&!@#&local function prompt(list, dir, isGrid)!@#&	local function draw(sel)!@#&		for i, v in ipairs(list) do!@#&			if i == sel then term.setBackgroundColor(v.highlight or colors[theme.promptHighlight])!@#&			else term.setBackgroundColor(v.bg or colors[theme.prompt]) end!@#&			term.setTextColor(v.tc or colors[theme.textColor])!@#&			for i = -1, 1 do!@#&				term.setCursorPos(v[2], v[3] + i)!@#&				term.write(string.rep(\" \", v[1]:len() + 4))!@#&			end!@#&!@#&			term.setCursorPos(v[2], v[3])!@#&			if i == sel then!@#&				term.setBackgroundColor(v.highlight or colors[theme.promptHighlight])!@#&				term.write(\" > \")!@#&			else term.write(\" - \") end!@#&			term.write(v[1] .. \" \")!@#&		end!@#&	end!@#&!@#&	local key1 = dir == \"horizontal\" and 203 or 200!@#&	local key2 = dir == \"horizontal\" and 205 or 208!@#&	local sel = 1!@#&	draw(sel)!@#&!@#&	while true do!@#&		local e, but, x, y = os.pullEvent()!@#&		if e == \"key\" and but == 28 then!@#&			return list[sel][1]!@#&		elseif e == \"key\" and but == key1 and sel > 1 then!@#&			sel = sel - 1!@#&			draw(sel)!@#&		elseif e == \"key\" and but == key2 and ((err == true and sel < #list - 1) or (sel < #list)) then!@#&			sel = sel + 1!@#&			draw(sel)!@#&		elseif isGrid and e == \"key\" and but == 203 and sel > 2 then!@#&			sel = sel - 2!@#&			draw(sel)!@#&		elseif isGrid and e == \"key\" and but == 205 and sel < 3 then!@#&			sel = sel + 2!@#&			draw(sel)!@#&		elseif e == \"mouse_click\" then!@#&			for i, v in ipairs(list) do!@#&				if x >= v[2] - 1 and x <= v[2] + v[1]:len() + 3 and y >= v[3] - 1 and y <= v[3] + 1 then!@#&					return list[i][1]!@#&				end!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&local function scrollingPrompt(list)!@#&	local function draw(items, sel, loc)!@#&		for i, v in ipairs(items) do!@#&			local bg = colors[theme.prompt]!@#&			local bghigh = colors[theme.promptHighlight]!@#&			if v:find(\"Back\") or v:find(\"Return\") then!@#&				bg = colors[theme.err]!@#&				bghigh = colors[theme.errHighlight]!@#&			end!@#&!@#&			if i == sel then term.setBackgroundColor(bghigh)!@#&			else term.setBackgroundColor(bg) end!@#&			term.setTextColor(colors[theme.textColor])!@#&			for x = -1, 1 do!@#&				term.setCursorPos(3, (i * 4) + x + 4)!@#&				term.write(string.rep(\" \", w - 13))!@#&			end!@#&!@#&			term.setCursorPos(3, i * 4 + 4)!@#&			if i == sel then!@#&				term.setBackgroundColor(bghigh)!@#&				term.write(\" > \")!@#&			else term.write(\" - \") end!@#&			term.write(v .. \" \")!@#&		end!@#&	end!@#&!@#&	local function updateDisplayList(items, loc, len)!@#&		local ret = {}!@#&		for i = 1, len do!@#&			local item = items[i + loc - 1]!@#&			if item then table.insert(ret, item) end!@#&		end!@#&		return ret!@#&	end!@#&!@#&	-- Variables!@#&	local sel = 1!@#&	local loc = 1!@#&	local len = 3!@#&	local disList = updateDisplayList(list, loc, len)!@#&	draw(disList, sel, loc)!@#&!@#&	-- Loop!@#&	while true do!@#&		local e, key, x, y = os.pullEvent()!@#&!@#&		if e == \"mouse_click\" then!@#&			for i, v in ipairs(disList) do!@#&				if x >= 3 and x <= w - 11 and y >= i * 4 + 3 and y <= i * 4 + 5 then return v end!@#&			end!@#&		elseif e == \"key\" and key == 200 then!@#&			if sel > 1 then!@#&				sel = sel - 1!@#&				draw(disList, sel, loc)!@#&			elseif loc > 1 then!@#&				loc = loc - 1!@#&				disList = updateDisplayList(list, loc, len)!@#&				draw(disList, sel, loc)!@#&			end!@#&		elseif e == \"key\" and key == 208 then!@#&			if sel < len then!@#&				sel = sel + 1!@#&				draw(disList, sel, loc)!@#&			elseif loc + len - 1 < #list then!@#&				loc = loc + 1!@#&				disList = updateDisplayList(list, loc, len)!@#&				draw(disList, sel, loc)!@#&			end!@#&		elseif e == \"mouse_scroll\" then!@#&			os.queueEvent(\"key\", key == -1 and 200 or 208)!@#&		elseif e == \"key\" and key == 28 then!@#&			return disList[sel]!@#&		end!@#&	end!@#&end!@#&!@#&function monitorKeyboardShortcuts()!@#&	local ta, tb = nil, nil!@#&	local allowChar = false!@#&	local shiftPressed = false!@#&	while true do!@#&		local event, char = os.pullEvent()!@#&		if event == \"key\" and (char == 42 or char == 52) then!@#&			shiftPressed = true!@#&			tb = os.startTimer(keyboardShortcutTimeout)!@#&		elseif event == \"key\" and (char == 29 or char == 157 or char == 219 or char == 220) then!@#&			allowEditorEvent = false!@#&			allowChar = true!@#&			ta = os.startTimer(keyboardShortcutTimeout)!@#&		elseif event == \"key\" and allowChar then!@#&			local name = nil!@#&			for k, v in pairs(keys) do!@#&				if v == char then!@#&					if shiftPressed then os.queueEvent(\"shortcut\", \"ctrl shift\", k:lower())!@#&					else os.queueEvent(\"shortcut\", \"ctrl\", k:lower()) end!@#&					sleep(0.005)!@#&					allowEditorEvent = true!@#&				end!@#&			end!@#&			if shiftPressed then os.queueEvent(\"shortcut\", \"ctrl shift\", char)!@#&			else os.queueEvent(\"shortcut\", \"ctrl\", char) end!@#&		elseif event == \"timer\" and char == ta then!@#&			allowEditorEvent = true!@#&			allowChar = false!@#&		elseif event == \"timer\" and char == tb then!@#&			shiftPressed = false!@#&		end!@#&	end!@#&end!@#&!@#&!@#&--  -------- Saving and Loading!@#&!@#&local function download(url, path)!@#&	for i = 1, 3 do!@#&		local response = http.get(url)!@#&		if response then!@#&			local data = response.readAll()!@#&			response.close()!@#&			if path then!@#&				local f = io.open(path, \"w\")!@#&				f:write(data)!@#&				f:close()!@#&			end!@#&			return true!@#&		end!@#&	end!@#&!@#&	return false!@#&end!@#&!@#&local function saveFile(path, lines)!@#&	local dir = path:sub(1, path:len() - fs.getName(path):len())!@#&	if not fs.exists(dir) then fs.makeDir(dir) end!@#&	if not fs.isDir(path) and not fs.isReadOnly(path) then!@#&		local a = \"\"!@#&		for _, v in pairs(lines) do a = a .. v .. \"\\n\" end!@#&!@#&		local f = io.open(path, \"w\")!@#&		f:write(a)!@#&		f:close()!@#&		return true!@#&	else return false end!@#&end!@#&!@#&local function loadFile(path)!@#&	if not fs.exists(path) then!@#&		local dir = path:sub(1, path:len() - fs.getName(path):len())!@#&		if not fs.exists(dir) then fs.makeDir(dir) end!@#&		local f = io.open(path, \"w\")!@#&		f:write(\"\")!@#&		f:close()!@#&	end!@#&!@#&	local l = {}!@#&	if fs.exists(path) and not fs.isDir(path) then!@#&		local f = io.open(path, \"r\")!@#&		if f then!@#&			local a = f:read(\"*l\")!@#&			while a do!@#&				table.insert(l, a)!@#&				a = f:read(\"*l\")!@#&			end!@#&			f:close()!@#&		end!@#&	else return nil end!@#&!@#&	if #l < 1 then table.insert(l, \"\") end!@#&	return l!@#&end!@#&!@#&!@#&--  -------- Languages!@#&!@#&languages.lua = {}!@#&languages.brainfuck = {}!@#&languages.none = {}!@#&!@#&--  Lua!@#&!@#&languages.lua.helpTips = {!@#&	\"A function you tried to call doesn't exist.\",!@#&	\"You made a typo.\",!@#&	\"The index of an array is nil.\",!@#&	\"The wrong variable type was passed.\",!@#&	\"A function/variable doesn't exist.\",!@#&	\"You missed an 'end'.\",!@#&	\"You missed a 'then'.\",!@#&	\"You declared a variable incorrectly.\",!@#&	\"One of your variables is mysteriously nil.\"!@#&}!@#&!@#&languages.lua.defaultHelpTips = {!@#&	2, 5!@#&}!@#&!@#&languages.lua.errors = {!@#&	[\"Attempt to call nil.\"] = {1, 2},!@#&	[\"Attempt to index nil.\"] = {3, 2},!@#&	[\".+ expected, got .+\"] = {4, 2, 9},!@#&	[\"'end' expected\"] = {6, 2},!@#&	[\"'then' expected\"] = {7, 2},!@#&	[\"'=' expected\"] = {8, 2}!@#&}!@#&!@#&languages.lua.keywords = {!@#&	[\"and\"] = \"conditional\",!@#&	[\"break\"] = \"conditional\",!@#&	[\"do\"] = \"conditional\",!@#&	[\"else\"] = \"conditional\",!@#&	[\"elseif\"] = \"conditional\",!@#&	[\"end\"] = \"conditional\",!@#&	[\"for\"] = \"conditional\",!@#&	[\"function\"] = \"conditional\",!@#&	[\"if\"] = \"conditional\",!@#&	[\"in\"] = \"conditional\",!@#&	[\"local\"] = \"conditional\",!@#&	[\"not\"] = \"conditional\",!@#&	[\"or\"] = \"conditional\",!@#&	[\"repeat\"] = \"conditional\",!@#&	[\"return\"] = \"conditional\",!@#&	[\"then\"] = \"conditional\",!@#&	[\"until\"] = \"conditional\",!@#&	[\"while\"] = \"conditional\",!@#&!@#&	[\"true\"] = \"constant\",!@#&	[\"false\"] = \"constant\",!@#&	[\"nil\"] = \"constant\",!@#&!@#&	[\"print\"] = \"function\",!@#&	[\"write\"] = \"function\",!@#&	[\"sleep\"] = \"function\",!@#&	[\"pairs\"] = \"function\",!@#&	[\"ipairs\"] = \"function\",!@#&	[\"loadstring\"] = \"function\",!@#&	[\"loadfile\"] = \"function\",!@#&	[\"dofile\"] = \"function\",!@#&	[\"rawset\"] = \"function\",!@#&	[\"rawget\"] = \"function\",!@#&	[\"setfenv\"] = \"function\",!@#&	[\"getfenv\"] = \"function\",!@#&}!@#&!@#&languages.lua.parseError = function(e)!@#&	local ret = {filename = \"unknown\", line = -1, display = \"Unknown!\", err = \"\"}!@#&	if e and e ~= \"\" then!@#&		ret.err = e!@#&		if e:find(\":\") then!@#&			ret.filename = e:sub(1, e:find(\":\") - 1):gsub(\"^%s*(.-)%s*$\", \"%1\")!@#&			-- The \"\" is needed to circumvent a CC bug!@#&			e = (e:sub(e:find(\":\") + 1) .. \"\"):gsub(\"^%s*(.-)%s*$\", \"%1\")!@#&			if e:find(\":\") then!@#&				ret.line = e:sub(1, e:find(\":\") - 1)!@#&				e = e:sub(e:find(\":\") + 2):gsub(\"^%s*(.-)%s*$\", \"%1\") .. \"\"!@#&			end!@#&		end!@#&		ret.display = e:sub(1, 1):upper() .. e:sub(2, -1) .. \".\"!@#&	end!@#&!@#&	return ret!@#&end!@#&!@#&languages.lua.getCompilerErrors = function(code)!@#&	code = \"local function ee65da6af1cb6f63fee9a081246f2fd92b36ef2(...)\\n\\n\" .. code .. \"\\n\\nend\"!@#&	local fn, err = loadstring(code)!@#&	if not err then!@#&		local _, e = pcall(fn)!@#&		if e then err = e end!@#&	end!@#&!@#&	if err then!@#&		local a = err:find(\"]\", 1, true)!@#&		if a then err = \"string\" .. err:sub(a + 1, -1) end!@#&		local ret = languages.lua.parseError(err)!@#&		if tonumber(ret.line) then ret.line = tonumber(ret.line) end!@#&		return ret!@#&	else return languages.lua.parseError(nil) end!@#&end!@#&!@#&languages.lua.run = function(path, ar)!@#&	local fn, err = loadfile(path)!@#&	setfenv(fn, getfenv())!@#&	if not err then!@#&		_, err = pcall(function() fn(unpack(ar)) end)!@#&	end!@#&	return err!@#&end!@#&!@#&!@#&--  Brainfuck!@#&!@#&languages.brainfuck.helpTips = {!@#&	\"Well idk...\",!@#&	\"Isn't this the whole point of the language?\",!@#&	\"Ya know... Not being able to debug it?\",!@#&	\"You made a typo.\"!@#&}!@#&!@#&languages.brainfuck.defaultHelpTips = {!@#&	1, 2, 3!@#&}!@#&!@#&languages.brainfuck.errors = {!@#&	[\"No matching '['\"] = {1, 2, 3, 4}!@#&}!@#&!@#&languages.brainfuck.keywords = {}!@#&!@#&languages.brainfuck.parseError = function(e)!@#&	local ret = {filename = \"unknown\", line = -1, display = \"Unknown!\", err = \"\"}!@#&	if e and e ~= \"\" then!@#&		ret.err = e!@#&		ret.line = e:sub(1, e:find(\":\") - 1)!@#&		e = e:sub(e:find(\":\") + 2):gsub(\"^%s*(.-)%s*$\", \"%1\") .. \"\"!@#&		ret.display = e:sub(1, 1):upper() .. e:sub(2, -1) .. \".\"!@#&	end!@#&!@#&	return ret!@#&end!@#&!@#&languages.brainfuck.mapLoops = function(code)!@#&	-- Map loops!@#&	local loopLocations = {}!@#&	local loc = 1!@#&	local line = 1!@#&	for let in string.gmatch(code, \".\") do!@#&		if let == \"[\" then!@#&			loopLocations[loc] = true!@#&		elseif let == \"]\" then!@#&			local found = false!@#&			for i = loc, 1, -1 do !@#&				if loopLocations[i] == true then!@#&					loopLocations[i] = loc!@#&					found = true!@#&				end!@#&			end!@#&!@#&			if not found then!@#&				return line .. \": No matching '['\"!@#&			end!@#&		end!@#&!@#&		if let == \"\\n\" then line = line + 1 end!@#&		loc = loc + 1!@#&	end!@#&	return loopLocations!@#&end!@#&!@#&languages.brainfuck.getCompilerErrors = function(code)!@#&	local a = languages.brainfuck.mapLoops(code)!@#&	if type(a) == \"string\" then return languages.brainfuck.parseError(a)!@#&	else return languages.brainfuck.parseError(nil) end!@#&end!@#&!@#&languages.brainfuck.run = function(path)!@#&	-- Read from file!@#&	local f = io.open(path, \"r\")!@#&	local content = f:read(\"*a\")!@#&	f:close()!@#&!@#&	-- Define environment!@#&	local dataCells = {}!@#&	local dataPointer = 1!@#&	local instructionPointer = 1!@#&!@#&	-- Map loops!@#&	local loopLocations = languages.brainfuck.mapLoops(content)!@#&	if type(loopLocations) == \"string\" then return loopLocations end!@#&!@#&	-- Execute code!@#&	while true do!@#&		local let = content:sub(instructionPointer, instructionPointer)!@#&!@#&		if let == \">\" then!@#&			dataPointer = dataPointer + 1!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&		elseif let == \"<\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			dataPointer = dataPointer - 1!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&		elseif let == \"+\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			dataCells[tostring(dataPointer)] = dataCells[tostring(dataPointer)] + 1!@#&		elseif let == \"-\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			dataCells[tostring(dataPointer)] = dataCells[tostring(dataPointer)] - 1!@#&		elseif let == \".\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			if term.getCursorPos() >= w then print(\"\") end!@#&			write(string.char(math.max(1, dataCells[tostring(dataPointer)])))!@#&		elseif let == \",\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			term.setCursorBlink(true)!@#&			local e, but = os.pullEvent(\"char\")!@#&			term.setCursorBlink(false)!@#&			dataCells[tostring(dataPointer)] = string.byte(but)!@#&			if term.getCursorPos() >= w then print(\"\") end!@#&			write(but)!@#&		elseif let == \"/\" then!@#&			if not dataCells[tostring(dataPointer)] then dataCells[tostring(dataPointer)] = 0 end!@#&			if term.getCursorPos() >= w then print(\"\") end!@#&			write(dataCells[tostring(dataPointer)])!@#&		elseif let == \"[\" then!@#&			if dataCells[tostring(dataPointer)] == 0 then!@#&				for k, v in pairs(loopLocations) do!@#&					if k == instructionPointer then instructionPointer = v end!@#&				end!@#&			end!@#&		elseif let == \"]\" then!@#&			for k, v in pairs(loopLocations) do!@#&				if v == instructionPointer then instructionPointer = k - 1 end!@#&			end!@#&		end!@#&!@#&		instructionPointer = instructionPointer + 1!@#&		if instructionPointer > content:len() then print(\"\") break end!@#&	end!@#&end!@#&!@#&--  None!@#&!@#&languages.none.helpTips = {}!@#&languages.none.defaultHelpTips = {}!@#&languages.none.errors = {}!@#&languages.none.keywords = {}!@#&!@#&languages.none.parseError = function(err)!@#&	return {filename = \"\", line = -1, display = \"\", err = \"\"}!@#&end!@#&!@#&languages.none.getCompilerErrors = function(code)!@#&	return languages.none.parseError(nil)!@#&end!@#&!@#&languages.none.run = function(path) end!@#&!@#&!@#&-- Load language!@#&curLanguage = languages.lua!@#&!@#&!@#&--  -------- Run GUI!@#&!@#&local function viewErrorHelp(e)!@#&	title(\"SpeedCode - Error Help\")!@#&!@#&	local tips = nil!@#&	for k, v in pairs(curLanguage.errors) do!@#&		if e.display:find(k) then tips = v break end!@#&	end!@#&!@#&	term.setBackgroundColor(colors[theme.err])!@#&	for i = 6, 8 do!@#&		term.setCursorPos(5, i)!@#&		term.write(string.rep(\" \", 35))!@#&	end!@#&!@#&	term.setBackgroundColor(colors[theme.prompt])!@#&	for i = 10, 18 do!@#&		term.setCursorPos(5, i)!@#&		term.write(string.rep(\" \", 46))!@#&	end!@#&!@#&	if tips then!@#&		term.setBackgroundColor(colors[theme.err])!@#&		term.setCursorPos(6, 7)!@#&		term.write(\"Error Help\")!@#&!@#&		term.setBackgroundColor(colors[theme.prompt])!@#&		for i, v in ipairs(tips) do!@#&			term.setCursorPos(7, i + 10)!@#&			term.write(\"- \" .. curLanguage.helpTips[v])!@#&		end!@#&	else!@#&		term.setBackgroundColor(colors[theme.err])!@#&		term.setCursorPos(6, 7)!@#&		term.write(\"No Error Tips Available!\")!@#&!@#&		term.setBackgroundColor(colors[theme.prompt])!@#&		term.setCursorPos(6, 11)!@#&		term.write(\"There are no error tips available, but\")!@#&		term.setCursorPos(6, 12)!@#&		term.write(\"you could see if it was any of these:\")!@#&!@#&		for i, v in ipairs(curLanguage.defaultHelpTips) do!@#&			term.setCursorPos(7, i + 12)!@#&			term.write(\"- \" .. curLanguage.helpTips[v])!@#&		end!@#&	end!@#&!@#&	prompt({{\"Back\", w - 8, 7}}, \"horizontal\")!@#&end!@#&!@#&local function run(path, lines, useArgs)!@#&	local ar = {}!@#&	if useArgs then!@#&		title(\"S - Run \" .. fs.getName(path))!@#&		local s = centerRead(w - 13, fs.getName(path) .. \" \")!@#&		for m in string.gmatch(s, \"[^ \\t]+\") do ar[#ar + 1] = m:gsub(\"^%s*(.-)%s*$\", \"%1\") end!@#&	end!@#&	!@#&	saveFile(path, lines)!@#&	term.setCursorBlink(false)!@#&	term.setBackgroundColor(colors.black)!@#&	term.setTextColor(colors.white)!@#&	term.clear()!@#&	term.setCursorPos(1, 1)!@#&	local err = curLanguage.run(path, ar)!@#&!@#&	term.setBackgroundColor(colors.black)!@#&	print(\"\\n\")!@#&	if err then!@#&		if isAdvanced() then term.setTextColor(colors.red) end!@#&		centerPrint(\"The program has crashed!\")!@#&	end!@#&	term.setTextColor(colors.white)!@#&	centerPrint(\"Press any key to return to SpeedCode...\")!@#&	while true do!@#&		local e = os.pullEvent()!@#&		if e == \"key\" then break end!@#&	end!@#&!@#&	-- To prevent key from showing up in editor!@#&	os.queueEvent(event_distract)!@#&	os.pullEvent()!@#&!@#&	if err then!@#&		if curLanguage == languages.lua and err:find(\"]\") then!@#&			err = fs.getName(path) .. err:sub(err:find(\"]\", 1, true) + 1, -1)!@#&		end!@#&!@#&		while true do!@#&			title(\"SpeedCode - Error!\")!@#&!@#&			term.setBackgroundColor(colors[theme.err])!@#&			for i = 6, 8 do!@#&				term.setCursorPos(3, i)!@#&				term.write(string.rep(\" \", w - 5))!@#&			end!@#&			term.setCursorPos(4, 7)!@#&			term.write(\"The program has crashed!\")!@#&!@#&			term.setBackgroundColor(colors[theme.prompt])!@#&			for i = 10, 14 do!@#&				term.setCursorPos(3, i)!@#&				term.write(string.rep(\" \", w - 5))!@#&			end!@#&!@#&			local formattedErr = curLanguage.parseError(err)!@#&			term.setCursorPos(4, 11)!@#&			term.write(\"Line: \" .. formattedErr.line)!@#&			term.setCursorPos(4, 12)!@#&			term.write(\"Error:\")!@#&			term.setCursorPos(5, 13)!@#&!@#&			local a = formattedErr.display!@#&			local b = nil!@#&			if a:len() > w - 8 then!@#&				for i = a:len(), 1, -1 do!@#&					if a:sub(i, i) == \" \" then!@#&						b = a:sub(i + 1, -1)!@#&						a = a:sub(1, i)!@#&						break!@#&					end!@#&				end!@#&			end!@#&!@#&			term.write(a)!@#&			if b then!@#&				term.setCursorPos(5, 14)!@#&				term.write(b)!@#&			end!@#&			!@#&			local opt = prompt({{\"Error Help\", w/2 - 15, 17}, {\"Go To Line\", w/2 + 2, 17}},!@#&				\"horizontal\")!@#&			if opt == \"Error Help\" then!@#&				viewErrorHelp(formattedErr)!@#&			elseif opt == \"Go To Line\" then!@#&				-- To prevent key from showing up in editor!@#&				os.queueEvent(event_distract)!@#&				os.pullEvent()!@#&!@#&				return \"go to\", tonumber(formattedErr.line)!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&!@#&--  -------- Functions!@#&!@#&local function goto()!@#&	term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&	term.setCursorPos(2, 1)!@#&	term.clearLine()!@#&	term.write(\"Line: \")!@#&	local line = modRead({visibleLength = w - 2})!@#&!@#&	local num = tonumber(line)!@#&	if num and num > 0 then return num!@#&	else!@#&		term.setCursorPos(2, 1)!@#&		term.clearLine()!@#&		term.write(\"Not a line number!\")!@#&		sleep(1.6)!@#&		return nil!@#&	end!@#&end!@#&!@#&local function setsyntax()!@#&	local opts = {!@#&		\"[Lua]   Brainfuck    None \",!@#&		\" Lua   [Brainfuck]   None \",!@#&		\" Lua    Brainfuck   [None]\"!@#&	}!@#&	local sel = 1!@#&!@#&	term.setCursorBlink(false)!@#&	term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&	term.setCursorPos(2, 1)!@#&	term.clearLine()!@#&	term.write(opts[sel])!@#&	while true do!@#&		local e, but, x, y = os.pullEvent(\"key\")!@#&		if but == 203 then!@#&			sel = math.max(1, sel - 1)!@#&			term.setCursorPos(2, 1)!@#&			term.clearLine()!@#&			term.write(opts[sel])!@#&		elseif but == 205 then!@#&			sel = math.min(#opts, sel + 1)!@#&			term.setCursorPos(2, 1)!@#&			term.clearLine()!@#&			term.write(opts[sel])!@#&		elseif but == 28 then!@#&			if sel == 1 then curLanguage = languages.lua!@#&			elseif sel == 2 then curLanguage = languages.brainfuck!@#&			elseif sel == 3 then curLanguage = languages.none end!@#&			term.setCursorBlink(true)!@#&			return!@#&		end!@#&	end!@#&end!@#&!@#&!@#&--  -------- Re-Indenting!@#&!@#&local tabWidth = 2!@#&!@#&local comments = {}!@#&local strings = {}!@#&!@#&local increment = {!@#&	\"if%s+.+%s+then%s*$\",!@#&	\"for%s+.+%s+do%s*$\",!@#&	\"while%s+.+%s+do%s*$\",!@#&	\"repeat%s*$\",!@#&	\"function%s+[a-zA-Z_0-9]\\(.*\\)%s*$\"!@#&}!@#&!@#&local decrement = {!@#&	\"end\",!@#&	\"until%s+.+\"!@#&}!@#&!@#&local special = {!@#&	\"else%s*$\",!@#&	\"elseif%s+.+%s+then%s*$\"!@#&}!@#&!@#&local function check(func)!@#&	for _, v in pairs(func) do!@#&		local cLineStart = v[\"lineStart\"]!@#&		local cLineEnd = v[\"lineEnd\"]!@#&		local cCharStart = v[\"charStart\"]!@#&		local cCharEnd = v[\"charEnd\"]!@#&!@#&		if line >= cLineStart and line <= cLineEnd then!@#&			if line == cLineStart then return cCharStart < charNumb!@#&			elseif line == cLineEnd then return cCharEnd > charNumb!@#&			else return true end!@#&		end!@#&	end!@#&end!@#&!@#&local function isIn(line, loc)!@#&	if check(comments) then return true end!@#&	if check(strings) then return true end!@#&	return false!@#&end!@#&!@#&local function setComment(ls, le, cs, ce)!@#&	comments[#comments + 1] = {}!@#&	comments[#comments].lineStart = ls!@#&	comments[#comments].lineEnd = le!@#&	comments[#comments].charStart = cs!@#&	comments[#comments].charEnd = ce!@#&end!@#&!@#&local function setString(ls, le, cs, ce)!@#&	strings[#strings + 1] = {}!@#&	strings[#strings].lineStart = ls!@#&	strings[#strings].lineEnd = le!@#&	strings[#strings].charStart = cs!@#&	strings[#strings].charEnd = ce!@#&end!@#&!@#&local function map(contents)!@#&	local inCom = false!@#&	local inStr = false!@#&!@#&	for i = 1, #contents do!@#&		if content[i]:find(\"%-%-%[%[\") and not inStr and not inCom then!@#&			local cStart = content[i]:find(\"%-%-%[%[\")!@#&			setComment(i, nil, cStart, nil)!@#&			inCom = true!@#&		elseif content[i]:find(\"%-%-%[=%[\") and not inStr and not inCom then!@#&			local cStart = content[i]:find(\"%-%-%[=%[\")!@#&			setComment(i, nil, cStart, nil)!@#&			inCom = true!@#&		elseif content[i]:find(\"%[%[\") and not inStr and not inCom then!@#&			local cStart = content[i]:find(\"%[%[\")!@#&			setString(i, nil, cStart, nil)!@#&			inStr = true!@#&		elseif content[i]:find(\"%[=%[\") and not inStr and not inCom then!@#&			local cStart = content[i]:find(\"%[=%[\")!@#&			setString(i, nil, cStart, nil)!@#&			inStr = true!@#&		end!@#&!@#&		if content[i]:find(\"%]%]\") and inStr and not inCom then!@#&			local cStart, cEnd = content[i]:find(\"%]%]\")!@#&			strings[#strings].lineEnd = i!@#&			strings[#strings].charEnd = cEnd!@#&			inStr = false!@#&		elseif content[i]:find(\"%]=%]\") and inStr and not inCom then!@#&			local cStart, cEnd = content[i]:find(\"%]=%]\")!@#&			strings[#strings].lineEnd = i!@#&			strings[#strings].charEnd = cEnd!@#&			inStr = false!@#&		end!@#&!@#&		if content[i]:find(\"%]%]\") and not inStr and inCom then!@#&			local cStart, cEnd = content[i]:find(\"%]%]\")!@#&			comments[#comments].lineEnd = i!@#&			comments[#comments].charEnd = cEnd!@#&			inCom = false!@#&		elseif content[i]:find(\"%]=%]\") and not inStr and inCom then!@#&			local cStart, cEnd = content[i]:find(\"%]=%]\")!@#&			comments[#comments].lineEnd = i!@#&			comments[#comments].charEnd = cEnd!@#&			inCom = false!@#&		end!@#&!@#&		if content[i]:find(\"%-%-\") and not inStr and not inCom then!@#&			local cStart = content[i]:find(\"%-%-\")!@#&			setComment(i, i, cStart, -1)!@#&		elseif content[i]:find(\"'\") and not inStr and not inCom then!@#&			local cStart, cEnd = content[i]:find(\"'\")!@#&			local nextChar = content[i]:sub(cEnd + 1, string.len(content[i]))!@#&			local _, cEnd = nextChar:find(\"'\")!@#&			setString(i, i, cStart, cEnd)!@#&		elseif content[i]:find('\"') and not inStr and not inCom then!@#&			local cStart, cEnd = content[i]:find('\"')!@#&			local nextChar = content[i]:sub(cEnd + 1, string.len(content[i]))!@#&			local _, cEnd = nextChar:find('\"')!@#&			setString(i, i, cStart, cEnd)!@#&		end!@#&	end!@#&end!@#&!@#&local function reindent(contents)!@#&	local err = nil!@#&	if curLanguage ~= languages.lua then!@#&		err = \"Cannot indent languages other than Lua!\"!@#&	elseif curLanguage.getCompilerErrors(table.concat(contents, \"\\n\")).line ~= -1 then!@#&		err = \"Cannot indent a program with errors!\"!@#&	end!@#&!@#&	if err then!@#&		term.setCursorBlink(false)!@#&		term.setCursorPos(2, 1)!@#&		term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&		term.clearLine()!@#&		term.write(err)!@#&		sleep(1.6)!@#&		return contents!@#&	end!@#&!@#&	local new = {}!@#&	local level = 0!@#&	for k, v in pairs(contents) do!@#&		local incrLevel = false!@#&		local foundIncr = false!@#&		for _, incr in pairs(increment) do!@#&			if v:find(incr) and not isIn(k, v:find(incr)) then!@#&				incrLevel = true!@#&			end!@#&			if v:find(incr:sub(1, -2)) and not isIn(k, v:find(incr)) then!@#&				foundIncr = true!@#&			end!@#&		end!@#&!@#&		local decrLevel = false!@#&		if not incrLevel then!@#&			for _, decr in pairs(decrement) do!@#&				if v:find(decr) and not isIn(k, v:find(decr)) and not foundIncr then!@#&					level = math.max(0, level - 1)!@#&					decrLevel = true!@#&				end!@#&			end!@#&		end!@#&!@#&		if not decrLevel then!@#&			for _, sp in pairs(special) do!@#&				if v:find(sp) and not isIn(k, v:find(sp)) then!@#&					incrLevel = true!@#&					level = math.max(0, level - 1)!@#&				end!@#&			end!@#&		end!@#&!@#&		new[k] = string.rep(\" \", level * tabWidth) .. v!@#&		if incrLevel then level = level + 1 end!@#&	end!@#&!@#&	return new!@#&end!@#&!@#&!@#&--  -------- Menu!@#&!@#&local menu = {!@#&	[1] = {\"File\",!@#&--		\"About\",!@#&--		\"Settings\",!@#&--		\"\",!@#&		\"New File  ^+N\",!@#&		\"Open File ^+O\",!@#&		\"Save File ^+S\",!@#&		\"Close     ^+W\",!@#&		\"Print     ^+P\",!@#&		\"Quit      ^+Q\"!@#&	}, [2] = {\"Edit\",!@#&		\"Cut Line   ^+X\",!@#&		\"Copy Line  ^+C\",!@#&		\"Paste Line ^+V\",!@#&		\"Delete Line\",!@#&		\"Clear Line\"!@#&	}, [3] = {\"Functions\",!@#&		\"Go To Line    ^+G\",!@#&		\"Re-Indent     ^+I\",!@#&		\"Set Syntax    ^+E\",!@#&		\"Start of Line ^+<\",!@#&		\"End of Line   ^+>\"!@#&	}, [4] = {\"Run\",!@#&		\"Run Program       ^+R\",!@#&		\"Run w/ Args ^+Shift+R\"!@#&	}!@#&}!@#&!@#&local shortcuts = {!@#&	-- File!@#&	[\"ctrl n\"] = \"New File  ^+N\",!@#&	[\"ctrl o\"] = \"Open File ^+O\",!@#&	[\"ctrl s\"] = \"Save File ^+S\",!@#&	[\"ctrl w\"] = \"Close     ^+W\",!@#&	[\"ctrl p\"] = \"Print     ^+P\",!@#&	[\"ctrl q\"] = \"Quit      ^+Q\",!@#&!@#&	-- Edit!@#&	[\"ctrl x\"] = \"Cut Line   ^+X\",!@#&	[\"ctrl c\"] = \"Copy Line  ^+C\",!@#&	[\"ctrl v\"] = \"Paste Line ^+V\",!@#&!@#&	-- Functions!@#&	[\"ctrl g\"] = \"Go To Line    ^+G\",!@#&	[\"ctrl i\"] = \"Re-Indent     ^+I\",!@#&	[\"ctrl e\"] = \"Set Syntax    ^+E\",!@#&	[\"ctrl 203\"] = \"Start of Line ^+<\",!@#&	[\"ctrl 205\"] = \"End of Line   ^+>\",!@#&!@#&	-- Run!@#&	[\"ctrl r\"] = \"Run Program       ^+R\",!@#&	[\"ctrl shift r\"] = \"Run w/ Args ^+Shift+R\"!@#&}!@#&!@#&local menuFunctions = {!@#&	-- File!@#&--	[\"About\"] = function() end,!@#&--	[\"Settings\"] = function() end,!@#&	[\"New File  ^+N\"] = function(path, lines) saveFile(path, lines) return \"new\" end,!@#&	[\"Open File ^+O\"] = function(path, lines) saveFile(path, lines) return \"open\" end,!@#&	[\"Save File ^+S\"] = function(path, lines) saveFile(path, lines) end,!@#&	[\"Close     ^+W\"] = function(path, lines) saveFile(path, lines) return \"menu\" end,!@#&	[\"Print     ^+P\"] = function(path, lines) saveFile(path, lines) return nil end,!@#&	[\"Quit      ^+Q\"] = function(path, lines) saveFile(path, lines) return \"exit\" end,!@#&!@#&	-- Edit!@#&	[\"Cut Line   ^+X\"] = function(path, lines, y)!@#&		clipboard = lines[y] table.remove(lines, y) return nil, lines end,!@#&	[\"Copy Line  ^+C\"] = function(path, lines, y) clipboard = lines[y] end,!@#&	[\"Paste Line ^+V\"] = function(path, lines, y)!@#&		if clipboard then table.insert(lines, y, clipboard) end return nil, lines end,!@#&	[\"Delete Line\"] = function(path, lines, y) table.remove(lines, y) return nil, lines end,!@#&	[\"Clear Line\"] = function(path, lines, y) lines[y] = \"\" return nil, lines, \"cursor\" end,!@#&!@#&	-- Functions!@#&	[\"Go To Line    ^+G\"] = function() return nil, \"go to\", goto() end,!@#&	[\"Re-Indent     ^+I\"] = function(path, lines)!@#&		local a = reindent(lines) saveFile(path, lines) return nil, a!@#&	end,!@#&	[\"Set Syntax    ^+E\"] = function(path, lines)!@#&		setsyntax()!@#&		if curLanguage == languages.brainfuck and lines[1] ~= \"-- Syntax: Brainfuck\" then!@#&			table.insert(lines, 1, \"-- Syntax: Brainfuck\")!@#&			return nil, lines!@#&		end!@#&	end,!@#&	[\"Start of Line ^+<\"] = function() os.queueEvent(\"key\", 199) end,!@#&	[\"End of Line   ^+>\"] = function() os.queueEvent(\"key\", 207) end,!@#&!@#&	-- Run!@#&	[\"Run Program       ^+R\"] = function(path, lines)!@#&		saveFile(path, lines)!@#&		return nil, run(path, lines, false)!@#&	end,!@#&	[\"Run w/ Args ^+Shift+R\"] = function(path, lines)!@#&		saveFile(path, lines)!@#&		return nil, run(path, lines, true)!@#&	end,!@#&}!@#&!@#&local function drawMenu(open)!@#&	term.setCursorPos(1, 1)!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&	term.clearLine()!@#&	local curX = 0!@#&	for _, v in pairs(menu) do!@#&		term.setCursorPos(3 + curX, 1)!@#&		term.write(v[1])!@#&		curX = curX + v[1]:len() + 3!@#&	end!@#&!@#&	if open then!@#&		local it = {}!@#&		local x = 1!@#&		for _, v in pairs(menu) do!@#&			if open == v[1] then!@#&				it = v!@#&				break!@#&			end!@#&			x = x + v[1]:len() + 3!@#&		end!@#&		x = x + 1!@#&!@#&		local items = {}!@#&		for i = 2, #it do!@#&			table.insert(items, it[i])!@#&		end!@#&!@#&		local len = 1!@#&		for _, v in pairs(items) do if v:len() + 2 > len then len = v:len() + 2 end end!@#&!@#&		for i, v in ipairs(items) do!@#&			term.setCursorPos(x, i + 1)!@#&			term.write(string.rep(\" \", len))!@#&			term.setCursorPos(x + 1, i + 1)!@#&			term.write(v)!@#&		end!@#&		term.setCursorPos(x, #items + 2)!@#&		term.write(string.rep(\" \", len))!@#&		return items, len!@#&	end!@#&end!@#&!@#&local function triggerMenu(cx, cy)!@#&	-- Determine clicked menu!@#&	local curX = 0!@#&	local open = nil!@#&	for _, v in pairs(menu) do!@#&		if cx >= curX + 3 and cx <= curX + v[1]:len() + 2 then!@#&			open = v[1]!@#&			break!@#&		end!@#&		curX = curX + v[1]:len() + 3!@#&	end!@#&	local menux = curX + 2!@#&	if not open then return false end!@#&!@#&	-- Flash menu item!@#&	term.setCursorBlink(false)!@#&	term.setCursorPos(menux, 1)!@#&	term.setBackgroundColor(colors[theme.background])!@#&	term.write(string.rep(\" \", open:len() + 2))!@#&	term.setCursorPos(menux + 1, 1)!@#&	term.write(open)!@#&	sleep(0.1)!@#&	local items, len = drawMenu(open)!@#&!@#&	local ret = true!@#&!@#&	-- Pull events on menu!@#&	local ox, oy = term.getCursorPos()!@#&	while type(ret) ~= \"string\" do!@#&		local e, but, x, y = os.pullEvent()!@#&		if e == \"mouse_click\" then!@#&			-- If clicked outside menu!@#&			if x < menux - 1 or x > menux + len - 1 then break!@#&			elseif y > #items + 2 then break!@#&			elseif y == 1 then break end!@#&!@#&			for i, v in ipairs(items) do!@#&				if y == i + 1 and x >= menux and x <= menux + len - 2 then!@#&					-- Flash when clicked!@#&					term.setCursorPos(menux, y)!@#&					term.setBackgroundColor(colors[theme.background])!@#&					term.write(string.rep(\" \", len))!@#&					term.setCursorPos(menux + 1, y)!@#&					term.write(v)!@#&					sleep(0.1)!@#&					drawMenu(open)!@#&!@#&					-- Return item!@#&					ret = v!@#&					break!@#&				end!@#&			end!@#&		end!@#&	end!@#&!@#&	term.setCursorPos(ox, oy)!@#&	term.setCursorBlink(true)!@#&	return ret!@#&end!@#&!@#&!@#&--  -------- Editing!@#&!@#&local standardsCompletions = {!@#&	\"if%s+.+%s+then%s*$\",!@#&	\"for%s+.+%s+do%s*$\",!@#&	\"while%s+.+%s+do%s*$\",!@#&	\"repeat%s*$\",!@#&	\"function%s+[a-zA-Z_0-9]?\\(.*\\)%s*$\",!@#&	\"=%s*function%s*\\(.*\\)%s*$\",!@#&	\"else%s*$\",!@#&	\"elseif%s+.+%s+then%s*$\"!@#&}!@#&!@#&local liveCompletions = {!@#&	[\"(\"] = \")\",!@#&	[\"{\"] = \"}\",!@#&	[\"[\"] = \"]\",!@#&	[\"\\\"\"] = \"\\\"\",!@#&	[\"'\"] = \"'\",!@#&}!@#&!@#&local x, y = 0, 0!@#&local edw, edh = 0, h - 1!@#&local offx, offy = 0, 1!@#&local scrollx, scrolly = 0, 0!@#&local lines = {}!@#&local liveErr = curLanguage.parseError(nil)!@#&local displayCode = true!@#&local lastEventClock = os.clock()!@#&!@#&local function attemptToHighlight(line, regex, col)!@#&	local match = string.match(line, regex)!@#&	if match then!@#&		if type(col) == \"number\" then term.setTextColor(col)!@#&		elseif type(col) == \"function\" then term.setTextColor(col(match)) end!@#&		term.write(match)!@#&		term.setTextColor(colors[theme.textColor])!@#&		return line:sub(match:len() + 1, -1)!@#&	end!@#&	return nil!@#&end!@#&!@#&local function writeHighlighted(line)!@#&	if curLanguage == languages.lua then!@#&		while line:len() > 0 do	!@#&			line = attemptToHighlight(line, \"^%-%-%[%[.-%]%]\", colors[theme.comment]) or!@#&				attemptToHighlight(line, \"^%-%-.*\", colors[theme.comment]) or!@#&				attemptToHighlight(line, \"^\\\".*[^\\\\]\\\"\", colors[theme.string]) or!@#&				attemptToHighlight(line, \"^\\'.*[^\\\\]\\'\", colors[theme.string]) or!@#&				attemptToHighlight(line, \"^%[%[.-%]%]\", colors[theme.string]) or!@#&				attemptToHighlight(line, \"^[%w_]+\", function(match)!@#&					if curLanguage.keywords[match] then!@#&						return colors[theme[curLanguage.keywords[match]]]!@#&					end!@#&					return colors[theme.textColor]!@#&				end) or!@#&				attemptToHighlight(line, \"^[^%w_]\", colors[theme.textColor])!@#&		end!@#&	else term.write(line) end!@#&end!@#&!@#&local function draw()!@#&	-- Menu!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.editorBackground])!@#&	term.clear()!@#&	drawMenu()!@#&!@#&	-- Line numbers!@#&	offx, offy = tostring(#lines):len() + 1, 1!@#&	edw, edh = w - offx, h - 1!@#&!@#&	-- Draw text!@#&	for i = 1, edh do!@#&		local a = lines[scrolly + i]!@#&		if a then!@#&			local ln = string.rep(\" \", offx - 1 - tostring(scrolly + i):len()) .. tostring(scrolly + i) !@#&			local l = a:sub(scrollx + 1, edw + scrollx + 1)!@#&			ln = ln .. \":\"!@#&!@#&			if liveErr.line == scrolly + i then ln = string.rep(\" \", offx - 2) .. \"!:\" end!@#&!@#&			term.setCursorPos(1, i + offy)!@#&			term.setBackgroundColor(colors[theme.editorBackground])!@#&			if scrolly + i == y then!@#&				if scrolly + i == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&				else term.setBackgroundColor(colors[theme.editorLineHightlight]) end!@#&				term.clearLine()!@#&			elseif scrolly + i == liveErr.line then!@#&				term.setBackgroundColor(colors[theme.editorError])!@#&				term.clearLine()!@#&			end!@#&!@#&			term.setCursorPos(1 - scrollx + offx, i + offy)!@#&			if scrolly + i == y then!@#&				if scrolly + i == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&				else term.setBackgroundColor(colors[theme.editorLineHightlight]) end!@#&			elseif scrolly + i == liveErr.line then term.setBackgroundColor(colors[theme.editorError])!@#&			else term.setBackgroundColor(colors[theme.editorBackground]) end!@#&			if scrolly + i == liveErr.line then!@#&				if displayCode then term.write(a)!@#&				else term.write(liveErr.display) end!@#&			else writeHighlighted(a) end!@#&!@#&			term.setCursorPos(1, i + offy)!@#&			if scrolly + i == y then!@#&				if scrolly + i == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorError])!@#&				else term.setBackgroundColor(colors[theme.editorLineNumbersHighlight]) end!@#&			elseif scrolly + i == liveErr.line then!@#&				term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&			else term.setBackgroundColor(colors[theme.editorLineNumbers]) end!@#&			term.write(ln)!@#&		end!@#&	end!@#&	term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&end!@#&!@#&local function drawLine(...)!@#&	local ls = {...}!@#&	offx = tostring(#lines):len() + 1!@#&	for _, ly in pairs(ls) do!@#&		local a = lines[ly]!@#&		if a then!@#&			local ln = string.rep(\" \", offx - 1 - tostring(ly):len()) .. tostring(ly) !@#&			local l = a:sub(scrollx + 1, edw + scrollx + 1)!@#&			ln = ln .. \":\"!@#&!@#&			if liveErr.line == ly then ln = string.rep(\" \", offx - 2) .. \"!:\" end!@#&!@#&			term.setCursorPos(1, (ly - scrolly) + offy)!@#&			term.setBackgroundColor(colors[theme.editorBackground])!@#&			if ly == y then!@#&				if ly == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&				else term.setBackgroundColor(colors[theme.editorLineHightlight]) end!@#&			elseif ly == liveErr.line then!@#&				term.setBackgroundColor(colors[theme.editorError])!@#&			end!@#&			term.clearLine()!@#&!@#&			term.setCursorPos(1 - scrollx + offx, (ly - scrolly) + offy)!@#&			if ly == y then!@#&				if ly == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&				else term.setBackgroundColor(colors[theme.editorLineHightlight]) end!@#&			elseif ly == liveErr.line then term.setBackgroundColor(colors[theme.editorError])!@#&			else term.setBackgroundColor(colors[theme.editorBackground]) end!@#&			if ly == liveErr.line then!@#&				if displayCode then term.write(a)!@#&				else term.write(liveErr.display) end!@#&			else writeHighlighted(a) end!@#&!@#&			term.setCursorPos(1, (ly - scrolly) + offy)!@#&			if ly == y then!@#&				if ly == liveErr.line and os.clock() - lastEventClock > 3 then!@#&					term.setBackgroundColor(colors[theme.editorError])!@#&				else term.setBackgroundColor(colors[theme.editorLineNumbersHighlight]) end!@#&			elseif ly == liveErr.line then!@#&				term.setBackgroundColor(colors[theme.editorErrorHighlight])!@#&			else term.setBackgroundColor(colors[theme.editorLineNumbers]) end!@#&			term.write(ln)!@#&		end!@#&	end!@#&	term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&end!@#&!@#&local function cursorLoc(x, y, force)!@#&	local sx, sy = x - scrollx, y - scrolly!@#&	local redraw = false!@#&	if sx < 1 then!@#&		scrollx = x - 1!@#&		sx = 1!@#&		redraw = true!@#&	elseif sx > edw then!@#&		scrollx = x - edw!@#&		sx = edw!@#&		redraw = true!@#&	end if sy < 1 then!@#&		scrolly = y - 1!@#&		sy = 1!@#&		redraw = true!@#&	elseif sy > edh then!@#&		scrolly = y - edh!@#&		sy = edh!@#&		redraw = true!@#&	end if redraw or force then draw() end!@#&	term.setCursorPos(sx + offx, sy + offy)!@#&end!@#&!@#&local function executeMenuItem(a, path)!@#&	if type(a) == \"string\" and menuFunctions[a] then!@#&		local opt, nl, gtln = menuFunctions[a](path, lines, y)!@#&		if type(opt) == \"string\" then term.setCursorBlink(false) return opt end!@#&		if type(nl) == \"table\" then!@#&			if #lines < 1 then table.insert(lines, \"\") end!@#&			y = math.min(y, #lines)!@#&			x = math.min(x, lines[y]:len() + 1)!@#&			lines = nl!@#&		elseif type(nl) == \"string\" then!@#&			if nl == \"go to\" and gtln then!@#&				x, y = 1, math.min(#lines, gtln)!@#&				cursorLoc(x, y)!@#&			end!@#&		end!@#&	end!@#&	term.setCursorBlink(true)!@#&	draw()!@#&	term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&end!@#&!@#&local function edit(path)!@#&	-- Variables!@#&	x, y = 1, 1!@#&	offx, offy = 0, 1!@#&	scrollx, scrolly = 0, 0!@#&	lines = loadFile(path)!@#&	if not lines then return \"menu\" end!@#&!@#&	-- Enable brainfuck!@#&	if lines[1] == \"-- Syntax: Brainfuck\" then!@#&		curLanguage = languages.brainfuck!@#&	end!@#&!@#&	-- Clocks!@#&	local autosaveClock = os.clock()!@#&	local scrollClock = os.clock() -- To prevent redraw flicker!@#&	local liveErrorClock = os.clock()!@#&	local hasScrolled = false!@#&!@#&	-- Draw!@#&	draw()!@#&	term.setCursorPos(x + offx, y + offy)!@#&	term.setCursorBlink(true)!@#&	!@#&	-- Main loop!@#&	local tid = os.startTimer(3)!@#&	while true do!@#&		local e, key, cx, cy = os.pullEvent()!@#&		if e == \"key\" and allowEditorEvent then!@#&			if key == 200 and y > 1 then!@#&				-- Up!@#&				x, y = math.min(x, lines[y - 1]:len() + 1), y - 1!@#&				drawLine(y, y + 1)!@#&				cursorLoc(x, y)!@#&			elseif key == 208 and y < #lines then!@#&				-- Down!@#&				x, y = math.min(x, lines[y + 1]:len() + 1), y + 1!@#&				drawLine(y, y - 1)!@#&				cursorLoc(x, y)!@#&			elseif key == 203 and x > 1 then!@#&				-- Left!@#&				x = x - 1!@#&				local force = false!@#&				if y - scrolly + offy < offy + 1 then force = true end!@#&				cursorLoc(x, y, force)!@#&			elseif key == 205 and x < lines[y]:len() + 1 then!@#&				-- Right!@#&				x = x + 1!@#&				local force = false!@#&				if y - scrolly + offy < offy + 1 then force = true end!@#&				cursorLoc(x, y, force)!@#&			elseif (key == 28 or key == 156) and (displayCode and true or y + scrolly - 1 ==!@#&					liveErr.line) then!@#&				-- Enter!@#&				local f = nil!@#&				for _, v in pairs(standardsCompletions) do!@#&					if lines[y]:find(v) then f = v end!@#&				end!@#&!@#&				local _, spaces = lines[y]:find(\"^[ ]+\")!@#&				if not spaces then spaces = 0 end!@#&				if f then!@#&					table.insert(lines, y + 1, string.rep(\" \", spaces + 2))!@#&					if not f:find(\"else\", 1, true) and not f:find(\"elseif\", 1, true) then!@#&						table.insert(lines, y + 2, string.rep(\" \", spaces) .. !@#&							(f:find(\"repeat\", 1, true) and \"until \" or f:find(\"{\", 1, true) and \"}\" or !@#&							\"end\"))!@#&					end!@#&					x, y = spaces + 3, y + 1!@#&					cursorLoc(x, y, true)!@#&				else!@#&					local oldLine = lines[y]!@#&!@#&					lines[y] = lines[y]:sub(1, x - 1)!@#&					table.insert(lines, y + 1, string.rep(\" \", spaces) .. oldLine:sub(x, -1))!@#&!@#&					x, y = spaces + 1, y + 1!@#&					cursorLoc(x, y, true)!@#&				end!@#&			elseif key == 14 and (displayCode and true or y + scrolly - 1 == liveErr.line) then!@#&				-- Backspace!@#&				if x > 1 then!@#&					local f = false!@#&					for k, v in pairs(liveCompletions) do!@#&						if lines[y]:sub(x - 1, x - 1) == k then f = true end!@#&					end!@#&!@#&					lines[y] = lines[y]:sub(1, x - 2) .. lines[y]:sub(x + (f and 1 or 0), -1)!@#&					drawLine(y)!@#&					x = x - 1!@#&					cursorLoc(x, y)!@#&				elseif y > 1 then!@#&					local prevLen = lines[y - 1]:len() + 1!@#&					lines[y - 1] = lines[y - 1] .. lines[y]!@#&					table.remove(lines, y)!@#&					x, y = prevLen, y - 1!@#&					cursorLoc(x, y, true)!@#&				end!@#&			elseif key == 199 then!@#&				-- Home!@#&				x = 1!@#&				local force = false!@#&				if y - scrolly + offy < offy + 1 then force = true end!@#&				cursorLoc(x, y, force)!@#&			elseif key == 207 then!@#&				-- End!@#&				x = lines[y]:len() + 1!@#&				local force = false!@#&				if y - scrolly + offy < offy + 1 then force = true end!@#&				cursorLoc(x, y, force)!@#&			elseif key == 211 and (displayCode and true or y + scrolly - 1 == liveErr.line) then!@#&				-- Forward Delete!@#&				if x < lines[y]:len() + 1 then!@#&					lines[y] = lines[y]:sub(1, x - 1) .. lines[y]:sub(x + 1)!@#&					local force = false!@#&					if y - scrolly + offy < offy + 1 then force = true end!@#&					drawLine(y)!@#&					cursorLoc(x, y, force)!@#&				elseif y < #lines then!@#&					lines[y] = lines[y] .. lines[y + 1]!@#&					table.remove(lines, y + 1)!@#&					draw()!@#&					cursorLoc(x, y)!@#&				end!@#&			elseif key == 15 and (displayCode and true or y + scrolly - 1 == liveErr.line) then!@#&				-- Tab!@#&				lines[y] = string.rep(\" \", tabWidth) .. lines[y]!@#&				x = x + 2!@#&				local force = false!@#&				if y - scrolly + offy < offy + 1 then force = true end!@#&				drawLine(y)!@#&				cursorLoc(x, y, force)!@#&			elseif key == 201 then!@#&				-- Page up!@#&				y = math.min(math.max(y - edh, 1), #lines)!@#&				x = math.min(lines[y]:len() + 1, x)!@#&				cursorLoc(x, y, true)!@#&			elseif key == 209 then!@#&				-- Page down!@#&				y = math.min(math.max(y + edh, 1), #lines)!@#&				x = math.min(lines[y]:len() + 1, x)!@#&				cursorLoc(x, y, true)!@#&			end!@#&		elseif e == \"char\" and allowEditorEvent and (displayCode and true or !@#&				y + scrolly - 1 == liveErr.line) then!@#&			local shouldIgnore = false!@#&			for k, v in pairs(liveCompletions) do!@#&				if key == v and lines[y]:find(k, 1, true) and lines[y]:sub(x, x) == v then!@#&					shouldIgnore = true!@#&				end!@#&			end!@#&!@#&			local addOne = false!@#&			if not shouldIgnore then!@#&				for k, v in pairs(liveCompletions) do!@#&					if key == k and lines[y]:sub(x, x) ~= k then key = key .. v addOne = true end!@#&				end!@#&				lines[y] = lines[y]:sub(1, x - 1) .. key .. lines[y]:sub(x, -1)!@#&			end!@#&!@#&			x = x + (addOne and 1 or key:len())!@#&			local force = false!@#&			if y - scrolly + offy < offy + 1 then force = true end!@#&			drawLine(y)!@#&			cursorLoc(x, y, force)!@#&		elseif e == \"mouse_click\" and key == 1 then!@#&			if cy > 1 then!@#&				if cx <= offx and cy - offy == liveErr.line - scrolly then!@#&					displayCode = not displayCode!@#&					drawLine(liveErr.line)!@#&				else!@#&					local oldy = y!@#&					y = math.min(math.max(scrolly + cy - offy, 1), #lines)!@#&					x = math.min(math.max(scrollx + cx - offx, 1), lines[y]:len() + 1)!@#&					if oldy ~= y then drawLine(oldy, y) end!@#&					cursorLoc(x, y)!@#&				end!@#&			else!@#&				local a = triggerMenu(cx, cy)!@#&				if a then!@#&					local opt = executeMenuItem(a, path)!@#&					if opt then return opt end!@#&				end!@#&			end!@#&		elseif e == \"shortcut\" then!@#&			local a = shortcuts[key .. \" \" .. cx]!@#&			if a then!@#&				local parent = nil!@#&				local curx = 0!@#&				for i, mv in ipairs(menu) do!@#&					for _, iv in pairs(mv) do!@#&						if iv == a then!@#&							parent = menu[i][1]!@#&							break!@#&						end!@#&					end!@#&					if parent then break end!@#&					curx = curx + mv[1]:len() + 3!@#&				end!@#&				local menux = curx + 2!@#&!@#&				-- Flash menu item!@#&				term.setCursorBlink(false)!@#&				term.setCursorPos(menux, 1)!@#&				term.setBackgroundColor(colors[theme.background])!@#&				term.write(string.rep(\" \", parent:len() + 2))!@#&				term.setCursorPos(menux + 1, 1)!@#&				term.write(parent)!@#&				sleep(0.1)!@#&				drawMenu()!@#&!@#&				-- Execute item!@#&				local opt = executeMenuItem(a, path)!@#&				if opt then return opt end!@#&			end!@#&		elseif e == \"mouse_scroll\" then!@#&			if key == -1 and scrolly > 0 then!@#&				scrolly = scrolly - 1!@#&				if os.clock() - scrollClock > 0.0005 then!@#&					draw()!@#&					term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&				end!@#&				scrollClock = os.clock()!@#&				hasScrolled = true!@#&			elseif key == 1 and scrolly < #lines - edh then!@#&				scrolly = scrolly + 1!@#&				if os.clock() - scrollClock > 0.0005 then!@#&					draw()!@#&					term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&				end!@#&				scrollClock = os.clock()!@#&				hasScrolled = true!@#&			end!@#&		elseif e == \"timer\" and key == tid then!@#&			drawLine(y)!@#&			tid = os.startTimer(3)!@#&		end!@#&!@#&		-- Draw!@#&		if hasScrolled and os.clock() - scrollClock > 0.1 then!@#&			draw()!@#&			term.setCursorPos(x - scrollx + offx, y - scrolly + offy)!@#&			hasScrolled = false!@#&		end!@#&!@#&		-- Autosave!@#&		if os.clock() - autosaveClock > autosaveInterval then!@#&			saveFile(path, lines)!@#&			autosaveClock = os.clock()!@#&		end!@#&!@#&		-- Errors!@#&		if os.clock() - liveErrorClock > 1 then!@#&			local prevLiveErr = liveErr!@#&			liveErr = curLanguage.parseError(nil)!@#&			local code = \"\"!@#&			for _, v in pairs(lines) do code = code .. v .. \"\\n\" end!@#&!@#&			liveErr = curLanguage.getCompilerErrors(code)!@#&			liveErr.line = math.min(liveErr.line - 2, #lines)!@#&			if liveErr ~= prevLiveErr then draw() end!@#&			liveErrorClock = os.clock()!@#&		end!@#&	end!@#&!@#&	return \"menu\"!@#&end!@#&!@#&!@#&--  -------- Open File!@#&!@#&local function newFile()!@#&	local wid = w - 13!@#&!@#&	-- Get name!@#&	title(\"Lua IDE - New File\")!@#&	local name = centerRead(wid, \"/\")!@#&	if not name or name == \"\" then return \"menu\" end!@#&	name = \"/\" .. name!@#&!@#&	-- Clear!@#&	title(\"Lua IDE - New File\")!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.promptHighlight])!@#&	for i = 8, 10 do!@#&		term.setCursorPos(w/2 - wid/2, i)!@#&		term.write(string.rep(\" \", wid))!@#&	end!@#&	term.setCursorPos(1, 9)!@#&	if fs.isDir(name) then!@#&		centerPrint(\"Cannot Edit a Directory!\")!@#&		sleep(1.6)!@#&		return \"menu\"!@#&	elseif fs.exists(name) then!@#&		centerPrint(\"File Already Exists!\")!@#&		local opt = prompt({{\"Open\", w/2 - 9, 14}, {\"Cancel\", w/2 + 2, 14}}, \"horizontal\")!@#&		if opt == \"Open\" then return \"edit\", name!@#&		elseif opt == \"Cancel\" then return \"menu\" end!@#&	else return \"edit\", name end!@#&end!@#&!@#&local function openFile()!@#&	local wid = w - 13!@#&!@#&	-- Get name!@#&	title(\"Lua IDE - Open File\")!@#&	local name = tostring(lddfm.makeMenu())!@#&	if not name or name == \"\" then return \"menu\" end!@#&!@#&	-- Clear!@#&	title(\"Lua IDE - New File\")!@#&	term.setTextColor(colors[theme.textColor])!@#&	term.setBackgroundColor(colors[theme.promptHighlight])!@#&	for i = 8, 10 do!@#&		term.setCursorPos(w/2 - wid/2, i)!@#&		term.write(string.rep(\" \", wid))!@#&	end!@#&	term.setCursorPos(1, 9)!@#&	if fs.isDir(name) then!@#&		centerPrint(\"Cannot Open a Directory!\")!@#&		sleep(1.6)!@#&		return \"menu\"!@#&	elseif not fs.exists(name) then!@#&		centerPrint(\"File Doesn't Exist!\")!@#&		local opt = prompt({{\"Create\", w/2 - 11, 14}, {\"Cancel\", w/2 + 2, 14}}, \"horizontal\")!@#&		if opt == \"Create\" then return \"edit\", name!@#&		elseif opt == \"Cancel\" then return \"menu\" end!@#&	else return \"edit\", name end!@#&end!@#&!@#&!@#&--  -------- Settings!@#&!@#&local function update()!@#&	local function draw(status)!@#&		title(\"SpeedCode - Update\")!@#&		term.setBackgroundColor(colors[theme.prompt])!@#&		term.setTextColor(colors[theme.textColor])!@#&		for i = 8, 10 do!@#&			term.setCursorPos(w/2 - (status:len() + 4), i)!@#&			write(string.rep(\" \", status:len() + 4))!@#&		end!@#&		term.setCursorPos(w/2 - (status:len() + 4), 9)!@#&		term.write(\" - \" .. status .. \" \")!@#&!@#&		term.setBackgroundColor(colors[theme.errHighlight])!@#&		for i = 8, 10 do!@#&			term.setCursorPos(w/2 + 2, i)!@#&			term.write(string.rep(\" \", 10))!@#&		end!@#&		term.setCursorPos(w/2 + 2, 9)!@#&		term.write(\" > Cancel \")!@#&	end!@#&!@#&	if not http then!@#&		draw(\"HTTP API Disabled!\")!@#&		sleep(1.6)!@#&		return \"settings\"!@#&	end!@#&!@#&	draw(\"Updating...\")!@#&	local tID = os.startTimer(10)!@#&	http.request(updateURL)!@#&	while true do!@#&		local e, but, x, y = os.pullEvent()!@#&		if (e == \"key\" and but == 28) or!@#&				(e == \"mouse_click\" and x >= w/2 + 2 and x <= w/2 + 12 and y == 9) then!@#&			draw(\"Cancelled\")!@#&			sleep(1.6)!@#&			break!@#&		elseif e == \"http_success\" and but == updateURL then!@#&			local new = x.readAll()!@#&			local curf = io.open(ideLocation, \"r\")!@#&			local cur = curf:read(\"*a\")!@#&			curf:close()!@#&!@#&			if cur ~= new then!@#&				draw(\"Update Found\")!@#&				sleep(1.6)!@#&				local f = io.open(ideLocation, \"w\")!@#&				f:write(new)!@#&				f:close()!@#&!@#&				draw(\"Click to Exit\")!@#&				while true do!@#&					local e = os.pullEvent()!@#&					if e == \"mouse_click\" or (not isAdvanced() and e == \"key\") then break end!@#&				end!@#&				return \"exit\"!@#&			else!@#&				draw(\"No Updates Found!\")!@#&				sleep(1.6)!@#&				break!@#&			end!@#&		elseif e == \"http_failure\" or (e == \"timer\" and but == tID) then!@#&			draw(\"Update Failed!\")!@#&			sleep(1.6)!@#&			break!@#&		end!@#&	end!@#&!@#&	return \"settings\"!@#&end!@#&!@#&local function changeTheme()!@#&	title(\"SpeedCode - Theme\")!@#&!@#&	if isAdvanced() then!@#&		local disThemes = {\"Back\"}!@#&		for _, v in pairs(availableThemes) do table.insert(disThemes, v[1]) end!@#&		local t = scrollingPrompt(disThemes)!@#&		local url = nil!@#&		for _, v in pairs(availableThemes) do if v[1] == t then url = v[2] end end!@#&!@#&		if not url then return \"settings\" end!@#&		if t == \"Dawn (Default)\" then!@#&			term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&			term.setCursorPos(3, 3)!@#&			term.clearLine()!@#&			term.write(\"SpeedCode - Loaded Theme!\")!@#&			sleep(1.6)!@#&!@#&			fs.delete(themeLocation)!@#&			theme = defaultTheme!@#&			return \"menu\"!@#&		end!@#&!@#&		term.setBackgroundColor(colors[theme.backgroundHighlight])!@#&		term.setCursorPos(3, 3)!@#&		term.clearLine()!@#&		term.write(\"SpeedCode - Downloading...\")!@#&!@#&		fs.delete(\"/.LuaIDE_temp_theme_file\")!@#&		download(url, \"/.LuaIDE_temp_theme_file\")!@#&		local a = loadTheme(\"/.LuaIDE_temp_theme_file\")!@#&!@#&		term.setCursorPos(3, 3)!@#&		term.clearLine()!@#&		if a then!@#&			term.write(\"SpeedCode - Loaded Theme!\")!@#&			fs.delete(themeLocation)!@#&			fs.move(\"/.LuaIDE_temp_theme_file\", themeLocation)!@#&			theme = a!@#&			sleep(1.6)!@#&			return \"menu\"!@#&		end!@#&		!@#&		term.write(\"SpeedCode - Could Not Load Theme!\")!@#&		fs.delete(\"/.LuaIDE_temp_theme_file\")!@#&		sleep(1.6)!@#&		return \"settings\"!@#&	else!@#&		term.setCursorPos(1, 8)!@#&		centerPrint(\"Themes are not available on\")!@#&		centerPrint(\"normal computers!\")!@#&	end!@#&end!@#&!@#&local function settings()!@#&	title(\"SpeedCode - Settings\")!@#&!@#&	local opt = prompt({{\"Change Theme\", w/2 - 17, 8}, {\"Return to Menu\", w/2 - 22, 13},!@#&		{\"Check for Updates\", w/2 + 2, 8}, {\"Exit IDE\", w/2 + 2, 13, bg = colors[theme.err], !@#&		highlight = colors[theme.errHighlight]}}, \"vertical\", true)!@#&	if opt == \"Change Theme\" then return changeTheme()!@#&	elseif opt == \"Check for Updates\" then return update()!@#&	elseif opt == \"Return to Menu\" then return \"menu\"!@#&	elseif opt == \"Exit IDE\" then return \"exit\" end!@#&end!@#&!@#&!@#&--  -------- Menu!@#&!@#&local function menu()!@#&	title(\"Welcome to SpeedCode \" .. version)!@#&!@#&	local opt = prompt({{\"New File\", w/2 - 13, 8}, {\"Open File\", w/2 - 14, 13},!@#&		{\"Settings\", w/2 + 2, 8}, {\"Exit IDE\", w/2 + 2, 13, bg = colors[theme.err],!@#&		highlight = colors[theme.errHighlight]}}, \"vertical\", true)!@#&	if opt == \"New File\" then return \"new\"!@#&	elseif opt == \"Open File\" then return \"open\"!@#&	elseif opt == \"Settings\" then return \"settings\"!@#&	elseif opt == \"Exit IDE\" then return \"exit\" end!@#&end!@#&!@#&!@#&--  -------- Main!@#&!@#&local function main(arguments)!@#&	local opt, data = \"menu\", nil!@#&!@#&	-- Check arguments!@#&	if type(arguments) == \"table\" and #arguments > 0 then!@#&		local f = \"/\" .. shell.resolve(arguments[1])!@#&		if fs.isDir(f) then print(\"Cannot edit a directory.\") end!@#&		opt, data = \"edit\", f!@#&	end!@#&!@#&	-- Main run loop!@#&	while true do!@#&		-- Menu!@#&		if opt == \"menu\" then opt = menu() end!@#&!@#&		-- Other!@#&		if opt == \"new\" then opt, data = newFile()!@#&		elseif opt == \"open\" then opt, data = openFile()!@#&		elseif opt == \"settings\" then opt = settings()!@#&		end if opt == \"exit\" then break end!@#&!@#&		-- Edit!@#&		if opt == \"edit\" and data then opt = edit(data) end!@#&	end!@#&end!@#&!@#&-- Load Theme!@#&if fs.exists(themeLocation) then theme = loadTheme(themeLocation) end!@#&if not theme and isAdvanced() then theme = defaultTheme!@#&elseif not theme then theme = normalTheme end!@#&!@#&-- Run!@#&local _, err = pcall(function()!@#&	parallel.waitForAny(function() main(args) end, monitorKeyboardShortcuts)!@#&end)!@#&!@#&-- Catch errors!@#&if err and not err:find(\"Terminated\") then!@#&	term.setCursorBlink(false)!@#&	title(\"SpeedCode - Crash! D:\")!@#&!@#&	term.setBackgroundColor(colors[theme.err])!@#&	for i = 6, 8 do!@#&		term.setCursorPos(5, i)!@#&		term.write(string.rep(\" \", 36))!@#&	end!@#&	term.setCursorPos(6, 7)!@#&	term.write(\"SpeedCode Has Crashed! D:\")!@#&!@#&	term.setBackgroundColor(colors[theme.background])!@#&	term.setCursorPos(2, 10)!@#&	print(err)!@#&!@#&	term.setBackgroundColor(colors[theme.prompt])!@#&	local _, cy = term.getCursorPos()!@#&	for i = cy + 1, cy + 4 do!@#&		term.setCursorPos(5, i)!@#&		term.write(string.rep(\" \", 36))!@#&	end!@#&	term.setCursorPos(6, cy + 2)!@#&	term.write(\"Please report this error to\")!@#&	term.setCursorPos(6, cy + 3)!@#&	term.write(\"Ma3rX! \")!@#&	!@#&	term.setBackgroundColor(colors[theme.background])!@#&	if isAdvanced() then centerPrint(\"Click to Exit...\", h - 1)!@#&	else centerPrint(\"Press Any Key to Exit...\", h - 1) end!@#&	while true do!@#&		local e = os.pullEvent()!@#&		if e == \"mouse_click\" or (not isAdvanced() and e == \"key\") then break end!@#&	end!@#&!@#&	-- Prevent key from being shown!@#&	os.queueEvent(event_distract)!@#&	os.pullEvent()!@#&end!@#&!@#&-- Exit!@#&term.setBackgroundColor(colors.black)!@#&term.setTextColor(colors.white)!@#&term.clear()!@#&term.setCursorPos(1, 1)",["VNC"]="os.loadAPI(\"/SpeedAPI/SpeedText\")!@#&os.loadAPI(\"/SpeedAPI/SpeedGUI\")!@#&!@#&term.setBackgroundColor(colors.white)!@#&term.setTextColor(colors.blue)!@#&term.clear()!@#&term.setCursorPos(1, 1)!@#&!@#&SpeedText.cPrint(\"VNC  \", 1)!@#&!@#&term.setTextColor(colors.gray)!@#&!@#&SpeedText.line()!@#&!@#&term.setCursorPos(51-7, 19)!@#&term.setTextColor(colors.lightGray)!@#&term.write(\"by Ma3rX\")!@#&!@#&function connect()!@#&  term.setBackgroundColor(colors.white)!@#&  term.setTextColor(colors.blue)!@#&  term.clear()!@#&  term.setCursorPos(1, 1)!@#&!@#&  SpeedText.cPrint(\"VNC  \", 1)!@#& !@#&  term.setTextColor(colors.gray)!@#&!@#&  SpeedText.line()!@#&!@#&  term.setCursorPos(2, 4)!@#&  term.setTextColor(colors.black)  !@#&!@#&  SpeedText.cPrint(\"Enter server ID: \", 4)!@#&  term.setCursorPos(20, 5)!@#&  term.setBackgroundColor(colors.lightGray)!@#&  term.setTextColor(colors.white)!@#&  SpeedText.cPrint(\"    \", 5)!@#&  !@#&  term.setTextColor(colors.black)!@#&  term.setCursorPos(23, 5)!@#&  servID = io.read()!@#&!@#&  term.setBackgroundColor(colors.black)!@#&  term.setTextColor(colors.lightBlue)!@#&  term.setCursorPos(1, 1)!@#&  term.clear()!@#&!@#&  shell.run(\"/SpeedOS/Applications/Utils/vnc \"..tostring(servID))!@#&  !@#&  term.setTextColor(colors.white)!@#&  term.setBackgroundColor(colors.black)!@#&  term.setCursorPos(1, 1)!@#&  term.clear()!@#&  error()!@#&end!@#&!@#&function host()!@#&  term.setBackgroundColor(colors.white)!@#&  term.setTextColor(colors.blue)!@#&  term.clear()!@#&  term.setCursorPos(1, 1)!@#&!@#&  SpeedText.cPrint(\"VNC  \", 1)!@#& !@#&  term.setTextColor(colors.gray)!@#&!@#&  SpeedText.line()!@#&!@#&  term.setBackgroundColor(colors.black)!@#&  term.setTextColor(colors.lightBlue)!@#&  term.setCursorPos(1, 1)!@#&  term.clear()!@#&!@#&  shell.run(\"/SpeedOS/Applications/Utils/vnc host\")!@#&  !@#&  term.setTextColor(colors.white)!@#&  term.setBackgroundColor(colors.black)!@#&  term.setCursorPos(1, 1)!@#&  term.clear()!@#&  error()!@#&end!@#&!@#&SpeedGUI.gui.button.add(\"Connect to VNC\",connect,SpeedText.cCursor(\"Connect to VNC\")[1]-2,5,2,3,colors.white,colors.gray)!@#&SpeedGUI.gui.button.add(\"Host VNC\",host,SpeedText.cCursor(\"Host VNC\")[1]-2,9,2,3,colors.white,colors.gray)!@#&SpeedGUI.gui.button.add(\"Exit\",SpeedText.extraExit,SpeedText.cCursor(\"Exit\")[1]-2,13,2,3,colors.white,colors.red)!@#&SpeedGUI.start()",["Word"]="tArgs = {...}!@#&!@#&if OneOS then!@#&	--running under OneOS!@#&	OneOS.ToolBarColour = colours.grey!@#&	OneOS.ToolBarTextColour = colours.white!@#&end!@#&!@#&local _w, _h = term.getSize()!@#&!@#&local round = function(num, idp)!@#&	local mult = 10^(idp or 0)!@#&	return math.floor(num * mult + 0.5) / mult!@#&end!@#&!@#&UIColours = {!@#&	Toolbar = colours.grey,!@#&	ToolbarText = colours.lightGrey,!@#&	ToolbarSelected = colours.lightBlue,!@#&	ControlText = colours.white,!@#&	ToolbarItemTitle = colours.black,!@#&	Background = colours.lightGrey,!@#&	MenuBackground = colours.white,!@#&	MenuText = colours.black,!@#&	MenuSeparatorText = colours.grey,!@#&	MenuDisabledText = colours.lightGrey,!@#&	Shadow = colours.grey,!@#&	TransparentBackgroundOne = colours.white,!@#&	TransparentBackgroundTwo = colours.lightGrey,!@#&	MenuBarActive = colours.white!@#&}!@#&!@#&local getNames = peripheral.getNames or function()!@#&	local tResults = {}!@#&	for n,sSide in ipairs( rs.getSides() ) do!@#&		if peripheral.isPresent( sSide ) then!@#&			table.insert( tResults, sSide )!@#&			local isWireless = false!@#&			if not pcall(function()isWireless = peripheral.call(sSide, 'isWireless') end) then!@#&				isWireless = true!@#&			end     !@#&			if peripheral.getType( sSide ) == \"modem\" and not isWireless then!@#&				local tRemote = peripheral.call( sSide, \"getNamesRemote\" )!@#&				for n,sName in ipairs( tRemote ) do!@#&					table.insert( tResults, sName )!@#&				end!@#&			end!@#&		end!@#&	end!@#&	return tResults!@#&end!@#&!@#&Peripheral = {!@#&	GetPeripheral = function(_type)!@#&		for i, p in ipairs(Peripheral.GetPeripherals()) do!@#&			if p.Type == _type then!@#&				return p!@#&			end!@#&		end!@#&	end,!@#&!@#&	Call = function(type, ...)!@#&		local tArgs = {...}!@#&		local p = Peripheral.GetPeripheral(type)!@#&		peripheral.call(p.Side, unpack(tArgs))!@#&	end,!@#&!@#&	GetPeripherals = function(filterType)!@#&		local peripherals = {}!@#&		for i, side in ipairs(getNames()) do!@#&			local name = peripheral.getType(side):gsub(\"^%l\", string.upper)!@#&			local code = string.upper(side:sub(1,1))!@#&			if side:find('_') then!@#&				code = side:sub(side:find('_')+1)!@#&			end!@#&!@#&			local dupe = false!@#&			for i, v in ipairs(peripherals) do!@#&				if v[1] == name .. ' ' .. code then!@#&					dupe = true!@#&				end!@#&			end!@#&!@#&			if not dupe then!@#&				local _type = peripheral.getType(side)!@#&				local isWireless = false!@#&				if _type == 'modem' then!@#&					if not pcall(function()isWireless = peripheral.call(sSide, 'isWireless') end) then!@#&						isWireless = true!@#&					end     !@#&					if isWireless then!@#&						_type = 'wireless_modem'!@#&						name = 'W '..name!@#&					end!@#&				end!@#&				if not filterType or _type == filterType then!@#&					table.insert(peripherals, {Name = name:sub(1,8) .. ' '..code, Fullname = name .. ' ('..side:sub(1, 1):upper() .. side:sub(2, -1)..')', Side = side, Type = _type, Wireless = isWireless})!@#&				end!@#&			end!@#&		end!@#&		return peripherals!@#&	end,!@#&!@#&	PresentNamed = function(name)!@#&		return peripheral.isPresent(name)!@#&	end,!@#&!@#&	CallType = function(type, ...)!@#&		local tArgs = {...}!@#&		local p = GetPeripheral(type)!@#&		return peripheral.call(p.Side, unpack(tArgs))!@#&	end,!@#&!@#&	CallNamed = function(name, ...)!@#&		local tArgs = {...}!@#&		return peripheral.call(name, unpack(tArgs))!@#&	end!@#&}!@#&!@#&TextLine = {!@#&	Text = \"\",!@#&	Alignment = AlignmentLeft,!@#&!@#&	Initialise = function(self, text, alignment)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Text = text!@#&		new.Alignment = alignment or AlignmentLeft!@#&		return new!@#&	end!@#&}!@#&!@#&local StripColours = function(str)!@#&	return str:gsub('['..string.char(14)..'-'..string.char(29)..']','')!@#&end!@#&!@#&Printer = {!@#&	Name = nil,!@#&	PeripheralType = 'printer',!@#&!@#&	paperLevel = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'getPaperLevel')!@#&	end,!@#&!@#&	newPage = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'newPage')!@#&	end,!@#&!@#&	endPage = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'endPage')!@#&	end,!@#&!@#&	pageWrite = function(self, text)!@#&		return Peripheral.CallNamed(self.Name, 'write', text)!@#&	end,!@#&!@#&	setPageTitle = function(self, title)!@#&		return Peripheral.CallNamed(self.Name, 'setPageTitle', title)!@#&	end,!@#&!@#&	inkLevel = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'getInkLevel')!@#&	end,!@#&!@#&	getCursorPos = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'getCursorPos')!@#&	end,!@#&!@#&	setCursorPos = function(self, x, y)!@#&		return Peripheral.CallNamed(self.Name, 'setCursorPos', x, y)!@#&	end,!@#&!@#&	pageSize = function(self)!@#&		return Peripheral.CallNamed(self.Name, 'getPageSize')!@#&	end,!@#&!@#&	Present = function()!@#&		if Peripheral.GetPeripheral(Printer.PeripheralType) == nil then!@#&			return false!@#&		else!@#&			return true!@#&		end!@#&	end,!@#&!@#&	PrintLines = function(self, lines, title, copies)!@#&		local pages = {}!@#&		local pageLines = {}!@#&		for i, line in ipairs(lines) do!@#&			table.insert(pageLines, TextLine:Initialise(StripColours(line)))!@#&			if i % 25 == 0 then!@#&				table.insert(pages, pageLines)!@#&				pageLines = {}!@#&			end!@#&		end!@#&		if #pageLines ~= 0 then!@#&				table.insert(pages, pageLines)!@#&		end!@#&		return self:PrintPages(pages, title, copies)!@#&	end,!@#&!@#&	PrintPages = function(self, pages, title, copies)!@#&		copies = copies or 1!@#&		for c = 1, copies do!@#&			for p, page in ipairs(pages) do!@#&				if self:paperLevel() < #pages * copies then!@#&					return 'Add more paper to the printer'!@#&				end!@#&				if self:inkLevel() < #pages * copies then!@#&					return 'Add more ink to the printer'!@#&				end!@#&				self:newPage()!@#&				for i, line in ipairs(page) do!@#&					self:setCursorPos(1, i)!@#&					self:pageWrite(StripColours(line.Text))!@#&				end!@#&				if title then!@#&					self:setPageTitle(title)!@#&				end!@#&				self:endPage()!@#&			end!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, name)!@#&		if Printer.Present() then --fix!@#&			local new = {}    -- the new instance!@#&			setmetatable( new, {__index = self} )!@#&			if name and Peripheral.PresentNamed(name) then!@#&				new.Name = name!@#&			else!@#&				new.Name = Peripheral.GetPeripheral(Printer.PeripheralType).Side!@#&			end!@#&			return new!@#&		end!@#&	end!@#&}!@#&!@#&Clipboard = {!@#&	Content = nil,!@#&	Type = nil,!@#&	IsCut = false,!@#&!@#&	Empty = function()!@#&		Clipboard.Content = nil!@#&		Clipboard.Type = nil!@#&		Clipboard.IsCut = false!@#&	end,!@#&!@#&	isEmpty = function()!@#&		return Clipboard.Content == nil!@#&	end,!@#&!@#&	Copy = function(content, _type)!@#&		Clipboard.Content = content!@#&		Clipboard.Type = _type or 'generic'!@#&		Clipboard.IsCut = false!@#&	end,!@#&!@#&	Cut = function(content, _type)!@#&		Clipboard.Content = content!@#&		Clipboard.Type = _type or 'generic'!@#&		Clipboard.IsCut = true!@#&	end,!@#&!@#&	Paste = function()!@#&		local c, t = Clipboard.Content, Clipboard.Type!@#&		if Clipboard.IsCut then!@#&			Clipboard.Empty()!@#&		end!@#&		return c, t!@#&	end!@#&}!@#&!@#&if OneOS and OneOS.Clipboard then!@#&	Clipboard = OneOS.Clipboard!@#&end!@#&!@#&Drawing = {!@#&	!@#&	Screen = {!@#&		Width = _w,!@#&		Height = _h!@#&	},!@#&!@#&	DrawCharacters = function (x, y, characters, textColour,bgColour)!@#&		Drawing.WriteStringToBuffer(x, y, characters, textColour, bgColour)!@#&	end,!@#&	!@#&	DrawBlankArea = function (x, y, w, h, colour)!@#&		Drawing.DrawArea (x, y, w, h, \" \", 1, colour)!@#&	end,!@#&!@#&	DrawArea = function (x, y, w, h, character, textColour, bgColour)!@#&		--width must be greater than 1, other wise we get a stack overflow!@#&		if w < 0 then!@#&			w = w * -1!@#&		elseif w == 0 then!@#&			w = 1!@#&		end!@#&!@#&		for ix = 1, w do!@#&			local currX = x + ix - 1!@#&			for iy = 1, h do!@#&				local currY = y + iy - 1!@#&				Drawing.WriteToBuffer(currX, currY, character, textColour, bgColour)!@#&			end!@#&		end!@#&	end,!@#&!@#&	DrawImage = function(_x,_y,tImage, w, h)!@#&		if tImage then!@#&			for y = 1, h do!@#&				if not tImage[y] then!@#&					break!@#&				end!@#&				for x = 1, w do!@#&					if not tImage[y][x] then!@#&						break!@#&					end!@#&					local bgColour = tImage[y][x]!@#&		            local textColour = tImage.textcol[y][x] or colours.white!@#&		            local char = tImage.text[y][x]!@#&		            Drawing.WriteToBuffer(x+_x-1, y+_y-1, char, textColour, bgColour)!@#&				end!@#&			end!@#&		elseif w and h then!@#&			Drawing.DrawBlankArea(x, y, w, h, colours.green)!@#&		end!@#&	end,!@#&	--using .nft!@#&	LoadImage = function(path)!@#&		local image = {!@#&			text = {},!@#&			textcol = {}!@#&		}!@#&		local fs = fs!@#&		if OneOS then!@#&			fs = OneOS.FS!@#&		end!@#&		if fs.exists(path) then!@#&			local _open = io.open!@#&			if OneOS then!@#&				_open = OneOS.IO.open!@#&			end!@#&	        local file = _open(path, \"r\")!@#&	        local sLine = file:read()!@#&	        local num = 1!@#&	        while sLine do  !@#&	                table.insert(image, num, {})!@#&	                table.insert(image.text, num, {})!@#&	                table.insert(image.textcol, num, {})!@#&	                                            !@#&	                --As we're no longer 1-1, we keep track of what index to write to!@#&	                local writeIndex = 1!@#&	                --Tells us if we've hit a 30 or 31 (BG and FG respectively)- next char specifies the curr colour!@#&	                local bgNext, fgNext = false, false!@#&	                --The current background and foreground colours!@#&	                local currBG, currFG = nil,nil!@#&	                for i=1,#sLine do!@#&	                        local nextChar = string.sub(sLine, i, i)!@#&	                        if nextChar:byte() == 30 then!@#&                                bgNext = true!@#&	                        elseif nextChar:byte() == 31 then!@#&                                fgNext = true!@#&	                        elseif bgNext then!@#&                                currBG = Drawing.GetColour(nextChar)!@#&                                bgNext = false!@#&	                        elseif fgNext then!@#&                                currFG = Drawing.GetColour(nextChar)!@#&                                fgNext = false!@#&	                        else!@#&                                if nextChar ~= \" \" and currFG == nil then!@#&                                       currFG = colours.white!@#&                                end!@#&                                image[num][writeIndex] = currBG!@#&                                image.textcol[num][writeIndex] = currFG!@#&                                image.text[num][writeIndex] = nextChar!@#&                                writeIndex = writeIndex + 1!@#&	                        end!@#&	                end!@#&	                num = num+1!@#&	                sLine = file:read()!@#&	        end!@#&	        file:close()!@#&		end!@#&	 	return image!@#&	end,!@#&!@#&	DrawCharactersCenter = function(x, y, w, h, characters, textColour,bgColour)!@#&		w = w or Drawing.Screen.Width!@#&		h = h or Drawing.Screen.Height!@#&		x = x or 0!@#&		y = y or 0!@#&		x = math.ceil((w - #characters) / 2) + x!@#&		y = math.floor(h / 2) + y!@#&!@#&		Drawing.DrawCharacters(x, y, characters, textColour, bgColour)!@#&	end,!@#&!@#&	GetColour = function(hex)!@#&		if hex == ' ' then!@#&			return colours.transparent!@#&		end!@#&	    local value = tonumber(hex, 16)!@#&	    if not value then return nil end!@#&	    value = math.pow(2,value)!@#&	    return value!@#&	end,!@#&!@#&	Clear = function (_colour)!@#&		_colour = _colour or colours.black!@#&		Drawing.ClearBuffer()!@#&		Drawing.DrawBlankArea(1, 1, Drawing.Screen.Width, Drawing.Screen.Height, _colour)!@#&	end,!@#&!@#&	Buffer = {},!@#&	BackBuffer = {},!@#&!@#&	DrawBuffer = function()!@#&		for y,row in pairs(Drawing.Buffer) do!@#&			for x,pixel in pairs(row) do!@#&				local shouldDraw = true!@#&				local hasBackBuffer = true!@#&				if Drawing.BackBuffer[y] == nil or Drawing.BackBuffer[y][x] == nil or #Drawing.BackBuffer[y][x] ~= 3 then!@#&					hasBackBuffer = false!@#&				end!@#&				if hasBackBuffer and Drawing.BackBuffer[y][x][1] == Drawing.Buffer[y][x][1] and Drawing.BackBuffer[y][x][2] == Drawing.Buffer[y][x][2] and Drawing.BackBuffer[y][x][3] == Drawing.Buffer[y][x][3] then!@#&					shouldDraw = false!@#&				end!@#&				if shouldDraw then!@#&					term.setBackgroundColour(pixel[3])!@#&					term.setTextColour(pixel[2])!@#&					term.setCursorPos(x, y)!@#&					term.write(pixel[1])!@#&				end!@#&			end!@#&		end!@#&		Drawing.BackBuffer = Drawing.Buffer!@#&		Drawing.Buffer = {}!@#&		term.setCursorPos(1,1)!@#&	end,!@#&!@#&	ClearBuffer = function()!@#&		Drawing.Buffer = {}!@#&	end,!@#&!@#&	WriteStringToBuffer = function (x, y, characters, textColour,bgColour)!@#&		for i = 1, #characters do!@#&   			local character = characters:sub(i,i)!@#&   			Drawing.WriteToBuffer(x + i - 1, y, character, textColour, bgColour)!@#&		end!@#&	end,!@#&!@#&	WriteToBuffer = function(x, y, character, textColour,bgColour)!@#&		x = round(x)!@#&		y = round(y)!@#&		if bgColour == colours.transparent then!@#&			Drawing.Buffer[y] = Drawing.Buffer[y] or {}!@#&			Drawing.Buffer[y][x] = Drawing.Buffer[y][x] or {\"\", colours.white, colours.black}!@#&			Drawing.Buffer[y][x][1] = character!@#&			Drawing.Buffer[y][x][2] = textColour!@#&		else!@#&			Drawing.Buffer[y] = Drawing.Buffer[y] or {}!@#&			Drawing.Buffer[y][x] = {character, textColour, bgColour}!@#&		end!@#&	end,!@#&}!@#&!@#&Current = {!@#&	Document = nil,!@#&	TextInput = nil,!@#&	CursorPos = {1,1},!@#&	CursorColour = colours.black,!@#&	Selection = {8, 36},!@#&	Window = nil,!@#&	Modified = false,!@#&}!@#&!@#&local isQuitting = false!@#&!@#&function OrderSelection()!@#&	if Current.Selection then!@#&		if Current.Selection[1] <= Current.Selection[2] then!@#&			return Current.Selection!@#&		else!@#&			return {Current.Selection[2], Current.Selection[1]}!@#&		end!@#&	end!@#&end!@#&!@#&function StripColours(str)!@#&	return str:gsub('['..string.char(14)..'-'..string.char(29)..']','')!@#&end!@#&!@#&function FindColours(str)!@#&	local _, count = str:gsub('['..string.char(14)..'-'..string.char(29)..']','')!@#&	return count!@#&end!@#&!@#&ColourFromCharacter = function(character)!@#&	local n = character:byte() - 14!@#&	if n > 16 then!@#&		return nil!@#&	else!@#&		return 2^n!@#&	end!@#&end!@#&!@#&CharacterFromColour = function(colour)!@#&	return string.char(math.floor(math.log(colour)/math.log(2))+14)!@#&end!@#&!@#&Events = {}!@#&!@#&Button = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	BackgroundColour = colours.lightGrey,!@#&	TextColour = colours.white,!@#&	ActiveBackgroundColour = colours.lightGrey,!@#&	Text = \"\",!@#&	Parent = nil,!@#&	_Click = nil,!@#&	Toggle = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)!@#&		local bg = self.BackgroundColour!@#&		local tc = self.TextColour!@#&		if type(bg) == 'function' then!@#&			bg = bg()!@#&		end!@#&!@#&		if self.Toggle then!@#&			tc = UIColours.MenuBarActive!@#&			bg = self.ActiveBackgroundColour!@#&		end!@#&!@#&		local pos = GetAbsolutePosition(self)!@#&		Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, bg)!@#&		Drawing.DrawCharactersCenter(pos.X, pos.Y, self.Width, self.Height, self.Text, tc, bg)!@#&	end,!@#&!@#&	Initialise = function(self, x, y, width, height, backgroundColour, parent, click, text, textColour, toggle, activeBackgroundColour)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		height = height or 1!@#&		new.Width = width or #text + 2!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.Text = text or \"\"!@#&		new.BackgroundColour = backgroundColour or colours.lightGrey!@#&		new.TextColour = textColour or colours.white!@#&		new.ActiveBackgroundColour = activeBackgroundColour or colours.lightGrey!@#&		new.Parent = parent!@#&		new._Click = click!@#&		new.Toggle = toggle!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		if self._Click then!@#&			if self:_Click(side, x, y, not self.Toggle) ~= false and self.Toggle ~= nil then!@#&				self.Toggle = not self.Toggle!@#&				Draw()!@#&			end!@#&			return true!@#&		else!@#&			return false!@#&		end!@#&	end!@#&}!@#&!@#&TextBox = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	BackgroundColour = colours.lightGrey,!@#&	TextColour = colours.black,!@#&	Parent = nil,!@#&	TextInput = nil,!@#&	Placeholder = '',!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)		!@#&		local pos = GetAbsolutePosition(self)!@#&		Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, self.BackgroundColour)!@#&		local text = self.TextInput.Value!@#&		if #tostring(text) > (self.Width - 2) then!@#&			text = text:sub(#text-(self.Width - 3))!@#&			if Current.TextInput == self.TextInput then!@#&				Current.CursorPos = {pos.X + 1 + self.Width-2, pos.Y}!@#&			end!@#&		else!@#&			if Current.TextInput == self.TextInput then!@#&				Current.CursorPos = {pos.X + 1 + self.TextInput.CursorPos, pos.Y}!@#&			end!@#&		end!@#&		!@#&		if #tostring(text) == 0 then!@#&			Drawing.DrawCharacters(pos.X + 1, pos.Y, self.Placeholder, colours.lightGrey, self.BackgroundColour)!@#&		else!@#&			Drawing.DrawCharacters(pos.X + 1, pos.Y, text, self.TextColour, self.BackgroundColour)!@#&		end!@#&!@#&		term.setCursorBlink(true)!@#&		!@#&		Current.CursorColour = self.TextColour!@#&	end,!@#&!@#&	Initialise = function(self, x, y, width, height, parent, text, backgroundColour, textColour, done, numerical)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		height = height or 1!@#&		new.Width = width or #text + 2!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.TextInput = TextInput:Initialise(text or '', function(key)!@#&			if done then!@#&				done(key)!@#&			end!@#&			Draw()!@#&		end, numerical)!@#&		new.BackgroundColour = backgroundColour or colours.lightGrey!@#&		new.TextColour = textColour or colours.black!@#&		new.Parent = parent!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		Current.Input = self.TextInput!@#&		self:Draw()!@#&	end!@#&}!@#&!@#&TextInput = {!@#&	Value = \"\",!@#&	Change = nil,!@#&	CursorPos = nil,!@#&	Numerical = false,!@#&	IsDocument = nil,!@#&!@#&	Initialise = function(self, value, change, numerical, isDocument)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Value = tostring(value)!@#&		new.Change = change!@#&		new.CursorPos = #tostring(value)!@#&		new.Numerical = numerical!@#&		new.IsDocument = isDocument or false!@#&		return new!@#&	end,!@#&!@#&	Insert = function(self, str)!@#&		if self.Numerical then!@#&			str = tostring(tonumber(str))!@#&		end!@#&!@#&		local selection = OrderSelection()!@#&!@#&		if self.IsDocument and selection then!@#&			self.Value = string.sub(self.Value, 1, selection[1]-1) .. str .. string.sub( self.Value, selection[2]+2)!@#&			self.CursorPos = selection[1]!@#&			Current.Selection = nil!@#&		else!@#&			local _, newLineAdjust = string.gsub(self.Value:sub(1, self.CursorPos), '\\n','')!@#&!@#&			self.Value = string.sub(self.Value, 1, self.CursorPos + newLineAdjust) .. str .. string.sub( self.Value, self.CursorPos + 1  + newLineAdjust)!@#&			self.CursorPos = self.CursorPos + 1!@#&		end!@#&		!@#&		self.Change(key)!@#&	end,!@#&!@#&	Extract = function(self, remove)!@#&		local selection = OrderSelection()!@#&		if self.IsDocument and selection then!@#&			local _, newLineAdjust = string.gsub(self.Value:sub(selection[1], selection[2]), '\\n','')!@#&			local str = string.sub(self.Value, selection[1], selection[2]+1+newLineAdjust)!@#&			if remove then!@#&				self.Value = string.sub(self.Value, 1, selection[1]-1) .. string.sub( self.Value, selection[2]+2+newLineAdjust)!@#&				self.CursorPos = selection[1] - 1!@#&				Current.Selection = nil!@#&			end!@#&			return str!@#&		end!@#&	end,!@#&!@#&	Char = function(self, char)!@#&		if char == 'nil' then!@#&			return!@#&		end!@#&		self:Insert(char)!@#&	end,!@#&!@#&	Key = function(self, key)!@#&		if key == keys.enter then!@#&			if self.IsDocument then!@#&				self.Value = string.sub(self.Value, 1, self.CursorPos ) .. '\\n' .. string.sub( self.Value, self.CursorPos + 1 )!@#&				self.CursorPos = self.CursorPos + 1!@#&			end!@#&			self.Change(key)		!@#&		elseif key == keys.left then!@#&			-- Left!@#&			if self.CursorPos > 0 then!@#&				local colShift = FindColours(string.sub( self.Value, self.CursorPos, self.CursorPos))!@#&				self.CursorPos = self.CursorPos - 1 - colShift!@#&				self.Change(key)!@#&			end!@#&			!@#&		elseif key == keys.right then!@#&			-- Right				!@#&			if self.CursorPos < string.len(self.Value) then!@#&				local colShift = FindColours(string.sub( self.Value, self.CursorPos+1, self.CursorPos+1))!@#&				self.CursorPos = self.CursorPos + 1 + colShift!@#&				self.Change(key)!@#&			end!@#&		!@#&		elseif key == keys.backspace then!@#&			-- Backspace!@#&			if self.IsDocument and Current.Selection then!@#&				self:Extract(true)!@#&				self.Change(key)!@#&			elseif self.CursorPos > 0 then!@#&				local colShift = FindColours(string.sub( self.Value, self.CursorPos, self.CursorPos))!@#&				local _, newLineAdjust = string.gsub(self.Value:sub(1, self.CursorPos), '\\n','')!@#&!@#&				self.Value = string.sub( self.Value, 1, self.CursorPos - 1 - colShift + newLineAdjust) .. string.sub( self.Value, self.CursorPos + 1 - colShift + newLineAdjust)!@#&				self.CursorPos = self.CursorPos - 1 - colShift!@#&				self.Change(key)!@#&			end!@#&		elseif key == keys.home then!@#&			-- Home!@#&			self.CursorPos = 0!@#&			self.Change(key)!@#&		elseif key == keys.delete then!@#&			if self.IsDocument and Current.Selection then!@#&				self:Extract(true)!@#&				self.Change(key)!@#&			elseif self.CursorPos < string.len(self.Value) then!@#&				self.Value = string.sub( self.Value, 1, self.CursorPos ) .. string.sub( self.Value, self.CursorPos + 2 )				!@#&				self.Change(key)!@#&			end!@#&		elseif key == keys[\"end\"] then!@#&			-- End!@#&			self.CursorPos = string.len(self.Value)!@#&			self.Change(key)!@#&		elseif key == keys.up and self.IsDocument then!@#&			-- Up!@#&			if Current.Document.CursorPos then!@#&				local page = Current.Document.Pages[Current.Document.CursorPos.Page]!@#&				self.CursorPos = page:GetCursorPosFromPoint(Current.Document.CursorPos.Collum + page.MarginX, Current.Document.CursorPos.Line - page.MarginY - 1 + Current.Document.ScrollBar.Scroll, true)!@#&				self.Change(key)!@#&			end!@#&		elseif key == keys.down and self.IsDocument then!@#&			-- Down!@#&			if Current.Document.CursorPos then!@#&				local page = Current.Document.Pages[Current.Document.CursorPos.Page]!@#&				self.CursorPos = page:GetCursorPosFromPoint(Current.Document.CursorPos.Collum + page.MarginX, Current.Document.CursorPos.Line - page.MarginY + 1 + Current.Document.ScrollBar.Scroll, true)!@#&				self.Change(key)!@#&			end!@#&		end!@#&	end!@#&}!@#&!@#&Menu = {!@#&	X = 0,!@#&	Y = 0,!@#&	Width = 0,!@#&	Height = 0,!@#&	Owner = nil,!@#&	Items = {},!@#&	RemoveTop = false,!@#&!@#&	Draw = function(self)!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y + 1, self.Width, self.Height, UIColours.Shadow)!@#&		if not self.RemoveTop then!@#&			Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.MenuBackground)!@#&			for i, item in ipairs(self.Items) do!@#&				if item.Separator then!@#&					Drawing.DrawArea(self.X, self.Y + i, self.Width, 1, '-', colours.grey, UIColours.MenuBackground)!@#&				else!@#&					local textColour = item.Colour or UIColours.MenuText!@#&					if (item.Enabled and type(item.Enabled) == 'function' and item.Enabled() == false) or item.Enabled == false then!@#&						textColour = UIColours.MenuDisabledText!@#&					end!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i, item.Title, textColour, UIColours.MenuBackground)!@#&				end!@#&			end!@#&		else!@#&			Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.MenuBackground)!@#&			for i, item in ipairs(self.Items) do!@#&				if item.Separator then!@#&					Drawing.DrawArea(self.X, self.Y + i - 1, self.Width, 1, '-', colours.grey, UIColours.MenuBackground)!@#&				else!@#&					local textColour = item.Colour or UIColours.MenuText!@#&					if (item.Enabled and type(item.Enabled) == 'function' and item.Enabled() == false) or item.Enabled == false then!@#&						textColour = UIColours.MenuDisabledText!@#&					end!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - 1, item.Title, textColour, UIColours.MenuBackground)!@#&!@#&					Drawing.DrawCharacters(self.X - 1 + self.Width-#item.KeyName, self.Y + i - 1, item.KeyName, textColour, UIColours.MenuBackground)!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	NameForKey = function(self, key)!@#&		if key == keys.leftCtrl then!@#&			return '^'!@#&		elseif key == keys.tab then!@#&			return 'Tab'!@#&		elseif key == keys.delete then!@#&			return 'Delete'!@#&		elseif key == keys.n then!@#&			return 'N'!@#&		elseif key == keys.a then!@#&			return 'A'!@#&		elseif key == keys.s then!@#&			return 'S'!@#&		elseif key == keys.o then!@#&			return 'O'!@#&		elseif key == keys.z then!@#&			return 'Z'!@#&		elseif key == keys.y then!@#&			return 'Y'!@#&		elseif key == keys.c then!@#&			return 'C'!@#&		elseif key == keys.x then!@#&			return 'X'!@#&		elseif key == keys.v then!@#&			return 'V'!@#&		elseif key == keys.r then!@#&			return 'R'!@#&		elseif key == keys.l then!@#&			return 'L'!@#&		elseif key == keys.t then!@#&			return 'T'!@#&		elseif key == keys.h then!@#&			return 'H'!@#&		elseif key == keys.e then!@#&			return 'E'!@#&		elseif key == keys.p then!@#&			return 'P'!@#&		elseif key == keys.f then!@#&			return 'F'!@#&		elseif key == keys.m then!@#&			return 'M'!@#&		elseif key == keys.q then!@#&			return 'Q'!@#&		else!@#&			return '?'		!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, x, y, items, owner, removeTop)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		if not owner then!@#&			return!@#&		end!@#&!@#&		local keyNames = {}!@#&!@#&		for i, v in ipairs(items) do!@#&			items[i].KeyName = ''!@#&			if v.Keys then!@#&				for _i, key in ipairs(v.Keys) do!@#&					items[i].KeyName = items[i].KeyName .. self:NameForKey(key)!@#&				end!@#&			end!@#&			if items[i].KeyName ~= '' then!@#&				table.insert(keyNames, items[i].KeyName)!@#&			end!@#&		end!@#&		local keysLength = LongestString(keyNames)!@#&		if keysLength > 0 then!@#&			keysLength = keysLength + 2!@#&		end!@#&!@#&		new.Width = LongestString(items, 'Title') + 2 + keysLength!@#&		if new.Width < 10 then!@#&			new.Width = 10!@#&		end!@#&		new.Height = #items + 2!@#&		new.RemoveTop = removeTop or false!@#&		if removeTop then!@#&			new.Height = new.Height - 1!@#&		end!@#&		!@#&		if y < 1 then!@#&			y = 1!@#&		end!@#&		if x < 1 then!@#&			x = 1!@#&		end!@#&!@#&		if y + new.Height > Drawing.Screen.Height + 1 then!@#&			y = Drawing.Screen.Height - new.Height!@#&		end!@#&		if x + new.Width > Drawing.Screen.Width + 1 then!@#&			x = Drawing.Screen.Width - new.Width!@#&		end!@#&!@#&!@#&		new.Y = y!@#&		new.X = x!@#&		new.Items = items!@#&		new.Owner = owner!@#&		return new!@#&	end,!@#&!@#&	New = function(self, x, y, items, owner, removeTop)!@#&		if Current.Menu and Current.Menu.Owner == owner then!@#&			Current.Menu = nil!@#&			return!@#&		end!@#&!@#&		local new = self:Initialise(x, y, items, owner, removeTop)!@#&		Current.Menu = new!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local i = y-1!@#&		if self.RemoveTop then!@#&			i = y!@#&		end!@#&		if i >= 1 and y < self.Height then!@#&			if not ((self.Items[i].Enabled and type(self.Items[i].Enabled) == 'function' and self.Items[i].Enabled() == false) or self.Items[i].Enabled == false) and self.Items[i].Click then!@#&				self.Items[i]:Click()!@#&				if Current.Menu.Owner and Current.Menu.Owner.Toggle then!@#&					Current.Menu.Owner.Toggle = false!@#&				end!@#&				Current.Menu = nil!@#&				self = nil!@#&			end!@#&			return true!@#&		end!@#&	end!@#&}!@#&!@#&MenuBar = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = Drawing.Screen.Width,!@#&	Height = 1,!@#&	MenuBarItems = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		--Drawing.DrawArea(self.X - 1, self.Y, 1, self.Height, \"|\", UIColours.ToolbarText, UIColours.Background)!@#&!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, colours.grey)!@#&		for i, button in ipairs(self.MenuBarItems) do!@#&			button:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, items)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.X = 1!@#&		new.Y = 1!@#&		new.MenuBarItems = items!@#&		return new!@#&	end,!@#&!@#&	AddToolbarItem = function(self, item)!@#&		table.insert(self.ToolbarItems, item)!@#&		self:CalculateToolbarItemPositions()!@#&	end,!@#&!@#&	CalculateToolbarItemPositions = function(self)!@#&		local currY = 1!@#&		for i, toolbarItem in ipairs(self.ToolbarItems) do!@#&			toolbarItem.Y = currY!@#&			currY = currY + toolbarItem.Height!@#&		end!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		for i, item in ipairs(self.MenuBarItems) do!@#&			if item.X <= x and item.X + item.Width > x then!@#&				if item:Click(item, side, x - item.X + 1, 1) then!@#&					return true!@#&				end!@#&			end!@#&		end!@#&		return false!@#&	end!@#&}!@#&!@#&TextFormatPlainText = 1!@#&TextFormatInkText = 2!@#&!@#&Document = {!@#&	X = 1,!@#&	Y = 1,!@#&	PageSize = {Width = 25, Height = 21},!@#&	TextInput = nil,!@#&	Pages = {},!@#&	Format = TextFormatPlainText,!@#&	Title = '',!@#&	Path = nil,!@#&	ScrollBar = nil,!@#&	Lines = {},!@#&	CursorPos = nil,!@#&!@#&	CalculateLineWrapping = function(self)!@#&		local limit = self.PageSize.Width!@#&		local text = self.TextInput.Value!@#&        local lines = {''}!@#&        local words = {}!@#&!@#&        for word, space in text:gmatch('(%S+)(%s*)') do!@#&        	for i = 1, math.ceil(#word/limit) do!@#&        		local _space = ''!@#&        		if i == math.ceil(#word/limit) then!@#&        			_space = space!@#&        		end!@#&        		table.insert(words, {word:sub(1+limit*(i-1), limit*i), _space})!@#&        	end!@#&        end!@#&!@#&        for i, ws in ipairs(words) do!@#&        		local word = ws[1]!@#&        		local space = ws[2]!@#&                local temp = lines[#lines] .. word .. space:gsub('\\n','')!@#&                if #temp > limit then!@#&                    table.insert(lines, '')!@#&                end!@#&                if space:find('\\n') then!@#&                    lines[#lines] = lines[#lines] .. word!@#&                    !@#&                    space = space:gsub('\\n', function()!@#&                            table.insert(lines, '')!@#&                            return ''!@#&                    end)!@#&                else!@#&                    lines[#lines] = lines[#lines] .. word .. space!@#&                end!@#&        end!@#&        return lines!@#&	end,!@#&!@#&	CalculateCursorPos = function(self)!@#&		local passedCharacters = 0!@#&		Current.CursorPos = nil!@#&		for p, page in ipairs(self.Pages) do!@#&			page:Draw()!@#&			if not Current.CursorPos then!@#&				for i, line in ipairs(page.Lines) do!@#&					local relCursor = self.TextInput.CursorPos - FindColours(self.TextInput.Value:sub(1,self.TextInput.CursorPos))!@#&					if passedCharacters + #StripColours(line.Text:gsub('\\n','')) >= relCursor then!@#&						Current.CursorPos = {self.X + page.MarginX + (relCursor - passedCharacters), page.Y + 1 + i}!@#&						self.CursorPos = {Page = p, Line = i, Collum = relCursor - passedCharacters - FindColours(self.TextInput.Value:sub(1,self.TextInput.CursorPos-1))}!@#&						break!@#&					end!@#&					passedCharacters = passedCharacters + #StripColours(line.Text:gsub('\\n',''))!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	Draw = function(self)!@#&		self:CalculatePages()!@#&		self:CalculateCursorPos()!@#&		self.ScrollBar:Draw()!@#&	end,!@#&!@#&	CalculatePages = function(self)!@#&		self.Pages = {}!@#&		local lines = self:CalculateLineWrapping()!@#&		self.Lines = lines!@#&		local pageLines = {}!@#&		local totalPageHeight = (3 + self.PageSize.Height + 2 * Page.MarginY)!@#&		for i, line in ipairs(lines) do!@#&			table.insert(pageLines, TextLine:Initialise(line))!@#&			if i % self.PageSize.Height == 0 then!@#&				table.insert(self.Pages, Page:Initialise(self, pageLines, 3 - self.ScrollBar.Scroll + totalPageHeight*(#self.Pages)))!@#&				pageLines = {}!@#&			end!@#&		end!@#&		if #pageLines ~= 0 then!@#&			table.insert(self.Pages, Page:Initialise(self, pageLines, 3 - self.ScrollBar.Scroll + totalPageHeight*(#self.Pages)))!@#&		end!@#&!@#&		self.ScrollBar.MaxScroll = totalPageHeight*(#self.Pages) - Drawing.Screen.Height + 1!@#&	end,!@#&!@#&	ScrollToCursor = function(self)!@#&		self:CalculateCursorPos()!@#&		if Current.CursorPos and !@#&			(Current.CursorPos[2] > Drawing.Screen.Height !@#&			or Current.CursorPos[2] < 2) then!@#&			self.ScrollBar:DoScroll(Current.CursorPos[2] - Drawing.Screen.Height)!@#&		end!@#&	end,!@#&!@#&	SetSelectionColour = function(self, colour)!@#&		local selection = OrderSelection()!@#&		local text = self.TextInput:Extract(true)!@#&		local colChar = CharacterFromColour(colour)!@#&		local precedingColour = ''!@#&		if FindColours(self.TextInput.Value:sub(self.TextInput.CursorPos+1, self.TextInput.CursorPos+1)) == 0 then!@#&			for i = 1, self.TextInput.CursorPos do!@#&				local c = self.TextInput.Value:sub(self.TextInput.CursorPos - i,self.TextInput.CursorPos - i)!@#&				if FindColours(c) == 1 then!@#&					precedingColour = c!@#&					break!@#&				end!@#&			end!@#&			if precedingColour == '' then!@#&				precedingColour = CharacterFromColour(colours.black)!@#&			end!@#&		end!@#&!@#&		self.TextInput:Insert(colChar..StripColours(text)..precedingColour)!@#&		--text = text:gsub('['..string.char(14)..'-'..string.char(29)..']','')!@#&	end,!@#&!@#&	Initialise = function(self, text, title, path)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Title = title or 'New Document'!@#&		new.Path = path!@#&		new.X = (Drawing.Screen.Width - (new.PageSize.Width + 2*(Page.MarginX)))/2!@#&		new.Y = 2!@#&		new.TextInput = TextInput:Initialise(text, function()!@#&			new:ScrollToCursor() !@#&			Current.Modified = true!@#&			Draw()!@#&		end, false, true)!@#&		new.ScrollBar = ScrollBar:Initialise(Drawing.Screen.Width, new.Y, Drawing.Screen.Height-1, 0, nil, nil, nil, function()end)!@#&		Current.TextInput = new.TextInput!@#&		Current.ScrollBar = new.ScrollBar!@#&		return new!@#&	end!@#&}!@#&!@#&ScrollBar = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 1,!@#&	Height = 1,!@#&	BackgroundColour = colours.grey,!@#&	BarColour = colours.lightBlue,!@#&	Parent = nil,!@#&	Change = nil,!@#&	Scroll = 0,!@#&	MaxScroll = 0,!@#&	ClickPoint = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)!@#&		local pos = GetAbsolutePosition(self)!@#&	    local barHeight = self.Height - self.MaxScroll!@#&	    if barHeight < 3 then!@#&	      barHeight = 3!@#&	    end!@#&	    local percentage = (self.Scroll/self.MaxScroll)!@#&!@#&	    Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, self.BackgroundColour)!@#&	    Drawing.DrawBlankArea(pos.X, pos.Y + round(self.Height*percentage - barHeight*percentage), self.Width, barHeight, self.BarColour)!@#&	end,!@#&!@#&	Initialise = function(self, x, y, height, maxScroll, backgroundColour, barColour, parent, change)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 1!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.BackgroundColour = backgroundColour or colours.grey!@#&		new.BarColour = barColour or colours.lightBlue!@#&		new.Parent = parent!@#&		new.Change = change or function()end!@#&		new.MaxScroll = maxScroll!@#&		new.Scroll = 0!@#&		return new!@#&	end,!@#&!@#&	DoScroll = function(self, amount)!@#&		amount = round(amount)!@#&		if self.Scroll < 0 or self.Scroll > self.MaxScroll then!@#&			return false!@#&		end!@#&		self.Scroll = self.Scroll + amount!@#&		if self.Scroll < 0 then!@#&			self.Scroll = 0!@#&		elseif self.Scroll > self.MaxScroll then!@#&			self.Scroll = self.MaxScroll!@#&		end!@#&		self.Change()!@#&		return true!@#&	end,!@#&!@#&	Click = function(self, side, x, y, drag)!@#&		local percentage = (self.Scroll/self.MaxScroll)!@#&		local barHeight = (self.Height - self.MaxScroll)!@#&		if barHeight < 3 then!@#&			barHeight = 3!@#&		end!@#&		local relScroll = (self.MaxScroll*(y + barHeight*percentage)/self.Height)!@#&		if not drag then!@#&			self.ClickPoint = self.Scroll - relScroll + 1!@#&		end!@#&!@#&		if self.Scroll-1 ~= relScroll then!@#&			self:DoScroll(relScroll-self.Scroll-1 + self.ClickPoint)!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&AlignmentLeft = 1!@#&AlignmentCentre = 2!@#&AlignmentRight = 3!@#&!@#&TextLine = {!@#&	Text = \"\",!@#&	Alignment = AlignmentLeft,!@#&!@#&	Initialise = function(self, text, alignment)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Text = text!@#&		new.Alignment = alignment or AlignmentLeft!@#&		return new!@#&	end!@#&}!@#&!@#&local clickPos = 1!@#&Page = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 1,!@#&	Height = 1,!@#&	MarginX = 3,!@#&	MarginY = 2,!@#&	BackgroundColour = colours.white,!@#&	TextColour = colours.white,!@#&	ActiveBackgroundColour = colours.lightGrey,!@#&	Lines = {},!@#&	Parent = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)!@#&		local pos = GetAbsolutePosition(self)!@#&!@#&		if pos.Y > Drawing.Screen.Height or pos.Y + self.Height < 1 then!@#&			return!@#&		end!@#&!@#&		Drawing.DrawBlankArea(pos.X+self.Width,pos.Y -1 + 1, 1, self.Height, UIColours.Shadow)!@#&		Drawing.DrawBlankArea(pos.X+1, pos.Y -1 + self.Height, self.Width, 1, UIColours.Shadow)!@#&		Drawing.DrawBlankArea(pos.X, pos.Y -1, self.Width, self.Height, self.BackgroundColour)!@#&!@#&		local textColour = self.TextColour!@#&		if not Current.Selection then!@#&			for i, line in ipairs(self.Lines) do!@#&				local _c = 1!@#&				for c = 1, #line.Text do!@#&					local col = ColourFromCharacter(line.Text:sub(c,c))!@#&					if col then!@#&						textColour = col!@#&					else!@#&						Drawing.WriteToBuffer(pos.X + self.MarginX - 1 + _c, pos.Y -2 + i + self.MarginY, line.Text:sub(c,c), textColour, self.BackgroundColour)!@#&						_c = _c + 1!@#&					end!@#&				end!@#&			end!@#&		else!@#&			local selection = OrderSelection()!@#&			local char = 1!@#&			local textColour = self.TextColour!@#&			for i, line in ipairs(self.Lines) do!@#&				local _c = 1!@#&				for c = 1, #line.Text do!@#&					local col = ColourFromCharacter(line.Text:sub(c,c))!@#&					if col then!@#&						textColour = col!@#&					else!@#&						local tc = textColour!@#&						local colour = colours.white!@#&						if char >= selection[1] and char <= selection[2] then!@#&							colour = colours.lightBlue!@#&							tc = colours.white!@#&						end!@#&!@#&						Drawing.WriteToBuffer(pos.X + self.MarginX - 1 + _c, pos.Y -2 + i + self.MarginY, line.Text:sub(c,c), tc, colour)!@#&						_c = _c + 1!@#&					end!@#&					char = char + 1!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, parent, lines, y)!@#&		local new = {}    -- the new instanc!@#&		setmetatable( new, {__index = self} )!@#&		new.Height = parent.PageSize.Height + 2 * self.MarginY!@#&		new.Width = parent.PageSize.Width + 2 * self.MarginX!@#&		new.X = 1!@#&		new.Y = y or 1!@#&		new.Lines = lines or {}!@#&		new.BackgroundColour = colours.white!@#&		new.TextColour = colours.black!@#&		new.Parent = parent!@#&		new.ClickPos = 1!@#&		return new!@#&	end,!@#&!@#&	GetCursorPosFromPoint = function(self, x, y, rel)!@#&		local pos = GetAbsolutePosition(self)!@#&		if rel then!@#&			pos = {Y = 0, X = 0}!@#&		end!@#&		local row = y - pos.Y + self.MarginY - self.Parent.ScrollBar.Scroll!@#&		local col = x - self.MarginX - pos.X + 1!@#&		local cursorPos = 0!@#&		if row <= 0 or col <= 0 then!@#&			return 0!@#&		end!@#&!@#&		if row > #self.Lines then!@#&			for i, v in ipairs(self.Lines) do!@#&				cursorPos = cursorPos + #v.Text-- - FindColours(v.Text)!@#&			end!@#&			return cursorPos!@#&		end!@#&!@#&		--term.setCursorPos(1,3)!@#&		local prevLineCount = 0!@#&		for i, v in ipairs(self.Lines) do!@#&			if i == row then!@#&				if col > #v.Text then!@#&					col = #v.Text-- + FindColours(v.Text)!@#&				else!@#&					col = col + FindColours(v.Text:sub(1, col))!@#&				end!@#&				--term.setCursorPos(1,2)!@#&				--print(prevLineCount)!@#&				cursorPos = cursorPos + col + 2 - i - prevLineCount!@#&				break!@#&			else!@#&				prevLineCount = FindColours(v.Text)!@#&				if prevLineCount ~= 0 then!@#&					prevLineCount = prevLineCount!@#&				end!@#&				cursorPos = cursorPos + #v.Text + 2 - i + FindColours(v.Text)!@#&			end!@#&		end!@#&!@#&		return cursorPos - 2!@#&	end,!@#&!@#&	Click = function(self, side, x, y, drag)!@#&		local cursorPos = self:GetCursorPosFromPoint(x, y)!@#&		self.Parent.TextInput.CursorPos = cursorPos!@#&		if drag == nil then!@#&			Current.Selection = nil!@#&			clickPos = x!@#&		else!@#&			local relCursor = cursorPos-- - FindColours(self.Parent.TextInput.Value:sub(1,cursorPos)) + 1!@#&			if not Current.Selection then!@#&				local adder = 1!@#&				if clickPos and clickPos < x then!@#&					adder = 0!@#&				end!@#&				Current.Selection = {relCursor + adder, relCursor + 1 + adder}!@#&			else!@#&				Current.Selection[2] = relCursor + 1!@#&			end!@#&		end!@#&		Draw()!@#&		return true!@#&	end!@#&}!@#&!@#&function GetAbsolutePosition(object)!@#&	local obj = object!@#&	local i = 0!@#&	local x = 1!@#&	local y = 1!@#&	while true do!@#&		x = x + obj.X - 1!@#&		y = y + obj.Y - 1!@#&!@#&		if not obj.Parent then!@#&			return {X = x, Y = y}!@#&		end!@#&!@#&		obj = obj.Parent!@#&!@#&		if i > 32 then!@#&			return {X = 1, Y = 1}!@#&		end!@#&!@#&		i = i + 1!@#&	end!@#&!@#&end!@#&!@#&function Draw()!@#&	if not Current.Window then!@#&		Drawing.Clear(colours.lightGrey)!@#&	else!@#&		Drawing.DrawArea(1, 2, Drawing.Screen.Width, Drawing.Screen.Height, '|', colours.black, colours.lightGrey)!@#&	end!@#&!@#&	if Current.Document then!@#&		Current.Document:Draw()!@#&	end!@#&!@#&	Current.MenuBar:Draw()!@#&!@#&	if Current.Window then!@#&		Current.Window:Draw()!@#&	end!@#&!@#&	if Current.Menu then!@#&		Current.Menu:Draw()!@#&	end!@#&!@#&	Drawing.DrawBuffer()!@#&!@#&	if Current.TextInput and Current.CursorPos and not Current.Menu and not(Current.Window and Current.Document and Current.TextInput == Current.Document.TextInput) and Current.CursorPos[2] > 1 then!@#&		term.setCursorPos(Current.CursorPos[1], Current.CursorPos[2])!@#&		term.setCursorBlink(true)!@#&		term.setTextColour(Current.CursorColour)!@#&	else!@#&		term.setCursorBlink(false)!@#&	end!@#&end!@#&MainDraw = Draw!@#&!@#&LongestString = function(input, key)!@#&	local length = 0!@#&	for i = 1, #input do!@#&		local value = input[i]!@#&		if key then!@#&			if value[key] then!@#&				value = value[key]!@#&			else!@#&				value = ''!@#&			end!@#&		end!@#&		local titleLength = string.len(value)!@#&		if titleLength > length then!@#&			length = titleLength!@#&		end!@#&	end!@#&	return length!@#&end!@#&!@#&function LoadMenuBar()!@#&	Current.MenuBar = MenuBar:Initialise({!@#&		Button:Initialise(1, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if toggle then!@#&				Menu:New(1, 2, {!@#&					{!@#&						Title = \"New...\",!@#&						Click = function()!@#&							Current.Document = Document:Initialise('')							!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.n!@#&						}!@#&					},!@#&					{!@#&						Title = 'Open...',!@#&						Click = function()!@#&							DisplayOpenDocumentWindow()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.o!@#&						}!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Save...',!@#&						Click = function()!@#&							SaveDocument()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.s!@#&						},!@#&						Enabled = function()!@#&							return true!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Print...',!@#&						Click = function()!@#&							PrintDocument()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.p!@#&						},!@#&						Enabled = function()!@#&							return true!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Quit',!@#&						Click = function()!@#&							Close()!@#&						end!@#&					},!@#&			--[[!@#&					{!@#&						Title = 'Save As...',!@#&						Click = function()!@#&!@#&						end!@#&					}	!@#&			]]--!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'File', colours.lightGrey, false),!@#&		Button:Initialise(7, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if not self.Toggle then!@#&				Menu:New(7, 2, {!@#&			--[[!@#&					{!@#&						Title = \"Undo\",!@#&						Click = function()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.z!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Title = 'Redo',!@#&						Click = function()!@#&							!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.y!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&			]]--!@#&					{!@#&						Title = 'Cut',!@#&						Click = function()!@#&							Clipboard.Cut(Current.Document.TextInput:Extract(true), 'text')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.x!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Copy',!@#&						Click = function()!@#&							Clipboard.Copy(Current.Document.TextInput:Extract(), 'text')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.c!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Paste',!@#&						Click = function()!@#&							local paste = Clipboard.Paste()!@#&							Current.Document.TextInput:Insert(paste)!@#&							Current.Document.TextInput.CursorPos = Current.Document.TextInput.CursorPos + #paste - 1!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.v!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and (not Clipboard.isEmpty()) and Clipboard.Type == 'text'!@#&						end!@#&					},!@#&					{!@#&						Separator = true,	!@#&					},!@#&					{!@#&						Title = 'Select All',!@#&						Click = function()!@#&							Current.Selection = {1, #Current.Document.TextInput.Value:gsub('\\n','')}!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.a!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil!@#&						end!@#&					}!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Edit', colours.lightGrey, false)!@#&	})!@#&end!@#&!@#&function LoadMenuBar()!@#&	Current.MenuBar = MenuBar:Initialise({!@#&		Button:Initialise(1, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if toggle then!@#&				Menu:New(1, 2, {!@#&					{!@#&						Title = \"New...\",!@#&						Click = function()!@#&							Current.Document = Document:Initialise('')							!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.n!@#&						}!@#&					},!@#&					{!@#&						Title = 'Open...',!@#&						Click = function()!@#&							DisplayOpenDocumentWindow()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.o!@#&						}!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Save...',!@#&						Click = function()!@#&							SaveDocument()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.s!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Print...',!@#&						Click = function()!@#&							PrintDocument()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.p!@#&						},!@#&						Enabled = function()!@#&							return true!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Quit',!@#&						Click = function()!@#&							if Close() and OneOS then!@#&								OneOS.Close()!@#&							end!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.q!@#&						}!@#&					},!@#&			--[[!@#&					{!@#&						Title = 'Save As...',!@#&						Click = function()!@#&!@#&						end!@#&					}	!@#&			]]--!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'File', colours.lightGrey, false),!@#&		Button:Initialise(7, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if not self.Toggle then!@#&				Menu:New(7, 2, {!@#&			--[[!@#&					{!@#&						Title = \"Undo\",!@#&						Click = function()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.z!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Title = 'Redo',!@#&						Click = function()!@#&							!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.y!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&			]]--!@#&					{!@#&						Title = 'Cut',!@#&						Click = function()!@#&							Clipboard.Cut(Current.Document.TextInput:Extract(true), 'text')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.x!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Copy',!@#&						Click = function()!@#&							Clipboard.Copy(Current.Document.TextInput:Extract(), 'text')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.c!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Paste',!@#&						Click = function()!@#&							local paste = Clipboard.Paste()!@#&							Current.Document.TextInput:Insert(paste)!@#&							Current.Document.TextInput.CursorPos = Current.Document.TextInput.CursorPos + #paste - 1!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.v!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil and (not Clipboard.isEmpty()) and Clipboard.Type == 'text'!@#&						end!@#&					},!@#&					{!@#&						Separator = true,	!@#&					},!@#&					{!@#&						Title = 'Select All',!@#&						Click = function()!@#&							Current.Selection = {1, #Current.Document.TextInput.Value:gsub('\\n','')}!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.a!@#&						},!@#&						Enabled = function()!@#&							return Current.Document ~= nil!@#&						end!@#&					}!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Edit', colours.lightGrey, false),!@#&		Button:Initialise(13, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if not self.Toggle then!@#&				Menu:New(13, 2, {!@#&					{!@#&						Title = 'Red',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.red,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Orange',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.orange,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Yellow',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.yellow,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Pink',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.pink,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Magenta',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.magenta,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Purple',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.purple,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Light Blue',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.lightBlue,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Cyan',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.cyan,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Blue',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.blue,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Green',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.green,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Light Grey',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.lightGrey,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Grey',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.grey,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Black',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.black,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					},!@#&					{!@#&						Title = 'Brown',!@#&						Click = function(item)!@#&							Current.Document:SetSelectionColour(item.Colour)!@#&						end,!@#&						Colour = colours.brown,!@#&						Enabled = function()!@#&							return (Current.Document ~= nil and Current.Selection ~= nil and Current.Selection[1] ~= nil and Current.Selection[2] ~= nil)!@#&						end!@#&					}!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Colour', colours.lightGrey, false)!@#&	})!@#&end!@#&!@#&function SplashScreen()!@#&	local w = colours.white!@#&	local b = colours.black!@#&	local u = colours.blue!@#&	local lb = colours.lightBlue!@#&	local splashIcon = {{w,w,w,b,w,w,w,b,w,w,w,},{w,w,w,b,w,w,w,b,w,w,w,},{w,w,w,b,u,u,u,b,w,w,w,},{w,b,b,u,u,u,u,u,b,b,w,},{b,u,u,lb,lb,u,u,u,u,u,b,},{b,u,lb,lb,u,u,u,u,u,u,b,},{b,u,lb,lb,u,u,u,u,u,u,b,},{b,u,u,u,u,u,u,u,u,u,b,},{w,b,b,b,b,b,b,b,b,b,w,},!@#&	[\"text\"]={{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\"W\",\"o\",\"r\",\"d\",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\"S\",\"p\",\"e\",\"e\",\"d\",\"O\",\"S\",\" \",\" \"},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},},!@#&	[\"textcol\"]={{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{w,w,w,w,w,w,w,w,w,w,w,},{lb,lb,lb,lb,lb,lb,lb,lb,lb,lb,lb,},{w,w,w,w,w,w,w,w,w,w,w,},},}!@#&	Drawing.Clear(colours.white)!@#&	Drawing.DrawImage((Drawing.Screen.Width - 11)/2, (Drawing.Screen.Height - 9)/2, splashIcon, 11, 9)!@#&	Drawing.DrawBuffer()!@#&	Drawing.Clear(colours.black)!@#&	parallel.waitForAny(function()sleep(1)end, function()os.pullEvent('mouse_click')end)!@#&end!@#&!@#&function Initialise(arg)!@#&	if OneOS then!@#&		fs = OneOS.FS!@#&	end!@#&!@#&	if not OneOS then!@#&		SplashScreen()!@#&	end!@#&	EventRegister('mouse_click', TryClick)!@#&	EventRegister('mouse_drag', function(event, side, x, y)TryClick(event, side, x, y, true)end)!@#&	EventRegister('mouse_scroll', Scroll)!@#&	EventRegister('key', HandleKey)!@#&	EventRegister('char', HandleKey)!@#&	EventRegister('timer', Timer)!@#&	EventRegister('terminate', function(event) if Close() then error( \"Terminated\", 0 ) end end)!@#&	!@#&	LoadMenuBar()!@#&!@#&	--Current.Document = Document:Initialise('abcdefghijklmnopqrtuvwxy')--'Hello everybody!')!@#&	if tArgs[1] then!@#&		if fs.exists(tArgs[1]) then!@#&			OpenDocument(tArgs[1])!@#&		else!@#&			--new!@#&		end!@#&	else!@#&		Current.Document = Document:Initialise('')--'Hello everybody!')!@#&	end!@#&!@#&	--[[!@#&	if arg and fs.exists(arg) then!@#&			OpenDocument(arg)!@#&		else!@#&			DisplayNewDocumentWindow()!@#&		end!@#&	]]--!@#&	Draw()!@#&!@#&	EventHandler()!@#&end!@#&!@#&local isControlPushed = false!@#&controlPushedTimer = nil!@#&closeWindowTimer = nil!@#&function Timer(event, timer)!@#&	if timer == closeWindowTimer then!@#&		if Current.Window then!@#&			Current.Window:Close()!@#&		end!@#&		Draw()!@#&	elseif timer == controlPushedTimer then!@#&		isControlPushed = false!@#&	end!@#&end!@#&!@#&local ignoreNextChar = false!@#&function HandleKey(...)!@#&	local args = {...}!@#&	local event = args[1]!@#&	local keychar = args[2]!@#&																							--Mac left command character!@#&	if event == 'key' and keychar == keys.leftCtrl or keychar == keys.rightCtrl or keychar == 219 then!@#&		isControlPushed = true!@#&		controlPushedTimer = os.startTimer(0.5)!@#&	elseif isControlPushed then!@#&		if event == 'key' then!@#&			if CheckKeyboardShortcut(keychar) then!@#&				isControlPushed = false!@#&				ignoreNextChar = true!@#&			end!@#&		end!@#&	elseif ignoreNextChar then!@#&		ignoreNextChar = false!@#&	elseif Current.TextInput then!@#&		if event == 'char' then!@#&			Current.TextInput:Char(keychar)!@#&		elseif event == 'key' then!@#&			Current.TextInput:Key(keychar)!@#&		end!@#&	end!@#&end!@#&!@#&function CheckKeyboardShortcut(key)!@#&	local shortcuts = {}!@#&	shortcuts[keys.n] = function() Current.Document = Document:Initialise('') end!@#&	shortcuts[keys.o] = function() DisplayOpenDocumentWindow() end!@#&	shortcuts[keys.s] = function() if Current.Document ~= nil then SaveDocument() end end!@#&	shortcuts[keys.left] = function() if Current.TextInput then Current.TextInput:Key(keys.home) end end!@#&	shortcuts[keys.right] = function() if Current.TextInput then Current.TextInput:Key(keys[\"end\"]) end end!@#&--	shortcuts[keys.q] = function() DisplayOpenDocumentWindow() end!@#&	if Current.Document ~= nil then!@#&		shortcuts[keys.s] = function() SaveDocument() end!@#&		shortcuts[keys.p] = function() PrintDocument() end!@#&		if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&			shortcuts[keys.x] = function() Clipboard.Cut(Current.Document.TextInput:Extract(true), 'text') end!@#&			shortcuts[keys.c] = function() Clipboard.Copy(Current.Document.TextInput:Extract(), 'text') end!@#&		end!@#&		if (not Clipboard.isEmpty()) and Clipboard.Type == 'text' then!@#&			shortcuts[keys.v] = function() local paste = Clipboard.Paste()!@#&									Current.Document.TextInput:Insert(paste)!@#&									Current.Document.TextInput.CursorPos = Current.Document.TextInput.CursorPos + #paste - 1!@#&								end!@#&		end!@#&		shortcuts[keys.a] = function() Current.Selection = {1, #Current.Document.TextInput.Value:gsub('\\n','')} end!@#&	end!@#&							!@#&	if shortcuts[key] then!@#&		shortcuts[key]()!@#&		Draw()!@#&		return true!@#&	else!@#&		return false!@#&	end!@#&end!@#&!@#&--[[!@#&	Check if the given object falls under the click coordinates!@#&]]--!@#&function CheckClick(object, x, y)!@#&	if object.X <= x and object.Y <= y and object.X + object.Width > x and object.Y + object.Height > y then!@#&		return true!@#&	end!@#&end!@#&!@#&--[[!@#&	Attempt to clicka given object!@#&]]--!@#&function DoClick(object, side, x, y, drag)!@#&	local obj = GetAbsolutePosition(object)!@#&	obj.Width = object.Width!@#&	obj.Height = object.Height!@#&	if object and CheckClick(obj, x, y) then!@#&		return object:Click(side, x - object.X + 1, y - object.Y + 1, drag)!@#&	end	!@#&end!@#&!@#&--[[!@#&	Try to click at the given coordinates!@#&]]--!@#&function TryClick(event, side, x, y, drag)!@#&	if Current.Menu then!@#&		if DoClick(Current.Menu, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		else!@#&			if Current.Menu.Owner and Current.Menu.Owner.Toggle then!@#&				Current.Menu.Owner.Toggle = false!@#&			end!@#&			Current.Menu = nil!@#&			Draw()!@#&			return!@#&		end!@#&	elseif Current.Window then!@#&		if DoClick(Current.Window, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		else!@#&			Current.Window:Flash()!@#&			return!@#&		end!@#&	end!@#&	local interfaceElements = {}!@#&!@#&	table.insert(interfaceElements, Current.MenuBar)!@#&	table.insert(interfaceElements, Current.ScrollBar)!@#&	for i, page in ipairs(Current.Document.Pages) do!@#&		table.insert(interfaceElements, page)!@#&	end!@#&!@#&	for i, object in ipairs(interfaceElements) do!@#&		if DoClick(object, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		end		!@#&	end!@#&	Draw()!@#&end!@#&!@#&function Scroll(event, direction, x, y)!@#&	if Current.Window and Current.Window.OpenButton then!@#&		Current.Document.Scroll = Current.Document.Scroll + direction!@#&		if Current.Window.Scroll < 0 then!@#&			Current.Window.Scroll = 0!@#&		elseif Current.Window.Scroll > Current.Window.MaxScroll then!@#&			Current.Window.Scroll = Current.Window.MaxScroll!@#&		end!@#&		Draw()!@#&	elseif Current.ScrollBar then!@#&		if Current.ScrollBar:DoScroll(direction*2) then!@#&			Draw()!@#&		end!@#&	end!@#&end!@#&!@#&!@#&--[[!@#&	Registers functions to run on certain events!@#&]]--!@#&function EventRegister(event, func)!@#&	if not Events[event] then!@#&		Events[event] = {}!@#&	end!@#&!@#&	table.insert(Events[event], func)!@#&end!@#&!@#&--[[!@#&	The main loop event handler, runs registered event functinos!@#&]]--!@#&function EventHandler()!@#&	while true do!@#&		local event, arg1, arg2, arg3, arg4 = os.pullEventRaw()!@#&		if Events[event] then!@#&			for i, e in ipairs(Events[event]) do!@#&				e(event, arg1, arg2, arg3, arg4)!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&!@#&local function Extension(path, addDot)!@#&	if not path then!@#&		return nil!@#&	elseif not string.find(fs.getName(path), '%.') then!@#&		if not addDot then!@#&			return fs.getName(path)!@#&		else!@#&			return ''!@#&		end!@#&	else!@#&		local _path = path!@#&		if path:sub(#path) == '/' then!@#&			_path = path:sub(1,#path-1)!@#&		end!@#&		local extension = _path:gmatch('%.[0-9a-z]+$')()!@#&		if extension then!@#&			extension = extension:sub(2)!@#&		else!@#&			--extension = nil!@#&			return ''!@#&		end!@#&		if addDot then!@#&			extension = '.'..extension!@#&		end!@#&		return extension:lower()!@#&	end!@#&end!@#&!@#&local RemoveExtension = function(path)!@#&	if path:sub(1,1) == '.' then!@#&		return path!@#&	end!@#&	local extension = Extension(path)!@#&	if extension == path then!@#&		return fs.getName(path)!@#&	end!@#&	return string.gsub(path, extension, ''):sub(1, -2)!@#&end!@#&!@#&local acknowledgedColour = false!@#&function PrintDocument()!@#&	if OneOS then!@#&		OneOS.LoadAPI('/System/API/Helpers.lua')!@#&		OneOS.LoadAPI('/System/API/Peripheral.lua')!@#&		OneOS.LoadAPI('/System/API/Printer.lua')!@#&	end!@#&!@#&	local doPrint = function()!@#&		local window = PrintDocumentWindow:Initialise():Show()!@#&	end!@#&!@#&	if Peripheral.GetPeripheral('printer') == nil then!@#&		ButtonDialougeWindow:Initialise('No Printer Found', 'Please place a printer next to your computer. Ensure you also insert dye (left slot) and paper (top slots)', 'Ok', nil, function(window, ok)!@#&			window:Close()!@#&		end):Show()!@#&	elseif not acknowledgedColour and FindColours(Current.Document.TextInput.Value) ~= 0 then!@#&		ButtonDialougeWindow:Initialise('Important', 'Due to the way printers work, you can\\'t print in more than one colour. The dye you use will be the colour of the text.', 'Ok', nil, function(window, ok)!@#&			acknowledgedColour = true!@#&			window:Close()!@#&			doPrint()!@#&		end):Show()!@#&	else!@#&		doPrint()!@#&	end!@#&end!@#&!@#&function SaveDocument()!@#&	local function save()!@#&		local h = fs.open(Current.Document.Path, 'w')!@#&		if h then!@#&			if Current.Document.Format == TextFormatPlainText then!@#&				h.write(Current.Document.TextInput.Value)!@#&			else!@#&				local lines = {}!@#&				for p, page in ipairs(Current.Document.Pages) do!@#&					for i, line in ipairs(page.Lines) do!@#&						table.insert(lines, line)!@#&					end!@#&				end!@#&				h.write(textutils.serialize(lines))!@#&			end!@#&			Current.Modified = false!@#&		else!@#&			ButtonDialougeWindow:Initialise('Error', 'An error occured while saving the file, try again.', 'Ok', nil, function(window, ok)!@#&				window:Close()!@#&			end):Show()!@#&		end!@#&		h.close()!@#&	end!@#&!@#&	if not Current.Document.Path then!@#&		SaveDocumentWindow:Initialise(function(self, success, path)!@#&			self:Close()!@#&			if success then!@#&				local extension = ''!@#&				if Current.Document.Format == TextFormatPlainText then!@#&					extension = '.txt'!@#&				elseif Current.Document.Format == TextFormatInkText then!@#&					extension = '.ink'!@#&				end!@#&				!@#&				if path:sub(-4) ~= extension then!@#&					path = path .. extension!@#&				end!@#&!@#&				Current.Document.Path = path!@#&				Current.Document.Title = fs.getName(path)!@#&				save()!@#&			end!@#&			if Current.Document then!@#&				Current.TextInput = Current.Document.TextInput!@#&			end!@#&		end):Show()!@#&	else!@#&		save()!@#&	end!@#&end!@#&!@#&function DisplayOpenDocumentWindow()!@#&	OpenDocumentWindow:Initialise(function(self, success, path)!@#&		self:Close()!@#&		if success then!@#&			OpenDocument(path)!@#&		end!@#&	end):Show()!@#&end!@#&!@#&function OpenDocument(path)!@#&	Current.Selection = nil!@#&	local h = fs.open(path, 'r')!@#&	if h then!@#&		Current.Document = Document:Initialise(h.readAll(), RemoveExtension(fs.getName(path)), path)!@#&	else!@#&		ButtonDialougeWindow:Initialise('Error', 'An error occured while opening the file, try again.', 'Ok', nil, function(window, ok)!@#&			window:Close()!@#&			if Current.Document then!@#&				Current.TextInput = Current.Document.TextInput!@#&			end!@#&		end):Show()!@#&	end!@#&	h.close()!@#&end!@#&!@#&local TidyPath = function(path)!@#&	path = '/'..path!@#&	local fs = fs!@#&	if OneOS then!@#&		fs = OneOS.FS!@#&	end!@#&	if fs.isDir(path) then!@#&		path = path .. '/'!@#&	end!@#&!@#&	path, n = path:gsub(\"//\", \"/\")!@#&	while n > 0 do!@#&		path, n = path:gsub(\"//\", \"/\")!@#&	end!@#&	return path!@#&end!@#&!@#&OpenDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	OpenButton = nil,!@#&	PathTextBox = nil,!@#&	CurrentDirectory = '/',!@#&	Scroll = 0,!@#&	MaxScroll = 0,!@#&	GoUpButton = nil,!@#&	SelectedFile = '',!@#&	Files = {},!@#&	Typed = false,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 3, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-6, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y + self.Height - 5, self.Width, 5, colours.lightGrey)!@#&		self:DrawFiles()!@#&!@#&		if (fs.exists(self.PathTextBox.TextInput.Value)) or (self.SelectedFile and #self.SelectedFile > 0 and fs.exists(self.CurrentDirectory .. self.SelectedFile)) then!@#&			self.OpenButton.TextColour = colours.black!@#&		else!@#&			self.OpenButton.TextColour = colours.lightGrey!@#&		end!@#&!@#&		self.PathTextBox:Draw()!@#&		self.OpenButton:Draw()!@#&		self.CancelButton:Draw()!@#&		self.GoUpButton:Draw()!@#&	end,!@#&!@#&	DrawFiles = function(self)!@#&		for i, file in ipairs(self.Files) do!@#&			if i > self.Scroll and i - self.Scroll <= 11 then!@#&				if file == self.SelectedFile then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.white, colours.lightBlue)!@#&				elseif string.find(file, '%.txt') or string.find(file, '%.text') or string.find(file, '%.ink') or fs.isDir(self.CurrentDirectory .. file) then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.black, colours.white)!@#&				else!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.grey, colours.white)!@#&				end!@#&			end!@#&		end!@#&		self.MaxScroll = #self.Files - 11!@#&		if self.MaxScroll < 0 then!@#&			self.MaxScroll = 0!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 32!@#&		new.Height = 17!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'Open Document'!@#&		new.Visible = true!@#&		new.CurrentDirectory = '/'!@#&		new.SelectedFile = nil!@#&		if OneOS and fs.exists('/Desktop/Documents/') then!@#&			new.CurrentDirectory = '/Desktop/Documents/'!@#&		end!@#&		new.OpenButton = Button:Initialise(new.Width - 6, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			if fs.exists(new.PathTextBox.TextInput.Value) and self.TextColour == colours.black and not fs.isDir(new.PathTextBox.TextInput.Value) then!@#&				returnFunc(new, true, TidyPath(new.PathTextBox.TextInput.Value))!@#&			elseif new.SelectedFile and self.TextColour == colours.black and fs.isDir(new.CurrentDirectory .. new.SelectedFile) then!@#&				new:GoToDirectory(new.CurrentDirectory .. new.SelectedFile)!@#&			elseif new.SelectedFile and self.TextColour == colours.black then!@#&				returnFunc(new, true, TidyPath(new.CurrentDirectory .. '/' .. new.SelectedFile))!@#&			end!@#&		end, 'Open', colours.black)!@#&		new.CancelButton = Button:Initialise(new.Width - 15, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			returnFunc(new, false)!@#&		end, 'Cancel', colours.black)!@#&		new.GoUpButton = Button:Initialise(2, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			local folderName = fs.getName(new.CurrentDirectory)!@#&			local parentDirectory = new.CurrentDirectory:sub(1, #new.CurrentDirectory-#folderName-1)!@#&			new:GoToDirectory(parentDirectory)!@#&		end, 'Go Up', colours.black)!@#&		new.PathTextBox = TextBox:Initialise(2, new.Height - 3, new.Width - 2, 1, new, new.CurrentDirectory, colours.white, colours.black)!@#&		new:GoToDirectory(new.CurrentDirectory)!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	GoToDirectory = function(self, path)!@#&		path = TidyPath(path)!@#&		self.CurrentDirectory = path!@#&		self.Scroll = 0!@#&		self.SelectedFile = nil!@#&		self.Typed = false!@#&		self.PathTextBox.TextInput.Value = path!@#&		local fs = fs!@#&		if OneOS then!@#&			fs = OneOS.FS!@#&		end!@#&		self.Files = fs.list(self.CurrentDirectory)!@#&		Draw()!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OpenButton, self.CancelButton, self.PathTextBox, self.GoUpButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&!@#&		if not found then!@#&			if y <= 12 then!@#&				local fs = fs!@#&				if OneOS then!@#&					fs = OneOS.FS!@#&				end!@#&				self.SelectedFile = fs.list(self.CurrentDirectory)[y-1]!@#&				self.PathTextBox.TextInput.Value = TidyPath(self.CurrentDirectory .. '/' .. self.SelectedFile)!@#&				Draw()!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&PrintDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	PrintButton = nil,!@#&	CopiesTextBox = nil,!@#&	Scroll = 0,!@#&	MaxScroll = 0,!@#&	PrinterSelectButton = nil,!@#&	Title = '',!@#&	Status = 0, --0 = neutral, 1 = good, -1 = error!@#&	StatusText = '',!@#&	SelectedPrinter = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&		!@#&		self.PrinterSelectButton:Draw()!@#&		Drawing.DrawCharactersCenter(self.X,  self.Y + self.PrinterSelectButton.Y - 2, self.Width, 1, 'Printer', colours.black, colours.white)!@#&		Drawing.DrawCharacters(self.X + self.Width - 3, self.Y + self.PrinterSelectButton.Y - 1, '\\\\/', colours.black, colours.lightGrey)!@#&		Drawing.DrawCharacters(self.X + 1, self.Y + self.CopiesTextBox.Y - 1, 'Copies', colours.black, colours.white)!@#&		local statusColour = colours.grey!@#&		if self.Status == -1 then!@#&			statusColour = colours.red!@#&		elseif self.Status == 1 then!@#&			statusColour = colours.green!@#&		end!@#&		Drawing.DrawCharacters(self.X + 1, self.Y + self.CopiesTextBox.Y + 1, self.StatusText, statusColour, colours.white)!@#&!@#&		self.CopiesTextBox:Draw()!@#&		self.PrintButton:Draw()!@#&		self.CancelButton:Draw()!@#&	end,!@#&!@#&	Initialise = function(self)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 32!@#&		new.Height = 11!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'Print Document'!@#&		new.Visible = true!@#&		new.PrintButton = Button:Initialise(new.Width - 7, new.Height - 1, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			local doPrint = true!@#&			if new.SelectedPrinter == nil then!@#&				local p = Peripheral.GetPeripheral('printer')!@#&				if p then!@#&					new.SelectedPrinter = p.Side!@#&					new.PrinterSelectButton.Text = p.Fullname!@#&				else!@#&					new.StatusText = 'No Connected Printer'!@#&					new.Status = -1!@#&					doPrint = false!@#&				end!@#&			end!@#&			if doPrint then!@#&				local printer = Printer:Initialise(new.SelectedPrinter)!@#&				local err = printer:PrintLines(Current.Document.Lines, Current.Document.Title, tonumber(new.CopiesTextBox.TextInput.Value))!@#&				if not err then!@#&					new.StatusText = 'Document Printed!'!@#&					new.Status = 1!@#&					closeWindowTimer = os.startTimer(1)!@#&				else!@#&					new.StatusText = err!@#&					new.Status = -1!@#&				end!@#&			end!@#&		end, 'Print', colours.black)!@#&		new.CancelButton = Button:Initialise(new.Width - 15, new.Height - 1, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new:Close()!@#&			Draw()!@#&		end, 'Close', colours.black)!@#&		new.PrinterSelectButton = Button:Initialise(2, 4, new.Width - 2, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			local printers = {!@#&					{!@#&						Title = \"Automatic\",!@#&						Click = function()!@#&							new.SelectedPrinter = nil!@#&							new.PrinterSelectButton.Text = 'Automatic'!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					}!@#&				}!@#&			for i, p in ipairs(Peripheral.GetPeripherals('printer')) do!@#&				table.insert(printers, {!@#&					Title = p.Fullname,!@#&					Click = function(self)!@#&						new.SelectedPrinter = p.Side!@#&						new.PrinterSelectButton.Text = p.Fullname!@#&					end!@#&				})!@#&			end!@#&			Current.Menu = Menu:New(x, y+4, printers, self, true)!@#&		end, 'Automatic', colours.black)!@#&		new.CopiesTextBox = TextBox:Initialise(9, 6, 4, 1, new, 1, colours.lightGrey, colours.black, nil, true)!@#&		Current.TextInput = new.CopiesTextBox.TextInput!@#&		new.StatusText = 'Waiting...'!@#&		new.Status = 0!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.PrintButton, self.CancelButton, self.CopiesTextBox, self.PrinterSelectButton}!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&SaveDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	SaveButton = nil,!@#&	PathTextBox = nil,!@#&	CurrentDirectory = '/',!@#&	Scroll = 0,!@#&	MaxScroll = 0,!@#&	ScrollBar = nil,!@#&	GoUpButton = nil,!@#&	Files = {},!@#&	Typed = false,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 3, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-6, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y + self.Height - 5, self.Width, 5, colours.lightGrey)!@#&		Drawing.DrawCharacters(self.X + 1, self.Y + self.Height - 5, self.CurrentDirectory, colours.grey, colours.lightGrey)!@#&		self:DrawFiles()!@#&!@#&		if (self.PathTextBox.TextInput.Value) then!@#&			self.SaveButton.TextColour = colours.black!@#&		else!@#&			self.SaveButton.TextColour = colours.lightGrey!@#&		end!@#&!@#&		self.PathTextBox:Draw()!@#&		self.SaveButton:Draw()!@#&		self.CancelButton:Draw()!@#&		self.GoUpButton:Draw()!@#&	end,!@#&!@#&	DrawFiles = function(self)!@#&		for i, file in ipairs(self.Files) do!@#&			if i > self.Scroll and i - self.Scroll <= 10 then!@#&				if file == self.SelectedFile then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.white, colours.lightBlue)!@#&				elseif fs.isDir(self.CurrentDirectory .. file) then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.black, colours.white)!@#&				else!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.lightGrey, colours.white)!@#&				end!@#&			end!@#&		end!@#&		self.MaxScroll = #self.Files - 11!@#&		if self.MaxScroll < 0 then!@#&			self.MaxScroll = 0!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 32!@#&		new.Height = 16!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'Save Document'!@#&		new.Visible = true!@#&		new.CurrentDirectory = '/'!@#&		if OneOS and fs.exists('/Desktop/Documents/') then!@#&			new.CurrentDirectory = '/Desktop/Documents/'!@#&		end!@#&		new.SaveButton = Button:Initialise(new.Width - 6, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			if self.TextColour == colours.black and not fs.isDir(new.CurrentDirectory ..'/' .. new.PathTextBox.TextInput.Value) then!@#&				returnFunc(new, true, TidyPath(new.CurrentDirectory ..'/' .. new.PathTextBox.TextInput.Value))!@#&			elseif new.SelectedFile and self.TextColour == colours.black and fs.isDir(new.CurrentDirectory .. new.SelectedFile) then!@#&				new:GoToDirectory(new.CurrentDirectory .. new.SelectedFile)!@#&			end!@#&		end, 'Save', colours.black)!@#&		new.CancelButton = Button:Initialise(new.Width - 15, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			returnFunc(new, false)!@#&		end, 'Cancel', colours.black)!@#&		new.GoUpButton = Button:Initialise(2, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			local folderName = fs.getName(new.CurrentDirectory)!@#&			local parentDirectory = new.CurrentDirectory:sub(1, #new.CurrentDirectory-#folderName-1)!@#&			new:GoToDirectory(parentDirectory)!@#&		end, 'Go Up', colours.black)!@#&		new.PathTextBox = TextBox:Initialise(2, new.Height - 3, new.Width - 2, 1, new, '', colours.white, colours.black, function(key)!@#&			if key == keys.enter then!@#&				new.SaveButton:Click()!@#&			end!@#&		end)!@#&		new.PathTextBox.Placeholder = 'Document Name'!@#&		Current.TextInput = new.PathTextBox.TextInput!@#&		new:GoToDirectory(new.CurrentDirectory)!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	GoToDirectory = function(self, path)!@#&		path = TidyPath(path)!@#&		self.CurrentDirectory = path!@#&		self.Scroll = 0!@#&		self.Typed = false!@#&		local fs = fs!@#&		if OneOS then!@#&			fs = OneOS.FS!@#&		end!@#&		self.Files = fs.list(self.CurrentDirectory)!@#&		Draw()!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.SaveButton, self.CancelButton, self.PathTextBox, self.GoUpButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&!@#&		if not found then!@#&			if y <= 11 then!@#&				local files = fs.list(self.CurrentDirectory)!@#&				if files[y-1] then!@#&					self:GoToDirectory(self.CurrentDirectory..files[y-1])!@#&					Draw()!@#&				end!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&local WrapText = function(text, maxWidth)!@#&	local lines = {''}!@#&    for word, space in text:gmatch('(%S+)(%s*)') do!@#&            local temp = lines[#lines] .. word .. space:gsub('\\n','')!@#&            if #temp > maxWidth then!@#&                    table.insert(lines, '')!@#&            end!@#&            if space:find('\\n') then!@#&                    lines[#lines] = lines[#lines] .. word!@#&                    !@#&                    space = space:gsub('\\n', function()!@#&                            table.insert(lines, '')!@#&                            return ''!@#&                    end)!@#&            else!@#&                    lines[#lines] = lines[#lines] .. word .. space!@#&            end!@#&    end!@#&	return lines!@#&end!@#&!@#&ButtonDialougeWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	CancelButton = nil,!@#&	OkButton = nil,!@#&	Lines = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		for i, text in ipairs(self.Lines) do!@#&			Drawing.DrawCharacters(self.X + 1, self.Y + 1 + i, text, colours.black, colours.white)!@#&		end!@#&!@#&		self.OkButton:Draw()!@#&		if self.CancelButton then!@#&			self.CancelButton:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, title, message, okText, cancelText, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 28!@#&		new.Lines = WrapText(message, new.Width - 2)!@#&		new.Height = 5 + #new.Lines!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = title!@#&		new.Visible = true!@#&		new.Visible = true!@#&		new.OkButton = Button:Initialise(new.Width - #okText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&			returnFunc(new, true)!@#&		end, okText)!@#&		if cancelText then!@#&			new.CancelButton = Button:Initialise(new.Width - #okText - 2 - 1 - #cancelText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&				returnFunc(new, false)!@#&			end, cancelText)!@#&		end!@#&!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.CancelButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&TextDialougeWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	CancelButton = nil,!@#&	OkButton = nil,!@#&	Lines = {},!@#&	TextInput = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		for i, text in ipairs(self.Lines) do!@#&			Drawing.DrawCharacters(self.X + 1, self.Y + 1 + i, text, colours.black, colours.white)!@#&		end!@#&!@#&!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y + self.Height - 4, self.Width - 2, 1, colours.lightGrey)!@#&		Drawing.DrawCharacters(self.X + 2, self.Y + self.Height - 4, self.TextInput.Value, colours.black, colours.lightGrey)!@#&		Current.CursorPos = {self.X + 2 + self.TextInput.CursorPos, self.Y + self.Height - 4}!@#&		Current.CursorColour = colours.black!@#&!@#&		self.OkButton:Draw()!@#&		if self.CancelButton then!@#&			self.CancelButton:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, title, message, okText, cancelText, returnFunc, numerical)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 28!@#&		new.Lines = WrapText(message, new.Width - 2)!@#&		new.Height = 7 + #new.Lines!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = title!@#&		new.Visible = true!@#&		new.Visible = true!@#&		new.OkButton = Button:Initialise(new.Width - #okText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&			if #new.TextInput.Value > 0 then!@#&				returnFunc(new, true, new.TextInput.Value)!@#&			end!@#&		end, okText)!@#&		if cancelText then!@#&			new.CancelButton = Button:Initialise(new.Width - #okText - 2 - 1 - #cancelText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&				returnFunc(new, false)!@#&			end, cancelText)!@#&		end!@#&		new.TextInput = TextInput:Initialise('', function(enter)!@#&			if enter then!@#&				new.OkButton:Click()!@#&			end!@#&			Draw()!@#&		end, numerical)!@#&!@#&		Current.Input = new.TextInput!@#&!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Window = nil!@#&		Current.Input = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.CancelButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&function PrintCentered(text, y)!@#&    local w, h = term.getSize()!@#&    x = math.ceil(math.ceil((w / 2) - (#text / 2)), 0)+1!@#&    term.setCursorPos(x, y)!@#&    print(text)!@#&end!@#&!@#&function DoVanillaClose()!@#&	term.setBackgroundColour(colours.black)!@#&	term.setTextColour(colours.white)!@#&	term.clear()!@#&	term.setCursorPos(1, 1)!@#&	PrintCentered(\"Thanks for using Word!\", (Drawing.Screen.Height/2)-1)!@#&	term.setTextColour(colours.lightGrey)!@#&	PrintCentered(\"Word Proccessor for ComputerCraft\", (Drawing.Screen.Height/2))!@#&	term.setTextColour(colours.white)!@#&	PrintCentered(\"(c) SpeedOS 2024\", (Drawing.Screen.Height/2)+3)!@#&	term.setCursorPos(1, Drawing.Screen.Height)!@#&	error('', 0)!@#&end!@#&!@#&function Close()!@#&	if isQuitting or not Current.Document or not Current.Modified then!@#&		if not OneOS then!@#&			DoVanillaClose()!@#&		end!@#&		return true!@#&	else!@#&		local _w = ButtonDialougeWindow:Initialise('Quit Word?', 'You have unsaved changes, do you want to quit anyway?', 'Quit', 'Cancel', function(window, success)!@#&			if success then!@#&				if OneOS then!@#&					OneOS.Close(true)!@#&				else!@#&					DoVanillaClose()!@#&				end!@#&			end!@#&			window:Close()!@#&			Draw()!@#&		end):Show()!@#&		--it's hacky but it works!@#&		os.queueEvent('mouse_click', 1, _w.X, _w.Y)!@#&		return false!@#&	end!@#&end!@#&!@#&if OneOS then!@#&	OneOS.CanClose = function()!@#&		return Close()!@#&	end!@#&end!@#&!@#&Initialise()",["Sketch"]="if OneOS then!@#&	--running under OneOS!@#&	OneOS.ToolBarColour = colours.grey!@#&	OneOS.ToolBarTextColour = colours.white!@#&end!@#&!@#&colours.transparent = -1!@#&colors.transparent = -1!@#&!@#&--APIS--!@#&!@#&--This is my drawing API, is is pretty much identical to what drives OneOS, PearOS, etc.!@#&local _w, _h = term.getSize()!@#&!@#&local round = function(num, idp)!@#&	local mult = 10^(idp or 0)!@#&	return math.floor(num * mult + 0.5) / mult!@#&end!@#&!@#&Clipboard = {!@#&	Content = nil,!@#&	Type = nil,!@#&	IsCut = false,!@#&!@#&	Empty = function()!@#&		Clipboard.Content = nil!@#&		Clipboard.Type = nil!@#&		Clipboard.IsCut = false!@#&	end,!@#&!@#&	isEmpty = function()!@#&		return Clipboard.Content == nil!@#&	end,!@#&!@#&	Copy = function(content, _type)!@#&		Clipboard.Content = content!@#&		Clipboard.Type = _type or 'generic'!@#&		Clipboard.IsCut = false!@#&	end,!@#&!@#&	Cut = function(content, _type)!@#&		Clipboard.Content = content!@#&		Clipboard.Type = _type or 'generic'!@#&		Clipboard.IsCut = true!@#&	end,!@#&!@#&	Paste = function()!@#&		local c, t = Clipboard.Content, Clipboard.Type!@#&		if Clipboard.IsCut then!@#&			Clipboard.Empty()!@#&		end!@#&		return c, t!@#&	end!@#&}!@#&!@#&if OneOS and OneOS.Clipboard then!@#&	Clipboard = OneOS.Clipboard!@#&end!@#&!@#&Drawing = {!@#&	!@#&	Screen = {!@#&		Width = _w,!@#&		Height = _h!@#&	},!@#&!@#&	DrawCharacters = function (x, y, characters, textColour,bgColour)!@#&		Drawing.WriteStringToBuffer(x, y, characters, textColour, bgColour)!@#&	end,!@#&	!@#&	DrawBlankArea = function (x, y, w, h, colour)!@#&		Drawing.DrawArea (x, y, w, h, \" \", 1, colour)!@#&	end,!@#&!@#&	DrawArea = function (x, y, w, h, character, textColour, bgColour)!@#&		--width must be greater than 1, other wise we get a stack overflow!@#&		if w < 0 then!@#&			w = w * -1!@#&		elseif w == 0 then!@#&			w = 1!@#&		end!@#&!@#&		for ix = 1, w do!@#&			local currX = x + ix - 1!@#&			for iy = 1, h do!@#&				local currY = y + iy - 1!@#&				Drawing.WriteToBuffer(currX, currY, character, textColour, bgColour)!@#&			end!@#&		end!@#&	end,!@#&!@#&	DrawImage = function(_x,_y,tImage, w, h)!@#&		if tImage then!@#&			for y = 1, h do!@#&				if not tImage[y] then!@#&					break!@#&				end!@#&				for x = 1, w do!@#&					if not tImage[y][x] then!@#&						break!@#&					end!@#&					local bgColour = tImage[y][x]!@#&		            local textColour = tImage.textcol[y][x] or colours.white!@#&		            local char = tImage.text[y][x]!@#&		            Drawing.WriteToBuffer(x+_x-1, y+_y-1, char, textColour, bgColour)!@#&				end!@#&			end!@#&		elseif w and h then!@#&			Drawing.DrawBlankArea(x, y, w, h, colours.green)!@#&		end!@#&	end,!@#&	--using .nft!@#&	LoadImage = function(path)!@#&		local image = {!@#&			text = {},!@#&			textcol = {}!@#&		}!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		if _fs.exists(path) then!@#&			local _open = io.open!@#&			if OneOS then!@#&				_open = OneOS.IO.open!@#&			end!@#&	        local file = _open(path, \"r\")!@#&	        local sLine = file:read()!@#&	        local num = 1!@#&	        while sLine do  !@#&	                table.insert(image, num, {})!@#&	                table.insert(image.text, num, {})!@#&	                table.insert(image.textcol, num, {})!@#&	                                            !@#&	                --As we're no longer 1-1, we keep track of what index to write to!@#&	                local writeIndex = 1!@#&	                --Tells us if we've hit a 30 or 31 (BG and FG respectively)- next char specifies the curr colour!@#&	                local bgNext, fgNext = false, false!@#&	                --The current background and foreground colours!@#&	                local currBG, currFG = nil,nil!@#&	                for i=1,#sLine do!@#&	                        local nextChar = string.sub(sLine, i, i)!@#&	                        if nextChar:byte() == 30 then!@#&                                bgNext = true!@#&	                        elseif nextChar:byte() == 31 then!@#&                                fgNext = true!@#&	                        elseif bgNext then!@#&                                currBG = Drawing.GetColour(nextChar)!@#&                                bgNext = false!@#&	                        elseif fgNext then!@#&                                currFG = Drawing.GetColour(nextChar)!@#&                                fgNext = false!@#&	                        else!@#&                                if nextChar ~= \" \" and currFG == nil then!@#&                                       currFG = colours.white!@#&                                end!@#&                                image[num][writeIndex] = currBG!@#&                                image.textcol[num][writeIndex] = currFG!@#&                                image.text[num][writeIndex] = nextChar!@#&                                writeIndex = writeIndex + 1!@#&	                        end!@#&	                end!@#&	                num = num+1!@#&	                sLine = file:read()!@#&	        end!@#&	        file:close()!@#&		end!@#&	 	return image!@#&	end,!@#&!@#&	DrawCharactersCenter = function(x, y, w, h, characters, textColour,bgColour)!@#&		w = w or Drawing.Screen.Width!@#&		h = h or Drawing.Screen.Height!@#&		x = x or 0!@#&		y = y or 0!@#&		x = math.ceil((w - #characters) / 2) + x!@#&		y = math.floor(h / 2) + y!@#&!@#&		Drawing.DrawCharacters(x, y, characters, textColour, bgColour)!@#&	end,!@#&!@#&	GetColour = function(hex)!@#&		if hex == ' ' then!@#&			return colours.transparent!@#&		end!@#&	    local value = tonumber(hex, 16)!@#&	    if not value then return nil end!@#&	    value = math.pow(2,value)!@#&	    return value!@#&	end,!@#&!@#&	Clear = function (_colour)!@#&		_colour = _colour or colours.black!@#&		Drawing.ClearBuffer()!@#&		Drawing.DrawBlankArea(1, 1, Drawing.Screen.Width, Drawing.Screen.Height, _colour)!@#&	end,!@#&!@#&	Buffer = {},!@#&	BackBuffer = {},!@#&!@#&	DrawBuffer = function()!@#&		for y,row in pairs(Drawing.Buffer) do!@#&			for x,pixel in pairs(row) do!@#&				local shouldDraw = true!@#&				local hasBackBuffer = true!@#&				if Drawing.BackBuffer[y] == nil or Drawing.BackBuffer[y][x] == nil or #Drawing.BackBuffer[y][x] ~= 3 then!@#&					hasBackBuffer = false!@#&				end!@#&				if hasBackBuffer and Drawing.BackBuffer[y][x][1] == Drawing.Buffer[y][x][1] and Drawing.BackBuffer[y][x][2] == Drawing.Buffer[y][x][2] and Drawing.BackBuffer[y][x][3] == Drawing.Buffer[y][x][3] then!@#&					shouldDraw = false!@#&				end!@#&				if shouldDraw then!@#&					term.setBackgroundColour(pixel[3])!@#&					term.setTextColour(pixel[2])!@#&					term.setCursorPos(x, y)!@#&					term.write(pixel[1])!@#&				end!@#&			end!@#&		end!@#&		Drawing.BackBuffer = Drawing.Buffer!@#&		Drawing.Buffer = {}!@#&		term.setCursorPos(1,1)!@#&	end,!@#&!@#&	ClearBuffer = function()!@#&		Drawing.Buffer = {}!@#&	end,!@#&!@#&	WriteStringToBuffer = function (x, y, characters, textColour,bgColour)!@#&		for i = 1, #characters do!@#&   			local character = characters:sub(i,i)!@#&   			Drawing.WriteToBuffer(x + i - 1, y, character, textColour, bgColour)!@#&		end!@#&	end,!@#&!@#&	WriteToBuffer = function(x, y, character, textColour,bgColour)!@#&		x = round(x)!@#&		y = round(y)!@#&		if bgColour == colours.transparent then!@#&			Drawing.Buffer[y] = Drawing.Buffer[y] or {}!@#&			Drawing.Buffer[y][x] = Drawing.Buffer[y][x] or {\"\", colours.white, colours.black}!@#&			Drawing.Buffer[y][x][1] = character!@#&			Drawing.Buffer[y][x][2] = textColour!@#&		else!@#&			Drawing.Buffer[y] = Drawing.Buffer[y] or {}!@#&			Drawing.Buffer[y][x] = {character, textColour, bgColour}!@#&		end!@#&	end,!@#&}!@#&!@#&--Colour Deffitions--!@#&UIColours = {!@#&	Toolbar = colours.grey,!@#&	ToolbarText = colours.lightGrey,!@#&	ToolbarSelected = colours.lightBlue,!@#&	ControlText = colours.white,!@#&	ToolbarItemTitle = colours.black,!@#&	Background = colours.lightGrey,!@#&	MenuBackground = colours.white,!@#&	MenuText = colours.black,!@#&	MenuSeparatorText = colours.grey,!@#&	MenuDisabledText = colours.lightGrey,!@#&	Shadow = colours.grey,!@#&	TransparentBackgroundOne = colours.white,!@#&	TransparentBackgroundTwo = colours.lightGrey,!@#&	MenuBarActive = colours.white!@#&}!@#&!@#&--Lists--!@#&Current = {!@#&	Artboard = nil,!@#&	Layer = nil,!@#&	Tool = nil,!@#&	ToolSize = 1,!@#&	Toolbar = nil,!@#&	Colour = colours.lightBlue,!@#&	Menu = nil,!@#&	MenuBar = nil,!@#&	Window = nil,!@#&	Input = nil,!@#&	CursorPos = {1,1},!@#&	CursorColour = colours.black,!@#&	InterfaceVisible = true,!@#&	Selection = {},!@#&	SelectionDrawTimer = nil,!@#&	HandDragStart = {},!@#&	Modified = false,!@#&}!@#&!@#&local isQuitting = false!@#&!@#&function PrintCentered(text, y)!@#&    local w, h = term.getSize()!@#&    x = math.ceil(math.ceil((w / 2) - (#text / 2)), 0)+1!@#&    term.setCursorPos(x, y)!@#&    print(text)!@#&end!@#&!@#&function DoVanillaClose()!@#&	term.setBackgroundColour(colours.black)!@#&	term.setTextColour(colours.white)!@#&	term.clear()!@#&	term.setCursorPos(1, 1)!@#&	PrintCentered(\"Thanks for using Sketch!\", (Drawing.Screen.Height/2)-1)!@#&	term.setTextColour(colours.lightGrey)!@#&	PrintCentered(\"Photoshop Inspired Image Editor for ComputerCraft\", (Drawing.Screen.Height/2))!@#&	term.setTextColour(colours.white)!@#&	PrintCentered(\"(c) SpeedOS 2024\", (Drawing.Screen.Height/2)+3)!@#&	term.setCursorPos(1, Drawing.Screen.Height)!@#&	error('', 0)!@#&end!@#&!@#&function Close()!@#&	if isQuitting or not Current.Artboard or not Current.Modified then!@#&		if not OneOS then!@#&			DoVanillaClose()!@#&		end!@#&		return true!@#&	else!@#&		local _w = ButtonDialougeWindow:Initialise('Quit Sketch?', 'You have unsaved changes, do you want to quit anyway?', 'Quit', 'Cancel', function(window, success)!@#&			if success then!@#&				if OneOS then!@#&					OneOS.Close(true)!@#&				else!@#&					DoVanillaClose()!@#&				end!@#&			end!@#&			window:Close()!@#&			Draw()!@#&		end):Show()!@#&		--it's hacky but it works!@#&		os.queueEvent('mouse_click', 1, _w.X, _w.Y)!@#&		return false!@#&	end!@#&end!@#&!@#&if OneOS then!@#&	OneOS.CanClose = function()!@#&		return Close()!@#&	end!@#&end!@#&!@#&Lists = {!@#&	Artboards = {},!@#&	Interface = {!@#&		Toolbars = {}!@#&	}	!@#&}!@#&!@#&Events = {!@#&	!@#&}!@#&!@#&--Setters--!@#&!@#&function SetColour(colour)!@#&	Current.Colour = colour!@#&	Draw()!@#&end!@#&!@#&function SetTool(tool)!@#&	if tool and tool.Select and tool:Select() then!@#&		Current.Input = nil!@#&		Current.Tool = tool!@#&		return true!@#&	end!@#&	return false!@#&end!@#&!@#&function GetAbsolutePosition(object)!@#&	local obj = object!@#&	local i = 0!@#&	local x = 1!@#&	local y = 1!@#&	while true do!@#&		x = x + obj.X - 1!@#&		y = y + obj.Y - 1!@#&!@#&		if not obj.Parent then!@#&			return {X = x, Y = y}!@#&		end!@#&!@#&		obj = obj.Parent!@#&!@#&		if i > 32 then!@#&			return {X = 1, Y = 1}!@#&		end!@#&!@#&		i = i + 1!@#&	end!@#&!@#&end!@#&!@#&--Object Defintions--!@#&!@#&Pixel = {!@#&	TextColour = colours.black,!@#&	BackgroundColour = colours.white,!@#&	Character = \" \",!@#&	Layer = nil,!@#&!@#&	Draw = function(self, x, y)!@#&		if self.BackgroundColour ~= colours.transparent or self.Character ~= ' ' then!@#&			Drawing.WriteToBuffer(self.Layer.Artboard.X + x - 1, self.Layer.Artboard.Y + y - 1, self.Character, self.TextColour, self.BackgroundColour)!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, textColour, backgroundColour, character, layer)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.TextColour = textColour or self.TextColour!@#&		new.BackgroundColour = backgroundColour or self.BackgroundColour!@#&		new.Character = character or self.Character!@#&		new.Layer = layer!@#&		return new!@#&	end,!@#&!@#&	Set = function(self, textColour, backgroundColour, character)!@#&		self.TextColour = textColour or self.TextColour!@#&		self.BackgroundColour = backgroundColour or self.BackgroundColour!@#&		self.Character = character or self.Character!@#&	end!@#&}!@#&!@#&Layer = {!@#&	Name = \"\",!@#&	Pixels = {!@#&!@#&	},!@#&	Artboard = nil,!@#&	BackgroundColour = colours.white,!@#&	Visible = true,!@#&	Index = 1,!@#&!@#&	Draw = function(self)!@#&		if self.Visible then!@#&			for x = 1, self.Artboard.Width do!@#&				for y = 1, self.Artboard.Height do!@#&					self.Pixels[x][y]:Draw(x, y)!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	Remove = function(self)!@#&		for i, v in ipairs(self.Artboard.Layers) do!@#&			if v == Current.Layer then!@#&				Current.Artboard.Layers[i] = nil!@#&				Current.Layer = Current.Artboard.Layers[1]!@#&				ModuleNamed('Layers'):Update()!@#&			end!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, name, backgroundColour, artboard, index, pixels)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Name = name!@#&		new.Pixels = {}!@#&		new.BackgroundColour = backgroundColour!@#&		new.Artboard = artboard!@#&		new.Index = index or #artboard.Layers + 1!@#&		if not pixels then!@#&			new:MakeAllBlankPixels()!@#&		else!@#&			new:MakeAllBlankPixels()!@#&			for x, col in ipairs(pixels) do!@#&				for y, pixel in ipairs(col) do!@#&					new:SetPixel(x, y, pixel.TextColour, pixel.BackgroundColour, pixel.Character)!@#&				end!@#&			end!@#&		end!@#&		!@#&		return new!@#&	end,!@#&!@#&	SetPixel = function(self, x, y, textColour, backgroundColour, character)!@#&		textColour = textColour or Current.Colour!@#&		backgroundColour = backgroundColour or Current.Colour!@#&		character = character or \" \"!@#&!@#&		if x < 1 or y < 1 or x > self.Artboard.Width or y > self.Artboard.Height then!@#&			return!@#&		end!@#&!@#&		if self.Pixels[x][y] then!@#&			self.Pixels[x][y]:Set(textColour, backgroundColour, character)!@#&			self.Pixels[x][y]:Draw(x,y)!@#&		end!@#&	end,!@#&!@#&	MakePixel = function(self, x, y, backgroundColour)!@#&		backgroundColour = backgroundColour or self.BackgroundColour			!@#&		self.Pixels[x][y] = Pixel:Initialise(nil, backgroundColour, nil, self)!@#&	end,!@#&!@#&	MakeColumn = function(self, x)!@#&		self.Pixels[x] = {}!@#&	end,!@#&!@#&	MakeAllBlankPixels = function(self)!@#&		for x = 1, self.Artboard.Width do!@#&			if not self.Pixels[x] then!@#&				self:MakeColumn(x)!@#&			end!@#&!@#&			for y = 1, self.Artboard.Height do			!@#&			!@#&				if not self.Pixels[x][y] then!@#&					self:MakePixel(x, y)!@#&				end!@#&!@#&			end!@#&		end!@#&	end,!@#&!@#&	PixelsInSelection = function(self, cut)!@#&		local pixels = {}!@#&		if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&			local point1 = Current.Selection[1]!@#&			local point2 = Current.Selection[2]!@#&!@#&			local size = point2 - point1!@#&			local cornerX = point1.x!@#&			local cornerY = point1.y!@#&			for x = 1, size.x + 1 do!@#&				for y = 1, size.y + 1 do!@#&					if not pixels[x] then!@#&						pixels[x] = {}!@#&					end!@#&					if not self.Pixels[cornerX + x - 1] or not self.Pixels[cornerX + x - 1][cornerY + y - 1] then!@#&						break!@#&					end!@#&					local pixel =  self.Pixels[cornerX + x - 1][cornerY + y - 1]!@#&					pixels[x][y] = Pixel:Initialise(pixel.TextColour, pixel.BackgroundColour, pixel.Character, Current.Layer)!@#&					if cut then!@#&						Current.Layer:SetPixel(cornerX + x - 1, cornerY + y - 1, nil, Current.Layer.BackgroundColour, nil)!@#&					end!@#&				end!@#&			end!@#&		end!@#&		return pixels!@#&	end,!@#&!@#&	EraseSelection = function(self)!@#&		if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&			local point1 = Current.Selection[1]!@#&			local point2 = Current.Selection[2]!@#&!@#&			local size = point2 - point1!@#&			local cornerX = point1.x!@#&			local cornerY = point1.y!@#&			for x = 1, size.x + 1 do!@#&				for y = 1, size.y + 1 do!@#&					Current.Layer:SetPixel(cornerX + x - 1, cornerY + y - 1, nil, Current.Layer.BackgroundColour, nil)!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	InsertPixels = function(self, pixels)!@#&		local cornerX = Current.Selection[1].x!@#&		local cornerY = Current.Selection[1].y!@#&		for x, col in ipairs(pixels) do!@#&			for y, pixel in ipairs(col) do!@#&				Current.Layer:SetPixel(cornerX + x - 1, cornerY + y - 1, pixel.TextColour, pixel.BackgroundColour, pixel.Character)!@#&			end!@#&		end!@#&	end!@#&}!@#&!@#&Artboard = {!@#&	X = 0,!@#&	Y = 0,!@#&	Name = \"\",!@#&	Path = \"\",!@#&	Width = 1,!@#&	Height = 1,!@#&	Layers = {},!@#&	Format = nil,!@#&	SelectionIsBlack = true,!@#&!@#&	Draw = function(self)!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y + 1, self.Width, self.Height, UIColours.Shadow)!@#&!@#&		local odd!@#&		for x = 1, self.Width do!@#&			odd = x % 2!@#&			if odd == 1 then!@#&				odd = true!@#&			else!@#&				odd = false!@#&			end!@#&			for y = 1, self.Height do!@#&				if odd then!@#&					Drawing.WriteToBuffer(self.X + x - 1, self.Y + y - 1, \":\", UIColours.TransparentBackgroundTwo, UIColours.TransparentBackgroundOne)!@#&				else!@#&					Drawing.WriteToBuffer(self.X + x - 1, self.Y + y - 1, \":\", UIColours.TransparentBackgroundOne, UIColours.TransparentBackgroundTwo)!@#&				end!@#&!@#&				odd = not odd!@#&			end!@#&		end!@#&!@#&		for i, layer in ipairs(self.Layers) do!@#&			layer:Draw()!@#&		end!@#&!@#&		if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&			local point1 = Current.Selection[1]!@#&			local point2 = Current.Selection[2]!@#&!@#&			local size = point2 - point1!@#&!@#&			local isBlack = self.SelectionIsBlack!@#&!@#&			local function c()!@#&				local c = colours.white!@#&				if isBlack then!@#&					c = colours.black!@#&				end!@#&				isBlack = not isBlack!@#&				return c!@#&			end!@#&!@#&			function horizontal(y)!@#&				Drawing.WriteToBuffer(self.X - 1 + point1.x, self.Y - 1 + y, '+', c(), colours.transparent)!@#&				if size.x > 0 then!@#&					for i = 1, size.x - 1 do!@#&						Drawing.WriteToBuffer(self.X - 1 + point1.x + i, self.Y - 1 + y, '-', c(), colours.transparent)!@#&					end!@#&				else!@#&					for i = 1, (-1 * size.x) - 1 do!@#&						Drawing.WriteToBuffer(self.X - 1 + point1.x - i, self.Y - 1 + y, '-', c(), colours.transparent)!@#&					end!@#&				end!@#&!@#&				Drawing.WriteToBuffer(self.X - 1 + point1.x + size.x, self.Y - 1 + y, '+', c(), colours.transparent)!@#&			end!@#&!@#&			function vertical(x)!@#&				if size.y < 0 then!@#&					for i = 1, (-1 * size.y) - 1 do!@#&						Drawing.WriteToBuffer(self.X - 1 + x, self.Y - 1 + point1.y  - i, '|', c(), colours.transparent)!@#&					end!@#&				else!@#&					for i = 1, size.y - 1 do!@#&						Drawing.WriteToBuffer(self.X - 1 + x, self.Y - 1 + point1.y  + i, '|', c(), colours.transparent)!@#&					end!@#&				end!@#&			end!@#&!@#&			horizontal(point1.y)!@#&			vertical(point1.x)!@#&			horizontal(point1.y + size.y)!@#&			vertical(point1.x + size.x)!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, name, path, width, height, format, backgroundColour, layers)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Y = 3!@#&		new.X = 2!@#&		new.Name = name!@#&		new.Path = path!@#&		new.Width = width!@#&		new.Height = height!@#&		new.Format = format!@#&		new.Layers = {}!@#&		if not layers then!@#&			new:MakeLayer('Background', backgroundColour)!@#&		else!@#&			for i, layer in ipairs(layers) do!@#&				new:MakeLayer(layer.Name, layer.BackgroundColour, layer.Index, layer.Pixels)!@#&				new.Layers[i].Visible = layer.Visible!@#&			end!@#&			Current.Layer = new.Layers[#new.Layers]!@#&		end!@#&		return new!@#&	end,!@#&!@#&	Resize = function(self, top, bottom, left, right)!@#&		self.Height = self.Height + top + bottom!@#&		self.Width = self.Width + left + right!@#&!@#&		for i, layer in ipairs(self.Layers) do!@#&!@#&			if left < 0 then!@#&				for x = 1, -left do!@#&					table.remove(layer.Pixels, 1)!@#&				end!@#&			end!@#&!@#&			if right < 0 then!@#&				for x = 1, -right do!@#&					table.remove(layer.Pixels, #layer.Pixels)!@#&				end!@#&			end!@#&!@#&			for x = 1, left do!@#&				table.insert(layer.Pixels, 1, {})!@#&				for y = 1, self.Height do!@#&					layer:MakePixel(1, y)!@#&				end!@#&			end!@#&!@#&			for x = 1, right do!@#&				table.insert(layer.Pixels, {})!@#&				for y = 1, self.Height do!@#&					layer:MakePixel(#layer.Pixels, y)!@#&				end!@#&			end!@#&!@#&			for y = 1, top do!@#&				for x = 1, self.Width do!@#&					table.insert(layer.Pixels[x], 1, {})!@#&					layer:MakePixel(x, 1)!@#&				end!@#&			end!@#&!@#&			for y = 1, bottom do!@#&				for x = 1, self.Width do!@#&					table.insert(layer.Pixels[x], {})!@#&					layer:MakePixel(x, #layer.Pixels[x])!@#&				end!@#&			end!@#&!@#&			if top < 0 then!@#&				for y = 1, -top do!@#&					for x = 1, self.Width do!@#&						table.remove(layer.Pixels[x], 1)!@#&					end!@#&				end!@#&			end!@#&!@#&			if bottom < 0 then!@#&				for y = 1, -bottom do!@#&					for x = 1, self.Width do!@#&						table.remove(layer.Pixels[x], #layer.Pixels[x])!@#&					end!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	MakeLayer = function(self, name, backgroundColour, index, pixels)!@#&		backgroundColour = backgroundColour or colours.white!@#&		name = name or \"Layer\"!@#&		local layer = Layer:Initialise(name, backgroundColour, self, index, pixels)!@#&		table.insert(self.Layers, layer)!@#&		Current.Layer = layer!@#&		ModuleNamed('Layers'):Update()!@#&		return layer!@#&	end,!@#&!@#&	New = function(self, name, path, width, height, format, backgroundColour, layers)!@#&		local new = self:Initialise(name, path, width, height, format, backgroundColour, layers)!@#&		table.insert(Lists.Artboards, new)!@#&		Current.Artboard = new!@#&		--new:Save()!@#&		return new!@#&	end,!@#&!@#&	Save = function(self, path)!@#&		Current.Artboard = self!@#&		path = path or self.Path!@#&		local _open = io.open!@#&		if OneOS then!@#&			_open = OneOS.IO.open!@#&		end!@#&        local file = _open(path, \"w\", true)!@#&		if self.Format == '.skch' then!@#&			file:write(textutils.serialize(SaveSKCH()))!@#&		else!@#&			local lines = {}!@#&			if self.Format == '.nfp' then!@#&				lines = SaveNFP()!@#&			elseif self.Format == '.nft' then!@#&				lines = SaveNFT()!@#&			end!@#&!@#&			for i, line in ipairs(lines) do!@#&                file:write(line..\"\\n\")!@#&			end!@#&		end!@#&		file:close()!@#&		Current.Modified = false!@#&	end,!@#&!@#&	Click = function(self, side, x, y, drag)!@#&		if Current.Tool and Current.Layer and Current.Layer.Visible then!@#&			Current.Tool:Use(x, y, side, drag)!@#&			Current.Modified = true!@#&			return true!@#&		end!@#&	end!@#&}!@#&!@#&Toolbar = {!@#&	X = 0,!@#&	Y = 0,!@#&	Width = 0,!@#&	ExpandedWidth = 14,!@#&	ClosedWidth = 2,!@#&	Height = 0,!@#&	Expanded = true,!@#&	ToolbarItems = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		self:CalculateToolbarItemPositions()!@#&		--Drawing.DrawArea(self.X - 1, self.Y, 1, self.Height, \"|\", UIColours.ToolbarText, UIColours.Background)!@#&!@#&		!@#&!@#&		--if not Current.Window then!@#&			Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.Toolbar)!@#&		--else!@#&		--	Drawing.DrawArea(self.X, self.Y, self.Width, self.Height, '|', colours.lightGrey, UIColours.Toolbar)!@#&		--end!@#&		for i, toolbarItem in ipairs(self.ToolbarItems) do!@#&			toolbarItem:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, side, expanded)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Expanded = expanded!@#&!@#&		if expanded then!@#&			new.Width = new.ExpandedWidth!@#&		else!@#&			new.Width = new.ClosedWidth!@#&		end!@#&!@#&		if side == 'right' then!@#&			new.X = Drawing.Screen.Width - new.Width + 1!@#&		end!@#&!@#&		if side == 'right' or side == 'left' then!@#&			new.Height = Drawing.Screen.Width!@#&		end!@#&!@#&		new.Y = 1!@#&!@#&		return new!@#&	end,!@#&!@#&	AddToolbarItem = function(self, item)!@#&		table.insert(self.ToolbarItems, item)!@#&		self:CalculateToolbarItemPositions()!@#&	end,!@#&!@#&	CalculateToolbarItemPositions = function(self)!@#&		local currY = 1!@#&		for i, toolbarItem in ipairs(self.ToolbarItems) do!@#&			toolbarItem.Y = currY!@#&			currY = currY + toolbarItem.Height!@#&		end!@#&	end,!@#&!@#&	Update = function(self)!@#&		for i, toolbarItem in ipairs(self.ToolbarItems) do!@#&			if toolbarItem.Module.Update then!@#&				toolbarItem.Module:Update(toolbarItem)!@#&			end!@#&		end!@#&	end,!@#&!@#&	New = function(self, side, expanded)!@#&		local new = self:Initialise(side, expanded)!@#&!@#&		--new:AddToolbarItem(ToolbarItem:Initialise(\"Colours\", nil, true, new))!@#&		--new:AddToolbarItem(ToolbarItem:Initialise(\"IDK\", true, new))!@#&!@#&		table.insert(Lists.Interface.Toolbars, new)!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		return false!@#&	end!@#&}!@#&!@#&ToolbarItem = {!@#&	X = 0,!@#&	Y = 0,!@#&	Width = 0,!@#&	Height = 0,!@#&	ExpandedHeight = 5,!@#&	Expanded = true,!@#&	Toolbar = nil,!@#&	Title = \"\",!@#&	MenuIcon = \"=\",!@#&	ExpandedIcon = \"+\",!@#&	ContractIcon = \"-\",!@#&	ContentView = nil,!@#&	Module = nil,!@#&	MenuItems = nil,!@#&!@#&	Draw = function(self)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, UIColours.ToolbarItemTitle)!@#&		Drawing.DrawCharacters(self.X + 1, self.Y, self.Title, UIColours.ToolbarText, UIColours.ToolbarItemTitle)!@#&!@#&		Drawing.DrawCharacters(self.X + self.Width - 1, self.Y, self.MenuIcon, UIColours.ToolbarText, UIColours.ToolbarItemTitle)!@#&!@#&		local expandContractIcon = self.ContractIcon!@#&		if not self.Expanded then!@#&			expandContractIcon = self.ExpandedIcon!@#&		end!@#&!@#&		if self.Expanded and self.ContentView then!@#&			self.ContentView:Draw()!@#&		end!@#&!@#&		Drawing.DrawCharacters(self.X + self.Width - 2, self.Y, expandContractIcon, UIColours.ToolbarText, UIColours.ToolbarItemTitle)!@#&	end,!@#&!@#&	Initialise = function(self, module, height, expanded, toolbar, menuItems)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Expanded = expanded!@#&		new.Title = module.Title!@#&		new.Width = toolbar.Width!@#&		new.Height = height or 5!@#&		new.Module = module!@#&		new.MenuItems = menuItems or {}!@#&		table.insert(new.MenuItems,!@#&			{!@#&				Title = 'Shrink',!@#&				Click = function()!@#&					new:ToggleExpanded()!@#&				end!@#&			})!@#&		new.ExpandedHeight = height or 5!@#&		new.Y = 1!@#&		new.X = toolbar.X!@#&		new.ContentView = ContentView:Initialise(1, 2, new.Width, new.Height - 1, nil, new)!@#&		new.Toolbar = toolbar!@#&!@#&		return new!@#&	end,!@#&!@#&	ToggleExpanded = function(self)!@#&		self.Expanded = not self.Expanded!@#&		if self.Expanded then!@#&			self.Height = self.ExpandedHeight!@#&		else!@#&			self.Height = 1!@#&		end!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local pos = GetAbsolutePosition(self)!@#&		if x == self.Width and y == 1 then!@#&			local expandContract = \"Shrink\"!@#&!@#&			if not self.Expanded then!@#&				expandContract = \"Expand\"!@#&			end!@#&			self.MenuItems[#self.MenuItems].Title = expandContract!@#&			Menu:New(pos.X + x, pos.Y + y, self.MenuItems, self)!@#&			return true!@#&		elseif x == self.Width - 1 and y == 1 then!@#&			self:ToggleExpanded()!@#&			return true!@#&		elseif y ~= 1 then!@#&			return self.ContentView:Click(side,  x - self.ContentView.X + 1,  y - self.ContentView.Y + 1)!@#&		end!@#&!@#&		return false!@#&	end!@#&}!@#&!@#&ContentView = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	Parent = nil,!@#&	Views = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)!@#&		for i, view in ipairs(self.Views) do!@#&			view:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, x, y, width, height, views, parent)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = width!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.Views = views or {}!@#&		new.Parent = parent!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		for k, view in pairs(self.Views) do!@#&			if DoClick(view, side, x, y) then!@#&				return true!@#&			end!@#&		end!@#&	end!@#&}!@#&!@#&Button = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	BackgroundColour = colours.lightGrey,!@#&	TextColour = colours.white,!@#&	ActiveBackgroundColour = colours.lightGrey,!@#&	Text = \"\",!@#&	Parent = nil,!@#&	_Click = nil,!@#&	Toggle = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)!@#&		local bg = self.BackgroundColour!@#&		local tc = self.TextColour!@#&		if type(bg) == 'function' then!@#&			bg = bg()!@#&		end!@#&!@#&		if self.Toggle then!@#&			tc = UIColours.MenuBarActive!@#&			bg = self.ActiveBackgroundColour!@#&		end!@#&!@#&		local pos = GetAbsolutePosition(self)!@#&		Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, bg)!@#&		Drawing.DrawCharactersCenter(pos.X, pos.Y, self.Width, self.Height, self.Text, tc, bg)!@#&	end,!@#&!@#&	Initialise = function(self, x, y, width, height, backgroundColour, parent, click, text, textColour, toggle, activeBackgroundColour)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		height = height or 1!@#&		new.Width = width or #text + 2!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.Text = text or \"\"!@#&		new.BackgroundColour = backgroundColour or colours.lightGrey!@#&		new.TextColour = textColour or colours.white!@#&		new.ActiveBackgroundColour = activeBackgroundColour or colours.lightGrey!@#&		new.Parent = parent!@#&		new._Click = click!@#&		new.Toggle = toggle!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		if self._Click then!@#&			if self:_Click(side, x, y, not self.Toggle) ~= false and self.Toggle ~= nil then!@#&				self.Toggle = not self.Toggle!@#&				Draw()!@#&			end!@#&			return true!@#&		else!@#&			return false!@#&		end!@#&	end!@#&}!@#&!@#&TextBox = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	BackgroundColour = colours.lightGrey,!@#&	TextColour = colours.black,!@#&	Parent = nil,!@#&	TextInput = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return self.Parent:AbsolutePosition()!@#&	end,!@#&!@#&	Draw = function(self)		!@#&		local pos = GetAbsolutePosition(self)!@#&		Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, self.BackgroundColour)!@#&		local text = self.TextInput.Value!@#&		if #text > (self.Width - 2) then!@#&			text = text:sub(#text-(self.Width - 3))!@#&			if Current.Input == self.TextInput then!@#&				Current.CursorPos = {pos.X + 1 + self.Width-2, pos.Y}!@#&			end!@#&		else!@#&			if Current.Input == self.TextInput then!@#&				Current.CursorPos = {pos.X + 1 + self.TextInput.CursorPos, pos.Y}!@#&			end!@#&		end!@#&		Drawing.DrawCharacters(pos.X + 1, pos.Y, text, self.TextColour, self.BackgroundColour)!@#&!@#&		term.setCursorBlink(true)!@#&		!@#&		Current.CursorColour = self.TextColour!@#&	end,!@#&!@#&	Initialise = function(self, x, y, width, height, parent, text, backgroundColour, textColour, done, numerical)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		height = height or 1!@#&		new.Width = width or #text + 2!@#&		new.Height = height!@#&		new.Y = y!@#&		new.X = x!@#&		new.TextInput = TextInput:Initialise(text or '', function(key)!@#&			if done then!@#&				done(key)!@#&			end!@#&			Draw()!@#&		end, numerical)!@#&		new.BackgroundColour = backgroundColour or colours.lightGrey!@#&		new.TextColour = textColour or colours.black!@#&		new.Parent = parent!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		Current.Input = self.TextInput!@#&		self:Draw()!@#&	end!@#&}!@#&!@#&TextInput = {!@#&	Value = \"\",!@#&	Change = nil,!@#&	CursorPos = nil,!@#&	Numerical = false,!@#&!@#&	Initialise = function(self, value, change, numerical)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Value = value!@#&		new.Change = change!@#&		new.CursorPos = #value!@#&		new.Numerical = numerical!@#&		return new!@#&	end,!@#&!@#&	Char = function(self, char)!@#&		if self.Numerical then!@#&			char = tostring(tonumber(char))!@#&		end!@#&		if char == 'nil' then!@#&			return!@#&		end!@#&		self.Value = string.sub(self.Value, 1, self.CursorPos ) .. char .. string.sub( self.Value, self.CursorPos + 1 )!@#&		!@#&		self.CursorPos = self.CursorPos + 1!@#&		self.Change(key)!@#&	end,!@#&!@#&	Key = function(self, key)!@#&		if key == keys.enter then!@#&			self.Change(key)		!@#&		elseif key == keys.left then!@#&			-- Left!@#&			if self.CursorPos > 0 then!@#&				self.CursorPos = self.CursorPos - 1!@#&				self.Change(key)!@#&			end!@#&			!@#&		elseif key == keys.right then!@#&			-- Right				!@#&			if self.CursorPos < string.len(self.Value) then!@#&				self.CursorPos = self.CursorPos + 1!@#&				self.Change(key)!@#&			end!@#&		!@#&		elseif key == keys.backspace then!@#&			-- Backspace!@#&			if self.CursorPos > 0 then!@#&				self.Value = string.sub( self.Value, 1, self.CursorPos - 1 ) .. string.sub( self.Value, self.CursorPos + 1 )!@#&				self.CursorPos = self.CursorPos - 1!@#&			end!@#&			self.Change(key)!@#&		elseif key == keys.home then!@#&			-- Home!@#&			self.CursorPos = 0!@#&			self.Change(key)!@#&		elseif key == keys.delete then!@#&			if self.CursorPos < string.len(self.Value) then!@#&				self.Value = string.sub( self.Value, 1, self.CursorPos ) .. string.sub( self.Value, self.CursorPos + 2 )				!@#&				self.Change(key)!@#&			end!@#&		elseif key == keys[\"end\"] then!@#&			-- End!@#&			self.CursorPos = string.len(self.Value)!@#&			self.Change(key)!@#&		end!@#&	end!@#&}!@#&!@#&LayerItem = {!@#&	X = 1,!@#&	Y = 1,!@#&	Parent = nil,!@#&	Layer = nil,!@#&!@#&	Draw = function(self)!@#&		self.Y = self.Layer.Index!@#&!@#&		local pos = GetAbsolutePosition(self)!@#&!@#&		local tc = colours.lightGrey!@#&!@#&		if Current.Layer == self.Layer then!@#&			tc = colours.white!@#&		end!@#&!@#&		Drawing.DrawBlankArea(pos.X, pos.Y, self.Width, self.Height, UIColours.Toolbar)!@#&		!@#&		Drawing.DrawCharacters(pos.X + 3, pos.Y, self.Layer.Name, tc, UIColours.Toolbar)!@#&!@#&		if self.Layer.Visible then!@#&			Drawing.DrawCharacters(pos.X + 1, pos.Y, \"@\", tc, UIColours.Toolbar)!@#&		else!@#&			Drawing.DrawCharacters(pos.X + 1, pos.Y, \"X\", tc, UIColours.Toolbar)!@#&		end!@#&!@#&	end,!@#&!@#&	Initialise = function(self, layer, parent)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = parent.Width!@#&		new.Height = 1!@#&		new.Y = 1!@#&		new.X = 1!@#&		new.Layer = layer!@#&		new.Parent = parent!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		if x == 2 then!@#&			self.Layer.Visible = not self.Layer.Visible!@#&		else!@#&			Current.Layer = self.Layer!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&Menu = {!@#&	X = 0,!@#&	Y = 0,!@#&	Width = 0,!@#&	Height = 0,!@#&	Owner = nil,!@#&	Items = {},!@#&	RemoveTop = false,!@#&!@#&	Draw = function(self)!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y + 1, self.Width, self.Height, UIColours.Shadow)!@#&		if not self.RemoveTop then!@#&			Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.MenuBackground)!@#&			for i, item in ipairs(self.Items) do!@#&				if item.Separator then!@#&					Drawing.DrawArea(self.X, self.Y + i, self.Width, 1, '-', colours.grey, UIColours.MenuBackground)!@#&				else!@#&					local textColour = UIColours.MenuText!@#&					if (item.Enabled and type(item.Enabled) == 'function' and item.Enabled() == false) or item.Enabled == false then!@#&						textColour = UIColours.MenuDisabledText!@#&					end!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i, item.Title, textColour, UIColours.MenuBackground)!@#&				end!@#&			end!@#&		else!@#&			Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.MenuBackground)!@#&			for i, item in ipairs(self.Items) do!@#&				if item.Separator then!@#&					Drawing.DrawArea(self.X, self.Y + i - 1, self.Width, 1, '-', colours.grey, UIColours.MenuBackground)!@#&				else!@#&					local textColour = UIColours.MenuText!@#&					if (item.Enabled and type(item.Enabled) == 'function' and item.Enabled() == false) or item.Enabled == false then!@#&						textColour = UIColours.MenuDisabledText!@#&					end!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - 1, item.Title, textColour, UIColours.MenuBackground)!@#&!@#&					Drawing.DrawCharacters(self.X - 1 + self.Width-#item.KeyName, self.Y + i - 1, item.KeyName, textColour, UIColours.MenuBackground)!@#&				end!@#&			end!@#&		end!@#&	end,!@#&!@#&	NameForKey = function(self, key)!@#&		if key == keys.leftCtrl then!@#&			return '^'!@#&		elseif key == keys.tab then!@#&			return 'Tab'!@#&		elseif key == keys.delete then!@#&			return 'Delete'!@#&		elseif key == keys.n then!@#&			return 'N'!@#&		elseif key == keys.s then!@#&			return 'S'!@#&		elseif key == keys.o then!@#&			return 'O'!@#&		elseif key == keys.z then!@#&			return 'Z'!@#&		elseif key == keys.y then!@#&			return 'Y'!@#&		elseif key == keys.c then!@#&			return 'C'!@#&		elseif key == keys.x then!@#&			return 'X'!@#&		elseif key == keys.v then!@#&			return 'V'!@#&		elseif key == keys.r then!@#&			return 'R'!@#&		elseif key == keys.l then!@#&			return 'L'!@#&		elseif key == keys.t then!@#&			return 'T'!@#&		elseif key == keys.h then!@#&			return 'H'!@#&		elseif key == keys.e then!@#&			return 'E'!@#&		elseif key == keys.p then!@#&			return 'P'!@#&		elseif key == keys.f then!@#&			return 'F'!@#&		elseif key == keys.m then!@#&			return 'M'!@#&		else!@#&			return '?'		!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, x, y, items, owner, removeTop)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		if not owner then!@#&			return!@#&		end!@#&!@#&		local keyNames = {}!@#&!@#&		for i, v in ipairs(items) do!@#&			items[i].KeyName = ''!@#&			if v.Keys then!@#&				for _i, key in ipairs(v.Keys) do!@#&					items[i].KeyName = items[i].KeyName .. self:NameForKey(key)!@#&				end!@#&			end!@#&			if items[i].KeyName ~= '' then!@#&				table.insert(keyNames, items[i].KeyName)!@#&			end!@#&		end!@#&		local keysLength = LongestString(keyNames)!@#&		if keysLength > 0 then!@#&			keysLength = keysLength + 2!@#&		end!@#&!@#&		new.Width = LongestString(items, 'Title') + 2 + keysLength!@#&		if new.Width < 10 then!@#&			new.Width = 10!@#&		end!@#&		new.Height = #items + 2!@#&		new.RemoveTop = removeTop or false!@#&		if removeTop then!@#&			new.Height = new.Height - 1!@#&		end!@#&		!@#&		if y < 1 then!@#&			y = 1!@#&		end!@#&		if x < 1 then!@#&			x = 1!@#&		end!@#&!@#&		if y + new.Height > Drawing.Screen.Height + 1 then!@#&			y = Drawing.Screen.Height - new.Height!@#&		end!@#&		if x + new.Width > Drawing.Screen.Width + 1 then!@#&			x = Drawing.Screen.Width - new.Width!@#&		end!@#&!@#&!@#&		new.Y = y!@#&		new.X = x!@#&		new.Items = items!@#&		new.Owner = owner!@#&		return new!@#&	end,!@#&!@#&	New = function(self, x, y, items, owner, removeTop)!@#&		if Current.Menu and Current.Menu.Owner == owner then!@#&			Current.Menu = nil!@#&			return!@#&		end!@#&!@#&		local new = self:Initialise(x, y, items, owner, removeTop)!@#&		Current.Menu = new!@#&		return new!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local i = y-1!@#&		if self.RemoveTop then!@#&			i = y!@#&		end!@#&		if i >= 1 and y < self.Height then!@#&			if not ((self.Items[i].Enabled and type(self.Items[i].Enabled) == 'function' and self.Items[i].Enabled() == false) or self.Items[i].Enabled == false) and self.Items[i].Click then!@#&				self.Items[i]:Click()!@#&				if Current.Menu.Owner and Current.Menu.Owner.Toggle then!@#&					Current.Menu.Owner.Toggle = false!@#&				end!@#&				Current.Menu = nil!@#&				self = nil!@#&			end!@#&			return true!@#&		end!@#&	end!@#&}!@#&!@#&MenuBar = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = Drawing.Screen.Width,!@#&	Height = 1,!@#&	MenuBarItems = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		--Drawing.DrawArea(self.X - 1, self.Y, 1, self.Height, \"|\", UIColours.ToolbarText, UIColours.Background)!@#&!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, self.Height, UIColours.Toolbar)!@#&		for i, button in ipairs(self.MenuBarItems) do!@#&			button:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, items)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.X = 1!@#&		new.Y = 1!@#&		new.MenuBarItems = items!@#&		return new!@#&	end,!@#&!@#&	AddToolbarItem = function(self, item)!@#&		table.insert(self.ToolbarItems, item)!@#&		self:CalculateToolbarItemPositions()!@#&	end,!@#&!@#&	CalculateToolbarItemPositions = function(self)!@#&		local currY = 1!@#&		for i, toolbarItem in ipairs(self.ToolbarItems) do!@#&			toolbarItem.Y = currY!@#&			currY = currY + toolbarItem.Height!@#&		end!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		for i, item in ipairs(self.MenuBarItems) do!@#&			if item.X <= x and item.X + item.Width > x then!@#&				if item:Click(item, side, x - item.X + 1, 1) then!@#&					break!@#&				end!@#&			end!@#&		end!@#&		return false!@#&	end!@#&}!@#&!@#&--Modules--!@#&!@#&Modules = {!@#&	{!@#&		Title = \"Colours\",!@#&		ToolbarItem = nil,!@#&		Initialise = function(self)!@#&			self.ToolbarItem = ToolbarItem:Initialise(self, nil, true, Current.Toolbar)!@#&!@#&			local buttons = {}!@#&!@#&			local i = 0!@#&!@#&			local coloursWidth = 8!@#&			local _colours = {!@#&				colours.brown,!@#&				colours.yellow,!@#&				colours.orange,!@#&				colours.red,!@#&				colours.green,!@#&				colours.lime,!@#&				colours.magenta,!@#&				colours.pink,!@#&				colours.purple,!@#&				colours.blue,!@#&				colours.cyan,!@#&				colours.lightBlue,!@#&				colours.lightGrey,!@#&				colours.grey,!@#&				colours.black,!@#&				colours.white!@#&			}!@#&!@#&			for k, colour in pairs(_colours) do!@#&				if type(colour) == 'number' and colour ~= -1 then!@#&					i = i + 1!@#&!@#&					local y = math.floor(i/(coloursWidth/2))!@#&!@#&					local x = (i%(coloursWidth/2))!@#&					if x == 0 then!@#&						x = (coloursWidth/2)!@#&						y = y -1!@#&					end!@#&!@#&					table.insert(buttons,!@#&						{!@#&							X = x*2 - 2 + self.ToolbarItem.Width - coloursWidth,!@#&							Y = y+1,!@#&							Width = 2,!@#&							Height = 1,!@#&							BackgroundColour = colour,!@#&							Click = function(self, side, x, y)!@#&								SetColour(self.BackgroundColour)!@#&							end!@#&						}!@#&					)!@#&				end!@#&			end!@#&!@#&			for i, button in ipairs(buttons) do!@#&				table.insert(self.ToolbarItem.ContentView.Views, !@#&					Button:Initialise(button.X, button.Y, button.Width, button.Height, button.BackgroundColour, self.ToolbarItem.ContentView, button.Click))	!@#&			end!@#&			!@#&			table.insert(self.ToolbarItem.ContentView.Views, !@#&					Button:Initialise(1, 1, 4, 3, function()return Current.Colour end, self.ToolbarItem.ContentView, nil))!@#&		!@#&			Current.Toolbar:AddToolbarItem(self.ToolbarItem)!@#&		end!@#&	},!@#&!@#&	{!@#&		Title = \"Tools\",!@#&		ToolbarItem = nil,!@#&		Update = function(self)!@#&			for i, view in ipairs(self.ToolbarItem.ContentView.Views) do!@#&				if (Current.Tool and Current.Tool.Name == view.Text) then!@#&					view.TextColour = colours.white!@#&				else!@#&					view.TextColour = colours.lightGrey!@#&				end!@#&			end!@#&			self.ToolbarItem.ContentView.Views[1].Text = 'Size: '..Current.ToolSize!@#&		end,!@#&!@#&		Initialise = function(self)!@#&			self.ToolbarItem = ToolbarItem:Initialise(self, #Tools+2, true, Current.Toolbar,!@#&				{{!@#&					Title = \"Change Tool Size\",!@#&					Click = function()!@#&						DisplayToolSizeWindow()!@#&					end,!@#&				}})!@#&!@#&			table.insert(self.ToolbarItem.ContentView.Views, Button:Initialise(1, 1, self.ToolbarItem.Width, 1, UIColours.Toolbar, self.ToolbarItem.ContentView, DisplayToolSizeWindow, 'Size: '..Current.ToolSize))!@#&!@#&			local y = 2!@#&			for i, tool in ipairs(Tools) do!@#&				table.insert(self.ToolbarItem.ContentView.Views, Button:Initialise(1, y, self.ToolbarItem.Width, 1, UIColours.Toolbar, self.ToolbarItem.ContentView, function() SetTool(tool) self:Update(self.ToolbarItem) end, tool.Name))!@#&				y = y + 1!@#&			end!@#&!@#&			self:Update(self.ToolbarItem)!@#&!@#&			Current.Toolbar:AddToolbarItem(self.ToolbarItem)!@#&		end!@#&	},!@#&!@#&	{!@#&		Title = \"Layers\",!@#&		ToolbarItem = nil,!@#&		Update = function(self)!@#&			if Current.Artboard then!@#&				self.ToolbarItem.ContentView.Views = {}!@#&				for i = 1, #Current.Artboard.Layers do!@#&					table.insert(self.ToolbarItem.ContentView.Views, LayerItem:Initialise(Current.Artboard.Layers[#Current.Artboard.Layers-i+1], self.ToolbarItem.ContentView))!@#&				end					!@#&			end!@#&		end,!@#&!@#&		Initialise = function(self)!@#&			self.ToolbarItem = ToolbarItem:Initialise(self, nil, true, Current.Toolbar,!@#&				{{!@#&					Title = \"New Layer\",!@#&					Click = function()!@#&						MakeNewLayer()!@#&					end,!@#&					Enabled = function()!@#&						return CheckOpenArtboard()!@#&					end!@#&				},!@#&				{!@#&					Title = 'Delete Layer',!@#&					Click = function()!@#&						DeleteLayer()!@#&					end,!@#&					Enabled = function()!@#&						return CheckSelectedLayer()!@#&					end!@#&				},!@#&				{!@#&					Title = 'Rename Layer...',!@#&					Click = function()!@#&						RenameLayer()!@#&					end,!@#&					Enabled = function()!@#&						return CheckSelectedLayer()!@#&					end!@#&				}})!@#&			!@#&			self:Update()!@#&!@#&			Current.Toolbar:AddToolbarItem(self.ToolbarItem)!@#&		end!@#&	}!@#&!@#&}!@#&!@#&function ModuleNamed(name)!@#&	for i, v in ipairs(Modules) do!@#&		if v.Title == name then!@#&			return v!@#&		end!@#&	end!@#&end!@#&!@#&--Tools--!@#&!@#&function ToolAffectedPixels(x, y)!@#&	if not CheckSelectedLayer() then!@#&		return {}!@#&	end!@#&	if Current.ToolSize == 1 then!@#&		if Current.Layer.Pixels[x] and Current.Layer.Pixels[x][y] then!@#&			return {{Current.Layer.Pixels[x][y], x, y}}!@#&		end!@#&	else!@#&		local pixels = {}!@#&		local cornerX = x - math.ceil(Current.ToolSize/2)!@#&		local cornerY = y - math.ceil(Current.ToolSize/2)!@#&		for _x = 1, Current.ToolSize do!@#&			for _y = 1, Current.ToolSize do!@#&				if Current.Layer.Pixels[cornerX + _x] and Current.Layer.Pixels[cornerX + _x][cornerY + _y] then!@#&					table.insert(pixels, {Current.Layer.Pixels[cornerX + _x][cornerY + _y], cornerX + _x, cornerY + _y})!@#&				end!@#&			end!@#&		end!@#&		return pixels!@#&	end!@#&end!@#&local moveStartPoint = {}!@#&Tools = {!@#&	{!@#&		Name = \"Hand\",!@#&		Use = function(self, x, y, side, drag)!@#&			Current.Input = nil!@#&			if drag and Current.HandDragStart and Current.HandDragStart[1] and Current.HandDragStart[2] then!@#&				local deltaX = x - Current.HandDragStart[1]!@#&				local deltaY = y - Current.HandDragStart[2]!@#&				Current.Artboard.X = Current.Artboard.X + deltaX!@#&				Current.Artboard.Y = Current.Artboard.Y + deltaY!@#&			else!@#&				Current.HandDragStart = {x, y}!@#&			end!@#&			sleep(0)!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Pencil\",!@#&		Use = function(self, _x, _y, side, artboard)!@#&			Current.Input = nil!@#&			for i, pixel in ipairs(ToolAffectedPixels(_x, _y)) do!@#&				if side == 1 then!@#&					pixel[1].BackgroundColour = Current.Colour!@#&				elseif side == 2 then!@#&					pixel[1].TextColour = Current.Colour!@#&				end!@#&				pixel[1]:Draw(pixel[2], pixel[3])!@#&			end!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Eraser\",!@#&		Use = function(self, x, y, side)!@#&			Current.Input = nil!@#&			Current.Layer:SetPixel(x, y, nil, Current.Layer.BackgroundColour, nil)!@#&			for i, pixel in ipairs(ToolAffectedPixels(x, y)) do!@#&				Current.Layer:SetPixel(pixel[2], pixel[3], nil, Current.Layer.BackgroundColour, nil)!@#&			end!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Fill Bucket\",!@#&		Use = function(self, x, y, side)!@#&			local replaceColour = Current.Layer.Pixels[x][y].BackgroundColour!@#&			if side == 2 then!@#&				replaceColour = Current.Layer.Pixels[x][y].TextColour!@#&			end!@#&!@#&			local nodes = {{X = x, Y = y}}!@#&!@#&			while #nodes > 0 do!@#&				local node = nodes[1]!@#&				if Current.Layer.Pixels[node.X] and Current.Layer.Pixels[node.X][node.Y] then!@#&					local replacing = Current.Layer.Pixels[node.X][node.Y].BackgroundColour!@#&					if side == 2 then!@#&						replacing = Current.Layer.Pixels[node.X][node.Y].TextColour!@#&					end!@#&					if replacing == replaceColour and replacing ~= Current.Colour then!@#&						if side == 1 then!@#&							Current.Layer.Pixels[node.X][node.Y].BackgroundColour = Current.Colour!@#&						elseif side == 2 then!@#&							Current.Layer.Pixels[node.X][node.Y].TextColour = Current.Colour!@#&						end!@#&						table.insert(nodes, {X = node.X, Y = node.Y + 1})!@#&						table.insert(nodes, {X = node.X + 1, Y = node.Y})!@#&						if x > 1 then!@#&							table.insert(nodes, {X = node.X - 1, Y = node.Y})!@#&						end!@#&						if y > 1 then!@#&							table.insert(nodes, {X = node.X, Y = node.Y - 1})!@#&						end!@#&					end!@#&				end!@#&				table.remove(nodes, 1)!@#&			end!@#&			Draw()!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Select\",!@#&		Use = function(self, x, y, side, drag)!@#&			Current.Input = nil!@#&			if not drag then!@#&				Current.Selection[1] = vector.new(x, y, 0)!@#&				Current.Selection[2] = nil!@#&			else!@#&				Current.Selection[2] = vector.new(x, y, 0)!@#&			end!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Move\",!@#&		Use = function(self, x, y, side, drag)!@#&			Current.Input = nil!@#&!@#&			if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&				if drag and moveStartPoint then!@#&					local pixels = Current.Layer:PixelsInSelection(true)!@#&					local size = Current.Selection[1] - Current.Selection[2]!@#&					Current.Selection[1] = vector.new(x-moveStartPoint[1], y-moveStartPoint[2], 0)!@#&					Current.Selection[2] = vector.new(x-moveStartPoint[1]-size.x, y-moveStartPoint[2]-size.y, 0)!@#&					Current.Layer:InsertPixels(pixels)!@#&				else!@#&					moveStartPoint = {x-Current.Selection[1].x, y-Current.Selection[1].y}!@#&				end!@#&			end!@#&		end,!@#&		Select = function(self)!@#&			return true!@#&		end!@#&	},!@#&!@#&	{!@#&		Name = \"Text\",!@#&		Use = function(self, x, y)!@#&			Current.Input = TextInput:Initialise('', function(key)!@#&				if key == keys.delete or key == keys.backspace then!@#&					if #Current.Input.Value == 0 then!@#&						if Current.Layer.Pixels[x] and Current.Layer.Pixels[x][y] then!@#&							Current.Layer.Pixels[x][y]:Set(nil, nil, ' ')!@#&							local newPos = Current.CursorPos[1] - Current.Artboard.X!@#&							if newPos < Current.Artboard.X - 1 then!@#&								newPos = Current.Artboard.X - 1!@#&							end!@#&							Current.Tool:Use(newPos, Current.CursorPos[2] - Current.Artboard.Y + 1)!@#&							Draw()!@#&						end!@#&						return!@#&					else!@#&						if Current.Layer.Pixels[x+#Current.Input.Value] and Current.Layer.Pixels[x+#Current.Input.Value][y] then!@#&							Current.Layer.Pixels[x+#Current.Input.Value][y]:Set(nil, nil, ' ')!@#&						end!@#&					end!@#&				else!@#&					local i = #Current.Input.Value!@#&					if Current.Layer.Pixels[x+i-1] then!@#&						Current.Layer.Pixels[x+i-1][y]:Set(Current.Colour, nil, Current.Input.Value:sub(i,i))!@#&						Current.Layer.Pixels[x+i-1][y]:Draw(x+i-1, y)!@#&					end!@#&				end!@#&!@#&				local newPos = x+Current.Input.CursorPos!@#&!@#&				if newPos > Current.Artboard.Width then!@#&					Current.Input.CursorPos = Current.Input.CursorPos - 1!@#&				end!@#&!@#&				Current.CursorPos = {x+Current.Input.CursorPos + Current.Artboard.X - 1, y + Current.Artboard.Y - 1}!@#&				Current.CursorColour = Current.Colour!@#&				Draw()!@#&			end)!@#&!@#&			Current.CursorPos = {x + Current.Artboard.X - 1, y + Current.Artboard.Y - 1}!@#&			Current.CursorColour = Current.Colour!@#&		end,!@#&		Select = function(self)!@#&			if Current.Artboard.Format == '.nfp' then!@#&				ButtonDialougeWindow:Initialise('NFP does not support text!', 'The format you are using, NFP, does not support text. Use NFT or SKCH to use text.', 'Ok', nil, function(window)!@#&					window:Close()!@#&				end):Show()!@#&				return false!@#&			else!@#&				return true!@#&			end!@#&		end!@#&	}!@#&}!@#&!@#&!@#&function ToolNamed(name)!@#&	for i, v in ipairs(Tools) do!@#&		if v.Name == name then!@#&			return v!@#&		end!@#&	end!@#&end!@#&!@#&--Windows--!@#&!@#&NewDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	OkButton = nil,!@#&	Format = '.skch',!@#&	ImageBackgroundColour = colours.white,!@#&	NameLabelHighlight = false,!@#&	SizeLabelHighlight = false,!@#&!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		local nameLabelColour = colours.black!@#&		if self.NameLabelHighlight then!@#&			nameLabelColour = colours.red!@#&		end!@#&!@#&		Drawing.DrawCharacters(self.X+1, self.Y+2, \"Name\", nameLabelColour, colours.white)!@#&		Drawing.DrawCharacters(self.X+1, self.Y+4, \"Type\", colours.black, colours.white)!@#&!@#&		local sizeLabelColour = colours.black!@#&		if self.SizeLabelHighlight then!@#&			sizeLabelColour = colours.red!@#&		end!@#&		Drawing.DrawCharacters(self.X+1, self.Y+6, \"Size\", sizeLabelColour, colours.white)!@#&		Drawing.DrawCharacters(self.X+11, self.Y+6, \"x\", colours.black, colours.white)!@#&		Drawing.DrawCharacters(self.X+1, self.Y+8, \"Background\", colours.black, colours.white)!@#&!@#&		self.OkButton:Draw()!@#&		self.CancelButton:Draw()!@#&		self.SKCHButton:Draw()!@#&		self.NFTButton:Draw()!@#&		self.NFPButton:Draw()!@#&		self.PathTextBox:Draw()!@#&		self.WidthTextBox:Draw()!@#&		self.HeightTextBox:Draw()!@#&		self.WhiteButton:Draw()!@#&		self.BlackButton:Draw()!@#&		self.TransparentButton:Draw()!@#&	end,	!@#&!@#&	Initialise = function(self, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 32!@#&		new.Height = 13!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'New Document'!@#&		new.Visible = true!@#&		new.NameLabelHighlight = false!@#&		new.SizeLabelHighlight = false!@#&		new.Format = '.skch'!@#&		new.OkButton = Button:Initialise(new.Width - 4, new.Height - 1, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			local path = new.PathTextBox.TextInput.Value!@#&			local ok = true!@#&			new.NameLabelHighlight = false!@#&			new.SizeLabelHighlight = false!@#&			local _fs = fs!@#&			if OneOS then!@#&				_fs = OneOS.FS!@#&			end!@#&			if path:sub(-1) == \"/SpeedOS/Pictures/\" or _fs.isDir(\"/SpeedOS/Pictures/\"..path) or #path == 0 then!@#&				ok = false!@#&				new.NameLabelHighlight = true!@#&			end!@#&!@#&			if #new.WidthTextBox.TextInput.Value == 0 or tonumber(new.WidthTextBox.TextInput.Value) <= 0 then!@#&				ok = false!@#&				new.SizeLabelHighlight = true!@#&			end!@#&!@#&			if #new.HeightTextBox.TextInput.Value == 0 or tonumber(new.HeightTextBox.TextInput.Value) <= 0 then!@#&				ok = false!@#&				new.SizeLabelHighlight = true!@#&			end!@#&!@#&			if ok then!@#&				returnFunc(new, true, path, tonumber(new.WidthTextBox.TextInput.Value), tonumber(new.HeightTextBox.TextInput.Value), new.Format, new.ImageBackgroundColour)!@#&			else!@#&				Draw()!@#&			end!@#&		end, 'Ok', colours.black)!@#&		new.CancelButton = Button:Initialise(new.Width - 13, new.Height - 1, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)returnFunc(new, false)end, 'Cancel', colours.black)!@#&!@#&		new.SKCHButton = Button:Initialise(7, 5, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.NFTButton.Toggle = false!@#&			new.NFPButton.Toggle = false!@#&			self.Toggle = false!@#&			new.Format = '.skch'!@#&		end, '.skch', colours.black, true, colours.lightBlue)!@#&		new.NFTButton = Button:Initialise(15, 5, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.SKCHButton.Toggle = false!@#&			new.NFPButton.Toggle = false!@#&			self.Toggle = false!@#&			new.Format = '.nft'!@#&		end, '.nft', colours.black, false, colours.lightBlue)!@#&		new.NFPButton = Button:Initialise(22, 5, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.SKCHButton.Toggle = false!@#&			new.NFTButton.Toggle = false!@#&			self.Toggle = false!@#&			new.Format = '.nfp'!@#&		end, '.nfp', colours.black, false, colours.lightBlue)!@#&!@#&		local path = \"/SpeedOS/Pictures/\"!@#&		if OneOS then!@#&			path = '/Desktop/'!@#&		end!@#&		new.PathTextBox = TextBox:Initialise(7, 3, new.Width - 7, 1, new, path, nil, nil, function(key)!@#&			if key == keys.enter or key == keys.tab then!@#&				Current.Input = new.WidthTextBox.TextInput!@#&			end			!@#&		end)!@#&		new.WidthTextBox = TextBox:Initialise(7, 7, 4, 1, new, tostring(15), nil, nil, function()!@#&			if key == keys.enter or key == keys.tab then!@#&				Current.Input = new.HeightTextBox.TextInput!@#&			end!@#&		end, true)!@#&		new.HeightTextBox = TextBox:Initialise(14, 7, 4, 1, new, tostring(10), nil, nil, function()!@#&			if key == keys.enter or key == keys.tab then!@#&				Current.Input = new.PathTextBox.TextInput!@#&			end!@#&		end, true)!@#&		Current.Input = new.PathTextBox.TextInput!@#&!@#&!@#&		new.WhiteButton = Button:Initialise(2, 10, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.TransparentButton.Toggle = false!@#&			new.BlackButton.Toggle = false!@#&			self.Toggle = false!@#&			new.ImageBackgroundColour = colours.white!@#&		end, 'White', colours.black, true, colours.lightBlue)!@#&		new.BlackButton = Button:Initialise(10, 10, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.TransparentButton.Toggle = false!@#&			new.WhiteButton.Toggle = false!@#&			self.Toggle = false!@#&			new.ImageBackgroundColour = colours.black!@#&		end, 'Black', colours.black, false, colours.lightBlue)!@#&		new.TransparentButton = Button:Initialise(18, 10, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			new.WhiteButton.Toggle = false!@#&			new.BlackButton.Toggle = false!@#&			self.Toggle = false!@#&			new.ImageBackgroundColour = colours.transparent!@#&		end, 'Transparent', colours.black, false, colours.lightBlue)!@#&!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	ButtonClick = function(self, button, x, y)!@#&		if button.X <= x and button.Y <= y and button.X + button.Width > x and button.Y + button.Height > y then!@#&			button:Click()!@#&		end!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.CancelButton, self.SKCHButton, self.NFTButton, self.NFPButton, self.PathTextBox, self.WidthTextBox, self.HeightTextBox, self.WhiteButton, self.BlackButton, self.TransparentButton}!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&local TidyPath = function(path)!@#&	path = \"/SpeedOS/Pictures/\"..path!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	if _fs.isDir(path) then!@#&		path = path .. '/'!@#&	end!@#&!@#&	path, n = path:gsub(\"//\", \"/\")!@#&	while n > 0 do!@#&		path, n = path:gsub(\"//\", \"/\")!@#&	end!@#&	return path!@#&end!@#&!@#&local WrapText = function(text, maxWidth)!@#&	local lines = {''}!@#&    for word, space in text:gmatch('(%S+)(%s*)') do!@#&            local temp = lines[#lines] .. word .. space:gsub('\\n','')!@#&            if #temp > maxWidth then!@#&                    table.insert(lines, '')!@#&            end!@#&            if space:find('\\n') then!@#&                    lines[#lines] = lines[#lines] .. word!@#&                    !@#&                    space = space:gsub('\\n', function()!@#&                            table.insert(lines, '')!@#&                            return ''!@#&                    end)!@#&            else!@#&                    lines[#lines] = lines[#lines] .. word .. space!@#&            end!@#&    end!@#&	return lines!@#&end!@#&!@#&OpenDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	OpenButton = nil,!@#&	PathTextBox = nil,!@#&	CurrentDirectory = '/',!@#&	Scroll = 0,!@#&	MaxScroll = 0,!@#&	GoUpButton = nil,!@#&	SelectedFile = '',!@#&	Files = {},!@#&	Typed = false,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 3, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-6, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y + self.Height - 5, self.Width, 5, colours.lightGrey)!@#&		self:DrawFiles()!@#&!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		if (_fs.exists(self.PathTextBox.TextInput.Value)) or (self.SelectedFile and #self.SelectedFile > 0 and _fs.exists(self.CurrentDirectory .. self.SelectedFile)) then!@#&			self.OpenButton.TextColour = colours.black!@#&		else!@#&			self.OpenButton.TextColour = colours.lightGrey!@#&		end!@#&!@#&		self.PathTextBox:Draw()!@#&		self.OpenButton:Draw()!@#&		self.CancelButton:Draw()!@#&		self.GoUpButton:Draw()!@#&	end,!@#&!@#&	DrawFiles = function(self)!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		for i, file in ipairs(self.Files) do!@#&			if i > self.Scroll and i - self.Scroll <= 11 then!@#&				if file == self.SelectedFile then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.white, colours.lightBlue)!@#&				elseif string.find(file, '%.skch') or string.find(file, '%.nft') or string.find(file, '%.nfp') or _fs.isDir(self.CurrentDirectory .. file) then!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.black, colours.white)!@#&				else!@#&					Drawing.DrawCharacters(self.X + 1, self.Y + i - self.Scroll, file, colours.grey, colours.white)!@#&				end!@#&			end!@#&		end!@#&		self.MaxScroll = #self.Files - 11!@#&		if self.MaxScroll < 0 then!@#&			self.MaxScroll = 0!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 32!@#&		new.Height = 17!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'Open Document'!@#&		new.Visible = true!@#&		new.CurrentDirectory = '/'!@#&		new.SelectedFile = nil!@#&		if OneOS then!@#&			new.CurrentDirectory = '/Desktop/'!@#&		end!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		new.OpenButton = Button:Initialise(new.Width - 6, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			if _fs.exists(new.PathTextBox.TextInput.Value) and self.TextColour == colours.black and not _fs.isDir(new.PathTextBox.TextInput.Value) then!@#&				returnFunc(new, true, TidyPath(new.PathTextBox.TextInput.Value))!@#&			elseif new.SelectedFile and self.TextColour == colours.black and _fs.isDir(new.CurrentDirectory .. new.SelectedFile) then!@#&				new:GoToDirectory(new.CurrentDirectory .. new.SelectedFile)!@#&			elseif new.SelectedFile and self.TextColour == colours.black then!@#&				returnFunc(new, true, TidyPath(new.CurrentDirectory .. '/' .. new.SelectedFile))!@#&			end!@#&		end, 'Open', colours.black)!@#&		new.CancelButton = Button:Initialise(new.Width - 15, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			returnFunc(new, false)!@#&		end, 'Cancel', colours.black)!@#&		new.GoUpButton = Button:Initialise(2, new.Height - 1, nil, nil, colours.white, new, function(self, side, x, y, toggle)!@#&			local folderName = _fs.getName(new.CurrentDirectory)!@#&			local parentDirectory = new.CurrentDirectory:sub(1, #new.CurrentDirectory-#folderName-1)!@#&			new:GoToDirectory(parentDirectory)!@#&		end, 'Go Up', colours.black)!@#&		new.PathTextBox = TextBox:Initialise(2, new.Height - 3, new.Width - 2, 1, new, new.CurrentDirectory, colours.white, colours.black)!@#&		new:GoToDirectory(new.CurrentDirectory)!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	GoToDirectory = function(self, path)!@#&		path = TidyPath(path)!@#&		self.CurrentDirectory = path!@#&		self.Scroll = 0!@#&		self.SelectedFile = nil!@#&		self.Typed = false!@#&		self.PathTextBox.TextInput.Value = path!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		self.Files = _fs.list(self.CurrentDirectory)!@#&		Draw()!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OpenButton, self.CancelButton, self.PathTextBox, self.GoUpButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&!@#&		if not found then!@#&			if y <= 12 then!@#&				local _fs = fs!@#&				if OneOS then!@#&					_fs = OneOS.FS!@#&				end!@#&				self.SelectedFile = _fs.list(self.CurrentDirectory)[y-1]!@#&				self.PathTextBox.TextInput.Value = TidyPath(self.CurrentDirectory .. '/' .. self.SelectedFile)!@#&				Draw()!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&ButtonDialougeWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	CancelButton = nil,!@#&	OkButton = nil,!@#&	Lines = {},!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		for i, text in ipairs(self.Lines) do!@#&			Drawing.DrawCharacters(self.X + 1, self.Y + 1 + i, text, colours.black, colours.white)!@#&		end!@#&!@#&		self.OkButton:Draw()!@#&		if self.CancelButton then!@#&			self.CancelButton:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, title, message, okText, cancelText, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 28!@#&		new.Lines = WrapText(message, new.Width - 2)!@#&		new.Height = 5 + #new.Lines!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = title!@#&		new.Visible = true!@#&		new.Visible = true!@#&		new.OkButton = Button:Initialise(new.Width - #okText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&			returnFunc(new, true)!@#&		end, okText)!@#&		if cancelText then!@#&			new.CancelButton = Button:Initialise(new.Width - #okText - 2 - 1 - #cancelText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&				returnFunc(new, false)!@#&			end, cancelText)!@#&		end!@#&!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.CancelButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&TextDialougeWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	CancelButton = nil,!@#&	OkButton = nil,!@#&	Lines = {},!@#&	TextInput = nil,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		for i, text in ipairs(self.Lines) do!@#&			Drawing.DrawCharacters(self.X + 1, self.Y + 1 + i, text, colours.black, colours.white)!@#&		end!@#&!@#&!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y + self.Height - 4, self.Width - 2, 1, colours.lightGrey)!@#&		Drawing.DrawCharacters(self.X + 2, self.Y + self.Height - 4, self.TextInput.Value, colours.black, colours.lightGrey)!@#&		Current.CursorPos = {self.X + 2 + self.TextInput.CursorPos, self.Y + self.Height - 4}!@#&		Current.CursorColour = colours.black!@#&!@#&		self.OkButton:Draw()!@#&		if self.CancelButton then!@#&			self.CancelButton:Draw()!@#&		end!@#&	end,!@#&!@#&	Initialise = function(self, title, message, okText, cancelText, returnFunc, numerical)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 28!@#&		new.Lines = WrapText(message, new.Width - 2)!@#&		new.Height = 7 + #new.Lines!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = title!@#&		new.Visible = true!@#&		new.Visible = true!@#&		new.OkButton = Button:Initialise(new.Width - #okText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&			if #new.TextInput.Value > 0 then!@#&				returnFunc(new, true, new.TextInput.Value)!@#&			end!@#&		end, okText)!@#&		if cancelText then!@#&			new.CancelButton = Button:Initialise(new.Width - #okText - 2 - 1 - #cancelText - 2, new.Height - 1, nil, 1, nil, new, function()!@#&				returnFunc(new, false)!@#&			end, cancelText)!@#&		end!@#&		new.TextInput = TextInput:Initialise('', function(enter)!@#&			if enter then!@#&				new.OkButton:Click()!@#&			end!@#&			Draw()!@#&		end, numerical)!@#&!@#&		Current.Input = new.TextInput!@#&!@#&		return new!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Window = nil!@#&		Current.Input = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.CancelButton}!@#&		local found = false!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&				found = true!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&ResizeDocumentWindow = {!@#&	X = 1,!@#&	Y = 1,!@#&	Width = 0,!@#&	Height = 0,!@#&	CursorPos = 1,!@#&	Visible = true,!@#&	Return = nil,!@#&	OkButton = nil,!@#&	AnchorPosition = 5,!@#&	WidthLabelHighlight = false,!@#&	HeightLabelHighlight = false,!@#&!@#&	AbsolutePosition = function(self)!@#&		return {X = self.X, Y = self.Y}!@#&	end,!@#&!@#&	Draw = function(self)!@#&		if not self.Visible then!@#&			return!@#&		end!@#&		Drawing.DrawBlankArea(self.X + 1, self.Y+1, self.Width, self.Height, colours.grey)!@#&		Drawing.DrawBlankArea(self.X, self.Y, self.Width, 1, colours.lightGrey)!@#&		Drawing.DrawBlankArea(self.X, self.Y+1, self.Width, self.Height-1, colours.white)!@#&		Drawing.DrawCharactersCenter(self.X, self.Y, self.Width, 1, self.Title, colours.black, colours.lightGrey)!@#&!@#&		Drawing.DrawCharacters(self.X+1, self.Y+2, \"New Size\", colours.lightGrey, colours.white)!@#&		if (#self.WidthTextBox.TextInput.Value > 0 and tonumber(self.WidthTextBox.TextInput.Value) < Current.Artboard.Width) or (#self.HeightTextBox.TextInput.Value > 0 and tonumber(self.HeightTextBox.TextInput.Value) < Current.Artboard.Height) then!@#&			Drawing.DrawCharacters(self.X+1, self.Y+8, \"Clipping will occur!\", colours.red, colours.white)!@#&		end!@#&!@#&		local widthLabelColour = colours.black!@#&		if self.WidthLabelHighlight then!@#&			widthLabelColour = colours.red!@#&		end!@#&		!@#&		local heightLabelColour = colours.black!@#&		if self.HeightLabelHighlight then!@#&			heightLabelColour = colours.red!@#&		end!@#&!@#&		Drawing.DrawCharacters(self.X+1, self.Y+4, \"Width\", widthLabelColour, colours.white)!@#&		Drawing.DrawCharacters(self.X+1, self.Y+6, \"Height\", heightLabelColour, colours.white)!@#&!@#&		Drawing.DrawCharacters(self.X+14, self.Y+2, \"Anchor\", colours.lightGrey, colours.white)!@#&!@#&		self.WidthTextBox:Draw()!@#&		self.HeightTextBox:Draw()!@#&		self.OkButton:Draw()!@#&		self.Anchor1:Draw()!@#&		self.Anchor2:Draw()!@#&		self.Anchor3:Draw()!@#&		self.Anchor4:Draw()!@#&		self.Anchor5:Draw()!@#&		self.Anchor6:Draw()!@#&		self.Anchor7:Draw()!@#&		self.Anchor8:Draw()!@#&		self.Anchor9:Draw()!@#&	end,	!@#&!@#&	Initialise = function(self, returnFunc)!@#&		local new = {}    -- the new instance!@#&		setmetatable( new, {__index = self} )!@#&		new.Width = 27!@#&		new.Height = 10!@#&		new.Return = returnFunc!@#&		new.X = math.ceil((Drawing.Screen.Width - new.Width) / 2)!@#&		new.Y = math.ceil((Drawing.Screen.Height - new.Height) / 2)!@#&		new.Title = 'Resize Document'!@#&		new.Visible = true!@#&!@#&		new.WidthTextBox = TextBox:Initialise(9, 5, 4, 1, new, tostring(Current.Artboard.Width), nil, nil, function()!@#&			new:UpdateAnchorButtons()!@#&		end, true)!@#&		new.HeightTextBox = TextBox:Initialise(9, 7, 4, 1, new, tostring(Current.Artboard.Height), nil, nil, function()!@#&			new:UpdateAnchorButtons()!@#&		end, true)!@#&		new.OkButton = Button:Initialise(new.Width - 4, new.Height - 1, nil, nil, colours.lightGrey, new, function(self, side, x, y, toggle)!@#&			local ok = true!@#&			new.WidthLabelHighlight = false!@#&			new.HeightLabelHighlight = false!@#&!@#&			if #new.WidthTextBox.TextInput.Value == 0 or tonumber(new.WidthTextBox.TextInput.Value) <= 0 then!@#&				ok = false!@#&				new.WidthLabelHighlight = true!@#&			end!@#&!@#&			if #new.HeightTextBox.TextInput.Value == 0 or tonumber(new.HeightTextBox.TextInput.Value) <= 0 then!@#&				ok = false!@#&				new.HeightLabelHighlight = true!@#&			end!@#&!@#&			if ok then!@#&				returnFunc(new, tonumber(new.WidthTextBox.TextInput.Value), tonumber(new.HeightTextBox.TextInput.Value), new.AnchorPosition)!@#&			else!@#&				Draw()!@#&			end!@#&		end, 'Ok', colours.black)!@#&!@#&		local anchorX = 15!@#&		local anchorY = 5!@#&		new.Anchor1 = Button:Initialise(anchorX, anchorY, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 1 new:UpdateAnchorButtons() end, ' ', colours.black)!@#&		new.Anchor2 = Button:Initialise(anchorX+1, anchorY, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 2 new:UpdateAnchorButtons() end, '^', colours.black)!@#&		new.Anchor3 = Button:Initialise(anchorX+2, anchorY, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 3 new:UpdateAnchorButtons() end, ' ', colours.black)!@#&		new.Anchor4 = Button:Initialise(anchorX, anchorY+1, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 4 new:UpdateAnchorButtons() end, '<', colours.black)!@#&		new.Anchor5 = Button:Initialise(anchorX+1, anchorY+1, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 5 new:UpdateAnchorButtons() end, '#', colours.black)!@#&		new.Anchor6 = Button:Initialise(anchorX+2, anchorY+1, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 6 new:UpdateAnchorButtons() end, '>', colours.black)!@#&		new.Anchor7 = Button:Initialise(anchorX, anchorY+2, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 7 new:UpdateAnchorButtons() end, ' ', colours.black)!@#&		new.Anchor8 = Button:Initialise(anchorX+1, anchorY+2, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 8 new:UpdateAnchorButtons() end, 'v', colours.black)!@#&		new.Anchor9 = Button:Initialise(anchorX+2, anchorY+2, 1, 1, colours.lightGrey, new, function(self, side, x, y, toggle)new.AnchorPosition = 9 new:UpdateAnchorButtons() end, ' ', colours.black)!@#&!@#&		return new!@#&	end,!@#&!@#&	UpdateAnchorButtons = function(self)!@#&		local anchor1 = ' '!@#&		local anchor2 = ' '!@#&		local anchor3 = ' '!@#&		local anchor4 = ' '!@#&		local anchor5 = ' '!@#&		local anchor6 = ' '!@#&		local anchor7 = ' '!@#&		local anchor8 = ' '!@#&		local anchor9 = ' '!@#&		self.AnchorPosition = self.AnchorPosition or 5!@#&		if self.AnchorPosition == 1 then!@#&			anchor1 = '#'!@#&			anchor2 = '>'!@#&			anchor4 = 'v'!@#&		elseif self.AnchorPosition == 2 then!@#&			anchor1 = '<'!@#&			anchor2 = '#'!@#&			anchor3 = '>'!@#&			anchor5 = 'v'!@#&		elseif self.AnchorPosition == 3 then!@#&			anchor2 = '<'!@#&			anchor3 = '#'!@#&			anchor6 = 'v'!@#&		elseif self.AnchorPosition == 4 then!@#&			anchor1 = '^'!@#&			anchor4 = '#'!@#&			anchor5 = '>'!@#&			anchor7 = 'v'!@#&		elseif self.AnchorPosition == 5 then!@#&			anchor2 = '^'!@#&			anchor4 = '<'!@#&			anchor5 = '#'!@#&			anchor6 = '>'!@#&			anchor8 = 'v'!@#&		elseif self.AnchorPosition == 6 then!@#&			anchor3 = '^'!@#&			anchor6 = '#'!@#&			anchor5 = '<'!@#&			anchor9 = 'v'!@#&		elseif self.AnchorPosition == 7 then!@#&			anchor4 = '^'!@#&			anchor7 = '#'!@#&			anchor8 = '>'!@#&		elseif self.AnchorPosition == 8 then!@#&			anchor5 = '^'!@#&			anchor8 = '#'!@#&			anchor7 = '<'!@#&			anchor9 = '>'!@#&		elseif self.AnchorPosition == 9 then!@#&			anchor6 = '^'!@#&			anchor9 = '#'!@#&			anchor8 = '<'!@#&		end!@#&!@#&		if #self.HeightTextBox.TextInput.Value > 0 and Current.Artboard.Height > tonumber(self.HeightTextBox.TextInput.Value) then!@#&			local r = function(str)!@#&				if string.find(str, \"%^\") then!@#&					str = str:gsub('%^','v')!@#&				elseif string.find(str, \"v\") then!@#&					str = str:gsub('v','%^')!@#&				end!@#&				return str!@#&			end!@#&			anchor1 = r(anchor1)!@#&			anchor2 = r(anchor2)!@#&			anchor3 = r(anchor3)!@#&			anchor4 = r(anchor4)!@#&			anchor5 = r(anchor5)!@#&			anchor6 = r(anchor6)!@#&			anchor7 = r(anchor7)!@#&			anchor8 = r(anchor8)!@#&			anchor9 = r(anchor9)!@#&		end!@#&!@#&		if #self.WidthTextBox.TextInput.Value > 0 and Current.Artboard.Width > tonumber(self.WidthTextBox.TextInput.Value) then!@#&			local r = function(str)!@#&				if string.find(str, \">\") then!@#&					str = str:gsub('>','<')!@#&				elseif string.find(str, \"<\") then!@#&					str = str:gsub('<','>')!@#&				end!@#&				return str!@#&			end!@#&			anchor1 = r(anchor1)!@#&			anchor2 = r(anchor2)!@#&			anchor3 = r(anchor3)!@#&			anchor4 = r(anchor4)!@#&			anchor5 = r(anchor5)!@#&			anchor6 = r(anchor6)!@#&			anchor7 = r(anchor7)!@#&			anchor8 = r(anchor8)!@#&			anchor9 = r(anchor9)!@#&		end!@#&!@#&		self.Anchor1.Text = anchor1!@#&		self.Anchor2.Text = anchor2!@#&		self.Anchor3.Text = anchor3!@#&		self.Anchor4.Text = anchor4!@#&		self.Anchor5.Text = anchor5!@#&		self.Anchor6.Text = anchor6!@#&		self.Anchor7.Text = anchor7!@#&		self.Anchor8.Text = anchor8!@#&		self.Anchor9.Text = anchor9!@#&	end,!@#&!@#&	Show = function(self)!@#&		Current.Window = self!@#&		return self!@#&	end,!@#&!@#&	Close = function(self)!@#&		Current.Input = nil!@#&		Current.Window = nil!@#&		self = nil!@#&	end,!@#&!@#&	Flash = function(self)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = false!@#&		Draw()!@#&		sleep(0.15)!@#&		self.Visible = true!@#&		Draw()!@#&	end,!@#&!@#&	ButtonClick = function(self, button, x, y)!@#&		if button.X <= x and button.Y <= y and button.X + button.Width > x and button.Y + button.Height > y then!@#&			button:Click()!@#&		end!@#&	end,!@#&!@#&	Click = function(self, side, x, y)!@#&		local items = {self.OkButton, self.WidthTextBox, self.HeightTextBox, self.Anchor1, self.Anchor2, self.Anchor3, self.Anchor4, self.Anchor5, self.Anchor6, self.Anchor7, self.Anchor8, self.Anchor9}!@#&		for i, v in ipairs(items) do!@#&			if CheckClick(v, x, y) then!@#&				v:Click(side, x, y)!@#&			end!@#&		end!@#&		return true!@#&	end!@#&}!@#&!@#&----------------------!@#&!@#&function CheckOpenArtboard()!@#&	if Current.Artboard then!@#&		return true!@#&	else!@#&		return false!@#&	end!@#&end!@#&!@#&function CheckSelectedLayer()!@#&	if Current.Artboard and Current.Layer then!@#&		return true!@#&	else!@#&		return false!@#&	end!@#&end!@#&!@#&function DisplayNewDocumentWindow()!@#&	NewDocumentWindow:Initialise(function(self, success, path, width, height, format, backgroundColour)!@#&		if success then!@#&			if path:sub(-4) ~= format then!@#&				path = path .. format!@#&			end!@#&			local oldWindow = self!@#&			Current.Input = nil!@#&			Current.Window = nil!@#&			makeDocument = function()oldWindow:Close()NewDocument(path, width, height, format, backgroundColour)end!@#&			local _fs = fs!@#&			if OneOS then!@#&				_fs = OneOS.FS!@#&			end!@#&			if _fs.exists(path) then!@#&				ButtonDialougeWindow:Initialise('File Exists', path..' already exists! Use a different name and try again.', 'Ok', nil, function(window, ok)!@#&					window:Close()!@#&					oldWindow:Show()!@#&				end):Show()!@#&			elseif format == '.nfp' then!@#&				Current.Window = nil!@#&				ButtonDialougeWindow:Initialise('Use NFP?', 'The NFT format does not support text or layers, if you use it you will only be able to use 1 layer and not have any text.', 'Use NFP', 'Cancel', function(window, ok)!@#&					window:Close()!@#&					if ok then!@#&						makeDocument()!@#&					else!@#&						oldWindow:Show()!@#&					end!@#&				end):Show()!@#&			elseif format == '.nft' then!@#&				ButtonDialougeWindow:Initialise('Use NFT?', 'The NFT format does not support layers, if you use it you will only be able to use 1 layer.', 'Use NFT', 'Cancel', function(window, ok)!@#&					window:Close()!@#&					if ok then!@#&						makeDocument()!@#&					else!@#&						oldWindow:Show()!@#&					end!@#&				end):Show()!@#&			else!@#&				makeDocument()!@#&			end!@#&!@#&			!@#&		else!@#&			self:Close()!@#&		end!@#&	end):Show()!@#&end!@#&!@#&function NewDocument(path, width, height, format, backgroundColour)!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	ab = Artboard:New(_fs.getName(path), path, width, height, format, backgroundColour)!@#&	Current.Tool = Tools[2]!@#&	Current.Toolbar:Update()!@#&	Current.Modified = false!@#&	Draw()!@#&end!@#&!@#&function DisplayToolSizeWindow()!@#&	if not CheckOpenArtboard() then!@#&		return!@#&	end	!@#&	TextDialougeWindow:Initialise('Change Tool Size', 'Enter the new tool size you\\'d like to use.', 'Ok', 'Cancel', function(window, success, value)!@#&		if success then!@#&			Current.ToolSize = math.ceil(tonumber(value))!@#&			if Current.ToolSize < 1 then!@#&				Current.ToolSize = 1!@#&			elseif Current.ToolSize > 50 then!@#&				Current.ToolSize = 50!@#&			end!@#&			ModuleNamed('Tools'):Update()!@#&		end!@#&		window:Close()!@#&	end, true):Show()	!@#&end!@#&!@#&--[[!@#&	Attempt to figure out what format the image is if it doesn't have an extension!@#&]]--!@#&function GetFormat(path)!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	local file = _fs.open(path, 'r')!@#&	local content = file.readAll()!@#&	file.close()!@#&	if type(textutils.unserialize(content)) == 'table' then!@#&		-- It's a serlized table, asume sketch!@#&		return '.skch'!@#&	elseif string.find(content, string.char(30)) or string.find(content, string.char(31)) then!@#&		-- Contains the characters that set colours, asume nft!@#&		return '.nft'!@#&	else!@#&		-- Otherwise asume nfp!@#&		return '.nfp'!@#&	end!@#&end!@#&!@#&function DisplayOpenDocumentWindow()!@#&	OpenDocumentWindow:Initialise(function(self, success, path)!@#&		self:Close()!@#&		if success then!@#&			OpenDocument(path)!@#&		end!@#&	end):Show()!@#&end!@#&!@#&!@#&local function Extension(path, addDot)!@#&	if not path then!@#&		return nil!@#&	elseif not string.find(fs.getName(path), '%.') then!@#&		if not addDot then!@#&			return fs.getName(path)!@#&		else!@#&			return ''!@#&		end!@#&	else!@#&		local _path = path!@#&		if path:sub(#path) == '/' then!@#&			_path = path:sub(1,#path-1)!@#&		end!@#&		local extension = _path:gmatch('\\.[0-9a-z]+$')()!@#&		if extension then!@#&			extension = extension:sub(2)!@#&		else!@#&			--extension = nil!@#&			return ''!@#&		end!@#&		if addDot then!@#&			extension = '.'..extension!@#&		end!@#&		return extension:lower()!@#&	end!@#&end!@#&!@#&local RemoveExtension = function(path)!@#&	if path:sub(1,1) == '.' then!@#&		return path!@#&	end!@#&	local extension = Extension(path)!@#&	if extension == path then!@#&		return fs.getName(path)!@#&	end!@#&	return string.gsub(path, extension, ''):sub(1, -2)!@#&end!@#&--[[!@#&	Open a documet at a given path!@#&]]--!@#&function OpenDocument(path)!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	if _fs.exists(path) and not _fs.isDir(path) then!@#&		local format = Extension(path, true)!@#&		if (not format or format == '') and (format ~= '.nfp' and format ~= '.nft' and format ~= '.skch') then!@#&			format = GetFormat(path)!@#&		end!@#&		local layers = {}!@#&		if format == '.nfp' then!@#&			layers = ReadNFP(path)!@#&		elseif format == '.nft' then!@#&			layers = ReadNFT(path)		!@#&		elseif format == '.skch' then!@#&			layers = ReadSKCH(path)!@#&		end!@#&!@#&		for i, layer in ipairs(layers) do!@#&			if layer.Visible == nil then!@#&				layer.Visible = true!@#&			end!@#&			if layer.Index == nil then!@#&				layer.Index = 1!@#&			end!@#&			if layer.Name == nil then!@#&				if layer.Index == 1 then!@#&					layer.Name = 'Background'!@#&				else!@#&					layer.Name = 'Layer'!@#&				end!@#&			end!@#&			if layer.BackgroundColour == nil then!@#&				layer.BackgroundColour = colours.white!@#&			end!@#&		end!@#&!@#&		if not layers[1] then!@#&			--log('File could not be read.')!@#&			return!@#&		end!@#&!@#&		local width = #layers[1].Pixels!@#&		local height = #layers[1].Pixels[1]!@#&!@#&		Current.Artboard = nil!@#&		local _fs = fs!@#&		if OneOS then!@#&			_fs = OneOS.FS!@#&		end!@#&		ab = Artboard:New(_fs.getName('Image'), path, width, height, format, nil, layers)!@#&		Current.Tool = Tools[2]!@#&		Current.Toolbar:Update()!@#&		Current.Modified = false!@#&		Draw()!@#&	end!@#&end!@#&!@#&function MakeNewLayer()!@#&	if not CheckOpenArtboard() then!@#&		return!@#&	end!@#&	if Current.Artboard.Format == '.skch' then!@#&		TextDialougeWindow:Initialise('New Layer Name', 'Enter the name you want for the next layer.', 'Ok', 'Cancel', function(window, success, value)!@#&			if success then!@#&				Current.Artboard:MakeLayer(value, colours.transparent)!@#&			end!@#&			window:Close()!@#&		end):Show()	!@#&	else!@#&		local format = 'NFP'!@#&		if Current.Artboard.Format == '.nft' then!@#&			format = 'NFT'!@#&		end!@#&		ButtonDialougeWindow:Initialise(format..' does not support layers!', 'The format you are using, '..format..', does not support multiple layers. Use SKCH to have more than one layer.', 'Ok', nil, function(window)!@#&			window:Close()!@#&		end):Show()!@#&	end!@#&end!@#&!@#&function ResizeDocument()!@#&	if not CheckOpenArtboard() then!@#&		return!@#&	end!@#&	ResizeDocumentWindow:Initialise(function(window, width, height, anchor)!@#&		window:Close()!@#&		local topResize = 0!@#&		local rightResize = 0!@#&		local bottomResize = 0!@#&		local leftResize = 0!@#&!@#&		if anchor == 1 then!@#&			rightResize = 1!@#&			bottomResize = 1!@#&		elseif anchor == 2 then!@#&			rightResize = 0.5!@#&			leftResize = 0.5!@#&			bottomResize = 1!@#&		elseif anchor == 3 then!@#&			leftResize = 1!@#&			bottomResize = 1!@#&		elseif anchor == 4 then!@#&			rightResize = 1!@#&			bottomResize = 0.5!@#&			topResize = 0.5!@#&		elseif anchor == 5 then!@#&			rightResize = 0.5!@#&			leftResize = 0.5!@#&			bottomResize = 0.5!@#&			topResize = 0.5!@#&		elseif anchor == 6 then!@#&			leftResize = 1!@#&			bottomResize = 0.5!@#&			topResize = 0.5!@#&		elseif anchor == 7 then!@#&			rightResize = 1!@#&			topResize = 1!@#&		elseif anchor == 8 then!@#&			rightResize = 0.5!@#&			leftResize = 0.5!@#&			topResize = 1!@#&		elseif anchor == 9 then!@#&			leftResize = 1!@#&			topResize = 1!@#&		end!@#&!@#&		topResize = topResize * (height - Current.Artboard.Height)!@#&		if topResize > 0 then!@#&			topResize = math.floor(topResize)!@#&		else!@#&			topResize = math.ceil(topResize)!@#&		end!@#&!@#&		bottomResize = bottomResize * (height - Current.Artboard.Height)!@#&		if bottomResize > 0 then!@#&			bottomResize = math.ceil(bottomResize)!@#&		else!@#&			bottomResize = math.floor(bottomResize)!@#&		end!@#&!@#&		leftResize = leftResize * (width - Current.Artboard.Width)!@#&		if leftResize > 0 then!@#&			leftResize = math.floor(leftResize)!@#&		else!@#&			leftResize = math.ceil(leftResize)!@#&		end!@#&!@#&		rightResize = rightResize * (width - Current.Artboard.Width)!@#&		if rightResize > 0 then!@#&			rightResize = math.ceil(rightResize)!@#&		else!@#&			rightResize = math.floor(rightResize)!@#&		end!@#&!@#&		Current.Artboard:Resize(topResize, bottomResize, leftResize, rightResize)!@#&	end):Show()!@#&end!@#&!@#&function RenameLayer()!@#&	if not CheckOpenArtboard() then!@#&		return!@#&	end!@#&	if Current.Artboard.Format == '.skch' then!@#&		TextDialougeWindow:Initialise(\"Rename Layer '\"..Current.Layer.Name..\"'\", 'Enter the new name you want the layer to be called.', 'Ok', 'Cancel', function(window, success, value)!@#&			if success then!@#&				Current.Layer.Name = value!@#&			end!@#&			window:Close()!@#&		end):Show()	!@#&	else!@#&		local format = 'NFP'!@#&		if Current.Artboard.Format == '.nft' then!@#&			format = 'NFT'!@#&		end!@#&		ButtonDialougeWindow:Initialise(format..' does not support layers!', 'The format you are using, '..format..', does not support renaming layers. Use SKCH to rename layers.', 'Ok', nil, function(window)!@#&			window:Close()!@#&		end):Show()!@#&	end!@#&end!@#&!@#&function DeleteLayer()!@#&	if not CheckOpenArtboard() then!@#&		return!@#&	end!@#&	if Current.Artboard.Format == '.skch' then!@#&		if #Current.Artboard.Layers > 1 then!@#&			ButtonDialougeWindow:Initialise(\"Delete Layer '\"..Current.Layer.Name..\"'?\", 'Are you sure you want delete the layer?', 'Ok', 'Cancel', function(window, success)!@#&				if success then!@#&					Current.Layer:Remove()!@#&				end!@#&				window:Close()!@#&			end):Show()!@#&		else!@#&			ButtonDialougeWindow:Initialise('Can not delete layer!', 'You can not delete the last layer of an image! Make another layer to delete this one.', 'Ok', nil, function(window)!@#&				window:Close()!@#&			end):Show()!@#&		end!@#&	else!@#&		local format = 'NFP'!@#&		if Current.Artboard.Format == '.nft' then!@#&			format = 'NFT'!@#&		end!@#&		ButtonDialougeWindow:Initialise(format..' does not support layers!', 'The format you are using, '..format..', does not support deleting layers. Use SKCH to deleting layers.', 'Ok', nil, function(window)!@#&			window:Close()!@#&		end):Show()!@#&	end!@#&end!@#&!@#&needsDraw = false!@#&isDrawing = false!@#&function Draw()!@#&	if isDrawing then!@#&		needsDraw = true!@#&		return!@#&	end!@#&	needsDraw = false!@#&	isDrawing = true!@#&	if not Current.Window then!@#&		Drawing.Clear(UIColours.Background)!@#&	else!@#&		Drawing.DrawArea(1, 2, Drawing.Screen.Width, Drawing.Screen.Height, '|', colours.black, colours.lightGrey)!@#&	end!@#&!@#&	if Current.Artboard then!@#&		ab:Draw()!@#&	end!@#&!@#&	if Current.InterfaceVisible then!@#&		Current.MenuBar:Draw()!@#&		Current.Toolbar.Width = Current.Toolbar.ExpandedWidth!@#&		Current.Toolbar:Draw()!@#&	else!@#&		Current.Toolbar.Width = Current.Toolbar.ExpandedWidth!@#&	end!@#&!@#&	if Current.InterfaceVisible and Current.Menu then!@#&		Current.Menu:Draw()!@#&	end!@#&!@#&	if Current.Window then!@#&		Current.Window:Draw()!@#&	end!@#&!@#&	if not Current.InterfaceVisible then!@#&		ShowInterfaceButton:Draw()!@#&	end!@#&!@#&	Drawing.DrawBuffer()!@#&	if Current.Input and not Current.Menu then!@#&		term.setCursorPos(Current.CursorPos[1], Current.CursorPos[2])!@#&		term.setCursorBlink(true)!@#&		term.setTextColour(Current.CursorColour)!@#&	else!@#&		term.setCursorBlink(false)!@#&	end!@#&!@#&	if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&		Current.SelectionDrawTimer = os.startTimer(0.5)!@#&	end!@#&	isDrawing = false!@#&	if needsDraw then!@#&		Draw()!@#&	end!@#&end!@#&!@#&function LoadMenuBar()!@#&	Current.MenuBar = MenuBar:Initialise({!@#&		Button:Initialise(1, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if toggle then!@#&				Menu:New(1, 2, {!@#&					{!@#&						Title = \"New...\",!@#&						Click = function()!@#&							DisplayNewDocumentWindow()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.n!@#&						}!@#&					},!@#&					{!@#&						Title = 'Open...',!@#&						Click = function()!@#&							DisplayOpenDocumentWindow()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.o!@#&						}!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Save...',!@#&						Click = function()!@#&							Current.Artboard:Save()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.s!@#&						},!@#&						Enabled = function()!@#&							return CheckOpenArtboard()!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Quit',!@#&						Click = function()!@#&							if Close() then!@#&								OneOS.Close()!@#&							end!@#&						end!@#&					},!@#&			--[[!@#&					{!@#&						Title = 'Save As...',!@#&						Click = function()!@#&!@#&						end!@#&					}	!@#&			]]--!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'File', colours.lightGrey, false),!@#&		Button:Initialise(7, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if not self.Toggle then!@#&				Menu:New(7, 2, {!@#&			--[[!@#&					{!@#&						Title = \"Undo\",!@#&						Click = function()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.z!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Title = 'Redo',!@#&						Click = function()!@#&							!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.y!@#&						},!@#&						Enabled = function()!@#&							return false!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&			]]--!@#&					{!@#&						Title = 'Cut',!@#&						Click = function()!@#&							Clipboard.Cut(Current.Layer:PixelsInSelection(true), 'sketchpixels')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.x!@#&						},!@#&						Enabled = function()!@#&							return Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Copy',!@#&						Click = function()!@#&							Clipboard.Copy(Current.Layer:PixelsInSelection(), 'sketchpixels')!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.c!@#&						},!@#&						Enabled = function()!@#&							return Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil!@#&						end!@#&					},!@#&					{!@#&						Title = 'Paste',!@#&						Click = function()!@#&							Current.Layer:InsertPixels(Clipboard.Paste())!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.v!@#&						},!@#&						Enabled = function()!@#&							return (not Clipboard.isEmpty()) and Clipboard.Type == 'sketchpixels'!@#&						end!@#&					}!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Edit', colours.lightGrey, false),!@#&		Button:Initialise(13, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if toggle then!@#&				Menu:New(13, 2, {!@#&					{!@#&						Title = \"Resize...\",!@#&						Click = function()!@#&							ResizeDocument()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.r!@#&						},!@#&						Enabled = function()!@#&							return CheckOpenArtboard()!@#&						end!@#&					},!@#&					{!@#&						Title = \"Crop\",!@#&						Click = function()!@#&							local top = 0!@#&							local left = 0!@#&							local bottom = 0!@#&							local right = 0!@#&							if Current.Selection[1].x < Current.Selection[2].x then!@#&								left = Current.Selection[1].x - 1!@#&								right = Current.Artboard.Width - Current.Selection[2].x!@#&							else!@#&								left = Current.Selection[2].x - 1!@#&								right = Current.Artboard.Width - Current.Selection[1].x!@#&							end!@#&							if Current.Selection[1].y < Current.Selection[2].y then!@#&								top = Current.Selection[1].y - 1!@#&								bottom = Current.Artboard.Height - Current.Selection[2].y!@#&							else!@#&								top = Current.Selection[2].y - 1!@#&								bottom = Current.Artboard.Height - Current.Selection[1].y!@#&							end!@#&							Current.Artboard:Resize(-1*top, -1*bottom, -1*left, -1*right)!@#&!@#&							Current.Selection[2] = nil!@#&						end,!@#&						Enabled = function()!@#&							if CheckSelectedLayer() and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&								return true!@#&							else!@#&								return false!@#&							end!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'New Layer...',!@#&						Click = function()!@#&							MakeNewLayer()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.l!@#&						},!@#&						Enabled = function()!@#&							return CheckOpenArtboard()!@#&						end!@#&					},!@#&					{!@#&						Title = 'Delete Layer',!@#&						Click = function()!@#&							DeleteLayer()!@#&						end,!@#&						Enabled = function()!@#&							return CheckSelectedLayer()!@#&						end!@#&					},!@#&					{!@#&						Title = 'Rename Layer...',!@#&						Click = function()!@#&							RenameLayer()!@#&						end,!@#&						Enabled = function()!@#&							return CheckSelectedLayer()!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Erase Selection',!@#&						Click = function()!@#&							Current.Layer:EraseSelection()!@#&						end,!@#&						Keys = {!@#&							keys.delete!@#&						},!@#&						Enabled = function()!@#&							if CheckSelectedLayer() and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then!@#&								return true!@#&							else!@#&								return false!@#&							end!@#&						end!@#&					},!@#&					{!@#&						Separator = true!@#&					},!@#&					{!@#&						Title = 'Hide Interface',!@#&						Click = function()!@#&							Current.InterfaceVisible = not Current.InterfaceVisible!@#&						end,!@#&						Keys = {!@#&							keys.tab!@#&						}!@#&					}!@#&				}, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Image', colours.lightGrey, false),!@#&		!@#&		Button:Initialise(20, 1, nil, nil, colours.grey, Current.MenuBar, function(self, side, x, y, toggle)!@#&			if toggle then!@#&				local menuItems = {{!@#&						Title = \"Change Size\",!@#&						Click = function()!@#&							DisplayToolSizeWindow()!@#&						end,!@#&						Keys = {!@#&							keys.leftCtrl,!@#&							keys.t!@#&						}!@#&					},!@#&					{!@#&						Separator = true!@#&					}!@#&				}!@#&				!@#&				local _keys = {'h','p','e','f','s','m','t'}!@#&				for i, tool in ipairs(Tools) do!@#&					table.insert(menuItems, {!@#&						Title = tool.Name,!@#&						Click = function()!@#&							SetTool(tool)!@#&							local m = ModuleNamed('Tools')!@#&							m:Update(m.ToolbarItem)!@#&						end,!@#&						Keys = {!@#&							keys[_keys[i]]!@#&						},!@#&						Enabled = function()!@#&							return CheckOpenArtboard()!@#&						end!@#&					})!@#&				end!@#&!@#&				Menu:New(20, 2, menuItems, self, true)!@#&			else!@#&				Current.Menu = nil!@#&			end!@#&			return true !@#&		end, 'Tools', colours.lightGrey, false),!@#&	})!@#&end!@#&!@#&function Timer(event, timer)!@#&	if timer == Current.ControlPressedTimer then!@#&		Current.ControlPressedTimer = nil!@#&	elseif timer == Current.SelectionDrawTimer then!@#&		if Current.Artboard then!@#&			Current.Artboard.SelectionIsBlack = not Current.Artboard.SelectionIsBlack!@#&			Draw()!@#&		end!@#&	end!@#&end!@#&!@#&function Initialise(arg)!@#&	if not OneOS then!@#&		SplashScreen()!@#&	end!@#&	EventRegister('mouse_click', TryClick)!@#&	EventRegister('mouse_drag', function(event, side, x, y)TryClick(event, side, x, y, true)end)!@#&	EventRegister('mouse_scroll', Scroll)!@#&	EventRegister('key', HandleKey)!@#&	EventRegister('char', HandleKey)!@#&	EventRegister('timer', Timer)!@#&	EventRegister('terminate', function(event) if Close() then error( \"Terminated\", 0 ) end end)!@#&!@#&!@#&	Current.Toolbar = Toolbar:New('right', true)!@#&!@#&	for k, v in pairs(Modules) do!@#&		v:Initialise()!@#&	end!@#&	!@#&	--term.setBackgroundColour(UIColours.Background)!@#&	--term.clear()!@#&!@#&	LoadMenuBar()!@#&!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	if arg and _fs.exists(arg) then!@#&		OpenDocument(arg)!@#&	else!@#&		DisplayNewDocumentWindow()!@#&		Current.Window.Visible = false!@#&	end!@#&!@#&	ShowInterfaceButton = Button:Initialise(Drawing.Screen.Width - 15, 1, nil, 1, colours.grey, nil, function(self)!@#&		Current.InterfaceVisible = true!@#&		Draw()!@#&	end, 'Show Interface')!@#&!@#&	Draw()!@#&	if Current.Window then!@#&		Current.Window.Visible = true!@#&		Draw()!@#&	end!@#&!@#&	EventHandler()!@#&end!@#&!@#&function SplashScreen()!@#&	local splashIcon = {{1,1,1,256,256,256,256,256,256,256,256,1,1,1,},{1,256,256,8,8,8,8,8,8,8,8,256,256,1,},{256,8,8,8,8,8,8,8,8,8,8,8,8,256,},{256,256,256,8,8,8,8,8,8,8,8,256,256,256,},{256,256,256,256,256,256,256,256,256,256,256,256,256,256,},{2048,2048,256,256,256,256,256,256,256,256,256,256,2048,2048,},{2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,},{2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,},{2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,},{2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,},{256,256,2048,2048,2048,2048,2048,2048,2048,2048,2048,2048,256,256,},{1,256,256,256,256,256,256,256,256,256,256,256,256,1,},{1,1,1,256,256,256,256,256,256,256,256,1,1,1,},[\"text\"]={{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\"S\",\"k\",\"e\",\"t\",\"c\",\"h\",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\"M\",\"a\",\"3\",\"r\",\"X\",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},{\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",\" \",},},[\"textcol\"]={{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,256,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,1,1,1,1,1,1,32768,32768,32768,32768,},{32768,32768,32768,32768,8,8,8,8,8,8,8,32768,32768,32768,},{32768,32768,32768,32768,1,1,1,1,1,32768,8,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},{32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,32768,},},}!@#&	Drawing.Clear(colours.white)!@#&	Drawing.DrawImage((Drawing.Screen.Width - 14)/2, (Drawing.Screen.Height - 13)/2, splashIcon, 14, 13)!@#&	Drawing.DrawBuffer()!@#&	parallel.waitForAny(function()sleep(1)end, function()os.pullEvent('mouse_click')end)!@#&end!@#&!@#&LongestString = function(input, key)!@#&	local length = 0!@#&	for i = 1, #input do!@#&		local value = input[i]!@#&		if key then!@#&			if value[key] then!@#&				value = value[key]!@#&			else!@#&				value = ''!@#&			end!@#&		end!@#&		local titleLength = string.len(value)!@#&		if titleLength > length then!@#&			length = titleLength!@#&		end!@#&	end!@#&	return length!@#&end!@#&!@#&function HandleKey(...)!@#&	local args = {...}!@#&	local event = args[1]!@#&	local keychar = args[2]!@#&	if event == 'key' and Current.Tool and Current.Tool.Name == 'Text' and Current.Input and (keychar == keys.up or keychar == keys.down or keychar == keys.left or keychar == keys.right) then!@#&		local currentPos = {Current.CursorPos[1] - Current.Artboard.X + 1, Current.CursorPos[2] - Current.Artboard.Y + 1}!@#&		if keychar == keys.up then!@#&			currentPos[2] = currentPos[2] - 1!@#&		elseif keychar == keys.down then!@#&			currentPos[2] = currentPos[2] + 1!@#&		elseif keychar == keys.left then!@#&			currentPos[1] = currentPos[1] - 1!@#&		elseif keychar == keys.right then!@#&			currentPos[1] = currentPos[1] + 1!@#&		end!@#&!@#&		if currentPos[1] < 1 then!@#&			currentPos[1] = 1!@#&		end!@#&!@#&		if currentPos[1] > Current.Artboard.Width then!@#&			currentPos[1] = Current.Artboard.Width!@#&		end!@#&!@#&		if currentPos[2] < 1 then!@#&			currentPos[2] = 1!@#&		end!@#&!@#&		if currentPos[2] > Current.Artboard.Height then!@#&			currentPos[2] = Current.Artboard.Height!@#&		end!@#&!@#&		Current.Tool:Use(currentPos[1], currentPos[2])!@#&		Current.Modified = true!@#&		Draw()!@#&	elseif Current.Input then!@#&		if event == 'char' then!@#&			Current.Input:Char(keychar)!@#&		elseif event == 'key' then!@#&			Current.Input:Key(keychar)!@#&		end!@#&	elseif event == 'key' then!@#&		CheckKeyboardShortcut(keychar)!@#&	end!@#&end!@#&!@#&function Scroll(event, direction, x, y)!@#&	if Current.Window and Current.Window.OpenButton then!@#&		Current.Window.Scroll = Current.Window.Scroll + direction!@#&		if Current.Window.Scroll < 0 then!@#&			Current.Window.Scroll = 0!@#&		elseif Current.Window.Scroll > Current.Window.MaxScroll then!@#&			Current.Window.Scroll = Current.Window.MaxScroll!@#&		end!@#&	end!@#&	Draw()!@#&end!@#&!@#&function CheckKeyboardShortcut(key)!@#&	local shortcuts = {}!@#&!@#&	if key == keys.leftCtrl then!@#&		Current.ControlPressedTimer = os.startTimer(0.5)!@#&		return!@#&	end!@#&	if Current.ControlPressedTimer then!@#&		shortcuts[keys.n] = function() DisplayNewDocumentWindow() end!@#&		shortcuts[keys.o] = function() DisplayOpenDocumentWindow() end!@#&		shortcuts[keys.s] = function() Current.Artboard:Save() end!@#&		shortcuts[keys.x] = function() if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then Clipboard.Cut(Current.Layer:PixelsInSelection(true), 'sketchpixels') end end!@#&		shortcuts[keys.c] = function() if Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then Clipboard.Copy(Current.Layer:PixelsInSelection(), 'sketchpixels') end end!@#&		shortcuts[keys.v] = function() if (not Clipboard.isEmpty()) and Clipboard.Type == 'sketchpixels' then Current.Layer:InsertPixels(Clipboard.Paste()) end end!@#&		shortcuts[keys.r] = function() ResizeDocument() end!@#&		shortcuts[keys.l] = function() MakeNewLayer() end!@#&	end!@#&!@#&	shortcuts[keys.delete] = function() if CheckSelectedLayer() and Current.Selection and Current.Selection[1] and Current.Selection[2] ~= nil then Current.Layer:EraseSelection() Draw() end end!@#&	shortcuts[keys.backspace] = shortcuts[keys.delete]!@#&	shortcuts[keys.tab] = function() Current.InterfaceVisible = not Current.InterfaceVisible Draw() end!@#&!@#&	shortcuts[keys.h] = function() SetTool(ToolNamed('Hand')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.e] = function() SetTool(ToolNamed('Eraser')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.p] = function() SetTool(ToolNamed('Pencil')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.f] = function() SetTool(ToolNamed('Fill Bucket')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.m] = function() SetTool(ToolNamed('Move')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.s] = function() SetTool(ToolNamed('Select')) ModuleNamed('Tools'):Update() Draw() end!@#&	shortcuts[keys.t] = function() SetTool(ToolNamed('Text')) ModuleNamed('Tools'):Update() Draw() end!@#&!@#&	if shortcuts[key] then!@#&		shortcuts[key]()!@#&		return true!@#&	else!@#&		return false!@#&	end!@#&end!@#&!@#&--[[!@#&	Check if the given object falls under the click coordinates!@#&]]--!@#&function CheckClick(object, x, y)!@#&	if object.X <= x and object.Y <= y and object.X + object.Width > x and object.Y + object.Height > y then!@#&		return true!@#&	end!@#&end!@#&!@#&--[[!@#&	Attempt to clicka given object!@#&]]--!@#&function DoClick(object, side, x, y, drag)!@#&	if object and CheckClick(object, x, y) then!@#&		return object:Click(side, x - object.X + 1, y - object.Y + 1, drag)!@#&	end	!@#&end!@#&!@#&--[[!@#&	Try to click at the given coordinates!@#&]]--!@#&function TryClick(event, side, x, y, drag)!@#&	if Current.InterfaceVisible and Current.Menu then!@#&		if DoClick(Current.Menu, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		else!@#&			if Current.Menu.Owner and Current.Menu.Owner.Toggle then!@#&				Current.Menu.Owner.Toggle = false!@#&			end!@#&			Current.Menu = nil!@#&			Draw()!@#&			return!@#&		end!@#&	elseif Current.Window then!@#&		if DoClick(Current.Window, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		else!@#&			Current.Window:Flash()!@#&			return!@#&		end!@#&	end!@#&	local interfaceElements = {}!@#&!@#&	if Current.InterfaceVisible then!@#&		table.insert(interfaceElements, Current.MenuBar)!@#&	else!@#&		table.insert(interfaceElements, ShowInterfaceButton)!@#&	end!@#&!@#&	for i, v in ipairs(Lists.Interface.Toolbars) do!@#&		for i, v2 in ipairs(v.ToolbarItems) do!@#&			table.insert(interfaceElements, v2)!@#&		end!@#&		table.insert(interfaceElements, v)!@#&	end!@#&!@#&	table.insert(interfaceElements, Current.Artboard)!@#&!@#&	for i, object in ipairs(interfaceElements) do!@#&		if DoClick(object, side, x, y, drag) then!@#&			Draw()!@#&			return!@#&		end		!@#&	end!@#&	Draw()!@#&end!@#&!@#&--[[!@#&	Registers functions to run on certain events!@#&]]--!@#&function EventRegister(event, func)!@#&	if not Events[event] then!@#&		Events[event] = {}!@#&	end!@#&!@#&	table.insert(Events[event], func)!@#&end!@#&!@#&--[[!@#&	The main loop event handler, runs registered event functinos!@#&]]--!@#&function EventHandler()!@#&	while true do!@#&		local event, arg1, arg2, arg3, arg4 = os.pullEventRaw()!@#&		if Events[event] then!@#&			for i, e in ipairs(Events[event]) do!@#&				e(event, arg1, arg2, arg3, arg4)!@#&			end!@#&		end!@#&	end!@#&end!@#&!@#&--[[!@#&	Thanks to NitrogenFingers for the colour functions and NFT + NFP read/write functions!@#&]]--!@#&!@#&--[[!@#&	Gets the hex value from a colour!@#&]]--!@#&local hexnums = { [10] = \"a\", [11] = \"b\", [12] = \"c\", [13] = \"d\", [14] = \"e\" , [15] = \"f\" }!@#&local function getHexOf(colour)!@#&    if colour == colours.transparent or not colour or not tonumber(colour) then!@#&            return \" \"!@#&    end!@#&    local value = math.log(colour)/math.log(2)!@#&    if value > 9 then!@#&            value = hexnums[value]!@#&    end!@#&    return value!@#&end!@#&!@#&--[[!@#&	Gets the colour from a hex value!@#&]]--!@#&local function getColourOf(hex)!@#&	if hex == ' ' then!@#&		return colours.transparent!@#&	end!@#&    local value = tonumber(hex, 16)!@#&    if not value then return nil end!@#&    value = math.pow(2,value)!@#&    return value!@#&end!@#&!@#&--[[!@#&	Saves the current artboard in .skch format!@#&]]--!@#&function SaveSKCH()!@#&	local layers = {}!@#&	for i, l in ipairs(Current.Artboard.Layers) do!@#&		local pixels = SaveNFT(i)!@#&		local layer = {!@#&			Name = l.Name,!@#&			Pixels = pixels,!@#&			BackgroundColour = l.BackgroundColour,!@#&			Visible = l.Visible,!@#&			Index = l.Index,!@#&		}!@#&		table.insert(layers, layer)!@#&	end!@#&	return layers!@#&end!@#&!@#&--[[!@#&	Saves the current artboard in .nft format!@#&]]--!@#&function SaveNFT(layer)!@#&	layer = layer or 1!@#&	local lines = {}!@#&	local width = Current.Artboard.Width!@#&	local height = Current.Artboard.Height!@#&	for y = 1, height do!@#&		local line = ''!@#&		local currentBackgroundColour = nil!@#&		local currentTextColour = nil!@#&		for x = 1, width do!@#&			local pixel = Current.Artboard.Layers[layer].Pixels[x][y]!@#&			if pixel.BackgroundColour ~= currentBackgroundColour then!@#&				line = line..string.char(30)..getHexOf(pixel.BackgroundColour)!@#&				currentBackgroundColour = pixel.BackgroundColour!@#&			end!@#&			if pixel.TextColour ~= currentTextColour then!@#&				line = line..string.char(31)..getHexOf(pixel.TextColour)!@#&				currentTextColour = pixel.TextColour!@#&			end!@#&			line = line .. pixel.Character!@#&		end!@#&		table.insert(lines, line)!@#&	end!@#&	return lines!@#&end!@#&!@#&--[[!@#&	Saves the current artboard in .nfp format!@#&]]--!@#&function SaveNFP()!@#&	local lines = {}!@#&	local width = Current.Artboard.Width!@#&	local height = Current.Artboard.Height!@#&	for y = 1, height do!@#&		local line = ''!@#&		for x = 1, width do!@#&			line = line .. getHexOf(Current.Artboard.Layers[1].Pixels[x][y].BackgroundColour)!@#&		end!@#&		table.insert(lines, line)!@#&	end!@#&	return lines!@#&end!@#&!@#&--[[!@#&	Reads a .nfp file from the given path!@#&]]--!@#&function ReadNFP(path)!@#&	local pixels = {}!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	local file = _fs.open(path, 'r')!@#&	local line = file.readLine()!@#&	local y = 1!@#&	while line do!@#&		for x = 1, #line do!@#&			if not pixels[x] then!@#&				pixels[x] = {}!@#&			end!@#&			pixels[x][y] = {BackgroundColour = getColourOf(line:sub(x,x))}!@#&		end!@#&		y = y + 1!@#&		line = file.readLine()!@#&	end!@#&	file.close()!@#&	return {{Pixels = pixels}}!@#&end!@#&!@#&--[[!@#&	Reads a .nft file from the given path!@#&]]--!@#&function ReadNFT(path)!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	local file = _fs.open(path, 'r')!@#&	local line = file.readLine()!@#&	local lines = {}!@#&	while line do!@#&		table.insert(lines, line)!@#&		line = file.readLine()!@#&	end!@#&	file.close()!@#&	return {{Pixels = ParseNFT(lines)}}!@#&end!@#&!@#&--[[!@#&	Converts the lines of an .nft document to readble pixel data!@#&]]--!@#&function ParseNFT(lines)!@#&	local pixels = {}!@#&	for y, line in ipairs(lines) do!@#&		local bgNext, fgNext = false, false!@#&		local currBG, currFG = nil,nil!@#&		local writePosition = 1!@#&		for x = 1, #line do!@#&			if not pixels[writePosition] then!@#&				pixels[writePosition] = {}!@#&			end!@#&!@#&			local nextChar = string.sub(line, x, x)!@#&            if nextChar:byte() == 30 then!@#&                    bgNext = true!@#&            elseif nextChar:byte() == 31 then!@#&                    fgNext = true!@#&            elseif bgNext then!@#&                    currBG = getColourOf(nextChar)!@#&                    if currBG == nil then!@#&                    	currBG = colours.transparent!@#&                    end!@#&                    bgNext = false!@#&            elseif fgNext then!@#&                    currFG = getColourOf(nextChar)!@#&                    fgNext = false!@#&            else!@#&                    if nextChar ~= \" \" and currFG == nil then!@#&                            currFG = colours.white!@#&                    end!@#&                    pixels[writePosition][y] = {BackgroundColour = currBG, TextColour = currFG, Character = nextChar}!@#&                    writePosition = writePosition + 1!@#&            end!@#&		end!@#&	end!@#&	return pixels!@#&end!@#&!@#&--[[!@#&	Read a .skch file from the given path!@#&]]--!@#&function ReadSKCH(path)!@#&	local _fs = fs!@#&	if OneOS then!@#&		_fs = OneOS.FS!@#&	end!@#&	local file = _fs.open(path, 'r')!@#&	local _layers = textutils.unserialize(file.readAll())!@#&	file.close()!@#&	local layers = {}!@#&!@#&	for i, l in ipairs(_layers) do!@#&		local layer = {!@#&			Name = l.Name,!@#&			Pixels = ParseNFT(l.Pixels),!@#&			BackgroundColour = l.BackgroundColour,!@#&			Visible = l.Visible,!@#&			Index = l.Index,!@#&		}!@#&		table.insert(layers, layer)!@#&	end!@#&	return layers!@#&end!@#&!@#&--[[!@#&	Start the program after all functions and tables are loaded!@#&]]--!@#&if term.isColor and term.isColor() then!@#&	Initialise(...)!@#&else!@#&	print('Sorry, but Sketch only works on Advanced (gold) Computers')!@#&end",["About"]="local xSize, ySize = term.getSize()!@#& !@#&local fileImage = 0!@#&local fileDocument = 0!@#&local fileOther = 0!@#&local computerLabel = os.getComputerLabel()!@#&if computerLabel == nil then computerLabel = \"not set\" end!@#& !@#&--------------------MODEM FIND----------------------------!@#&function findModem()!@#&        local PeriList = rs.getSides() --peripheral.getNames()!@#&        for i=1,#PeriList do!@#&                if peripheral.getType(PeriList[i]) == \"modem\" then!@#&                        return PeriList[i]!@#&                end!@#&        end!@#&end!@#& !@#&local computerModem = findModem()!@#&if computerModem == nil then computerModem = \"not found\" end!@#& !@#&local function clearScreen(color)!@#&        term.setBackgroundColor(color)!@#&        term.clear()!@#&end!@#& !@#&local function fadeIn(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.white)!@#&        sleep(time)!@#&end!@#& !@#&local function fadeOut(time)!@#&        clearScreen(colors.lightGray)!@#&        sleep(time)!@#&        clearScreen(colors.gray)!@#&        sleep(time)!@#&        clearScreen(colors.black)!@#&        sleep(time)!@#&        term.setCursorPos(1,1)!@#&        term.setTextColor(colors.white)!@#&end!@#& !@#&local function getSizeOfAll()!@#&        local sizeOfAll1 = 0!@#&        local function files(path)!@#&                local massiv = fs.list(path)!@#&                for i=1,#massiv do!@#&                        if fs.isDir(massiv[i]) then!@#&                                files(path..\"/\"..massiv[i])!@#&                        else!@#&                                sizeOfAll1 = sizeOfAll1 + fs.getSize(path..\"/\"..massiv[i])!@#&                        end!@#&                end!@#&        end!@#&        files(\"\")!@#&        return sizeOfAll1!@#&end!@#& !@#&local function getFileFormat(file)!@#&        local start,ending = string.find(file,\"%.%w*$\")!@#&        if start == nil then!@#&                return nil!@#&        else!@#&                return string.sub(file,start,ending)!@#&        end!@#&end!@#& !@#&local function getSizeOfFormat()!@#&        local sizeOfAll1 = 0!@#&        local function files(path)!@#&                local massiv = fs.list(path)!@#&                for i=1,#massiv do!@#&                        if fs.isDir(massiv[i]) then!@#&                                files(path..\"/\"..massiv[i])!@#&                        else!@#&                                local f = getFileFormat(path..\"/\"..massiv[i])!@#&                                local s = fs.getSize(path..\"/\"..massiv[i])!@#&                                if f == \".nfp\" or f == \".png\" or f == \".skch\" then!@#&                                        fileImage = fileImage + s!@#&                                elseif f == \".cfg\" or f == \".log\" or f == \".txt\" or f == \".nfa\" or f == \".zip\" then!@#&                                        fileDocument = fileDocument + s!@#&                                elseif f == nil then!@#&                                        fileOther = fileOther + s!@#&                                end!@#&                        end!@#&                end!@#&        end!@#&        files(\"\")!@#&        return sizeOfAll1!@#&end!@#& !@#&local function writeText(text,x,y)!@#&        term.setCursorPos(x,y)!@#&        term.write(text)!@#&end!@#& !@#&local function infoText(key,keyColor,value,x,y)!@#&        term.setCursorPos(x,y)!@#&        term.setTextColor(keyColor)!@#&        term.write(key..\": \")!@#&        term.setTextColor(colors.lightGray)!@#&        term.write(value)!@#&end!@#& !@#&getSizeOfFormat()!@#& !@#&local sizeOfAll =  getSizeOfAll()!@#&local freeSpace = 64000000!@#&local totalSpace = freeSpace + sizeOfAll!@#&local lengthOfPolosa = xSize-6!@#&local lengthOfAll = math.floor(lengthOfPolosa*(math.ceil(sizeOfAll/totalSpace*100))/100)!@#&local lengthOfDocuments = math.floor(lengthOfPolosa*math.ceil(fileDocument/sizeOfAll*100)/100)!@#&local lengthOfImages = math.floor(lengthOfPolosa*math.ceil(fileImage/sizeOfAll*100)/100)!@#& !@#&-------------------------------------------------------------!@#&fadeIn(0.05)!@#& !@#&local xStart = math.floor(xSize/2-lengthOfPolosa/2)!@#&local yStart = ySize-3!@#& !@#& !@#&local function displayBar(time)!@#&        while true do!@#&        for y=yStart,(yStart+1) do!@#&                for x=(xStart+1),(xStart+lengthOfPolosa) do!@#&                        paintutils.drawPixel(x,y,colors.gray)!@#&                end!@#&        end!@#&        for y=yStart,(yStart+1) do!@#&                for x=(xStart+1),(xStart+lengthOfAll) do!@#&                        paintutils.drawPixel(x,y,colors.black)!@#&                end!@#&        end!@#& !@#&------------------------------!@#&        sleep(2)!@#&------------------------------!@#& !@#&        for y=yStart,(yStart+1) do!@#&                for x=(xStart+1),(xStart+lengthOfPolosa) do!@#&                        paintutils.drawPixel(x,y,colors.lime)!@#&                end!@#&        end!@#&        for y=yStart,(yStart+1) do!@#&                for x=(xStart+1),(xStart+lengthOfDocuments) do!@#&                        paintutils.drawPixel(x,y,colors.red)!@#&                end!@#&        end!@#&        for y=yStart,(yStart+1) do!@#&                for x=(xStart+1+lengthOfDocuments),(xStart+lengthOfDocuments+lengthOfImages) do!@#&                        paintutils.drawPixel(x,y,colors.yellow)!@#&                end!@#&        end!@#&------------------------------!@#&        sleep(2)!@#&------------------------------!@#&        end!@#&end!@#& !@#& !@#& !@#&for i=1,xSize do!@#&        paintutils.drawPixel(i,1,colors.gray)!@#&end!@#&term.setTextColor(colors.lightGray)!@#&writeText(\"About\",math.floor(xSize/2-string.len(\"About\")/2),1)!@#& !@#&term.setBackgroundColor(colors.white)!@#&infoText(\"Computer label\",colors.gray,computerLabel,2,3)!@#&infoText(\"Computer ID\",colors.gray,tostring(os.getComputerID()),2,4)!@#&infoText(\"Connected modem\",colors.gray,computerModem,2,5)!@#&infoText(\"Aviable space\",colors.gray,math.ceil(totalSpace/1024)..\" KB\",2,6)!@#&infoText(\"Used space\",colors.black,math.ceil(sizeOfAll/1024)..\" KB\",2,8)!@#&infoText(\"Free space\",colors.gray,math.ceil(freeSpace/1024)..\" KB\",2,9)!@#&infoText(\"Documents\",colors.red,math.ceil(fileDocument/1024)..\" KB\",2,10)!@#&infoText(\"Images\",colors.yellow,math.ceil(fileImage/1024)..\" KB\",2,11)!@#&infoText(\"Other\",colors.lime,math.ceil(fileOther/1024)..\" KB\",2,12)!@#& !@#&local function touch()!@#&        while true do!@#&                event = os.pullEvent()!@#&                if event == \"key\" or event == \"mouse_click\" then break end!@#&        end!@#&end!@#& !@#&parallel.waitForAny(displayBar,touch)!@#& !@#&fadeOut(0.05)",["PictureView"]="os.loadAPI(\"/SpeedAPI/SpeedGUI\")!@#&os.loadAPI(\"/SpeedAPI/peripheral\")!@#&os.loadAPI(\"/SpeedAPI/lddfm\")!@#&!@#&term.setCursorPos(1, 1)!@#&term.clear()!@#&!@#&local args = {...}!@#&local use_monitor = false!@#&local monitor!@#&!@#&if peripheral.find(\"monitor\") then!@#&  term.setCursorPos(1, 1)!@#&  io.write(\"Program found monitor on side \"..peripheral.find(\"monitor\")..\". Do you want to use it? [y/N] \")!@#&  use_mon = io.read()!@#&  if use_mon == \"y\" or use_mon == \"Y\" then!@#&    use_monitor = true!@#&    monitor = peripheral.wrap(peripheral.find(\"monitor\"))    !@#&!@#&  else!@#&    use_monitor = false  !@#&!@#&  end!@#&end!@#&!@#&function draw_picture(filename)!@#&  term.clear()!@#&  if use_monitor then!@#&    term.redirect(monitor)  !@#&    monitor.clear()!@#&  end!@#&  !@#&  image = paintutils.loadImage(filename) !@#&  paintutils.drawImage(image, 1,1)!@#&  sleep(60)!@#&  if use_monitor then!@#&    monitor.clear()!@#&    monitor.setTextColor(colors.white)!@#&    monitor.setBackgroundColor(colors.black)!@#&    monitor.setCursorPos(1, 1)!@#&    os.reboot()!@#&!@#&  else!@#&    term.clear()!@#&    term.setTextColor(colors.white)!@#&    term.setBackgroundColor(colors.black)!@#&    term.setCursorPos(1, 1)!@#&    os.reboot()!@#&  end!@#&end!@#&!@#&if args[1] then!@#&  draw_picture(tostring(args[1]))!@#&  !@#&else!@#&  draw_picture(tostring(lddfm.makeMenu()))!@#&end",["rFTP"]="os.loadAPI(\"SpeedAPI/devices\")!@#&os.loadAPI(\"SpeedAPI/windows\")!@#&!@#&windows.clearScreen(colors.white)!@#&!@#&-- GLOBAL VARIABLES --!@#&local ver=\"1.1\"!@#&local id=os.getComputerID()!@#&local wifi!@#&local dest!@#&local sfile!@#&local sender!@#&local dcat!@#&local dfile!@#&local dpath!@#&-- /GLOBAL VARIABLES --!@#&!@#&function Main()!@#&  Clear()!@#&  Menu()!@#& !@#&  wifi=devices.find(\"modem\")!@#&  rednet.open(wifi)!@#&  if wifi~=\"none\" then!@#&    windows.error(\"You need wireless modem!\")!@#&    error()!@#&  end!@#&end!@#&!@#&function Menu()!@#&  windows.clearScreen(colors.white)!@#&  pressedButton = windows.select({\"Hello!\"},{\"Welcome to FTP!\"},{\"Send\",colors.lightGray,colors.black},{\"Receive\",colors.lightBlue,colors.black})!@#&!@#&  local p1 = pressedButton!@#&    if p1==\"Send\" then!@#&          SendMenu()!@#&    elseif p1==\"Receive\" then!@#&          DownMenu()!@#&    end!@#&end  !@#&!@#&function SendMenu()!@#&  windows.clearScreen(colors.white)!@#&  local govno = windows.input(\"auto\", \"auto\", \"Send\", 10, {\"ID\", \"\"}, {\"Filename\", \"\"})!@#&  dest=tonumber(govno[1])!@#&  sfile=govno[2]!@#&  if fs.exists(sfile)==true then!@#&    windows.clearScreen(colors.black)!@#&    term.setTextColor(colors.white)!@#&    term.setCursorPos(1,1)!@#&  else!@#&    windows.error(\"File not found!\")!@#&    Menu()!@#&  end!@#&  print(\"Estabilishing connection\")!@#&  rednet.send(dest,\"@rftpstart\")!@#&  rednet.send(dest,sfile)!@#&  print(\"Waiting for device #\"..dest..\" to respond... [Press SPACE to cancel]\")!@#&  Waiting()!@#&end!@#&!@#&function Waiting()!@#&  while true do!@#&    local event,p1,p2=os.pullEvent()!@#&!@#&    if (event==\"rednet_message\") and (p2==\"@rftpagree\") then!@#&        print(\"File accepted by #\"..dest..\"!\")!@#&        sleep(1)!@#&        Transfer()!@#&        break!@#&    elseif (event==\"rednet_message\") and (p2==\"@rftpdeny\") then!@#&        print(\"#\"..dest..\" denied connection! Any key to continue...\")!@#&        os.pullEvent(\"key\")!@#&        Menu()!@#&        break!@#&    elseif (event==\"key\") and (p1==57) then!@#&        Menu()!@#&        break!@#&    end!@#&  end!@#&end!@#&!@#&function Transfer()!@#&    local plik=fs.open(sfile,\"r\")!@#&    local tresc=plik.readAll()!@#&    rednet.send(dest,tresc)!@#&    sleep(0.3)!@#&    rednet.send(dest,\"@rftpend\")!@#&    plik.close()!@#&    print(\"Transfer complete! Any key to continue...\")!@#&    os.pullEvent(\"key\")!@#&    Menu()!@#&end!@#&    !@#&function DownMenu()!@#&    Clear()!@#&    print(\"Your ID: \"..id)!@#&    print()!@#&    print(\"Waiting for an oncoming file... [Press SPACE to cancel]\")!@#&    local event,p1,p2!@#&    repeat!@#&    event,p1,p2=os.pullEvent()!@#&    until ((event==\"rednet_message\") and (p2==\"@rftpstart\")) or ((event==\"key\") and (p1==57))!@#&    if (event==\"rednet_message\") and (p2==\"@rftpstart\") then!@#&        sender=p1!@#&        event,p1,p2=os.pullEvent(\"rednet_message\")!@#&        print(\"Device \"..p1..\" want to send you a file: \"..p2..\". Accept? [y/N]\")!@#&        local event,pp1=os.pullEvent(\"key\")!@#&        if (pp1==20) or (pp1==21) then!@#&            Download()!@#&        else!@#&            rednet.send(p1,\"@rftpdeny\")!@#&            Menu()!@#&        end!@#&    elseif (event==\"key\") and (p1==57) then!@#&        Menu()!@#&    end!@#&end!@#&!@#&function Download()!@#&    Clear()!@#&    !@#&    print(\"Select the folder: [default: /SpeedOS/Downloads]\")!@#&    dcat=read()!@#&    if dcat==\"\" then!@#&        dcat=\"/SpeedOS/Downloads\"!@#&    end!@#&    fs.makeDir(dcat)!@#&    !@#&    print(\"Select filename:\")!@#&    dfile=read()!@#&    !@#&    dpath=fs.combine(dcat,dfile)!@#&    !@#&    if fs.exists(dpath)==false then!@#&        SaveFile()!@#&    else!@#&        print(\"File already exists! Try again? [y/N]\")!@#&        local event,p1=os.pullEvent(\"key\")!@#&        if (p1==20) or (p1==21) then!@#&            Download()!@#&        else!@#&            rednet.send(p1,\"@rftpdeny\")!@#&            Menu()!@#&        end!@#&    end!@#&end!@#&!@#&function SaveFile()!@#&    local plik=fs.open(dpath,\"w\")!@#&    rednet.send(p1,\"@rftpagree\")!@#&    local event,p1,p2!@#&    repeat!@#&        event,p1,p2=os.pullEvent(\"rednet_message\")!@#&    until p1==sender!@#&    if p2~=\"@rftpend\" then!@#&        plik.write(p2)!@#&    end!@#&    os.startTimer(10)!@#&    while true do!@#&        local event,p1,p2=os.pullEvent()!@#&        if event==\"rednet_message\" and p1==sender and p2==\"@rftpend\" then!@#&            write(\"Transfer completed! \")!@#&            break!@#&        elseif event==\"timer\" then!@#&            write(\"Timed out! Check the file. \")!@#&            break!@#&        end!@#&    end!@#&    plik.close()!@#&    print(\"Any key to continue...\")!@#&    os.pullEvent(\"key\")!@#&    Menu()!@#&end!@#&!@#&function Clear()!@#&  windows.clearScreen(colors.black)!@#&  term.setTextColor(colors.white)!@#&  term.setCursorPos(1, 1)!@#&end!@#&!@#&Main()",},["Videos"]={},},} local function makeFile(_path, _content) local file = fs.open(_path, "w") _content = _content:gsub("!@".."#&", "%\n") _content = textutils.unserialize(_content) file.write(_content) file.close() end local function makeFolder(_path, _content) fs.makeDir(_path) for k,v in pairs(_content) do if type(v) == "table" then makeFolder(_path .. "/" .. k, v) else makeFile(_path .. "/" .. k, v) end end end local sDest = shell.resolve( '/' ) or "/" if sDest == "root" then sDest = "/" end local tPackage = pkg makeFolder(sDest, tPackage)